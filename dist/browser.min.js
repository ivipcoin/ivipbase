(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.ivipbase=f()}})((function(){var define,module,exports;return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,(function(r){var n=e[i][1][r];return o(n||r)}),p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.deleteApp=exports.getFirstApp=exports.getApps=exports.getApp=exports.appExists=exports.initializeApp=exports.IvipBaseApp=void 0;const ivipbase_core_1=require("ivipbase-core");const internal_1=require("./internal");const erros_1=require("../controller/erros");const server_1=require("../server");const verifyStorage_1=require("./verifyStorage");const settings_1=require("./settings");class IvipBaseApp extends ivipbase_core_1.SimpleEventEmitter{constructor(options){super();this._ready=false;this.name=internal_1.DEFAULT_ENTRY_NAME;this.settings=new settings_1.IvipBaseSettings;this.storage=new verifyStorage_1.DataStorage;this.isDeleted=false;if(typeof options.name==="string"){this.name=options.name}if(options.settings instanceof settings_1.IvipBaseSettings){this.settings=options.settings}if(typeof options.isDeleted==="boolean"){this.isDeleted=options.isDeleted}this.storage=(0,verifyStorage_1.applySettings)(this.settings.dbname,this.settings.storage);this.isServer=typeof this.settings.server==="object";this.once("ready",(()=>{this._ready=true}))}init(){if(!this._ready){if(this.isServer){this.server=new server_1.LocalServer(this.name,this.settings.server);this.server.ready((()=>{this.emitOnce("ready")}))}else{this.emitOnce("ready")}}}async ready(callback){if(!this._ready){await new Promise((resolve=>this.on("ready",resolve)))}callback===null||callback===void 0?void 0:callback()}get isReady(){return this._ready}}exports.IvipBaseApp=IvipBaseApp;function initializeApp(options){const settings=new settings_1.IvipBaseSettings(options);const newApp=new IvipBaseApp({name:settings.name,settings:settings});const existingApp=internal_1._apps.get(newApp.name);if(existingApp){if(ivipbase_core_1.Utils.deepEqual(newApp.settings,existingApp.settings)){return existingApp}else{throw erros_1.ERROR_FACTORY.create("duplicate-app",{appName:newApp.name})}}internal_1._apps.set(newApp.name,newApp);newApp.init();return newApp}exports.initializeApp=initializeApp;function appExists(name){return typeof name==="string"&&internal_1._apps.has(name)}exports.appExists=appExists;function getApp(name=internal_1.DEFAULT_ENTRY_NAME){const app=internal_1._apps.get(name);if(!app){throw erros_1.ERROR_FACTORY.create("no-app",{appName:name})}return app}exports.getApp=getApp;function getApps(){return Array.from(internal_1._apps.values())}exports.getApps=getApps;function getFirstApp(){let app;if(internal_1._apps.has(internal_1.DEFAULT_ENTRY_NAME)){app=internal_1._apps.get(internal_1.DEFAULT_ENTRY_NAME)}app=!app?getApps()[0]:app;if(!app){throw erros_1.ERROR_FACTORY.create("no-app",{appName:internal_1.DEFAULT_ENTRY_NAME})}return app}exports.getFirstApp=getFirstApp;function deleteApp(app){const name=app.name;if(internal_1._apps.has(name)){internal_1._apps.delete(name);app.isDeleted=true}}exports.deleteApp=deleteApp},{"../controller/erros":7,"../server":19,"./internal":2,"./settings":4,"./verifyStorage":5,"ivipbase-core":273}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports._apps=exports.DEFAULT_ENTRY_NAME=void 0;exports.DEFAULT_ENTRY_NAME="[DEFAULT]";exports._apps=new Map},{}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.IvipBaseSettings=exports.ServerEmailSettings=void 0;const internal_1=require("../internal");const verifyStorage_1=require("../verifyStorage");class NotImplementedError extends Error{constructor(name){super(`${name} is not implemented`)}}class ServerEmailSettings{constructor(options){this.prepareModel=()=>({title:"",subject:"",message:""});this.server=options.server}send(request){throw new NotImplementedError("ServerEmail")}}exports.ServerEmailSettings=ServerEmailSettings;const hostnameRegex=/^(?:(?:https?|ftp):\/\/)?(?:localhost|(?:[a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.[a-zA-Z]{2,}|(?:\d{1,3}\.){3}\d{1,3})$/;class IvipBaseSettings{constructor(options={}){this.name=internal_1.DEFAULT_ENTRY_NAME;this.dbname="root";this.logLevel="log";this.storage=new verifyStorage_1.DataStorageSettings;this.isServer=false;this.isValidClient=false;if(typeof options.name==="string"){this.name=options.name}if(typeof options.dbname==="string"){this.dbname=options.dbname}if(typeof options.logLevel==="string"&&["log","warn","error"].includes(options.logLevel)){this.logLevel=options.logLevel}if((0,verifyStorage_1.validSettings)(options.storage)){this.storage=options.storage}if(typeof options.host==="string"&&hostnameRegex.test(options.host)){this.host=options.host;this.isValidClient=true}if(typeof options.port==="number"){this.port=options.port}}}exports.IvipBaseSettings=IvipBaseSettings},{"../internal":2,"../verifyStorage":5}],4:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.IvipBaseSettings=void 0;const server_1=require("../../server");const browser_1=require("./browser");const nodemailer_1=__importDefault(require("nodemailer"));const juice_1=__importDefault(require("juice"));const getTemplateValueBy=(str,actions)=>{var _a,_b;str=String(!str||String(str).trim()===""?"":str);actions=!actions||typeof actions!=="object"?{}:actions;const expression=/\{\{(([a-z0-9_\-]+\.?)+)\}\}/i;if(expression.test(str)!==true){return str}let path=(_a=(str!==null&&str!==void 0?str:"").match(expression))===null||_a===void 0?void 0:_a[1];if(path){let value=actions;path.split(".").forEach(((key,i)=>{value=value&&typeof value==="object"&&key in value?value[key]:null}));value=typeof value==="function"?value():["string","number","boolean"].includes(typeof value)?value:"[[ERROR]]";str=str.replace(new RegExp("{{"+path+"}}","gi"),(_b=value)!==null&&_b!==void 0?_b:"")}return getTemplateValueBy(str,actions)};class ServerEmailSettings extends browser_1.ServerEmailSettings{constructor(options){super(options);this.prepareModel=request=>{let title="iVipBase";let subject="";let message="";try{}catch(_a){}return{title:title,subject:subject,message:message}};if(typeof options.prepareModel==="function"){this.prepareModel=options.prepareModel}this.transporter=nodemailer_1.default.createTransport({host:this.server.host,port:this.server.port,secure:this.server.secure,auth:{user:this.server.user,pass:this.server.pass}})}async send(request){const{title:title,subject:subject,message:message}=this.prepareModel(request);await this.transporter.sendMail({priority:"high",from:`${title} <${this.server.user}>`,to:request.user.email,subject:subject,text:subject,html:(0,juice_1.default)(getTemplateValueBy(message,request),{removeStyleTags:false})})}}class IvipBaseSettings extends browser_1.IvipBaseSettings{constructor(options={}){super(options);this.isServer=false;this.isValidClient=false;if(options.isServer&&server_1.isPossiblyServer){this.server=new server_1.ServerSettings(options);if(typeof options.email==="object"){this.email=new ServerEmailSettings(options.email)}}}}exports.IvipBaseSettings=IvipBaseSettings},{"../../server":19,"./browser":3,juice:275,nodemailer:311}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataStorageSettings=exports.DataStorage=exports.CustomStorage=exports.applySettings=exports.validSettings=void 0;const storage_1=require("../../controller/storage");Object.defineProperty(exports,"CustomStorage",{enumerable:true,get:function(){return storage_1.CustomStorage}});Object.defineProperty(exports,"DataStorage",{enumerable:true,get:function(){return storage_1.DataStorage}});Object.defineProperty(exports,"DataStorageSettings",{enumerable:true,get:function(){return storage_1.DataStorageSettings}});function validSettings(options){return options instanceof storage_1.DataStorageSettings||options instanceof storage_1.CustomStorage}exports.validSettings=validSettings;function applySettings(dbname,options){if(options instanceof storage_1.DataStorageSettings){return new storage_1.DataStorage(options)}else if(options instanceof storage_1.CustomStorage){return options}return new storage_1.DataStorage}exports.applySettings=applySettings},{"../../controller/storage":17}],6:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});exports.DataStorageSettings=exports.CustomStorage=void 0;var storage_1=require("./controller/storage");Object.defineProperty(exports,"CustomStorage",{enumerable:true,get:function(){return storage_1.CustomStorage}});Object.defineProperty(exports,"DataStorageSettings",{enumerable:true,get:function(){return storage_1.DataStorageSettings}});__exportStar(require("./app"),exports);__exportStar(require("./database"),exports)},{"./app":1,"./controller/storage":17,"./database":18}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ERROR_FACTORY=void 0;const util_1=require("./util");const ERRORS={["no-app"]:"Nenhum aplicativo iVipBase '{$appName}' foi criado - "+"chame inicializeApp() primeiro",["bad-app-name"]:"Nome de aplicativo ilegal: '{$appName}",["duplicate-app"]:"O aplicativo Firebase chamado '{$appName}' já existe com diferentes opções ou configurações",["app-deleted"]:"Aplicativo iVipBase chamado '{$appName}' já excluído",["db-disconnected"]:"Banco de dados '{$dbName}' desconectado",["db-connection-error"]:"Database connection error: {$error}"};exports.ERROR_FACTORY=new util_1.ErrorFactory("app","Firebase",ERRORS)},{"./util":8}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ErrorFactory=exports.MainError=void 0;const ERROR_NAME="iVipBaseError";class MainError extends Error{constructor(code,message,customData){super(message);this.code=code;this.customData=customData;this.name=ERROR_NAME;Object.setPrototypeOf(this,MainError.prototype);if(Error.captureStackTrace){Error.captureStackTrace(this,ErrorFactory.prototype.create)}}}exports.MainError=MainError;const PATTERN=/\{\$([^}]+)}/g;function replaceTemplate(template,data){return template.replace(PATTERN,((_,key)=>{const value=data[key];return value!=null?String(value):`<${key}?>`}))}class ErrorFactory{constructor(service,serviceName,errors){this.service=service;this.serviceName=serviceName;this.errors=errors}create(code,...data){const customData=data[0]||{};const fullCode=`${this.service}/${code}`;const template=this.errors[code];const message=template?replaceTemplate(template,customData):"Error";const fullMessage=`${this.serviceName}: ${message} (${fullCode}).`;const error=new MainError(fullCode,fullMessage,customData);return error}}exports.ErrorFactory=ErrorFactory},{}],9:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};Object.defineProperty(exports,"__esModule",{value:true});exports.CustomStorage=exports.CustomStorageSettings=void 0;const erros_1=require("../erros");const MDE_1=__importStar(require("./MDE"));class CustomStorageSettings extends MDE_1.MDESettings{constructor(options={}){super(options)}}exports.CustomStorageSettings=CustomStorageSettings;class CustomStorage extends MDE_1.default{constructor(options={}){super(Object.assign(Object.assign({},options),{getMultiple:e=>{if(!this.ready){throw erros_1.ERROR_FACTORY.create("db-disconnected",{dbName:this.dbName})}return this.getMultiple(e)},setNode:(path,content,node)=>{if(!this.ready){throw erros_1.ERROR_FACTORY.create("db-disconnected",{dbName:this.dbName})}return this.setNode(path,content,node)},removeNode:(path,content,node)=>{if(!this.ready){throw erros_1.ERROR_FACTORY.create("db-disconnected",{dbName:this.dbName})}return this.removeNode(path,content,node)}}));this.dbName="CustomStorage";this.ready=false}}exports.CustomStorage=CustomStorage},{"../erros":7,"./MDE":13}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataStorage=exports.DataStorageSettings=void 0;const CustomStorage_1=require("./CustomStorage");class DataStorageSettings extends CustomStorage_1.CustomStorageSettings{constructor(options={}){super(options)}}exports.DataStorageSettings=DataStorageSettings;class DataStorage extends CustomStorage_1.CustomStorage{constructor(options={}){super(options);this.data=new Map;this.dbName="TempStorage";this.ready=true}async getMultiple(expression){const list=[];this.data.forEach(((content,path)=>{if(expression.test(path)){if(content){list.push({path:path,content:content})}}}));return list}async setNode(path,content){this.data.set(path,content)}async removeNode(path){this.data.delete(path)}}exports.DataStorage=DataStorage},{"./CustomStorage":9}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CustomStorageNodeInfo=exports.NodeInfo=exports.NodeAddress=void 0;const ivipbase_core_1=require("ivipbase-core");const utils_1=require("./utils");class NodeAddress{constructor(path){this.path=path}toString(){return`"/${this.path}"`}equals(address){return ivipbase_core_1.PathInfo.get(this.path).equals(address.path)}}exports.NodeAddress=NodeAddress;class NodeInfo{constructor(info){this.path=info.path;this.type=info.type;this.index=info.index;this.key=info.key;this.exists=info.exists;this.address=info.address;this.value=info.value;this.childCount=info.childCount;if(typeof this.path==="string"&&typeof this.key==="undefined"&&typeof this.index==="undefined"){const pathInfo=ivipbase_core_1.PathInfo.get(this.path);if(typeof pathInfo.key==="number"){this.index=pathInfo.key}else{this.key=pathInfo.key}}if(typeof this.exists==="undefined"){this.exists=true}}get valueType(){return this.type}get valueTypeName(){return(0,utils_1.getValueTypeName)(this.valueType)}toString(){if(!this.exists){return`"${this.path}" doesn't exist`}if(this.address){return`"${this.path}" is ${this.valueTypeName} stored at ${this.address.toString()}`}else{return`"${this.path}" is ${this.valueTypeName} with value ${this.value}`}}}exports.NodeInfo=NodeInfo;class CustomStorageNodeInfo extends NodeInfo{constructor(info){super(info);this.revision=info.revision;this.revision_nr=info.revision_nr;this.created=info.created;this.modified=info.modified}}exports.CustomStorageNodeInfo=CustomStorageNodeInfo},{"./utils":16,"ivipbase-core":273}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const ivipbase_core_1=require("ivipbase-core");const utils_1=require("./utils");function destructureData(type,path,data,options={}){var _a,_b;let result=(_a=options===null||options===void 0?void 0:options.previous_result)!==null&&_a!==void 0?_a:[];let pathInfo=ivipbase_core_1.PathInfo.get(path);const revision=(_b=options===null||options===void 0?void 0:options.assert_revision)!==null&&_b!==void 0?_b:ivipbase_core_1.ID.generate();options.assert_revision=revision;options.include_checks=typeof options.include_checks==="boolean"?options.include_checks:true;if(options.include_checks){while(typeof pathInfo.parentPath==="string"&&pathInfo.parentPath.trim()!==""){const node={path:pathInfo.parentPath,type:"VERIFY",content:{type:typeof pathInfo.key==="number"?utils_1.nodeValueTypes.ARRAY:utils_1.nodeValueTypes.OBJECT,value:{},revision:revision,revision_nr:1,created:Date.now(),modified:Date.now()}};result.push(node);pathInfo=ivipbase_core_1.PathInfo.get(pathInfo.parentPath)}}options.include_checks=false;let value=data;let valueType=(0,utils_1.getValueType)(value);if(typeof value==="object"){value={};valueType=Array.isArray(data)?utils_1.VALUE_TYPES.ARRAY:utils_1.VALUE_TYPES.OBJECT;for(let key in data){if(valueType===utils_1.VALUE_TYPES.OBJECT&&(0,utils_1.valueFitsInline)(data[key],this.settings)){value[key]=(0,utils_1.getTypedChildValue)(data[key]);continue}result=destructureData.apply(this,[type,ivipbase_core_1.PathInfo.get([path,valueType===utils_1.VALUE_TYPES.OBJECT?key:parseInt(key)]).path,data[key],Object.assign(Object.assign({},options),{previous_result:result})])}}const node={path:path,type:type,content:{type:valueType,value:value,revision:revision,revision_nr:1,created:Date.now(),modified:Date.now()}};result.push(node);return result}exports.default=destructureData},{"./utils":16,"ivipbase-core":273}],13:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.MDESettings=exports.VALUE_TYPES=void 0;const ivipbase_core_1=require("ivipbase-core");const NodeInfo_1=require("./NodeInfo");const utils_1=require("./utils");Object.defineProperty(exports,"VALUE_TYPES",{enumerable:true,get:function(){return utils_1.VALUE_TYPES}});const prepareMergeNodes_1=__importDefault(require("./prepareMergeNodes"));const structureNodes_1=__importDefault(require("./structureNodes"));const destructureData_1=__importDefault(require("./destructureData"));class MDESettings{constructor(options){this.prefix="root";this.maxInlineValueSize=50;this.removeVoidProperties=false;this.commit=()=>{};this.rollback=()=>{};this.getMultiple=()=>[];this.setNode=()=>{};this.removeNode=()=>{};if(typeof options.prefix==="string"&&options.prefix.trim()!==""){this.prefix=options.prefix}if(typeof options.maxInlineValueSize==="number"){this.maxInlineValueSize=options.maxInlineValueSize}if(typeof options.removeVoidProperties==="boolean"){this.removeVoidProperties=options.removeVoidProperties}if(typeof options.removeVoidProperties==="boolean"){this.removeVoidProperties=options.removeVoidProperties}if(typeof options.commit==="function"){this.commit=options.commit}if(typeof options.rollback==="function"){this.rollback=options.rollback}this.getMultiple=async reg=>{if(typeof options.getMultiple==="function"){return await Promise.race([options.getMultiple(reg)])}return[]};this.setNode=async(path,content,node)=>{if(typeof options.setNode==="function"){await Promise.race([options.setNode(path,content,node)])}};this.removeNode=async(path,content,node)=>{if(typeof options.removeNode==="function"){await Promise.race([options.removeNode(path,content,node)])}};if(typeof options.init==="function"){this.init=options.init}}}exports.MDESettings=MDESettings;class MDE extends ivipbase_core_1.SimpleEventEmitter{constructor(options={}){super();this.nodes=[];this.batch=[];this.sendingNodes=Promise.resolve();this.settings=new MDESettings(options);this.init()}init(){if(typeof this.settings.init==="function"){this.settings.init.apply(this,[])}}pathToRegex(path,onlyChildren=false,allHeirs=false){const pathsRegex=[];const replasePathToRegex=path=>{path=path.replace(/\/((\*)|(\$[^/\$]*))/g,"/([^/]*)");path=path.replace(/\[\*\]/g,"\\[(\\d+)\\]");return path};pathsRegex.push(replasePathToRegex(path));if(onlyChildren){pathsRegex.forEach((exp=>pathsRegex.push(`${exp}((/([^/]*)){1})`)))}else if(allHeirs){pathsRegex.forEach((exp=>pathsRegex.push(`${exp}((/([^/]*)){1,})`)))}pathsRegex.push(replasePathToRegex(ivipbase_core_1.PathInfo.get(path).parentPath));const fullRegex=new RegExp(`^(${pathsRegex.join("$)|(")}$)`);return fullRegex}async isPathExists(path){const nodeList=await this.getNodesBy(path,false,false).then((nodes=>Promise.resolve(nodes.sort((({content:{modified:aM}},{content:{modified:bM}})=>aM>bM?-1:aM<bM?1:0)).filter((({path:path,content:{modified:modified}},i,l)=>{const indexRecent=l.findIndex((({path:p,content:{modified:m}})=>p===path&&m>modified));return indexRecent<0||indexRecent===i})))));let nodeSelected=nodeList.find((({path:p})=>ivipbase_core_1.PathInfo.get(p).equals(path)||ivipbase_core_1.PathInfo.get(p).isParentOf(path)));if(!nodeSelected){return false}else if(ivipbase_core_1.PathInfo.get(nodeSelected.path).isParentOf(path)){const key=ivipbase_core_1.PathInfo.get(path).key;return key!==null&&nodeSelected.content.type===utils_1.nodeValueTypes.OBJECT&&Object.keys(nodeSelected.content.value).includes(key)}return ivipbase_core_1.PathInfo.get(nodeSelected.path).equals(path)}async getNodesBy(path,onlyChildren=false,allHeirs=false){const reg=this.pathToRegex(path,onlyChildren,allHeirs);let nodeList=this.nodes.concat(this.batch).filter((({path:path})=>reg.test(path)));let byNodes=[];try{byNodes=await this.settings.getMultiple(reg)}catch(_a){}const{result:result}=prepareMergeNodes_1.default.apply(this,[byNodes,nodeList]);let nodes=result.filter((({path:p})=>ivipbase_core_1.PathInfo.get(path).equals(p)));if(nodes.length<=0){nodes=result.filter((({path:p})=>ivipbase_core_1.PathInfo.get(path).isChildOf(p)))}else if(onlyChildren){nodes=result.filter((({path:p})=>ivipbase_core_1.PathInfo.get(path).equals(p)||ivipbase_core_1.PathInfo.get(path).isParentOf(p)))}else if(allHeirs){nodes=result.filter((({path:p})=>ivipbase_core_1.PathInfo.get(path).equals(p)||ivipbase_core_1.PathInfo.get(path).isAncestorOf(p)))}return nodes}async getNodeParentBy(path){const pathInfo=ivipbase_core_1.PathInfo.get(path);const nodes=await this.getNodesBy(path,false);return nodes.filter((node=>{const nodePath=ivipbase_core_1.PathInfo.get(node.path);return nodePath.path===""||pathInfo.path===nodePath.path||nodePath.isParentOf(pathInfo)})).sort(((a,b)=>{const pathA=ivipbase_core_1.PathInfo.get(a.path);const pathB=ivipbase_core_1.PathInfo.get(b.path);return pathA.isDescendantOf(pathB.path)?-1:pathB.isDescendantOf(pathA.path)?1:0})).shift()}async sendNodes(){const status=await(0,utils_1.promiseState)(this.sendingNodes);if(status==="pending"){return}this.sendingNodes=new Promise((async resolve=>{this.batch=this.nodes.splice(0).sort((({content:{modified:aM}},{content:{modified:bM}})=>aM>bM?1:aM<bM?-1:0)).filter((({path:path},i,list)=>list.findIndex((({path:p})=>ivipbase_core_1.PathInfo.get(p).equals(path)))===i)).sort((({path:a},{path:b})=>ivipbase_core_1.PathInfo.get(a).isAncestorOf(b)?1:ivipbase_core_1.PathInfo.get(a).isDescendantOf(b)?-1:0));let listBatchRemoved=[];try{for(let node of this.batch){const reg=this.pathToRegex(node.path,false,false);const byNodes=await this.settings.getMultiple(reg);const{added:added,modified:modified,removed:removed}=prepareMergeNodes_1.default.apply(this,[byNodes,[node]]);listBatchRemoved=listBatchRemoved.concat(removed);for(let node of modified){await this.settings.setNode(node.path,node.content,node);this.batch=this.batch.filter((({path:path})=>ivipbase_core_1.PathInfo.get(path).equals(node.path)!==true));this.emit("change",{name:"change",path:node.path,value:node.content.value})}for(let node of added){await this.settings.setNode(node.path,node.content,node);this.batch=this.batch.filter((({path:path})=>ivipbase_core_1.PathInfo.get(path).equals(node.path)!==true));this.emit("add",{name:"add",path:node.path,value:node.content.value})}}for(let node of listBatchRemoved){const reg=this.pathToRegex(node.path,false,true);const byNodes=await this.settings.getMultiple(reg);for(let r of byNodes){await this.settings.removeNode(r.path,r.content,r);this.batch=this.batch.filter((({path:path})=>ivipbase_core_1.PathInfo.get(path).equals(r.path)!==true));this.emit("remove",{name:"remove",path:r.path,value:r.content.value})}}}catch(_a){}this.nodes=this.nodes.concat(this.batch);resolve()}))}pushNode(...nodes){var _a;const forNodes=(_a=Array.prototype.concat.apply([],nodes.map((node=>Array.isArray(node)?node:[node]))).filter(((node={})=>node&&typeof node.path==="string"&&"content"in node)))!==null&&_a!==void 0?_a:[];for(let node of forNodes){this.nodes.push(node)}this.sendNodes();return this}async getInfoBy(path,options={}){var _a,_b,_c,_d;const pathInfo=ivipbase_core_1.PathInfo.get(path);const nodes=await this.getNodesBy(path,options.include_child_count,false);const mainNode=nodes.find((({path:p})=>ivipbase_core_1.PathInfo.get(p).equals(path)||ivipbase_core_1.PathInfo.get(p).isParentOf(path)));const defaultNode=new NodeInfo_1.CustomStorageNodeInfo({path:pathInfo.path,key:typeof pathInfo.key==="string"?pathInfo.key:undefined,index:typeof pathInfo.key==="number"?pathInfo.key:undefined,type:0,exists:false,address:undefined,created:new Date,modified:new Date,revision:"",revision_nr:0});if(!mainNode||!pathInfo.key){return defaultNode}const content=(0,utils_1.processReadNodeValue)(mainNode.content);let value=content.value;if(pathInfo.isChildOf(mainNode.path)){if([utils_1.nodeValueTypes.OBJECT,utils_1.nodeValueTypes.ARRAY].includes(mainNode.content.type)){if(Object.keys(value).includes(pathInfo.key)){value=value[pathInfo.key]}else{value=null}}else{value=null}}const containsChild=nodes.findIndex((({path:p})=>pathInfo.isParentOf(p)))>=0;const isArrayChild=!containsChild&&mainNode.content.type===utils_1.nodeValueTypes.ARRAY;const info=new NodeInfo_1.CustomStorageNodeInfo({path:pathInfo.path,key:typeof pathInfo.key==="string"?pathInfo.key:undefined,index:typeof pathInfo.key==="number"?pathInfo.key:undefined,type:value!==null?(0,utils_1.getValueType)(value):containsChild?isArrayChild?utils_1.VALUE_TYPES.ARRAY:utils_1.VALUE_TYPES.OBJECT:0,exists:value!==null||containsChild,address:new NodeInfo_1.NodeAddress(mainNode.path),created:(_a=new Date(content.created))!==null&&_a!==void 0?_a:new Date,modified:(_b=new Date(content.modified))!==null&&_b!==void 0?_b:new Date,revision:(_c=content.revision)!==null&&_c!==void 0?_c:"",revision_nr:(_d=content.revision_nr)!==null&&_d!==void 0?_d:0});info.value=value?value:null;if(options.include_child_count&&(containsChild||isArrayChild)){info.childCount=nodes.reduce(((c,{path:p})=>c+(pathInfo.isParentOf(p)?1:0)),Object.keys(info.value).length)}return info}getChildren(path){const pathInfo=ivipbase_core_1.PathInfo.get(path);const next=async callback=>{var _a;const nodes=await this.getNodesBy(path,true,false);let isContinue=true;for(let node of nodes){if(!isContinue){break}if(pathInfo.equals(node.path)&&pathInfo.isDescendantOf(node.path)){continue}const info=await this.getInfoBy(node.path,{include_child_count:false});isContinue=(_a=callback(info))!==null&&_a!==void 0?_a:true}};return{next:next}}async get(path,options){path=ivipbase_core_1.PathInfo.get([this.settings.prefix,path]).path;const nodes=await this.getNodesBy(path,options===null||options===void 0?void 0:options.onlyChildren,true);return(0,structureNodes_1.default)(path,nodes,options)}async set(path,value,options={}){path=ivipbase_core_1.PathInfo.get([this.settings.prefix,path]).path;const nodes=destructureData_1.default.apply(this,["SET",path,value,options]);this.pushNode(nodes)}async update(path,value,options={}){path=ivipbase_core_1.PathInfo.get([this.settings.prefix,path]).path;const nodes=destructureData_1.default.apply(this,["UPDATE",path,value,options]);this.pushNode(nodes)}}exports.default=MDE},{"./NodeInfo":11,"./destructureData":12,"./prepareMergeNodes":14,"./structureNodes":15,"./utils":16,"ivipbase-core":273}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const ivipbase_core_1=require("ivipbase-core");const utils_1=require("./utils");function prepareMergeNodes(nodes,comparison=undefined){let result=[];let added=[];let modified=[];let removed=[];if(!comparison){comparison=nodes;nodes=nodes.sort((({content:{modified:aM}},{content:{modified:bM}})=>aM>bM?1:aM<bM?-1:0)).filter((({path:path},i,list)=>list.findIndex((({path:p})=>ivipbase_core_1.PathInfo.get(p).equals(path)))===i))}if(comparison.length===0){return{result:nodes,added:added,modified:modified,removed:removed}}comparison=comparison.sort((({content:{modified:aM}},{content:{modified:bM}})=>aM>bM?-1:aM<bM?1:0));const setNodeBy=node=>{const nodesIndex=nodes.findIndex((({path:path})=>ivipbase_core_1.PathInfo.get(node.path).equals(path)));if(nodesIndex<0){const addedIndex=added.findIndex((({path:path})=>ivipbase_core_1.PathInfo.get(node.path).equals(path)));if(addedIndex<0){added.push(node)}else{added[addedIndex]=node}}else{const modifiedIndex=modified.findIndex((({path:path})=>ivipbase_core_1.PathInfo.get(node.path).equals(path)));if(modifiedIndex<0){modified.push(node)}else{modified[modifiedIndex]=node}}const index=result.findIndex((({path:path})=>ivipbase_core_1.PathInfo.get(node.path).equals(path)));if(index<0){result.push(node);result=result.sort((({path:p1},{path:p2})=>ivipbase_core_1.PathInfo.get(p1).isAncestorOf(p2)?-1:ivipbase_core_1.PathInfo.get(p1).isDescendantOf(p2)?1:0))}result[index]=node;return result.findIndex((({path:path})=>ivipbase_core_1.PathInfo.get(node.path).equals(path)))};let pathsRemoved=comparison.sort((({content:{modified:aM}},{content:{modified:bM}})=>aM>bM?-1:aM<bM?1:0)).filter((({path:path,content:{modified:modified}},i,l)=>{const indexRecent=l.findIndex((({path:p,content:{modified:m}})=>p===path&&m>modified));return indexRecent<0||indexRecent===i})).filter((({content:content})=>content.type===utils_1.nodeValueTypes.EMPTY||content.value===null)).map((({path:path})=>path));pathsRemoved=nodes.filter((({path:path})=>{var _a;const{content:content}=(_a=comparison===null||comparison===void 0?void 0:comparison.find((({path:p})=>ivipbase_core_1.PathInfo.get(p).isParentOf(path))))!==null&&_a!==void 0?_a:{};const key=ivipbase_core_1.PathInfo.get(path).key;return content?typeof key==="number"?content.type!==utils_1.nodeValueTypes.ARRAY:content.type!==utils_1.nodeValueTypes.OBJECT:false})).map((({path:path})=>path)).concat(pathsRemoved).filter(((path,i,l)=>l.indexOf(path)===i)).filter(((path,i,l)=>l.findIndex((p=>ivipbase_core_1.PathInfo.get(p).isAncestorOf(path)))<0));removed=nodes.filter((({path:path})=>pathsRemoved.findIndex((p=>ivipbase_core_1.PathInfo.get(p).equals(path)||ivipbase_core_1.PathInfo.get(p).isAncestorOf(path)))>=0));comparison=comparison.filter((({path:path})=>pathsRemoved.findIndex((p=>ivipbase_core_1.PathInfo.get(p).equals(path)||ivipbase_core_1.PathInfo.get(p).isAncestorOf(path)))<0)).sort((({path:p1},{path:p2})=>ivipbase_core_1.PathInfo.get(p1).isAncestorOf(p2)?-1:ivipbase_core_1.PathInfo.get(p1).isDescendantOf(p2)?1:0));result=nodes.filter((({path:path})=>pathsRemoved.findIndex((p=>ivipbase_core_1.PathInfo.get(p).equals(path)||ivipbase_core_1.PathInfo.get(p).isAncestorOf(path)))<0)).sort((({path:p1},{path:p2})=>ivipbase_core_1.PathInfo.get(p1).isAncestorOf(p2)?-1:ivipbase_core_1.PathInfo.get(p1).isDescendantOf(p2)?1:0));const verifyNodes=comparison.filter((({type:type})=>type==="VERIFY"));for(let verify of verifyNodes){if(nodes.findIndex((({path:path})=>ivipbase_core_1.PathInfo.get(verify.path).equals(path)))<0){setNodeBy(verify)}}comparison=comparison.filter((({type:type})=>type!=="VERIFY"));for(let node of comparison){const pathInfo=ivipbase_core_1.PathInfo.get(node.path);let index=result.findIndex((({path:path})=>pathInfo.equals(path)));index=index<0?result.findIndex((({path:path})=>pathInfo.isParentOf(path)||pathInfo.isChildOf(path))):index;if(index<0){setNodeBy(node);continue}const lastNode=result[index];if(pathInfo.equals(lastNode.path)&&lastNode.content.type!==node.content.type){setNodeBy(node);continue}if(pathInfo.equals(lastNode.path)){switch(lastNode.content.type){case utils_1.nodeValueTypes.OBJECT:case utils_1.nodeValueTypes.ARRAY:{const{created:created,revision_nr:revision_nr}=lastNode.content.modified>node.content.modified?node.content:lastNode.content;const contents=lastNode.content.modified>node.content.modified?[node.content,lastNode.content]:[lastNode.content,node.content];const content_values=contents.map((({value:value})=>value));const new_content_value=Object.assign.apply(null,content_values);const content=Object.assign.apply(null,[...contents,{value:Object.fromEntries(Object.entries(new_content_value).filter((([k,v])=>v!==null))),created:created,revision_nr:revision_nr+1}]);setNodeBy(Object.assign(lastNode,{content:content}));break}default:{if(lastNode.content.modified<node.content.modified){setNodeBy(node)}}}continue}const parentNodeIsLast=pathInfo.isChildOf(lastNode.path);const parentNode=!parentNodeIsLast?node:lastNode;const childNode=parentNodeIsLast?node:lastNode;const childKey=ivipbase_core_1.PathInfo.get(childNode.path).key;if(parentNode.content.type===utils_1.nodeValueTypes.OBJECT&&childKey!==null){let parentNodeModified=false;if([utils_1.nodeValueTypes.STRING,utils_1.nodeValueTypes.BIGINT,utils_1.nodeValueTypes.BOOLEAN,utils_1.nodeValueTypes.DATETIME,utils_1.nodeValueTypes.NUMBER].includes(childNode.content.type)&&(0,utils_1.valueFitsInline)(childNode.content.value,this.settings)){parentNode.content.value[childKey]=childNode.content.value;parentNodeModified=true}else if(childNode.content.type===utils_1.nodeValueTypes.EMPTY){parentNode.content.value[childKey]=null;parentNodeModified=true}if(parentNodeModified){result[index]=parentNode;setNodeBy(result[index]);continue}}setNodeBy(node)}result=result.map((({path:path,content:content})=>({path:path,content:content})));added=added.sort((({path:p1},{path:p2})=>ivipbase_core_1.PathInfo.get(p1).isAncestorOf(p2)?-1:ivipbase_core_1.PathInfo.get(p1).isDescendantOf(p2)?1:0)).map((({path:path,content:content})=>({path:path,content:content})));modified=modified.sort((({path:p1},{path:p2})=>ivipbase_core_1.PathInfo.get(p1).isAncestorOf(p2)?-1:ivipbase_core_1.PathInfo.get(p1).isDescendantOf(p2)?1:0)).map((({path:path,content:content})=>({path:path,content:content})));removed=removed.sort((({path:p1},{path:p2})=>ivipbase_core_1.PathInfo.get(p1).isAncestorOf(p2)?-1:ivipbase_core_1.PathInfo.get(p1).isDescendantOf(p2)?1:0)).map((({path:path,content:content})=>({path:path,content:content})));return{result:result,added:added,modified:modified,removed:removed}}exports.default=prepareMergeNodes},{"./utils":16,"ivipbase-core":273}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const ivipbase_core_1=require("ivipbase-core");const utils_1=require("./utils");function structureNodes(path,nodes,options){var _a,_b;const include=((_a=options===null||options===void 0?void 0:options.include)!==null&&_a!==void 0?_a:[]).map((p=>ivipbase_core_1.PathInfo.get([path,p])));const exclude=((_b=options===null||options===void 0?void 0:options.exclude)!==null&&_b!==void 0?_b:[]).map((p=>ivipbase_core_1.PathInfo.get([path,p])));const pathInfo=ivipbase_core_1.PathInfo.get(path);const checkIncludedPath=from=>{const p=ivipbase_core_1.PathInfo.get(from);const isInclude=include.length>0?include.findIndex((path=>p.equals(path)||p.isDescendantOf(path)))>=0:true;return exclude.findIndex((path=>p.equals(path)||p.isDescendantOf(path)))<0&&isInclude};let value=undefined;if(nodes.length===1){const{path:p,content:content}=nodes[0];value=(0,utils_1.processReadNodeValue)(content).value;if(content.type===utils_1.nodeValueTypes.OBJECT){value=Object.fromEntries(Object.entries(value).filter((([k,v])=>{const p=ivipbase_core_1.PathInfo.get([path,k]);return checkIncludedPath(p.path)})))}if(pathInfo.equals(p)!==true){value=pathInfo.key!==null&&pathInfo.key in value?value[pathInfo.key]:undefined}}else if(nodes.length>1){nodes=nodes.filter((({path:path})=>checkIncludedPath(path)));const responsibleNode=nodes.find((({path:p})=>pathInfo.equals(p)));if(!responsibleNode){value=undefined}else{value=(0,utils_1.processReadNodeValue)(responsibleNode.content).value;const child_nodes=nodes.filter((({path:p})=>pathInfo.isParentOf(p)));for(let node of child_nodes){const pathInfo=ivipbase_core_1.PathInfo.get(node.path);if(!pathInfo.key){continue}const v=structureNodes(node.path,nodes.filter((({path:p})=>pathInfo.isAncestorOf(p))),options);value[pathInfo.key]=v}}}return value}exports.default=structureNodes},{"./utils":16,"ivipbase-core":273}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.processReadNodeValue=exports.getTypedChildValue=exports.valueFitsInline=exports.promiseState=exports.getValueType=exports.getNodeValueType=exports.getValueTypeDefault=exports.getValueTypeName=exports.VALUE_TYPES=exports.nodeValueTypes=void 0;const ivipbase_core_1=require("ivipbase-core");const ivip_utils_1=require("ivip-utils");const{assert:assert}=ivipbase_core_1.Lib;exports.nodeValueTypes={EMPTY:0,OBJECT:1,ARRAY:2,NUMBER:3,BOOLEAN:4,STRING:5,BIGINT:7,DATETIME:6,BINARY:8,REFERENCE:9,DEDICATED_RECORD:99};exports.VALUE_TYPES=exports.nodeValueTypes;function getValueTypeName(valueType){switch(valueType){case exports.VALUE_TYPES.ARRAY:return"array";case exports.VALUE_TYPES.BINARY:return"binary";case exports.VALUE_TYPES.BOOLEAN:return"boolean";case exports.VALUE_TYPES.DATETIME:return"date";case exports.VALUE_TYPES.NUMBER:return"number";case exports.VALUE_TYPES.OBJECT:return"object";case exports.VALUE_TYPES.REFERENCE:return"reference";case exports.VALUE_TYPES.STRING:return"string";case exports.VALUE_TYPES.BIGINT:return"bigint";case exports.VALUE_TYPES.DEDICATED_RECORD:return"dedicated_record";default:"unknown"}}exports.getValueTypeName=getValueTypeName;function getValueTypeDefault(valueType){switch(valueType){case exports.VALUE_TYPES.ARRAY:return[];case exports.VALUE_TYPES.OBJECT:return{};case exports.VALUE_TYPES.NUMBER:return 0;case exports.VALUE_TYPES.BOOLEAN:return false;case exports.VALUE_TYPES.STRING:return"";case exports.VALUE_TYPES.BIGINT:return BigInt(0);case exports.VALUE_TYPES.DATETIME:return(new Date).toISOString();case exports.VALUE_TYPES.BINARY:return new Uint8Array;case exports.VALUE_TYPES.REFERENCE:return null;default:return undefined}}exports.getValueTypeDefault=getValueTypeDefault;function getNodeValueType(value){if(value instanceof Array){return exports.VALUE_TYPES.ARRAY}else if(value instanceof ivipbase_core_1.PathReference){return exports.VALUE_TYPES.REFERENCE}else if(value instanceof ArrayBuffer){return exports.VALUE_TYPES.BINARY}else if((0,ivip_utils_1.isDate)(value)){return exports.VALUE_TYPES.DATETIME}else if(typeof value==="string"){return exports.VALUE_TYPES.STRING}else if(typeof value==="object"){return exports.VALUE_TYPES.OBJECT}else if(typeof value==="bigint"){return exports.VALUE_TYPES.BIGINT}return exports.VALUE_TYPES.EMPTY}exports.getNodeValueType=getNodeValueType;function getValueType(value){if(value instanceof Array){return exports.VALUE_TYPES.ARRAY}else if(value instanceof ivipbase_core_1.PathReference){return exports.VALUE_TYPES.REFERENCE}else if(value instanceof ArrayBuffer){return exports.VALUE_TYPES.BINARY}else if((0,ivip_utils_1.isDate)(value)){return exports.VALUE_TYPES.DATETIME}else if(typeof value==="string"){return exports.VALUE_TYPES.STRING}else if(typeof value==="object"){return exports.VALUE_TYPES.OBJECT}else if(typeof value==="number"){return exports.VALUE_TYPES.NUMBER}else if(typeof value==="boolean"){return exports.VALUE_TYPES.BOOLEAN}else if(typeof value==="bigint"){return exports.VALUE_TYPES.BIGINT}return exports.VALUE_TYPES.EMPTY}exports.getValueType=getValueType;const promiseState=p=>{const t={__timestamp__:Date.now()};return Promise.race([p,t]).then((v=>v===t?"pending":"fulfilled"),(()=>"rejected"))};exports.promiseState=promiseState;function valueFitsInline(value,settings){if(typeof value==="number"||typeof value==="boolean"||(0,ivip_utils_1.isDate)(value)){return true}else if(typeof value==="string"){if(value.length>settings.maxInlineValueSize){return false}const encoded=(0,ivip_utils_1.encodeString)(value);return encoded.length<settings.maxInlineValueSize}else if(value instanceof ivipbase_core_1.PathReference){if(value.path.length>settings.maxInlineValueSize){return false}const encoded=(0,ivip_utils_1.encodeString)(value.path);return encoded.length<settings.maxInlineValueSize}else if(value instanceof ArrayBuffer){return value.byteLength<settings.maxInlineValueSize}else if(value instanceof Array){return value.length===0}else if(typeof value==="object"){return Object.keys(value).length===0}else{throw new TypeError("What else is there?")}}exports.valueFitsInline=valueFitsInline;function getTypedChildValue(val){if(val===null){throw new Error(`Not allowed to store null values. remove the property`)}else if((0,ivip_utils_1.isDate)(val)){return{type:exports.VALUE_TYPES.DATETIME,value:new Date(val).getTime()}}else if(["string","number","boolean"].includes(typeof val)){return val}else if(val instanceof ivipbase_core_1.PathReference){return{type:exports.VALUE_TYPES.REFERENCE,value:val.path}}else if(val instanceof ArrayBuffer){return{type:exports.VALUE_TYPES.BINARY,value:ivipbase_core_1.ascii85.encode(val)}}else if(typeof val==="object"){assert(Object.keys(val).length===0||"type"in val&&val.type===exports.VALUE_TYPES.DEDICATED_RECORD,"child object stored in parent can only be empty");return val}}exports.getTypedChildValue=getTypedChildValue;function processReadNodeValue(node){const getTypedChildValue=val=>{if(val.type===exports.VALUE_TYPES.BINARY){return ivipbase_core_1.ascii85.decode(val.value)}else if(val.type===exports.VALUE_TYPES.DATETIME){return new Date(val.value)}else if(val.type===exports.VALUE_TYPES.REFERENCE){return new ivipbase_core_1.PathReference(val.value)}else if(val.type===exports.VALUE_TYPES.DEDICATED_RECORD){return getValueTypeDefault(val.value)}else{throw new Error(`Unhandled child value type ${val.type}`)}};node=JSON.parse(JSON.stringify(node));switch(node.type){case exports.VALUE_TYPES.ARRAY:case exports.VALUE_TYPES.OBJECT:{const obj=node.value;Object.keys(obj).forEach((key=>{const item=obj[key];if(typeof item==="object"&&"type"in item){obj[key]=getTypedChildValue(item)}}));node.value=obj;break}case exports.VALUE_TYPES.BINARY:{node.value=ivipbase_core_1.ascii85.decode(node.value);break}case exports.VALUE_TYPES.REFERENCE:{node.value=new ivipbase_core_1.PathReference(node.value);break}case exports.VALUE_TYPES.STRING:{break}default:throw new Error(`Invalid standalone record value type`)}return node}exports.processReadNodeValue=processReadNodeValue},{"ivip-utils":247,"ivipbase-core":273}],17:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});__exportStar(require("./DataStorage"),exports);__exportStar(require("./CustomStorage"),exports)},{"./CustomStorage":9,"./DataStorage":10}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getDatabase=exports.DataBase=void 0;const ivipbase_core_1=require("ivipbase-core");const app_1=require("../app");const MDE_1=require("../controller/storage/MDE");class StorageDBServer extends ivipbase_core_1.Api{constructor(db){super();this.db=db;this.cache={};this.db.emit("ready")}async stats(){return{writes:0,reads:0,bytesRead:0,bytesWritten:0}}subscribe(path,event,callback){this.db.subscriptions.add(path,event,callback)}unsubscribe(path,event,callback){this.db.subscriptions.remove(path,event,callback)}async set(path,value,options){await this.db.app.storage.set(path,value);return{}}async get(path,options){if(!options){options={}}if(typeof options.include!=="undefined"&&!(options.include instanceof Array)){throw new TypeError(`options.include must be an array of key names`)}if(typeof options.exclude!=="undefined"&&!(options.exclude instanceof Array)){throw new TypeError(`options.exclude must be an array of key names`)}const value=await this.db.app.storage.get(path,options);return{value:value,context:{more:false}}}async update(path,updates,options){await this.db.app.storage.update(path,updates);return{}}async exists(path){return await this.db.app.storage.isPathExists(path)}async reflect(path,type,args){var _a,_b,_c,_d,_e;args=args||{};const getChildren=async(path,limit=50,skip=0,from=null)=>{if(typeof limit==="string"){limit=parseInt(limit)}if(typeof skip==="string"){skip=parseInt(skip)}if(["null","undefined",null,undefined].includes(from)){from=null}const children=[];let n=0,stop=false,more=false;await this.db.app.storage.getChildren(path).next((childInfo=>{var _a,_b;if(stop){more=true;return false}n++;const include=from!==null&&childInfo.key?childInfo.key>from:skip===0||n>skip;if(include){children.push(Object.assign({key:(_a=typeof childInfo.key==="string"?childInfo.key:childInfo.index)!==null&&_a!==void 0?_a:"",type:(_b=childInfo.valueTypeName)!==null&&_b!==void 0?_b:"unknown",value:childInfo.value},typeof childInfo.address==="object"&&{address:childInfo.address}))}stop=limit>0&&children.length===limit})).catch((err=>{throw err}));return{more:more,list:children}};switch(type){case"children":{const result=await getChildren(path,args.limit,args.skip,args.from);return result}case"info":{const info={key:"",exists:false,type:"unknown",value:undefined,address:undefined,children:{count:0,more:false,list:[]}};const nodeInfo=await this.db.app.storage.getInfoBy(path,{include_child_count:args.child_count===true});info.key=(_a=typeof nodeInfo.key!=="undefined"?nodeInfo.key:nodeInfo.index)!==null&&_a!==void 0?_a:"";info.exists=(_b=nodeInfo.exists)!==null&&_b!==void 0?_b:false;info.type=(_c=nodeInfo.exists?nodeInfo.valueTypeName:undefined)!==null&&_c!==void 0?_c:"unknown";info.value=nodeInfo.value;info.address=typeof nodeInfo.address==="object"?nodeInfo.address:undefined;const isObjectOrArray=nodeInfo.exists&&nodeInfo.address&&[MDE_1.VALUE_TYPES.OBJECT,MDE_1.VALUE_TYPES.ARRAY].includes((_d=nodeInfo.type)!==null&&_d!==void 0?_d:0);if(args.child_count===true){info.children={count:isObjectOrArray?(_e=nodeInfo.childCount)!==null&&_e!==void 0?_e:0:0}}else if(typeof args.child_limit==="number"&&args.child_limit>0){if(isObjectOrArray){info.children=await getChildren(path,args.child_limit,args.child_skip,args.child_from)}}return info}}}}class StorageDBClient extends ivipbase_core_1.Api{constructor(db){super();this.db=db;this.cache={};this.db.emit("ready")}}const SUPPORTED_EVENTS=["value","child_added","child_changed","child_removed","mutated","mutations"];SUPPORTED_EVENTS.push(...SUPPORTED_EVENTS.map((event=>`notify_${event}`)));class DataBase extends ivipbase_core_1.DataBase{constructor(app=undefined,options){const appNow=typeof app==="string"?(0,app_1.getApp)(app):app instanceof app_1.IvipBaseApp?app:(0,app_1.getFirstApp)();super(appNow.settings.dbname,options);this._eventSubscriptions={};this.subscriptions={add:(path,type,callback)=>{if(SUPPORTED_EVENTS.indexOf(type)<0){throw new TypeError(`Invalid event type "${type}"`)}let pathSubs=this._eventSubscriptions[path];if(!pathSubs){pathSubs=this._eventSubscriptions[path]=[]}pathSubs.push({created:Date.now(),type:type,callback:callback})},remove:(path,type,callback)=>{const pathSubs=this._eventSubscriptions[path];if(!pathSubs){return}const next=()=>pathSubs.findIndex((ps=>(type?ps.type===type:true)&&(callback?ps.callback===callback:true)));let i;while((i=next())>=0){pathSubs.splice(i,1)}},hasValueSubscribersForPath(path){const valueNeeded=this.getValueSubscribersForPath(path);return!!valueNeeded},getValueSubscribersForPath:path=>{const pathInfo=new ivipbase_core_1.PathInfo(path);const valueSubscribers=[];Object.keys(this._eventSubscriptions).forEach((subscriptionPath=>{if(pathInfo.equals(subscriptionPath)||pathInfo.isDescendantOf(subscriptionPath)){const pathSubs=this._eventSubscriptions[subscriptionPath];const eventPath=ivipbase_core_1.PathInfo.fillVariables(subscriptionPath,path);pathSubs.filter((sub=>!sub.type.startsWith("notify_"))).forEach((sub=>{let dataPath=null;if(sub.type==="value"){dataPath=eventPath}else if(["mutated","mutations"].includes(sub.type)&&pathInfo.isDescendantOf(eventPath)){dataPath=path}else if(sub.type==="child_changed"&&path!==eventPath){const childKey=ivipbase_core_1.PathInfo.getPathKeys(path.slice(eventPath.length).replace(/^\//,""))[0];dataPath=ivipbase_core_1.PathInfo.getChildPath(eventPath,childKey)}else if(["child_added","child_removed"].includes(sub.type)&&pathInfo.isChildOf(eventPath)){const childKey=ivipbase_core_1.PathInfo.getPathKeys(path.slice(eventPath.length).replace(/^\//,""))[0];dataPath=ivipbase_core_1.PathInfo.getChildPath(eventPath,childKey)}if(dataPath!==null&&!valueSubscribers.some((s=>s.type===sub.type&&s.eventPath===eventPath))){valueSubscribers.push({type:sub.type,eventPath:eventPath,dataPath:dataPath,subscriptionPath:subscriptionPath})}}))}}));return valueSubscribers},getAllSubscribersForPath:path=>{const pathInfo=ivipbase_core_1.PathInfo.get(path);const subscribers=[];Object.keys(this._eventSubscriptions).forEach((subscriptionPath=>{if(pathInfo.isOnTrailOf(subscriptionPath)){const pathSubs=this._eventSubscriptions[subscriptionPath];const eventPath=ivipbase_core_1.PathInfo.fillVariables(subscriptionPath,path);pathSubs.forEach((sub=>{let dataPath=null;if(sub.type==="value"||sub.type==="notify_value"){dataPath=eventPath}else if(["child_changed","notify_child_changed"].includes(sub.type)){const childKey=path===eventPath||pathInfo.isAncestorOf(eventPath)?"*":ivipbase_core_1.PathInfo.getPathKeys(path.slice(eventPath.length).replace(/^\//,""))[0];dataPath=ivipbase_core_1.PathInfo.getChildPath(eventPath,childKey)}else if(["mutated","mutations","notify_mutated","notify_mutations"].includes(sub.type)){dataPath=path}else if(["child_added","child_removed","notify_child_added","notify_child_removed"].includes(sub.type)&&(pathInfo.isChildOf(eventPath)||path===eventPath||pathInfo.isAncestorOf(eventPath))){const childKey=path===eventPath||pathInfo.isAncestorOf(eventPath)?"*":ivipbase_core_1.PathInfo.getPathKeys(path.slice(eventPath.length).replace(/^\//,""))[0];dataPath=ivipbase_core_1.PathInfo.getChildPath(eventPath,childKey)}if(dataPath!==null&&!subscribers.some((s=>s.type===sub.type&&s.eventPath===eventPath&&s.subscriptionPath===subscriptionPath))){subscribers.push({type:sub.type,eventPath:eventPath,dataPath:dataPath,subscriptionPath:subscriptionPath})}}))}}));return subscribers},trigger:(event,path,dataPath,oldValue,newValue,context)=>{const pathSubscriptions=this._eventSubscriptions[path]||[];pathSubscriptions.filter((sub=>sub.type===event)).forEach((sub=>{sub.callback(null,dataPath,newValue,oldValue,context)}))}};this.app=appNow;this.storage=appNow.isServer||!appNow.settings.isValidClient?new StorageDBServer(this):new StorageDBClient(this);this.emitOnce("ready")}}exports.DataBase=DataBase;function getDatabase(app=undefined,options){return new DataBase(app,options)}exports.getDatabase=getDatabase},{"../app":1,"../controller/storage/MDE":13,"ivipbase-core":273}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LocalServer=exports.AbstractLocalServer=exports.isPossiblyServer=exports.ServerSettings=exports.ServerAuthenticationSettings=exports.AUTH_ACCESS_DEFAULT=exports.ExternalServerError=exports.ServerNotReadyError=void 0;const ivipbase_core_1=require("ivipbase-core");const database_1=require("../database");class ServerNotReadyError extends Error{constructor(){super("O servidor ainda não está pronto")}}exports.ServerNotReadyError=ServerNotReadyError;class ExternalServerError extends Error{constructor(){super("Este método não está disponível com um servidor externo")}}exports.ExternalServerError=ExternalServerError;exports.AUTH_ACCESS_DEFAULT={DENY_ALL:"deny",ALLOW_ALL:"allow",ALLOW_AUTHENTICATED:"auth"};class ServerAuthenticationSettings{constructor(settings={}){this.enabled=true;this.allowUserSignup=false;this.newUserRateLimit=0;this.tokensExpire=0;this.defaultAccessRule=exports.AUTH_ACCESS_DEFAULT.ALLOW_AUTHENTICATED;this.separateDb=false;if(typeof settings!=="object"){settings={}}if(typeof settings.enabled==="boolean"){this.enabled=settings.enabled}if(typeof settings.allowUserSignup==="boolean"){this.allowUserSignup=settings.allowUserSignup}if(typeof settings.newUserRateLimit==="number"){this.newUserRateLimit=settings.newUserRateLimit}if(typeof settings.tokensExpire==="number"){this.tokensExpire=settings.tokensExpire}if(typeof settings.defaultAccessRule==="string"){this.defaultAccessRule=settings.defaultAccessRule}if(typeof settings.defaultAdminPassword==="string"){this.defaultAdminPassword=settings.defaultAdminPassword}if(typeof settings.seperateDb==="boolean"){this.separateDb=settings.seperateDb}if(typeof settings.separateDb==="boolean"){this.separateDb=settings.separateDb}}}exports.ServerAuthenticationSettings=ServerAuthenticationSettings;class ServerSettings{constructor(options={}){this.logLevel="log";this.host="localhost";this.port=3e3;this.rootPath="";this.maxPayloadSize="10mb";this.allowOrigin="*";this.trustProxy=true;if(typeof options.logLevel==="string"&&["verbose","log","warn","error"].includes(options.logLevel)){this.logLevel=options.logLevel}if(typeof options.host==="string"){this.host=options.host}if(typeof options.port==="number"){this.port=options.port}if(typeof options.maxPayloadSize==="string"){this.maxPayloadSize=options.maxPayloadSize}if(typeof options.allowOrigin==="string"){this.allowOrigin=options.allowOrigin}if(typeof options.trustProxy==="boolean"){this.trustProxy=options.trustProxy}this.auth=new ServerAuthenticationSettings(options.authentication);if(typeof options.init==="function"){this.init=options.init}}}exports.ServerSettings=ServerSettings;exports.isPossiblyServer=false;class AbstractLocalServer extends ivipbase_core_1.SimpleEventEmitter{constructor(appName,settings={}){super();this.appName=appName;this._ready=false;this.settings=new ServerSettings(settings);this.db=(0,database_1.getDatabase)(appName);this.debug=new ivipbase_core_1.DebugLogger(this.settings.logLevel,`[${this.db.name}]`);this.once("ready",(()=>{this._ready=true}))}async ready(callback){if(!this._ready){await new Promise((resolve=>this.on("ready",resolve)))}callback===null||callback===void 0?void 0:callback()}get isReady(){return this._ready}get url(){return`http://${this.settings.host}:${this.settings.port}/${this.settings.rootPath}`}}exports.AbstractLocalServer=AbstractLocalServer;class LocalServer extends AbstractLocalServer{constructor(appName,settings={}){super(appName,settings);this.appName=appName;this.isServer=false;this.init()}init(){this.emitOnce("ready")}}exports.LocalServer=LocalServer},{"../database":18,"ivipbase-core":273}],20:[function(require,module,exports){"use strict";const asn1=exports;asn1.bignum=require("bn.js");asn1.define=require("./asn1/api").define;asn1.base=require("./asn1/base");asn1.constants=require("./asn1/constants");asn1.decoders=require("./asn1/decoders");asn1.encoders=require("./asn1/encoders")},{"./asn1/api":21,"./asn1/base":23,"./asn1/constants":27,"./asn1/decoders":29,"./asn1/encoders":32,"bn.js":34}],21:[function(require,module,exports){"use strict";const encoders=require("./encoders");const decoders=require("./decoders");const inherits=require("inherits");const api=exports;api.define=function define(name,body){return new Entity(name,body)};function Entity(name,body){this.name=name;this.body=body;this.decoders={};this.encoders={}}Entity.prototype._createNamed=function createNamed(Base){const name=this.name;function Generated(entity){this._initNamed(entity,name)}inherits(Generated,Base);Generated.prototype._initNamed=function _initNamed(entity,name){Base.call(this,entity,name)};return new Generated(this)};Entity.prototype._getDecoder=function _getDecoder(enc){enc=enc||"der";if(!this.decoders.hasOwnProperty(enc))this.decoders[enc]=this._createNamed(decoders[enc]);return this.decoders[enc]};Entity.prototype.decode=function decode(data,enc,options){return this._getDecoder(enc).decode(data,options)};Entity.prototype._getEncoder=function _getEncoder(enc){enc=enc||"der";if(!this.encoders.hasOwnProperty(enc))this.encoders[enc]=this._createNamed(encoders[enc]);return this.encoders[enc]};Entity.prototype.encode=function encode(data,enc,reporter){return this._getEncoder(enc).encode(data,reporter)}},{"./decoders":29,"./encoders":32,inherits:233}],22:[function(require,module,exports){"use strict";const inherits=require("inherits");const Reporter=require("../base/reporter").Reporter;const Buffer=require("safer-buffer").Buffer;function DecoderBuffer(base,options){Reporter.call(this,options);if(!Buffer.isBuffer(base)){this.error("Input not Buffer");return}this.base=base;this.offset=0;this.length=base.length}inherits(DecoderBuffer,Reporter);exports.DecoderBuffer=DecoderBuffer;DecoderBuffer.isDecoderBuffer=function isDecoderBuffer(data){if(data instanceof DecoderBuffer){return true}const isCompatible=typeof data==="object"&&Buffer.isBuffer(data.base)&&data.constructor.name==="DecoderBuffer"&&typeof data.offset==="number"&&typeof data.length==="number"&&typeof data.save==="function"&&typeof data.restore==="function"&&typeof data.isEmpty==="function"&&typeof data.readUInt8==="function"&&typeof data.skip==="function"&&typeof data.raw==="function";return isCompatible};DecoderBuffer.prototype.save=function save(){return{offset:this.offset,reporter:Reporter.prototype.save.call(this)}};DecoderBuffer.prototype.restore=function restore(save){const res=new DecoderBuffer(this.base);res.offset=save.offset;res.length=this.offset;this.offset=save.offset;Reporter.prototype.restore.call(this,save.reporter);return res};DecoderBuffer.prototype.isEmpty=function isEmpty(){return this.offset===this.length};DecoderBuffer.prototype.readUInt8=function readUInt8(fail){if(this.offset+1<=this.length)return this.base.readUInt8(this.offset++,true);else return this.error(fail||"DecoderBuffer overrun")};DecoderBuffer.prototype.skip=function skip(bytes,fail){if(!(this.offset+bytes<=this.length))return this.error(fail||"DecoderBuffer overrun");const res=new DecoderBuffer(this.base);res._reporterState=this._reporterState;res.offset=this.offset;res.length=this.offset+bytes;this.offset+=bytes;return res};DecoderBuffer.prototype.raw=function raw(save){return this.base.slice(save?save.offset:this.offset,this.length)};function EncoderBuffer(value,reporter){if(Array.isArray(value)){this.length=0;this.value=value.map((function(item){if(!EncoderBuffer.isEncoderBuffer(item))item=new EncoderBuffer(item,reporter);this.length+=item.length;return item}),this)}else if(typeof value==="number"){if(!(0<=value&&value<=255))return reporter.error("non-byte EncoderBuffer value");this.value=value;this.length=1}else if(typeof value==="string"){this.value=value;this.length=Buffer.byteLength(value)}else if(Buffer.isBuffer(value)){this.value=value;this.length=value.length}else{return reporter.error("Unsupported type: "+typeof value)}}exports.EncoderBuffer=EncoderBuffer;EncoderBuffer.isEncoderBuffer=function isEncoderBuffer(data){if(data instanceof EncoderBuffer){return true}const isCompatible=typeof data==="object"&&data.constructor.name==="EncoderBuffer"&&typeof data.length==="number"&&typeof data.join==="function";return isCompatible};EncoderBuffer.prototype.join=function join(out,offset){if(!out)out=Buffer.alloc(this.length);if(!offset)offset=0;if(this.length===0)return out;if(Array.isArray(this.value)){this.value.forEach((function(item){item.join(out,offset);offset+=item.length}))}else{if(typeof this.value==="number")out[offset]=this.value;else if(typeof this.value==="string")out.write(this.value,offset);else if(Buffer.isBuffer(this.value))this.value.copy(out,offset);offset+=this.length}return out}},{"../base/reporter":25,inherits:233,"safer-buffer":386}],23:[function(require,module,exports){"use strict";const base=exports;base.Reporter=require("./reporter").Reporter;base.DecoderBuffer=require("./buffer").DecoderBuffer;base.EncoderBuffer=require("./buffer").EncoderBuffer;base.Node=require("./node")},{"./buffer":22,"./node":24,"./reporter":25}],24:[function(require,module,exports){"use strict";const Reporter=require("../base/reporter").Reporter;const EncoderBuffer=require("../base/buffer").EncoderBuffer;const DecoderBuffer=require("../base/buffer").DecoderBuffer;const assert=require("minimalistic-assert");const tags=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"];const methods=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(tags);const overrided=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function Node(enc,parent,name){const state={};this._baseState=state;state.name=name;state.enc=enc;state.parent=parent||null;state.children=null;state.tag=null;state.args=null;state.reverseArgs=null;state.choice=null;state.optional=false;state.any=false;state.obj=false;state.use=null;state.useDecoder=null;state.key=null;state["default"]=null;state.explicit=null;state.implicit=null;state.contains=null;if(!state.parent){state.children=[];this._wrap()}}module.exports=Node;const stateProps=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];Node.prototype.clone=function clone(){const state=this._baseState;const cstate={};stateProps.forEach((function(prop){cstate[prop]=state[prop]}));const res=new this.constructor(cstate.parent);res._baseState=cstate;return res};Node.prototype._wrap=function wrap(){const state=this._baseState;methods.forEach((function(method){this[method]=function _wrappedMethod(){const clone=new this.constructor(this);state.children.push(clone);return clone[method].apply(clone,arguments)}}),this)};Node.prototype._init=function init(body){const state=this._baseState;assert(state.parent===null);body.call(this);state.children=state.children.filter((function(child){return child._baseState.parent===this}),this);assert.equal(state.children.length,1,"Root node can have only one child")};Node.prototype._useArgs=function useArgs(args){const state=this._baseState;const children=args.filter((function(arg){return arg instanceof this.constructor}),this);args=args.filter((function(arg){return!(arg instanceof this.constructor)}),this);if(children.length!==0){assert(state.children===null);state.children=children;children.forEach((function(child){child._baseState.parent=this}),this)}if(args.length!==0){assert(state.args===null);state.args=args;state.reverseArgs=args.map((function(arg){if(typeof arg!=="object"||arg.constructor!==Object)return arg;const res={};Object.keys(arg).forEach((function(key){if(key==(key|0))key|=0;const value=arg[key];res[value]=key}));return res}))}};overrided.forEach((function(method){Node.prototype[method]=function _overrided(){const state=this._baseState;throw new Error(method+" not implemented for encoding: "+state.enc)}}));tags.forEach((function(tag){Node.prototype[tag]=function _tagMethod(){const state=this._baseState;const args=Array.prototype.slice.call(arguments);assert(state.tag===null);state.tag=tag;this._useArgs(args);return this}}));Node.prototype.use=function use(item){assert(item);const state=this._baseState;assert(state.use===null);state.use=item;return this};Node.prototype.optional=function optional(){const state=this._baseState;state.optional=true;return this};Node.prototype.def=function def(val){const state=this._baseState;assert(state["default"]===null);state["default"]=val;state.optional=true;return this};Node.prototype.explicit=function explicit(num){const state=this._baseState;assert(state.explicit===null&&state.implicit===null);state.explicit=num;return this};Node.prototype.implicit=function implicit(num){const state=this._baseState;assert(state.explicit===null&&state.implicit===null);state.implicit=num;return this};Node.prototype.obj=function obj(){const state=this._baseState;const args=Array.prototype.slice.call(arguments);state.obj=true;if(args.length!==0)this._useArgs(args);return this};Node.prototype.key=function key(newKey){const state=this._baseState;assert(state.key===null);state.key=newKey;return this};Node.prototype.any=function any(){const state=this._baseState;state.any=true;return this};Node.prototype.choice=function choice(obj){const state=this._baseState;assert(state.choice===null);state.choice=obj;this._useArgs(Object.keys(obj).map((function(key){return obj[key]})));return this};Node.prototype.contains=function contains(item){const state=this._baseState;assert(state.use===null);state.contains=item;return this};Node.prototype._decode=function decode(input,options){const state=this._baseState;if(state.parent===null)return input.wrapResult(state.children[0]._decode(input,options));let result=state["default"];let present=true;let prevKey=null;if(state.key!==null)prevKey=input.enterKey(state.key);if(state.optional){let tag=null;if(state.explicit!==null)tag=state.explicit;else if(state.implicit!==null)tag=state.implicit;else if(state.tag!==null)tag=state.tag;if(tag===null&&!state.any){const save=input.save();try{if(state.choice===null)this._decodeGeneric(state.tag,input,options);else this._decodeChoice(input,options);present=true}catch(e){present=false}input.restore(save)}else{present=this._peekTag(input,tag,state.any);if(input.isError(present))return present}}let prevObj;if(state.obj&&present)prevObj=input.enterObject();if(present){if(state.explicit!==null){const explicit=this._decodeTag(input,state.explicit);if(input.isError(explicit))return explicit;input=explicit}const start=input.offset;if(state.use===null&&state.choice===null){let save;if(state.any)save=input.save();const body=this._decodeTag(input,state.implicit!==null?state.implicit:state.tag,state.any);if(input.isError(body))return body;if(state.any)result=input.raw(save);else input=body}if(options&&options.track&&state.tag!==null)options.track(input.path(),start,input.length,"tagged");if(options&&options.track&&state.tag!==null)options.track(input.path(),input.offset,input.length,"content");if(state.any){}else if(state.choice===null){result=this._decodeGeneric(state.tag,input,options)}else{result=this._decodeChoice(input,options)}if(input.isError(result))return result;if(!state.any&&state.choice===null&&state.children!==null){state.children.forEach((function decodeChildren(child){child._decode(input,options)}))}if(state.contains&&(state.tag==="octstr"||state.tag==="bitstr")){const data=new DecoderBuffer(result);result=this._getUse(state.contains,input._reporterState.obj)._decode(data,options)}}if(state.obj&&present)result=input.leaveObject(prevObj);if(state.key!==null&&(result!==null||present===true))input.leaveKey(prevKey,state.key,result);else if(prevKey!==null)input.exitKey(prevKey);return result};Node.prototype._decodeGeneric=function decodeGeneric(tag,input,options){const state=this._baseState;if(tag==="seq"||tag==="set")return null;if(tag==="seqof"||tag==="setof")return this._decodeList(input,tag,state.args[0],options);else if(/str$/.test(tag))return this._decodeStr(input,tag,options);else if(tag==="objid"&&state.args)return this._decodeObjid(input,state.args[0],state.args[1],options);else if(tag==="objid")return this._decodeObjid(input,null,null,options);else if(tag==="gentime"||tag==="utctime")return this._decodeTime(input,tag,options);else if(tag==="null_")return this._decodeNull(input,options);else if(tag==="bool")return this._decodeBool(input,options);else if(tag==="objDesc")return this._decodeStr(input,tag,options);else if(tag==="int"||tag==="enum")return this._decodeInt(input,state.args&&state.args[0],options);if(state.use!==null){return this._getUse(state.use,input._reporterState.obj)._decode(input,options)}else{return input.error("unknown tag: "+tag)}};Node.prototype._getUse=function _getUse(entity,obj){const state=this._baseState;state.useDecoder=this._use(entity,obj);assert(state.useDecoder._baseState.parent===null);state.useDecoder=state.useDecoder._baseState.children[0];if(state.implicit!==state.useDecoder._baseState.implicit){state.useDecoder=state.useDecoder.clone();state.useDecoder._baseState.implicit=state.implicit}return state.useDecoder};Node.prototype._decodeChoice=function decodeChoice(input,options){const state=this._baseState;let result=null;let match=false;Object.keys(state.choice).some((function(key){const save=input.save();const node=state.choice[key];try{const value=node._decode(input,options);if(input.isError(value))return false;result={type:key,value:value};match=true}catch(e){input.restore(save);return false}return true}),this);if(!match)return input.error("Choice not matched");return result};Node.prototype._createEncoderBuffer=function createEncoderBuffer(data){return new EncoderBuffer(data,this.reporter)};Node.prototype._encode=function encode(data,reporter,parent){const state=this._baseState;if(state["default"]!==null&&state["default"]===data)return;const result=this._encodeValue(data,reporter,parent);if(result===undefined)return;if(this._skipDefault(result,reporter,parent))return;return result};Node.prototype._encodeValue=function encode(data,reporter,parent){const state=this._baseState;if(state.parent===null)return state.children[0]._encode(data,reporter||new Reporter);let result=null;this.reporter=reporter;if(state.optional&&data===undefined){if(state["default"]!==null)data=state["default"];else return}let content=null;let primitive=false;if(state.any){result=this._createEncoderBuffer(data)}else if(state.choice){result=this._encodeChoice(data,reporter)}else if(state.contains){content=this._getUse(state.contains,parent)._encode(data,reporter);primitive=true}else if(state.children){content=state.children.map((function(child){if(child._baseState.tag==="null_")return child._encode(null,reporter,data);if(child._baseState.key===null)return reporter.error("Child should have a key");const prevKey=reporter.enterKey(child._baseState.key);if(typeof data!=="object")return reporter.error("Child expected, but input is not object");const res=child._encode(data[child._baseState.key],reporter,data);reporter.leaveKey(prevKey);return res}),this).filter((function(child){return child}));content=this._createEncoderBuffer(content)}else{if(state.tag==="seqof"||state.tag==="setof"){if(!(state.args&&state.args.length===1))return reporter.error("Too many args for : "+state.tag);if(!Array.isArray(data))return reporter.error("seqof/setof, but data is not Array");const child=this.clone();child._baseState.implicit=null;content=this._createEncoderBuffer(data.map((function(item){const state=this._baseState;return this._getUse(state.args[0],data)._encode(item,reporter)}),child))}else if(state.use!==null){result=this._getUse(state.use,parent)._encode(data,reporter)}else{content=this._encodePrimitive(state.tag,data);primitive=true}}if(!state.any&&state.choice===null){const tag=state.implicit!==null?state.implicit:state.tag;const cls=state.implicit===null?"universal":"context";if(tag===null){if(state.use===null)reporter.error("Tag could be omitted only for .use()")}else{if(state.use===null)result=this._encodeComposite(tag,primitive,cls,content)}}if(state.explicit!==null)result=this._encodeComposite(state.explicit,false,"context",result);return result};Node.prototype._encodeChoice=function encodeChoice(data,reporter){const state=this._baseState;const node=state.choice[data.type];if(!node){assert(false,data.type+" not found in "+JSON.stringify(Object.keys(state.choice)))}return node._encode(data.value,reporter)};Node.prototype._encodePrimitive=function encodePrimitive(tag,data){const state=this._baseState;if(/str$/.test(tag))return this._encodeStr(data,tag);else if(tag==="objid"&&state.args)return this._encodeObjid(data,state.reverseArgs[0],state.args[1]);else if(tag==="objid")return this._encodeObjid(data,null,null);else if(tag==="gentime"||tag==="utctime")return this._encodeTime(data,tag);else if(tag==="null_")return this._encodeNull();else if(tag==="int"||tag==="enum")return this._encodeInt(data,state.args&&state.reverseArgs[0]);else if(tag==="bool")return this._encodeBool(data);else if(tag==="objDesc")return this._encodeStr(data,tag);else throw new Error("Unsupported tag: "+tag)};Node.prototype._isNumstr=function isNumstr(str){return/^[0-9 ]*$/.test(str)};Node.prototype._isPrintstr=function isPrintstr(str){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(str)}},{"../base/buffer":22,"../base/reporter":25,"minimalistic-assert":291}],25:[function(require,module,exports){"use strict";const inherits=require("inherits");function Reporter(options){this._reporterState={obj:null,path:[],options:options||{},errors:[]}}exports.Reporter=Reporter;Reporter.prototype.isError=function isError(obj){return obj instanceof ReporterError};Reporter.prototype.save=function save(){const state=this._reporterState;return{obj:state.obj,pathLen:state.path.length}};Reporter.prototype.restore=function restore(data){const state=this._reporterState;state.obj=data.obj;state.path=state.path.slice(0,data.pathLen)};Reporter.prototype.enterKey=function enterKey(key){return this._reporterState.path.push(key)};Reporter.prototype.exitKey=function exitKey(index){const state=this._reporterState;state.path=state.path.slice(0,index-1)};Reporter.prototype.leaveKey=function leaveKey(index,key,value){const state=this._reporterState;this.exitKey(index);if(state.obj!==null)state.obj[key]=value};Reporter.prototype.path=function path(){return this._reporterState.path.join("/")};Reporter.prototype.enterObject=function enterObject(){const state=this._reporterState;const prev=state.obj;state.obj={};return prev};Reporter.prototype.leaveObject=function leaveObject(prev){const state=this._reporterState;const now=state.obj;state.obj=prev;return now};Reporter.prototype.error=function error(msg){let err;const state=this._reporterState;const inherited=msg instanceof ReporterError;if(inherited){err=msg}else{err=new ReporterError(state.path.map((function(elem){return"["+JSON.stringify(elem)+"]"})).join(""),msg.message||msg,msg.stack)}if(!state.options.partial)throw err;if(!inherited)state.errors.push(err);return err};Reporter.prototype.wrapResult=function wrapResult(result){const state=this._reporterState;if(!state.options.partial)return result;return{result:this.isError(result)?null:result,errors:state.errors}};function ReporterError(path,msg){this.path=path;this.rethrow(msg)}inherits(ReporterError,Error);ReporterError.prototype.rethrow=function rethrow(msg){this.message=msg+" at: "+(this.path||"(shallow)");if(Error.captureStackTrace)Error.captureStackTrace(this,ReporterError);if(!this.stack){try{throw new Error(this.message)}catch(e){this.stack=e.stack}}return this}},{inherits:233}],26:[function(require,module,exports){"use strict";function reverse(map){const res={};Object.keys(map).forEach((function(key){if((key|0)==key)key=key|0;const value=map[key];res[value]=key}));return res}exports.tagClass={0:"universal",1:"application",2:"context",3:"private"};exports.tagClassByName=reverse(exports.tagClass);exports.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"};exports.tagByName=reverse(exports.tag)},{}],27:[function(require,module,exports){"use strict";const constants=exports;constants._reverse=function reverse(map){const res={};Object.keys(map).forEach((function(key){if((key|0)==key)key=key|0;const value=map[key];res[value]=key}));return res};constants.der=require("./der")},{"./der":26}],28:[function(require,module,exports){"use strict";const inherits=require("inherits");const bignum=require("bn.js");const DecoderBuffer=require("../base/buffer").DecoderBuffer;const Node=require("../base/node");const der=require("../constants/der");function DERDecoder(entity){this.enc="der";this.name=entity.name;this.entity=entity;this.tree=new DERNode;this.tree._init(entity.body)}module.exports=DERDecoder;DERDecoder.prototype.decode=function decode(data,options){if(!DecoderBuffer.isDecoderBuffer(data)){data=new DecoderBuffer(data,options)}return this.tree._decode(data,options)};function DERNode(parent){Node.call(this,"der",parent)}inherits(DERNode,Node);DERNode.prototype._peekTag=function peekTag(buffer,tag,any){if(buffer.isEmpty())return false;const state=buffer.save();const decodedTag=derDecodeTag(buffer,'Failed to peek tag: "'+tag+'"');if(buffer.isError(decodedTag))return decodedTag;buffer.restore(state);return decodedTag.tag===tag||decodedTag.tagStr===tag||decodedTag.tagStr+"of"===tag||any};DERNode.prototype._decodeTag=function decodeTag(buffer,tag,any){const decodedTag=derDecodeTag(buffer,'Failed to decode tag of "'+tag+'"');if(buffer.isError(decodedTag))return decodedTag;let len=derDecodeLen(buffer,decodedTag.primitive,'Failed to get length of "'+tag+'"');if(buffer.isError(len))return len;if(!any&&decodedTag.tag!==tag&&decodedTag.tagStr!==tag&&decodedTag.tagStr+"of"!==tag){return buffer.error('Failed to match tag: "'+tag+'"')}if(decodedTag.primitive||len!==null)return buffer.skip(len,'Failed to match body of: "'+tag+'"');const state=buffer.save();const res=this._skipUntilEnd(buffer,'Failed to skip indefinite length body: "'+this.tag+'"');if(buffer.isError(res))return res;len=buffer.offset-state.offset;buffer.restore(state);return buffer.skip(len,'Failed to match body of: "'+tag+'"')};DERNode.prototype._skipUntilEnd=function skipUntilEnd(buffer,fail){for(;;){const tag=derDecodeTag(buffer,fail);if(buffer.isError(tag))return tag;const len=derDecodeLen(buffer,tag.primitive,fail);if(buffer.isError(len))return len;let res;if(tag.primitive||len!==null)res=buffer.skip(len);else res=this._skipUntilEnd(buffer,fail);if(buffer.isError(res))return res;if(tag.tagStr==="end")break}};DERNode.prototype._decodeList=function decodeList(buffer,tag,decoder,options){const result=[];while(!buffer.isEmpty()){const possibleEnd=this._peekTag(buffer,"end");if(buffer.isError(possibleEnd))return possibleEnd;const res=decoder.decode(buffer,"der",options);if(buffer.isError(res)&&possibleEnd)break;result.push(res)}return result};DERNode.prototype._decodeStr=function decodeStr(buffer,tag){if(tag==="bitstr"){const unused=buffer.readUInt8();if(buffer.isError(unused))return unused;return{unused:unused,data:buffer.raw()}}else if(tag==="bmpstr"){const raw=buffer.raw();if(raw.length%2===1)return buffer.error("Decoding of string type: bmpstr length mismatch");let str="";for(let i=0;i<raw.length/2;i++){str+=String.fromCharCode(raw.readUInt16BE(i*2))}return str}else if(tag==="numstr"){const numstr=buffer.raw().toString("ascii");if(!this._isNumstr(numstr)){return buffer.error("Decoding of string type: "+"numstr unsupported characters")}return numstr}else if(tag==="octstr"){return buffer.raw()}else if(tag==="objDesc"){return buffer.raw()}else if(tag==="printstr"){const printstr=buffer.raw().toString("ascii");if(!this._isPrintstr(printstr)){return buffer.error("Decoding of string type: "+"printstr unsupported characters")}return printstr}else if(/str$/.test(tag)){return buffer.raw().toString()}else{return buffer.error("Decoding of string type: "+tag+" unsupported")}};DERNode.prototype._decodeObjid=function decodeObjid(buffer,values,relative){let result;const identifiers=[];let ident=0;let subident=0;while(!buffer.isEmpty()){subident=buffer.readUInt8();ident<<=7;ident|=subident&127;if((subident&128)===0){identifiers.push(ident);ident=0}}if(subident&128)identifiers.push(ident);const first=identifiers[0]/40|0;const second=identifiers[0]%40;if(relative)result=identifiers;else result=[first,second].concat(identifiers.slice(1));if(values){let tmp=values[result.join(" ")];if(tmp===undefined)tmp=values[result.join(".")];if(tmp!==undefined)result=tmp}return result};DERNode.prototype._decodeTime=function decodeTime(buffer,tag){const str=buffer.raw().toString();let year;let mon;let day;let hour;let min;let sec;if(tag==="gentime"){year=str.slice(0,4)|0;mon=str.slice(4,6)|0;day=str.slice(6,8)|0;hour=str.slice(8,10)|0;min=str.slice(10,12)|0;sec=str.slice(12,14)|0}else if(tag==="utctime"){year=str.slice(0,2)|0;mon=str.slice(2,4)|0;day=str.slice(4,6)|0;hour=str.slice(6,8)|0;min=str.slice(8,10)|0;sec=str.slice(10,12)|0;if(year<70)year=2e3+year;else year=1900+year}else{return buffer.error("Decoding "+tag+" time is not supported yet")}return Date.UTC(year,mon-1,day,hour,min,sec,0)};DERNode.prototype._decodeNull=function decodeNull(){return null};DERNode.prototype._decodeBool=function decodeBool(buffer){const res=buffer.readUInt8();if(buffer.isError(res))return res;else return res!==0};DERNode.prototype._decodeInt=function decodeInt(buffer,values){const raw=buffer.raw();let res=new bignum(raw);if(values)res=values[res.toString(10)]||res;return res};DERNode.prototype._use=function use(entity,obj){if(typeof entity==="function")entity=entity(obj);return entity._getDecoder("der").tree};function derDecodeTag(buf,fail){let tag=buf.readUInt8(fail);if(buf.isError(tag))return tag;const cls=der.tagClass[tag>>6];const primitive=(tag&32)===0;if((tag&31)===31){let oct=tag;tag=0;while((oct&128)===128){oct=buf.readUInt8(fail);if(buf.isError(oct))return oct;tag<<=7;tag|=oct&127}}else{tag&=31}const tagStr=der.tag[tag];return{cls:cls,primitive:primitive,tag:tag,tagStr:tagStr}}function derDecodeLen(buf,primitive,fail){let len=buf.readUInt8(fail);if(buf.isError(len))return len;if(!primitive&&len===128)return null;if((len&128)===0){return len}const num=len&127;if(num>4)return buf.error("length octect is too long");len=0;for(let i=0;i<num;i++){len<<=8;const j=buf.readUInt8(fail);if(buf.isError(j))return j;len|=j}return len}},{"../base/buffer":22,"../base/node":24,"../constants/der":26,"bn.js":34,inherits:233}],29:[function(require,module,exports){"use strict";const decoders=exports;decoders.der=require("./der");decoders.pem=require("./pem")},{"./der":28,"./pem":30}],30:[function(require,module,exports){"use strict";const inherits=require("inherits");const Buffer=require("safer-buffer").Buffer;const DERDecoder=require("./der");function PEMDecoder(entity){DERDecoder.call(this,entity);this.enc="pem"}inherits(PEMDecoder,DERDecoder);module.exports=PEMDecoder;PEMDecoder.prototype.decode=function decode(data,options){const lines=data.toString().split(/[\r\n]+/g);const label=options.label.toUpperCase();const re=/^-----(BEGIN|END) ([^-]+)-----$/;let start=-1;let end=-1;for(let i=0;i<lines.length;i++){const match=lines[i].match(re);if(match===null)continue;if(match[2]!==label)continue;if(start===-1){if(match[1]!=="BEGIN")break;start=i}else{if(match[1]!=="END")break;end=i;break}}if(start===-1||end===-1)throw new Error("PEM section not found for: "+label);const base64=lines.slice(start+1,end).join("");base64.replace(/[^a-z0-9+/=]+/gi,"");const input=Buffer.from(base64,"base64");return DERDecoder.prototype.decode.call(this,input,options)}},{"./der":28,inherits:233,"safer-buffer":386}],31:[function(require,module,exports){"use strict";const inherits=require("inherits");const Buffer=require("safer-buffer").Buffer;const Node=require("../base/node");const der=require("../constants/der");function DEREncoder(entity){this.enc="der";this.name=entity.name;this.entity=entity;this.tree=new DERNode;this.tree._init(entity.body)}module.exports=DEREncoder;DEREncoder.prototype.encode=function encode(data,reporter){return this.tree._encode(data,reporter).join()};function DERNode(parent){Node.call(this,"der",parent)}inherits(DERNode,Node);DERNode.prototype._encodeComposite=function encodeComposite(tag,primitive,cls,content){const encodedTag=encodeTag(tag,primitive,cls,this.reporter);if(content.length<128){const header=Buffer.alloc(2);header[0]=encodedTag;header[1]=content.length;return this._createEncoderBuffer([header,content])}let lenOctets=1;for(let i=content.length;i>=256;i>>=8)lenOctets++;const header=Buffer.alloc(1+1+lenOctets);header[0]=encodedTag;header[1]=128|lenOctets;for(let i=1+lenOctets,j=content.length;j>0;i--,j>>=8)header[i]=j&255;return this._createEncoderBuffer([header,content])};DERNode.prototype._encodeStr=function encodeStr(str,tag){if(tag==="bitstr"){return this._createEncoderBuffer([str.unused|0,str.data])}else if(tag==="bmpstr"){const buf=Buffer.alloc(str.length*2);for(let i=0;i<str.length;i++){buf.writeUInt16BE(str.charCodeAt(i),i*2)}return this._createEncoderBuffer(buf)}else if(tag==="numstr"){if(!this._isNumstr(str)){return this.reporter.error("Encoding of string type: numstr supports "+"only digits and space")}return this._createEncoderBuffer(str)}else if(tag==="printstr"){if(!this._isPrintstr(str)){return this.reporter.error("Encoding of string type: printstr supports "+"only latin upper and lower case letters, "+"digits, space, apostrophe, left and rigth "+"parenthesis, plus sign, comma, hyphen, "+"dot, slash, colon, equal sign, "+"question mark")}return this._createEncoderBuffer(str)}else if(/str$/.test(tag)){return this._createEncoderBuffer(str)}else if(tag==="objDesc"){return this._createEncoderBuffer(str)}else{return this.reporter.error("Encoding of string type: "+tag+" unsupported")}};DERNode.prototype._encodeObjid=function encodeObjid(id,values,relative){if(typeof id==="string"){if(!values)return this.reporter.error("string objid given, but no values map found");if(!values.hasOwnProperty(id))return this.reporter.error("objid not found in values map");id=values[id].split(/[\s.]+/g);for(let i=0;i<id.length;i++)id[i]|=0}else if(Array.isArray(id)){id=id.slice();for(let i=0;i<id.length;i++)id[i]|=0}if(!Array.isArray(id)){return this.reporter.error("objid() should be either array or string, "+"got: "+JSON.stringify(id))}if(!relative){if(id[1]>=40)return this.reporter.error("Second objid identifier OOB");id.splice(0,2,id[0]*40+id[1])}let size=0;for(let i=0;i<id.length;i++){let ident=id[i];for(size++;ident>=128;ident>>=7)size++}const objid=Buffer.alloc(size);let offset=objid.length-1;for(let i=id.length-1;i>=0;i--){let ident=id[i];objid[offset--]=ident&127;while((ident>>=7)>0)objid[offset--]=128|ident&127}return this._createEncoderBuffer(objid)};function two(num){if(num<10)return"0"+num;else return num}DERNode.prototype._encodeTime=function encodeTime(time,tag){let str;const date=new Date(time);if(tag==="gentime"){str=[two(date.getUTCFullYear()),two(date.getUTCMonth()+1),two(date.getUTCDate()),two(date.getUTCHours()),two(date.getUTCMinutes()),two(date.getUTCSeconds()),"Z"].join("")}else if(tag==="utctime"){str=[two(date.getUTCFullYear()%100),two(date.getUTCMonth()+1),two(date.getUTCDate()),two(date.getUTCHours()),two(date.getUTCMinutes()),two(date.getUTCSeconds()),"Z"].join("")}else{this.reporter.error("Encoding "+tag+" time is not supported yet")}return this._encodeStr(str,"octstr")};DERNode.prototype._encodeNull=function encodeNull(){return this._createEncoderBuffer("")};DERNode.prototype._encodeInt=function encodeInt(num,values){if(typeof num==="string"){if(!values)return this.reporter.error("String int or enum given, but no values map");if(!values.hasOwnProperty(num)){return this.reporter.error("Values map doesn't contain: "+JSON.stringify(num))}num=values[num]}if(typeof num!=="number"&&!Buffer.isBuffer(num)){const numArray=num.toArray();if(!num.sign&&numArray[0]&128){numArray.unshift(0)}num=Buffer.from(numArray)}if(Buffer.isBuffer(num)){let size=num.length;if(num.length===0)size++;const out=Buffer.alloc(size);num.copy(out);if(num.length===0)out[0]=0;return this._createEncoderBuffer(out)}if(num<128)return this._createEncoderBuffer(num);if(num<256)return this._createEncoderBuffer([0,num]);let size=1;for(let i=num;i>=256;i>>=8)size++;const out=new Array(size);for(let i=out.length-1;i>=0;i--){out[i]=num&255;num>>=8}if(out[0]&128){out.unshift(0)}return this._createEncoderBuffer(Buffer.from(out))};DERNode.prototype._encodeBool=function encodeBool(value){return this._createEncoderBuffer(value?255:0)};DERNode.prototype._use=function use(entity,obj){if(typeof entity==="function")entity=entity(obj);return entity._getEncoder("der").tree};DERNode.prototype._skipDefault=function skipDefault(dataBuffer,reporter,parent){const state=this._baseState;let i;if(state["default"]===null)return false;const data=dataBuffer.join();if(state.defaultBuffer===undefined)state.defaultBuffer=this._encodeValue(state["default"],reporter,parent).join();if(data.length!==state.defaultBuffer.length)return false;for(i=0;i<data.length;i++)if(data[i]!==state.defaultBuffer[i])return false;return true};function encodeTag(tag,primitive,cls,reporter){let res;if(tag==="seqof")tag="seq";else if(tag==="setof")tag="set";if(der.tagByName.hasOwnProperty(tag))res=der.tagByName[tag];else if(typeof tag==="number"&&(tag|0)===tag)res=tag;else return reporter.error("Unknown tag: "+tag);if(res>=31)return reporter.error("Multi-octet tag encoding unsupported");if(!primitive)res|=32;res|=der.tagClassByName[cls||"universal"]<<6;return res}},{"../base/node":24,"../constants/der":26,inherits:233,"safer-buffer":386}],32:[function(require,module,exports){"use strict";const encoders=exports;encoders.der=require("./der");encoders.pem=require("./pem")},{"./der":31,"./pem":33}],33:[function(require,module,exports){"use strict";const inherits=require("inherits");const DEREncoder=require("./der");function PEMEncoder(entity){DEREncoder.call(this,entity);this.enc="pem"}inherits(PEMEncoder,DEREncoder);module.exports=PEMEncoder;PEMEncoder.prototype.encode=function encode(data,options){const buf=DEREncoder.prototype.encode.call(this,data);const p=buf.toString("base64");const out=["-----BEGIN "+options.label+"-----"];for(let i=0;i<p.length;i+=64)out.push(p.slice(i,i+64));out.push("-----END "+options.label+"-----");return out.join("\n")}},{"./der":31,inherits:233}],34:[function(require,module,exports){(function(module,exports){"use strict";function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}function BN(number,base,endian){if(BN.isBN(number)){return number}this.negative=0;this.words=null;this.length=0;this.red=null;if(number!==null){if(base==="le"||base==="be"){endian=base;base=10}this._init(number||0,base||10,endian||"be")}}if(typeof module==="object"){module.exports=BN}else{exports.BN=BN}BN.BN=BN;BN.wordSize=26;var Buffer;try{if(typeof window!=="undefined"&&typeof window.Buffer!=="undefined"){Buffer=window.Buffer}else{Buffer=require("buffer").Buffer}}catch(e){}BN.isBN=function isBN(num){if(num instanceof BN){return true}return num!==null&&typeof num==="object"&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)};BN.max=function max(left,right){if(left.cmp(right)>0)return left;return right};BN.min=function min(left,right){if(left.cmp(right)<0)return left;return right};BN.prototype._init=function init(number,base,endian){if(typeof number==="number"){return this._initNumber(number,base,endian)}if(typeof number==="object"){return this._initArray(number,base,endian)}if(base==="hex"){base=16}assert(base===(base|0)&&base>=2&&base<=36);number=number.toString().replace(/\s+/g,"");var start=0;if(number[0]==="-"){start++;this.negative=1}if(start<number.length){if(base===16){this._parseHex(number,start,endian)}else{this._parseBase(number,base,start);if(endian==="le"){this._initArray(this.toArray(),base,endian)}}}};BN.prototype._initNumber=function _initNumber(number,base,endian){if(number<0){this.negative=1;number=-number}if(number<67108864){this.words=[number&67108863];this.length=1}else if(number<4503599627370496){this.words=[number&67108863,number/67108864&67108863];this.length=2}else{assert(number<9007199254740992);this.words=[number&67108863,number/67108864&67108863,1];this.length=3}if(endian!=="le")return;this._initArray(this.toArray(),base,endian)};BN.prototype._initArray=function _initArray(number,base,endian){assert(typeof number.length==="number");if(number.length<=0){this.words=[0];this.length=1;return this}this.length=Math.ceil(number.length/3);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}var j,w;var off=0;if(endian==="be"){for(i=number.length-1,j=0;i>=0;i-=3){w=number[i]|number[i-1]<<8|number[i-2]<<16;this.words[j]|=w<<off&67108863;this.words[j+1]=w>>>26-off&67108863;off+=24;if(off>=26){off-=26;j++}}}else if(endian==="le"){for(i=0,j=0;i<number.length;i+=3){w=number[i]|number[i+1]<<8|number[i+2]<<16;this.words[j]|=w<<off&67108863;this.words[j+1]=w>>>26-off&67108863;off+=24;if(off>=26){off-=26;j++}}}return this.strip()};function parseHex4Bits(string,index){var c=string.charCodeAt(index);if(c>=65&&c<=70){return c-55}else if(c>=97&&c<=102){return c-87}else{return c-48&15}}function parseHexByte(string,lowerBound,index){var r=parseHex4Bits(string,index);if(index-1>=lowerBound){r|=parseHex4Bits(string,index-1)<<4}return r}BN.prototype._parseHex=function _parseHex(number,start,endian){this.length=Math.ceil((number.length-start)/6);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}var off=0;var j=0;var w;if(endian==="be"){for(i=number.length-1;i>=start;i-=2){w=parseHexByte(number,start,i)<<off;this.words[j]|=w&67108863;if(off>=18){off-=18;j+=1;this.words[j]|=w>>>26}else{off+=8}}}else{var parseLength=number.length-start;for(i=parseLength%2===0?start+1:start;i<number.length;i+=2){w=parseHexByte(number,start,i)<<off;this.words[j]|=w&67108863;if(off>=18){off-=18;j+=1;this.words[j]|=w>>>26}else{off+=8}}}this.strip()};function parseBase(str,start,end,mul){var r=0;var len=Math.min(str.length,end);for(var i=start;i<len;i++){var c=str.charCodeAt(i)-48;r*=mul;if(c>=49){r+=c-49+10}else if(c>=17){r+=c-17+10}else{r+=c}}return r}BN.prototype._parseBase=function _parseBase(number,base,start){this.words=[0];this.length=1;for(var limbLen=0,limbPow=1;limbPow<=67108863;limbPow*=base){limbLen++}limbLen--;limbPow=limbPow/base|0;var total=number.length-start;var mod=total%limbLen;var end=Math.min(total,total-mod)+start;var word=0;for(var i=start;i<end;i+=limbLen){word=parseBase(number,i,i+limbLen,base);this.imuln(limbPow);if(this.words[0]+word<67108864){this.words[0]+=word}else{this._iaddn(word)}}if(mod!==0){var pow=1;word=parseBase(number,i,number.length,base);for(i=0;i<mod;i++){pow*=base}this.imuln(pow);if(this.words[0]+word<67108864){this.words[0]+=word}else{this._iaddn(word)}}this.strip()};BN.prototype.copy=function copy(dest){dest.words=new Array(this.length);for(var i=0;i<this.length;i++){dest.words[i]=this.words[i]}dest.length=this.length;dest.negative=this.negative;dest.red=this.red};BN.prototype.clone=function clone(){var r=new BN(null);this.copy(r);return r};BN.prototype._expand=function _expand(size){while(this.length<size){this.words[this.length++]=0}return this};BN.prototype.strip=function strip(){while(this.length>1&&this.words[this.length-1]===0){this.length--}return this._normSign()};BN.prototype._normSign=function _normSign(){if(this.length===1&&this.words[0]===0){this.negative=0}return this};BN.prototype.inspect=function inspect(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"];var groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];BN.prototype.toString=function toString(base,padding){base=base||10;padding=padding|0||1;var out;if(base===16||base==="hex"){out="";var off=0;var carry=0;for(var i=0;i<this.length;i++){var w=this.words[i];var word=((w<<off|carry)&16777215).toString(16);carry=w>>>24-off&16777215;if(carry!==0||i!==this.length-1){out=zeros[6-word.length]+word+out}else{out=word+out}off+=2;if(off>=26){off-=26;i--}}if(carry!==0){out=carry.toString(16)+out}while(out.length%padding!==0){out="0"+out}if(this.negative!==0){out="-"+out}return out}if(base===(base|0)&&base>=2&&base<=36){var groupSize=groupSizes[base];var groupBase=groupBases[base];out="";var c=this.clone();c.negative=0;while(!c.isZero()){var r=c.modn(groupBase).toString(base);c=c.idivn(groupBase);if(!c.isZero()){out=zeros[groupSize-r.length]+r+out}else{out=r+out}}if(this.isZero()){out="0"+out}while(out.length%padding!==0){out="0"+out}if(this.negative!==0){out="-"+out}return out}assert(false,"Base should be between 2 and 36")};BN.prototype.toNumber=function toNumber(){var ret=this.words[0];if(this.length===2){ret+=this.words[1]*67108864}else if(this.length===3&&this.words[2]===1){ret+=4503599627370496+this.words[1]*67108864}else if(this.length>2){assert(false,"Number can only safely store up to 53 bits")}return this.negative!==0?-ret:ret};BN.prototype.toJSON=function toJSON(){return this.toString(16)};BN.prototype.toBuffer=function toBuffer(endian,length){assert(typeof Buffer!=="undefined");return this.toArrayLike(Buffer,endian,length)};BN.prototype.toArray=function toArray(endian,length){return this.toArrayLike(Array,endian,length)};BN.prototype.toArrayLike=function toArrayLike(ArrayType,endian,length){var byteLength=this.byteLength();var reqLength=length||Math.max(1,byteLength);assert(byteLength<=reqLength,"byte array longer than desired length");assert(reqLength>0,"Requested array length <= 0");this.strip();var littleEndian=endian==="le";var res=new ArrayType(reqLength);var b,i;var q=this.clone();if(!littleEndian){for(i=0;i<reqLength-byteLength;i++){res[i]=0}for(i=0;!q.isZero();i++){b=q.andln(255);q.iushrn(8);res[reqLength-i-1]=b}}else{for(i=0;!q.isZero();i++){b=q.andln(255);q.iushrn(8);res[i]=b}for(;i<reqLength;i++){res[i]=0}}return res};if(Math.clz32){BN.prototype._countBits=function _countBits(w){return 32-Math.clz32(w)}}else{BN.prototype._countBits=function _countBits(w){var t=w;var r=0;if(t>=4096){r+=13;t>>>=13}if(t>=64){r+=7;t>>>=7}if(t>=8){r+=4;t>>>=4}if(t>=2){r+=2;t>>>=2}return r+t}}BN.prototype._zeroBits=function _zeroBits(w){if(w===0)return 26;var t=w;var r=0;if((t&8191)===0){r+=13;t>>>=13}if((t&127)===0){r+=7;t>>>=7}if((t&15)===0){r+=4;t>>>=4}if((t&3)===0){r+=2;t>>>=2}if((t&1)===0){r++}return r};BN.prototype.bitLength=function bitLength(){var w=this.words[this.length-1];var hi=this._countBits(w);return(this.length-1)*26+hi};function toBitArray(num){var w=new Array(num.bitLength());for(var bit=0;bit<w.length;bit++){var off=bit/26|0;var wbit=bit%26;w[bit]=(num.words[off]&1<<wbit)>>>wbit}return w}BN.prototype.zeroBits=function zeroBits(){if(this.isZero())return 0;var r=0;for(var i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);r+=b;if(b!==26)break}return r};BN.prototype.byteLength=function byteLength(){return Math.ceil(this.bitLength()/8)};BN.prototype.toTwos=function toTwos(width){if(this.negative!==0){return this.abs().inotn(width).iaddn(1)}return this.clone()};BN.prototype.fromTwos=function fromTwos(width){if(this.testn(width-1)){return this.notn(width).iaddn(1).ineg()}return this.clone()};BN.prototype.isNeg=function isNeg(){return this.negative!==0};BN.prototype.neg=function neg(){return this.clone().ineg()};BN.prototype.ineg=function ineg(){if(!this.isZero()){this.negative^=1}return this};BN.prototype.iuor=function iuor(num){while(this.length<num.length){this.words[this.length++]=0}for(var i=0;i<num.length;i++){this.words[i]=this.words[i]|num.words[i]}return this.strip()};BN.prototype.ior=function ior(num){assert((this.negative|num.negative)===0);return this.iuor(num)};BN.prototype.or=function or(num){if(this.length>num.length)return this.clone().ior(num);return num.clone().ior(this)};BN.prototype.uor=function uor(num){if(this.length>num.length)return this.clone().iuor(num);return num.clone().iuor(this)};BN.prototype.iuand=function iuand(num){var b;if(this.length>num.length){b=num}else{b=this}for(var i=0;i<b.length;i++){this.words[i]=this.words[i]&num.words[i]}this.length=b.length;return this.strip()};BN.prototype.iand=function iand(num){assert((this.negative|num.negative)===0);return this.iuand(num)};BN.prototype.and=function and(num){if(this.length>num.length)return this.clone().iand(num);return num.clone().iand(this)};BN.prototype.uand=function uand(num){if(this.length>num.length)return this.clone().iuand(num);return num.clone().iuand(this)};BN.prototype.iuxor=function iuxor(num){var a;var b;if(this.length>num.length){a=this;b=num}else{a=num;b=this}for(var i=0;i<b.length;i++){this.words[i]=a.words[i]^b.words[i]}if(this!==a){for(;i<a.length;i++){this.words[i]=a.words[i]}}this.length=a.length;return this.strip()};BN.prototype.ixor=function ixor(num){assert((this.negative|num.negative)===0);return this.iuxor(num)};BN.prototype.xor=function xor(num){if(this.length>num.length)return this.clone().ixor(num);return num.clone().ixor(this)};BN.prototype.uxor=function uxor(num){if(this.length>num.length)return this.clone().iuxor(num);return num.clone().iuxor(this)};BN.prototype.inotn=function inotn(width){assert(typeof width==="number"&&width>=0);var bytesNeeded=Math.ceil(width/26)|0;var bitsLeft=width%26;this._expand(bytesNeeded);if(bitsLeft>0){bytesNeeded--}for(var i=0;i<bytesNeeded;i++){this.words[i]=~this.words[i]&67108863}if(bitsLeft>0){this.words[i]=~this.words[i]&67108863>>26-bitsLeft}return this.strip()};BN.prototype.notn=function notn(width){return this.clone().inotn(width)};BN.prototype.setn=function setn(bit,val){assert(typeof bit==="number"&&bit>=0);var off=bit/26|0;var wbit=bit%26;this._expand(off+1);if(val){this.words[off]=this.words[off]|1<<wbit}else{this.words[off]=this.words[off]&~(1<<wbit)}return this.strip()};BN.prototype.iadd=function iadd(num){var r;if(this.negative!==0&&num.negative===0){this.negative=0;r=this.isub(num);this.negative^=1;return this._normSign()}else if(this.negative===0&&num.negative!==0){num.negative=0;r=this.isub(num);num.negative=1;return r._normSign()}var a,b;if(this.length>num.length){a=this;b=num}else{a=num;b=this}var carry=0;for(var i=0;i<b.length;i++){r=(a.words[i]|0)+(b.words[i]|0)+carry;this.words[i]=r&67108863;carry=r>>>26}for(;carry!==0&&i<a.length;i++){r=(a.words[i]|0)+carry;this.words[i]=r&67108863;carry=r>>>26}this.length=a.length;if(carry!==0){this.words[this.length]=carry;this.length++}else if(a!==this){for(;i<a.length;i++){this.words[i]=a.words[i]}}return this};BN.prototype.add=function add(num){var res;if(num.negative!==0&&this.negative===0){num.negative=0;res=this.sub(num);num.negative^=1;return res}else if(num.negative===0&&this.negative!==0){this.negative=0;res=num.sub(this);this.negative=1;return res}if(this.length>num.length)return this.clone().iadd(num);return num.clone().iadd(this)};BN.prototype.isub=function isub(num){if(num.negative!==0){num.negative=0;var r=this.iadd(num);num.negative=1;return r._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(num);this.negative=1;return this._normSign()}var cmp=this.cmp(num);if(cmp===0){this.negative=0;this.length=1;this.words[0]=0;return this}var a,b;if(cmp>0){a=this;b=num}else{a=num;b=this}var carry=0;for(var i=0;i<b.length;i++){r=(a.words[i]|0)-(b.words[i]|0)+carry;carry=r>>26;this.words[i]=r&67108863}for(;carry!==0&&i<a.length;i++){r=(a.words[i]|0)+carry;carry=r>>26;this.words[i]=r&67108863}if(carry===0&&i<a.length&&a!==this){for(;i<a.length;i++){this.words[i]=a.words[i]}}this.length=Math.max(this.length,i);if(a!==this){this.negative=1}return this.strip()};BN.prototype.sub=function sub(num){return this.clone().isub(num)};function smallMulTo(self,num,out){out.negative=num.negative^self.negative;var len=self.length+num.length|0;out.length=len;len=len-1|0;var a=self.words[0]|0;var b=num.words[0]|0;var r=a*b;var lo=r&67108863;var carry=r/67108864|0;out.words[0]=lo;for(var k=1;k<len;k++){var ncarry=carry>>>26;var rword=carry&67108863;var maxJ=Math.min(k,num.length-1);for(var j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j|0;a=self.words[i]|0;b=num.words[j]|0;r=a*b+rword;ncarry+=r/67108864|0;rword=r&67108863}out.words[k]=rword|0;carry=ncarry|0}if(carry!==0){out.words[k]=carry|0}else{out.length--}return out.strip()}var comb10MulTo=function comb10MulTo(self,num,out){var a=self.words;var b=num.words;var o=out.words;var c=0;var lo;var mid;var hi;var a0=a[0]|0;var al0=a0&8191;var ah0=a0>>>13;var a1=a[1]|0;var al1=a1&8191;var ah1=a1>>>13;var a2=a[2]|0;var al2=a2&8191;var ah2=a2>>>13;var a3=a[3]|0;var al3=a3&8191;var ah3=a3>>>13;var a4=a[4]|0;var al4=a4&8191;var ah4=a4>>>13;var a5=a[5]|0;var al5=a5&8191;var ah5=a5>>>13;var a6=a[6]|0;var al6=a6&8191;var ah6=a6>>>13;var a7=a[7]|0;var al7=a7&8191;var ah7=a7>>>13;var a8=a[8]|0;var al8=a8&8191;var ah8=a8>>>13;var a9=a[9]|0;var al9=a9&8191;var ah9=a9>>>13;var b0=b[0]|0;var bl0=b0&8191;var bh0=b0>>>13;var b1=b[1]|0;var bl1=b1&8191;var bh1=b1>>>13;var b2=b[2]|0;var bl2=b2&8191;var bh2=b2>>>13;var b3=b[3]|0;var bl3=b3&8191;var bh3=b3>>>13;var b4=b[4]|0;var bl4=b4&8191;var bh4=b4>>>13;var b5=b[5]|0;var bl5=b5&8191;var bh5=b5>>>13;var b6=b[6]|0;var bl6=b6&8191;var bh6=b6>>>13;var b7=b[7]|0;var bl7=b7&8191;var bh7=b7>>>13;var b8=b[8]|0;var bl8=b8&8191;var bh8=b8>>>13;var b9=b[9]|0;var bl9=b9&8191;var bh9=b9>>>13;out.negative=self.negative^num.negative;out.length=19;lo=Math.imul(al0,bl0);mid=Math.imul(al0,bh0);mid=mid+Math.imul(ah0,bl0)|0;hi=Math.imul(ah0,bh0);var w0=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w0>>>26)|0;w0&=67108863;lo=Math.imul(al1,bl0);mid=Math.imul(al1,bh0);mid=mid+Math.imul(ah1,bl0)|0;hi=Math.imul(ah1,bh0);lo=lo+Math.imul(al0,bl1)|0;mid=mid+Math.imul(al0,bh1)|0;mid=mid+Math.imul(ah0,bl1)|0;hi=hi+Math.imul(ah0,bh1)|0;var w1=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w1>>>26)|0;w1&=67108863;lo=Math.imul(al2,bl0);mid=Math.imul(al2,bh0);mid=mid+Math.imul(ah2,bl0)|0;hi=Math.imul(ah2,bh0);lo=lo+Math.imul(al1,bl1)|0;mid=mid+Math.imul(al1,bh1)|0;mid=mid+Math.imul(ah1,bl1)|0;hi=hi+Math.imul(ah1,bh1)|0;lo=lo+Math.imul(al0,bl2)|0;mid=mid+Math.imul(al0,bh2)|0;mid=mid+Math.imul(ah0,bl2)|0;hi=hi+Math.imul(ah0,bh2)|0;var w2=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w2>>>26)|0;w2&=67108863;lo=Math.imul(al3,bl0);mid=Math.imul(al3,bh0);mid=mid+Math.imul(ah3,bl0)|0;hi=Math.imul(ah3,bh0);lo=lo+Math.imul(al2,bl1)|0;mid=mid+Math.imul(al2,bh1)|0;mid=mid+Math.imul(ah2,bl1)|0;hi=hi+Math.imul(ah2,bh1)|0;lo=lo+Math.imul(al1,bl2)|0;mid=mid+Math.imul(al1,bh2)|0;mid=mid+Math.imul(ah1,bl2)|0;hi=hi+Math.imul(ah1,bh2)|0;lo=lo+Math.imul(al0,bl3)|0;mid=mid+Math.imul(al0,bh3)|0;mid=mid+Math.imul(ah0,bl3)|0;hi=hi+Math.imul(ah0,bh3)|0;var w3=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w3>>>26)|0;w3&=67108863;lo=Math.imul(al4,bl0);mid=Math.imul(al4,bh0);mid=mid+Math.imul(ah4,bl0)|0;hi=Math.imul(ah4,bh0);lo=lo+Math.imul(al3,bl1)|0;mid=mid+Math.imul(al3,bh1)|0;mid=mid+Math.imul(ah3,bl1)|0;hi=hi+Math.imul(ah3,bh1)|0;lo=lo+Math.imul(al2,bl2)|0;mid=mid+Math.imul(al2,bh2)|0;mid=mid+Math.imul(ah2,bl2)|0;hi=hi+Math.imul(ah2,bh2)|0;lo=lo+Math.imul(al1,bl3)|0;mid=mid+Math.imul(al1,bh3)|0;mid=mid+Math.imul(ah1,bl3)|0;hi=hi+Math.imul(ah1,bh3)|0;lo=lo+Math.imul(al0,bl4)|0;mid=mid+Math.imul(al0,bh4)|0;mid=mid+Math.imul(ah0,bl4)|0;hi=hi+Math.imul(ah0,bh4)|0;var w4=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w4>>>26)|0;w4&=67108863;lo=Math.imul(al5,bl0);mid=Math.imul(al5,bh0);mid=mid+Math.imul(ah5,bl0)|0;hi=Math.imul(ah5,bh0);lo=lo+Math.imul(al4,bl1)|0;mid=mid+Math.imul(al4,bh1)|0;mid=mid+Math.imul(ah4,bl1)|0;hi=hi+Math.imul(ah4,bh1)|0;lo=lo+Math.imul(al3,bl2)|0;mid=mid+Math.imul(al3,bh2)|0;mid=mid+Math.imul(ah3,bl2)|0;hi=hi+Math.imul(ah3,bh2)|0;lo=lo+Math.imul(al2,bl3)|0;mid=mid+Math.imul(al2,bh3)|0;mid=mid+Math.imul(ah2,bl3)|0;hi=hi+Math.imul(ah2,bh3)|0;lo=lo+Math.imul(al1,bl4)|0;mid=mid+Math.imul(al1,bh4)|0;mid=mid+Math.imul(ah1,bl4)|0;hi=hi+Math.imul(ah1,bh4)|0;lo=lo+Math.imul(al0,bl5)|0;mid=mid+Math.imul(al0,bh5)|0;mid=mid+Math.imul(ah0,bl5)|0;hi=hi+Math.imul(ah0,bh5)|0;var w5=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w5>>>26)|0;w5&=67108863;lo=Math.imul(al6,bl0);mid=Math.imul(al6,bh0);mid=mid+Math.imul(ah6,bl0)|0;hi=Math.imul(ah6,bh0);lo=lo+Math.imul(al5,bl1)|0;mid=mid+Math.imul(al5,bh1)|0;mid=mid+Math.imul(ah5,bl1)|0;hi=hi+Math.imul(ah5,bh1)|0;lo=lo+Math.imul(al4,bl2)|0;mid=mid+Math.imul(al4,bh2)|0;mid=mid+Math.imul(ah4,bl2)|0;hi=hi+Math.imul(ah4,bh2)|0;lo=lo+Math.imul(al3,bl3)|0;mid=mid+Math.imul(al3,bh3)|0;mid=mid+Math.imul(ah3,bl3)|0;hi=hi+Math.imul(ah3,bh3)|0;lo=lo+Math.imul(al2,bl4)|0;mid=mid+Math.imul(al2,bh4)|0;mid=mid+Math.imul(ah2,bl4)|0;hi=hi+Math.imul(ah2,bh4)|0;lo=lo+Math.imul(al1,bl5)|0;mid=mid+Math.imul(al1,bh5)|0;mid=mid+Math.imul(ah1,bl5)|0;hi=hi+Math.imul(ah1,bh5)|0;lo=lo+Math.imul(al0,bl6)|0;mid=mid+Math.imul(al0,bh6)|0;mid=mid+Math.imul(ah0,bl6)|0;hi=hi+Math.imul(ah0,bh6)|0;var w6=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w6>>>26)|0;w6&=67108863;lo=Math.imul(al7,bl0);mid=Math.imul(al7,bh0);mid=mid+Math.imul(ah7,bl0)|0;hi=Math.imul(ah7,bh0);lo=lo+Math.imul(al6,bl1)|0;mid=mid+Math.imul(al6,bh1)|0;mid=mid+Math.imul(ah6,bl1)|0;hi=hi+Math.imul(ah6,bh1)|0;lo=lo+Math.imul(al5,bl2)|0;mid=mid+Math.imul(al5,bh2)|0;mid=mid+Math.imul(ah5,bl2)|0;hi=hi+Math.imul(ah5,bh2)|0;lo=lo+Math.imul(al4,bl3)|0;mid=mid+Math.imul(al4,bh3)|0;mid=mid+Math.imul(ah4,bl3)|0;hi=hi+Math.imul(ah4,bh3)|0;lo=lo+Math.imul(al3,bl4)|0;mid=mid+Math.imul(al3,bh4)|0;mid=mid+Math.imul(ah3,bl4)|0;hi=hi+Math.imul(ah3,bh4)|0;lo=lo+Math.imul(al2,bl5)|0;mid=mid+Math.imul(al2,bh5)|0;mid=mid+Math.imul(ah2,bl5)|0;hi=hi+Math.imul(ah2,bh5)|0;lo=lo+Math.imul(al1,bl6)|0;mid=mid+Math.imul(al1,bh6)|0;mid=mid+Math.imul(ah1,bl6)|0;hi=hi+Math.imul(ah1,bh6)|0;lo=lo+Math.imul(al0,bl7)|0;mid=mid+Math.imul(al0,bh7)|0;mid=mid+Math.imul(ah0,bl7)|0;hi=hi+Math.imul(ah0,bh7)|0;var w7=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w7>>>26)|0;w7&=67108863;lo=Math.imul(al8,bl0);mid=Math.imul(al8,bh0);mid=mid+Math.imul(ah8,bl0)|0;hi=Math.imul(ah8,bh0);lo=lo+Math.imul(al7,bl1)|0;mid=mid+Math.imul(al7,bh1)|0;mid=mid+Math.imul(ah7,bl1)|0;hi=hi+Math.imul(ah7,bh1)|0;lo=lo+Math.imul(al6,bl2)|0;mid=mid+Math.imul(al6,bh2)|0;mid=mid+Math.imul(ah6,bl2)|0;hi=hi+Math.imul(ah6,bh2)|0;lo=lo+Math.imul(al5,bl3)|0;mid=mid+Math.imul(al5,bh3)|0;mid=mid+Math.imul(ah5,bl3)|0;hi=hi+Math.imul(ah5,bh3)|0;lo=lo+Math.imul(al4,bl4)|0;mid=mid+Math.imul(al4,bh4)|0;mid=mid+Math.imul(ah4,bl4)|0;hi=hi+Math.imul(ah4,bh4)|0;lo=lo+Math.imul(al3,bl5)|0;mid=mid+Math.imul(al3,bh5)|0;mid=mid+Math.imul(ah3,bl5)|0;hi=hi+Math.imul(ah3,bh5)|0;lo=lo+Math.imul(al2,bl6)|0;mid=mid+Math.imul(al2,bh6)|0;mid=mid+Math.imul(ah2,bl6)|0;hi=hi+Math.imul(ah2,bh6)|0;lo=lo+Math.imul(al1,bl7)|0;mid=mid+Math.imul(al1,bh7)|0;mid=mid+Math.imul(ah1,bl7)|0;hi=hi+Math.imul(ah1,bh7)|0;lo=lo+Math.imul(al0,bl8)|0;mid=mid+Math.imul(al0,bh8)|0;mid=mid+Math.imul(ah0,bl8)|0;hi=hi+Math.imul(ah0,bh8)|0;var w8=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w8>>>26)|0;w8&=67108863;lo=Math.imul(al9,bl0);mid=Math.imul(al9,bh0);mid=mid+Math.imul(ah9,bl0)|0;hi=Math.imul(ah9,bh0);lo=lo+Math.imul(al8,bl1)|0;mid=mid+Math.imul(al8,bh1)|0;mid=mid+Math.imul(ah8,bl1)|0;hi=hi+Math.imul(ah8,bh1)|0;lo=lo+Math.imul(al7,bl2)|0;mid=mid+Math.imul(al7,bh2)|0;mid=mid+Math.imul(ah7,bl2)|0;hi=hi+Math.imul(ah7,bh2)|0;lo=lo+Math.imul(al6,bl3)|0;mid=mid+Math.imul(al6,bh3)|0;mid=mid+Math.imul(ah6,bl3)|0;hi=hi+Math.imul(ah6,bh3)|0;lo=lo+Math.imul(al5,bl4)|0;mid=mid+Math.imul(al5,bh4)|0;mid=mid+Math.imul(ah5,bl4)|0;hi=hi+Math.imul(ah5,bh4)|0;lo=lo+Math.imul(al4,bl5)|0;mid=mid+Math.imul(al4,bh5)|0;mid=mid+Math.imul(ah4,bl5)|0;hi=hi+Math.imul(ah4,bh5)|0;lo=lo+Math.imul(al3,bl6)|0;mid=mid+Math.imul(al3,bh6)|0;mid=mid+Math.imul(ah3,bl6)|0;hi=hi+Math.imul(ah3,bh6)|0;lo=lo+Math.imul(al2,bl7)|0;mid=mid+Math.imul(al2,bh7)|0;mid=mid+Math.imul(ah2,bl7)|0;hi=hi+Math.imul(ah2,bh7)|0;lo=lo+Math.imul(al1,bl8)|0;mid=mid+Math.imul(al1,bh8)|0;mid=mid+Math.imul(ah1,bl8)|0;hi=hi+Math.imul(ah1,bh8)|0;lo=lo+Math.imul(al0,bl9)|0;mid=mid+Math.imul(al0,bh9)|0;mid=mid+Math.imul(ah0,bl9)|0;hi=hi+Math.imul(ah0,bh9)|0;var w9=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w9>>>26)|0;w9&=67108863;lo=Math.imul(al9,bl1);mid=Math.imul(al9,bh1);mid=mid+Math.imul(ah9,bl1)|0;hi=Math.imul(ah9,bh1);lo=lo+Math.imul(al8,bl2)|0;mid=mid+Math.imul(al8,bh2)|0;mid=mid+Math.imul(ah8,bl2)|0;hi=hi+Math.imul(ah8,bh2)|0;lo=lo+Math.imul(al7,bl3)|0;mid=mid+Math.imul(al7,bh3)|0;mid=mid+Math.imul(ah7,bl3)|0;hi=hi+Math.imul(ah7,bh3)|0;lo=lo+Math.imul(al6,bl4)|0;mid=mid+Math.imul(al6,bh4)|0;mid=mid+Math.imul(ah6,bl4)|0;hi=hi+Math.imul(ah6,bh4)|0;lo=lo+Math.imul(al5,bl5)|0;mid=mid+Math.imul(al5,bh5)|0;mid=mid+Math.imul(ah5,bl5)|0;hi=hi+Math.imul(ah5,bh5)|0;lo=lo+Math.imul(al4,bl6)|0;mid=mid+Math.imul(al4,bh6)|0;mid=mid+Math.imul(ah4,bl6)|0;hi=hi+Math.imul(ah4,bh6)|0;lo=lo+Math.imul(al3,bl7)|0;mid=mid+Math.imul(al3,bh7)|0;mid=mid+Math.imul(ah3,bl7)|0;hi=hi+Math.imul(ah3,bh7)|0;lo=lo+Math.imul(al2,bl8)|0;mid=mid+Math.imul(al2,bh8)|0;mid=mid+Math.imul(ah2,bl8)|0;hi=hi+Math.imul(ah2,bh8)|0;lo=lo+Math.imul(al1,bl9)|0;mid=mid+Math.imul(al1,bh9)|0;mid=mid+Math.imul(ah1,bl9)|0;hi=hi+Math.imul(ah1,bh9)|0;var w10=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w10>>>26)|0;w10&=67108863;lo=Math.imul(al9,bl2);mid=Math.imul(al9,bh2);mid=mid+Math.imul(ah9,bl2)|0;hi=Math.imul(ah9,bh2);lo=lo+Math.imul(al8,bl3)|0;mid=mid+Math.imul(al8,bh3)|0;mid=mid+Math.imul(ah8,bl3)|0;hi=hi+Math.imul(ah8,bh3)|0;lo=lo+Math.imul(al7,bl4)|0;mid=mid+Math.imul(al7,bh4)|0;mid=mid+Math.imul(ah7,bl4)|0;hi=hi+Math.imul(ah7,bh4)|0;lo=lo+Math.imul(al6,bl5)|0;mid=mid+Math.imul(al6,bh5)|0;mid=mid+Math.imul(ah6,bl5)|0;hi=hi+Math.imul(ah6,bh5)|0;lo=lo+Math.imul(al5,bl6)|0;mid=mid+Math.imul(al5,bh6)|0;mid=mid+Math.imul(ah5,bl6)|0;hi=hi+Math.imul(ah5,bh6)|0;lo=lo+Math.imul(al4,bl7)|0;mid=mid+Math.imul(al4,bh7)|0;mid=mid+Math.imul(ah4,bl7)|0;hi=hi+Math.imul(ah4,bh7)|0;lo=lo+Math.imul(al3,bl8)|0;mid=mid+Math.imul(al3,bh8)|0;mid=mid+Math.imul(ah3,bl8)|0;hi=hi+Math.imul(ah3,bh8)|0;lo=lo+Math.imul(al2,bl9)|0;mid=mid+Math.imul(al2,bh9)|0;mid=mid+Math.imul(ah2,bl9)|0;hi=hi+Math.imul(ah2,bh9)|0;var w11=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w11>>>26)|0;w11&=67108863;lo=Math.imul(al9,bl3);mid=Math.imul(al9,bh3);mid=mid+Math.imul(ah9,bl3)|0;hi=Math.imul(ah9,bh3);lo=lo+Math.imul(al8,bl4)|0;mid=mid+Math.imul(al8,bh4)|0;mid=mid+Math.imul(ah8,bl4)|0;hi=hi+Math.imul(ah8,bh4)|0;lo=lo+Math.imul(al7,bl5)|0;mid=mid+Math.imul(al7,bh5)|0;mid=mid+Math.imul(ah7,bl5)|0;hi=hi+Math.imul(ah7,bh5)|0;lo=lo+Math.imul(al6,bl6)|0;mid=mid+Math.imul(al6,bh6)|0;mid=mid+Math.imul(ah6,bl6)|0;hi=hi+Math.imul(ah6,bh6)|0;lo=lo+Math.imul(al5,bl7)|0;mid=mid+Math.imul(al5,bh7)|0;mid=mid+Math.imul(ah5,bl7)|0;hi=hi+Math.imul(ah5,bh7)|0;lo=lo+Math.imul(al4,bl8)|0;mid=mid+Math.imul(al4,bh8)|0;mid=mid+Math.imul(ah4,bl8)|0;hi=hi+Math.imul(ah4,bh8)|0;lo=lo+Math.imul(al3,bl9)|0;mid=mid+Math.imul(al3,bh9)|0;mid=mid+Math.imul(ah3,bl9)|0;hi=hi+Math.imul(ah3,bh9)|0;var w12=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w12>>>26)|0;w12&=67108863;lo=Math.imul(al9,bl4);mid=Math.imul(al9,bh4);mid=mid+Math.imul(ah9,bl4)|0;hi=Math.imul(ah9,bh4);lo=lo+Math.imul(al8,bl5)|0;mid=mid+Math.imul(al8,bh5)|0;mid=mid+Math.imul(ah8,bl5)|0;hi=hi+Math.imul(ah8,bh5)|0;lo=lo+Math.imul(al7,bl6)|0;mid=mid+Math.imul(al7,bh6)|0;mid=mid+Math.imul(ah7,bl6)|0;hi=hi+Math.imul(ah7,bh6)|0;lo=lo+Math.imul(al6,bl7)|0;mid=mid+Math.imul(al6,bh7)|0;mid=mid+Math.imul(ah6,bl7)|0;hi=hi+Math.imul(ah6,bh7)|0;lo=lo+Math.imul(al5,bl8)|0;mid=mid+Math.imul(al5,bh8)|0;mid=mid+Math.imul(ah5,bl8)|0;hi=hi+Math.imul(ah5,bh8)|0;lo=lo+Math.imul(al4,bl9)|0;mid=mid+Math.imul(al4,bh9)|0;mid=mid+Math.imul(ah4,bl9)|0;hi=hi+Math.imul(ah4,bh9)|0;var w13=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w13>>>26)|0;w13&=67108863;lo=Math.imul(al9,bl5);mid=Math.imul(al9,bh5);mid=mid+Math.imul(ah9,bl5)|0;hi=Math.imul(ah9,bh5);lo=lo+Math.imul(al8,bl6)|0;mid=mid+Math.imul(al8,bh6)|0;mid=mid+Math.imul(ah8,bl6)|0;hi=hi+Math.imul(ah8,bh6)|0;lo=lo+Math.imul(al7,bl7)|0;mid=mid+Math.imul(al7,bh7)|0;mid=mid+Math.imul(ah7,bl7)|0;hi=hi+Math.imul(ah7,bh7)|0;lo=lo+Math.imul(al6,bl8)|0;mid=mid+Math.imul(al6,bh8)|0;mid=mid+Math.imul(ah6,bl8)|0;hi=hi+Math.imul(ah6,bh8)|0;lo=lo+Math.imul(al5,bl9)|0;mid=mid+Math.imul(al5,bh9)|0;mid=mid+Math.imul(ah5,bl9)|0;hi=hi+Math.imul(ah5,bh9)|0;var w14=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w14>>>26)|0;w14&=67108863;lo=Math.imul(al9,bl6);mid=Math.imul(al9,bh6);mid=mid+Math.imul(ah9,bl6)|0;hi=Math.imul(ah9,bh6);lo=lo+Math.imul(al8,bl7)|0;mid=mid+Math.imul(al8,bh7)|0;mid=mid+Math.imul(ah8,bl7)|0;hi=hi+Math.imul(ah8,bh7)|0;lo=lo+Math.imul(al7,bl8)|0;mid=mid+Math.imul(al7,bh8)|0;mid=mid+Math.imul(ah7,bl8)|0;hi=hi+Math.imul(ah7,bh8)|0;lo=lo+Math.imul(al6,bl9)|0;mid=mid+Math.imul(al6,bh9)|0;mid=mid+Math.imul(ah6,bl9)|0;hi=hi+Math.imul(ah6,bh9)|0;var w15=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w15>>>26)|0;w15&=67108863;lo=Math.imul(al9,bl7);mid=Math.imul(al9,bh7);mid=mid+Math.imul(ah9,bl7)|0;hi=Math.imul(ah9,bh7);lo=lo+Math.imul(al8,bl8)|0;mid=mid+Math.imul(al8,bh8)|0;mid=mid+Math.imul(ah8,bl8)|0;hi=hi+Math.imul(ah8,bh8)|0;lo=lo+Math.imul(al7,bl9)|0;mid=mid+Math.imul(al7,bh9)|0;mid=mid+Math.imul(ah7,bl9)|0;hi=hi+Math.imul(ah7,bh9)|0;var w16=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w16>>>26)|0;w16&=67108863;lo=Math.imul(al9,bl8);mid=Math.imul(al9,bh8);mid=mid+Math.imul(ah9,bl8)|0;hi=Math.imul(ah9,bh8);lo=lo+Math.imul(al8,bl9)|0;mid=mid+Math.imul(al8,bh9)|0;mid=mid+Math.imul(ah8,bl9)|0;hi=hi+Math.imul(ah8,bh9)|0;var w17=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w17>>>26)|0;w17&=67108863;lo=Math.imul(al9,bl9);mid=Math.imul(al9,bh9);mid=mid+Math.imul(ah9,bl9)|0;hi=Math.imul(ah9,bh9);var w18=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w18>>>26)|0;w18&=67108863;o[0]=w0;o[1]=w1;o[2]=w2;o[3]=w3;o[4]=w4;o[5]=w5;o[6]=w6;o[7]=w7;o[8]=w8;o[9]=w9;o[10]=w10;o[11]=w11;o[12]=w12;o[13]=w13;o[14]=w14;o[15]=w15;o[16]=w16;o[17]=w17;o[18]=w18;if(c!==0){o[19]=c;out.length++}return out};if(!Math.imul){comb10MulTo=smallMulTo}function bigMulTo(self,num,out){out.negative=num.negative^self.negative;out.length=self.length+num.length;var carry=0;var hncarry=0;for(var k=0;k<out.length-1;k++){var ncarry=hncarry;hncarry=0;var rword=carry&67108863;var maxJ=Math.min(k,num.length-1);for(var j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j;var a=self.words[i]|0;var b=num.words[j]|0;var r=a*b;var lo=r&67108863;ncarry=ncarry+(r/67108864|0)|0;lo=lo+rword|0;rword=lo&67108863;ncarry=ncarry+(lo>>>26)|0;hncarry+=ncarry>>>26;ncarry&=67108863}out.words[k]=rword;carry=ncarry;ncarry=hncarry}if(carry!==0){out.words[k]=carry}else{out.length--}return out.strip()}function jumboMulTo(self,num,out){var fftm=new FFTM;return fftm.mulp(self,num,out)}BN.prototype.mulTo=function mulTo(num,out){var res;var len=this.length+num.length;if(this.length===10&&num.length===10){res=comb10MulTo(this,num,out)}else if(len<63){res=smallMulTo(this,num,out)}else if(len<1024){res=bigMulTo(this,num,out)}else{res=jumboMulTo(this,num,out)}return res};function FFTM(x,y){this.x=x;this.y=y}FFTM.prototype.makeRBT=function makeRBT(N){var t=new Array(N);var l=BN.prototype._countBits(N)-1;for(var i=0;i<N;i++){t[i]=this.revBin(i,l,N)}return t};FFTM.prototype.revBin=function revBin(x,l,N){if(x===0||x===N-1)return x;var rb=0;for(var i=0;i<l;i++){rb|=(x&1)<<l-i-1;x>>=1}return rb};FFTM.prototype.permute=function permute(rbt,rws,iws,rtws,itws,N){for(var i=0;i<N;i++){rtws[i]=rws[rbt[i]];itws[i]=iws[rbt[i]]}};FFTM.prototype.transform=function transform(rws,iws,rtws,itws,N,rbt){this.permute(rbt,rws,iws,rtws,itws,N);for(var s=1;s<N;s<<=1){var l=s<<1;var rtwdf=Math.cos(2*Math.PI/l);var itwdf=Math.sin(2*Math.PI/l);for(var p=0;p<N;p+=l){var rtwdf_=rtwdf;var itwdf_=itwdf;for(var j=0;j<s;j++){var re=rtws[p+j];var ie=itws[p+j];var ro=rtws[p+j+s];var io=itws[p+j+s];var rx=rtwdf_*ro-itwdf_*io;io=rtwdf_*io+itwdf_*ro;ro=rx;rtws[p+j]=re+ro;itws[p+j]=ie+io;rtws[p+j+s]=re-ro;itws[p+j+s]=ie-io;if(j!==l){rx=rtwdf*rtwdf_-itwdf*itwdf_;itwdf_=rtwdf*itwdf_+itwdf*rtwdf_;rtwdf_=rx}}}}};FFTM.prototype.guessLen13b=function guessLen13b(n,m){var N=Math.max(m,n)|1;var odd=N&1;var i=0;for(N=N/2|0;N;N=N>>>1){i++}return 1<<i+1+odd};FFTM.prototype.conjugate=function conjugate(rws,iws,N){if(N<=1)return;for(var i=0;i<N/2;i++){var t=rws[i];rws[i]=rws[N-i-1];rws[N-i-1]=t;t=iws[i];iws[i]=-iws[N-i-1];iws[N-i-1]=-t}};FFTM.prototype.normalize13b=function normalize13b(ws,N){var carry=0;for(var i=0;i<N/2;i++){var w=Math.round(ws[2*i+1]/N)*8192+Math.round(ws[2*i]/N)+carry;ws[i]=w&67108863;if(w<67108864){carry=0}else{carry=w/67108864|0}}return ws};FFTM.prototype.convert13b=function convert13b(ws,len,rws,N){var carry=0;for(var i=0;i<len;i++){carry=carry+(ws[i]|0);rws[2*i]=carry&8191;carry=carry>>>13;rws[2*i+1]=carry&8191;carry=carry>>>13}for(i=2*len;i<N;++i){rws[i]=0}assert(carry===0);assert((carry&~8191)===0)};FFTM.prototype.stub=function stub(N){var ph=new Array(N);for(var i=0;i<N;i++){ph[i]=0}return ph};FFTM.prototype.mulp=function mulp(x,y,out){var N=2*this.guessLen13b(x.length,y.length);var rbt=this.makeRBT(N);var _=this.stub(N);var rws=new Array(N);var rwst=new Array(N);var iwst=new Array(N);var nrws=new Array(N);var nrwst=new Array(N);var niwst=new Array(N);var rmws=out.words;rmws.length=N;this.convert13b(x.words,x.length,rws,N);this.convert13b(y.words,y.length,nrws,N);this.transform(rws,_,rwst,iwst,N,rbt);this.transform(nrws,_,nrwst,niwst,N,rbt);for(var i=0;i<N;i++){var rx=rwst[i]*nrwst[i]-iwst[i]*niwst[i];iwst[i]=rwst[i]*niwst[i]+iwst[i]*nrwst[i];rwst[i]=rx}this.conjugate(rwst,iwst,N);this.transform(rwst,iwst,rmws,_,N,rbt);this.conjugate(rmws,_,N);this.normalize13b(rmws,N);out.negative=x.negative^y.negative;out.length=x.length+y.length;return out.strip()};BN.prototype.mul=function mul(num){var out=new BN(null);out.words=new Array(this.length+num.length);return this.mulTo(num,out)};BN.prototype.mulf=function mulf(num){var out=new BN(null);out.words=new Array(this.length+num.length);return jumboMulTo(this,num,out)};BN.prototype.imul=function imul(num){return this.clone().mulTo(num,this)};BN.prototype.imuln=function imuln(num){assert(typeof num==="number");assert(num<67108864);var carry=0;for(var i=0;i<this.length;i++){var w=(this.words[i]|0)*num;var lo=(w&67108863)+(carry&67108863);carry>>=26;carry+=w/67108864|0;carry+=lo>>>26;this.words[i]=lo&67108863}if(carry!==0){this.words[i]=carry;this.length++}return this};BN.prototype.muln=function muln(num){return this.clone().imuln(num)};BN.prototype.sqr=function sqr(){return this.mul(this)};BN.prototype.isqr=function isqr(){return this.imul(this.clone())};BN.prototype.pow=function pow(num){var w=toBitArray(num);if(w.length===0)return new BN(1);var res=this;for(var i=0;i<w.length;i++,res=res.sqr()){if(w[i]!==0)break}if(++i<w.length){for(var q=res.sqr();i<w.length;i++,q=q.sqr()){if(w[i]===0)continue;res=res.mul(q)}}return res};BN.prototype.iushln=function iushln(bits){assert(typeof bits==="number"&&bits>=0);var r=bits%26;var s=(bits-r)/26;var carryMask=67108863>>>26-r<<26-r;var i;if(r!==0){var carry=0;for(i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask;var c=(this.words[i]|0)-newCarry<<r;this.words[i]=c|carry;carry=newCarry>>>26-r}if(carry){this.words[i]=carry;this.length++}}if(s!==0){for(i=this.length-1;i>=0;i--){this.words[i+s]=this.words[i]}for(i=0;i<s;i++){this.words[i]=0}this.length+=s}return this.strip()};BN.prototype.ishln=function ishln(bits){assert(this.negative===0);return this.iushln(bits)};BN.prototype.iushrn=function iushrn(bits,hint,extended){assert(typeof bits==="number"&&bits>=0);var h;if(hint){h=(hint-hint%26)/26}else{h=0}var r=bits%26;var s=Math.min((bits-r)/26,this.length);var mask=67108863^67108863>>>r<<r;var maskedWords=extended;h-=s;h=Math.max(0,h);if(maskedWords){for(var i=0;i<s;i++){maskedWords.words[i]=this.words[i]}maskedWords.length=s}if(s===0){}else if(this.length>s){this.length-=s;for(i=0;i<this.length;i++){this.words[i]=this.words[i+s]}}else{this.words[0]=0;this.length=1}var carry=0;for(i=this.length-1;i>=0&&(carry!==0||i>=h);i--){var word=this.words[i]|0;this.words[i]=carry<<26-r|word>>>r;carry=word&mask}if(maskedWords&&carry!==0){maskedWords.words[maskedWords.length++]=carry}if(this.length===0){this.words[0]=0;this.length=1}return this.strip()};BN.prototype.ishrn=function ishrn(bits,hint,extended){assert(this.negative===0);return this.iushrn(bits,hint,extended)};BN.prototype.shln=function shln(bits){return this.clone().ishln(bits)};BN.prototype.ushln=function ushln(bits){return this.clone().iushln(bits)};BN.prototype.shrn=function shrn(bits){return this.clone().ishrn(bits)};BN.prototype.ushrn=function ushrn(bits){return this.clone().iushrn(bits)};BN.prototype.testn=function testn(bit){assert(typeof bit==="number"&&bit>=0);var r=bit%26;var s=(bit-r)/26;var q=1<<r;if(this.length<=s)return false;var w=this.words[s];return!!(w&q)};BN.prototype.imaskn=function imaskn(bits){assert(typeof bits==="number"&&bits>=0);var r=bits%26;var s=(bits-r)/26;assert(this.negative===0,"imaskn works only with positive numbers");if(this.length<=s){return this}if(r!==0){s++}this.length=Math.min(s,this.length);if(r!==0){var mask=67108863^67108863>>>r<<r;this.words[this.length-1]&=mask}return this.strip()};BN.prototype.maskn=function maskn(bits){return this.clone().imaskn(bits)};BN.prototype.iaddn=function iaddn(num){assert(typeof num==="number");assert(num<67108864);if(num<0)return this.isubn(-num);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<num){this.words[0]=num-(this.words[0]|0);this.negative=0;return this}this.negative=0;this.isubn(num);this.negative=1;return this}return this._iaddn(num)};BN.prototype._iaddn=function _iaddn(num){this.words[0]+=num;for(var i=0;i<this.length&&this.words[i]>=67108864;i++){this.words[i]-=67108864;if(i===this.length-1){this.words[i+1]=1}else{this.words[i+1]++}}this.length=Math.max(this.length,i+1);return this};BN.prototype.isubn=function isubn(num){assert(typeof num==="number");assert(num<67108864);if(num<0)return this.iaddn(-num);if(this.negative!==0){this.negative=0;this.iaddn(num);this.negative=1;return this}this.words[0]-=num;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var i=0;i<this.length&&this.words[i]<0;i++){this.words[i]+=67108864;this.words[i+1]-=1}}return this.strip()};BN.prototype.addn=function addn(num){return this.clone().iaddn(num)};BN.prototype.subn=function subn(num){return this.clone().isubn(num)};BN.prototype.iabs=function iabs(){this.negative=0;return this};BN.prototype.abs=function abs(){return this.clone().iabs()};BN.prototype._ishlnsubmul=function _ishlnsubmul(num,mul,shift){var len=num.length+shift;var i;this._expand(len);var w;var carry=0;for(i=0;i<num.length;i++){w=(this.words[i+shift]|0)+carry;var right=(num.words[i]|0)*mul;w-=right&67108863;carry=(w>>26)-(right/67108864|0);this.words[i+shift]=w&67108863}for(;i<this.length-shift;i++){w=(this.words[i+shift]|0)+carry;carry=w>>26;this.words[i+shift]=w&67108863}if(carry===0)return this.strip();assert(carry===-1);carry=0;for(i=0;i<this.length;i++){w=-(this.words[i]|0)+carry;carry=w>>26;this.words[i]=w&67108863}this.negative=1;return this.strip()};BN.prototype._wordDiv=function _wordDiv(num,mode){var shift=this.length-num.length;var a=this.clone();var b=num;var bhi=b.words[b.length-1]|0;var bhiBits=this._countBits(bhi);shift=26-bhiBits;if(shift!==0){b=b.ushln(shift);a.iushln(shift);bhi=b.words[b.length-1]|0}var m=a.length-b.length;var q;if(mode!=="mod"){q=new BN(null);q.length=m+1;q.words=new Array(q.length);for(var i=0;i<q.length;i++){q.words[i]=0}}var diff=a.clone()._ishlnsubmul(b,1,m);if(diff.negative===0){a=diff;if(q){q.words[m]=1}}for(var j=m-1;j>=0;j--){var qj=(a.words[b.length+j]|0)*67108864+(a.words[b.length+j-1]|0);qj=Math.min(qj/bhi|0,67108863);a._ishlnsubmul(b,qj,j);while(a.negative!==0){qj--;a.negative=0;a._ishlnsubmul(b,1,j);if(!a.isZero()){a.negative^=1}}if(q){q.words[j]=qj}}if(q){q.strip()}a.strip();if(mode!=="div"&&shift!==0){a.iushrn(shift)}return{div:q||null,mod:a}};BN.prototype.divmod=function divmod(num,mode,positive){assert(!num.isZero());if(this.isZero()){return{div:new BN(0),mod:new BN(0)}}var div,mod,res;if(this.negative!==0&&num.negative===0){res=this.neg().divmod(num,mode);if(mode!=="mod"){div=res.div.neg()}if(mode!=="div"){mod=res.mod.neg();if(positive&&mod.negative!==0){mod.iadd(num)}}return{div:div,mod:mod}}if(this.negative===0&&num.negative!==0){res=this.divmod(num.neg(),mode);if(mode!=="mod"){div=res.div.neg()}return{div:div,mod:res.mod}}if((this.negative&num.negative)!==0){res=this.neg().divmod(num.neg(),mode);if(mode!=="div"){mod=res.mod.neg();if(positive&&mod.negative!==0){mod.isub(num)}}return{div:res.div,mod:mod}}if(num.length>this.length||this.cmp(num)<0){return{div:new BN(0),mod:this}}if(num.length===1){if(mode==="div"){return{div:this.divn(num.words[0]),mod:null}}if(mode==="mod"){return{div:null,mod:new BN(this.modn(num.words[0]))}}return{div:this.divn(num.words[0]),mod:new BN(this.modn(num.words[0]))}}return this._wordDiv(num,mode)};BN.prototype.div=function div(num){return this.divmod(num,"div",false).div};BN.prototype.mod=function mod(num){return this.divmod(num,"mod",false).mod};BN.prototype.umod=function umod(num){return this.divmod(num,"mod",true).mod};BN.prototype.divRound=function divRound(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=dm.div.negative!==0?dm.mod.isub(num):dm.mod;var half=num.ushrn(1);var r2=num.andln(1);var cmp=mod.cmp(half);if(cmp<0||r2===1&&cmp===0)return dm.div;return dm.div.negative!==0?dm.div.isubn(1):dm.div.iaddn(1)};BN.prototype.modn=function modn(num){assert(num<=67108863);var p=(1<<26)%num;var acc=0;for(var i=this.length-1;i>=0;i--){acc=(p*acc+(this.words[i]|0))%num}return acc};BN.prototype.idivn=function idivn(num){assert(num<=67108863);var carry=0;for(var i=this.length-1;i>=0;i--){var w=(this.words[i]|0)+carry*67108864;this.words[i]=w/num|0;carry=w%num}return this.strip()};BN.prototype.divn=function divn(num){return this.clone().idivn(num)};BN.prototype.egcd=function egcd(p){assert(p.negative===0);assert(!p.isZero());var x=this;var y=p.clone();if(x.negative!==0){x=x.umod(p)}else{x=x.clone()}var A=new BN(1);var B=new BN(0);var C=new BN(0);var D=new BN(1);var g=0;while(x.isEven()&&y.isEven()){x.iushrn(1);y.iushrn(1);++g}var yp=y.clone();var xp=x.clone();while(!x.isZero()){for(var i=0,im=1;(x.words[0]&im)===0&&i<26;++i,im<<=1);if(i>0){x.iushrn(i);while(i-- >0){if(A.isOdd()||B.isOdd()){A.iadd(yp);B.isub(xp)}A.iushrn(1);B.iushrn(1)}}for(var j=0,jm=1;(y.words[0]&jm)===0&&j<26;++j,jm<<=1);if(j>0){y.iushrn(j);while(j-- >0){if(C.isOdd()||D.isOdd()){C.iadd(yp);D.isub(xp)}C.iushrn(1);D.iushrn(1)}}if(x.cmp(y)>=0){x.isub(y);A.isub(C);B.isub(D)}else{y.isub(x);C.isub(A);D.isub(B)}}return{a:C,b:D,gcd:y.iushln(g)}};BN.prototype._invmp=function _invmp(p){assert(p.negative===0);assert(!p.isZero());var a=this;var b=p.clone();if(a.negative!==0){a=a.umod(p)}else{a=a.clone()}var x1=new BN(1);var x2=new BN(0);var delta=b.clone();while(a.cmpn(1)>0&&b.cmpn(1)>0){for(var i=0,im=1;(a.words[0]&im)===0&&i<26;++i,im<<=1);if(i>0){a.iushrn(i);while(i-- >0){if(x1.isOdd()){x1.iadd(delta)}x1.iushrn(1)}}for(var j=0,jm=1;(b.words[0]&jm)===0&&j<26;++j,jm<<=1);if(j>0){b.iushrn(j);while(j-- >0){if(x2.isOdd()){x2.iadd(delta)}x2.iushrn(1)}}if(a.cmp(b)>=0){a.isub(b);x1.isub(x2)}else{b.isub(a);x2.isub(x1)}}var res;if(a.cmpn(1)===0){res=x1}else{res=x2}if(res.cmpn(0)<0){res.iadd(p)}return res};BN.prototype.gcd=function gcd(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone();var b=num.clone();a.negative=0;b.negative=0;for(var shift=0;a.isEven()&&b.isEven();shift++){a.iushrn(1);b.iushrn(1)}do{while(a.isEven()){a.iushrn(1)}while(b.isEven()){b.iushrn(1)}var r=a.cmp(b);if(r<0){var t=a;a=b;b=t}else if(r===0||b.cmpn(1)===0){break}a.isub(b)}while(true);return b.iushln(shift)};BN.prototype.invm=function invm(num){return this.egcd(num).a.umod(num)};BN.prototype.isEven=function isEven(){return(this.words[0]&1)===0};BN.prototype.isOdd=function isOdd(){return(this.words[0]&1)===1};BN.prototype.andln=function andln(num){return this.words[0]&num};BN.prototype.bincn=function bincn(bit){assert(typeof bit==="number");var r=bit%26;var s=(bit-r)/26;var q=1<<r;if(this.length<=s){this._expand(s+1);this.words[s]|=q;return this}var carry=q;for(var i=s;carry!==0&&i<this.length;i++){var w=this.words[i]|0;w+=carry;carry=w>>>26;w&=67108863;this.words[i]=w}if(carry!==0){this.words[i]=carry;this.length++}return this};BN.prototype.isZero=function isZero(){return this.length===1&&this.words[0]===0};BN.prototype.cmpn=function cmpn(num){var negative=num<0;if(this.negative!==0&&!negative)return-1;if(this.negative===0&&negative)return 1;this.strip();var res;if(this.length>1){res=1}else{if(negative){num=-num}assert(num<=67108863,"Number is too big");var w=this.words[0]|0;res=w===num?0:w<num?-1:1}if(this.negative!==0)return-res|0;return res};BN.prototype.cmp=function cmp(num){if(this.negative!==0&&num.negative===0)return-1;if(this.negative===0&&num.negative!==0)return 1;var res=this.ucmp(num);if(this.negative!==0)return-res|0;return res};BN.prototype.ucmp=function ucmp(num){if(this.length>num.length)return 1;if(this.length<num.length)return-1;var res=0;for(var i=this.length-1;i>=0;i--){var a=this.words[i]|0;var b=num.words[i]|0;if(a===b)continue;if(a<b){res=-1}else if(a>b){res=1}break}return res};BN.prototype.gtn=function gtn(num){return this.cmpn(num)===1};BN.prototype.gt=function gt(num){return this.cmp(num)===1};BN.prototype.gten=function gten(num){return this.cmpn(num)>=0};BN.prototype.gte=function gte(num){return this.cmp(num)>=0};BN.prototype.ltn=function ltn(num){return this.cmpn(num)===-1};BN.prototype.lt=function lt(num){return this.cmp(num)===-1};BN.prototype.lten=function lten(num){return this.cmpn(num)<=0};BN.prototype.lte=function lte(num){return this.cmp(num)<=0};BN.prototype.eqn=function eqn(num){return this.cmpn(num)===0};BN.prototype.eq=function eq(num){return this.cmp(num)===0};BN.red=function red(num){return new Red(num)};BN.prototype.toRed=function toRed(ctx){assert(!this.red,"Already a number in reduction context");assert(this.negative===0,"red works only with positives");return ctx.convertTo(this)._forceRed(ctx)};BN.prototype.fromRed=function fromRed(){assert(this.red,"fromRed works only with numbers in reduction context");return this.red.convertFrom(this)};BN.prototype._forceRed=function _forceRed(ctx){this.red=ctx;return this};BN.prototype.forceRed=function forceRed(ctx){assert(!this.red,"Already a number in reduction context");return this._forceRed(ctx)};BN.prototype.redAdd=function redAdd(num){assert(this.red,"redAdd works only with red numbers");return this.red.add(this,num)};BN.prototype.redIAdd=function redIAdd(num){assert(this.red,"redIAdd works only with red numbers");return this.red.iadd(this,num)};BN.prototype.redSub=function redSub(num){assert(this.red,"redSub works only with red numbers");return this.red.sub(this,num)};BN.prototype.redISub=function redISub(num){assert(this.red,"redISub works only with red numbers");return this.red.isub(this,num)};BN.prototype.redShl=function redShl(num){assert(this.red,"redShl works only with red numbers");return this.red.shl(this,num)};BN.prototype.redMul=function redMul(num){assert(this.red,"redMul works only with red numbers");this.red._verify2(this,num);return this.red.mul(this,num)};BN.prototype.redIMul=function redIMul(num){assert(this.red,"redMul works only with red numbers");this.red._verify2(this,num);return this.red.imul(this,num)};BN.prototype.redSqr=function redSqr(){assert(this.red,"redSqr works only with red numbers");this.red._verify1(this);return this.red.sqr(this)};BN.prototype.redISqr=function redISqr(){assert(this.red,"redISqr works only with red numbers");this.red._verify1(this);return this.red.isqr(this)};BN.prototype.redSqrt=function redSqrt(){assert(this.red,"redSqrt works only with red numbers");this.red._verify1(this);return this.red.sqrt(this)};BN.prototype.redInvm=function redInvm(){assert(this.red,"redInvm works only with red numbers");this.red._verify1(this);return this.red.invm(this)};BN.prototype.redNeg=function redNeg(){assert(this.red,"redNeg works only with red numbers");this.red._verify1(this);return this.red.neg(this)};BN.prototype.redPow=function redPow(num){assert(this.red&&!num.red,"redPow(normalNum)");this.red._verify1(this);return this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};function MPrime(name,p){this.name=name;this.p=new BN(p,16);this.n=this.p.bitLength();this.k=new BN(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}MPrime.prototype._tmp=function _tmp(){var tmp=new BN(null);tmp.words=new Array(Math.ceil(this.n/13));return tmp};MPrime.prototype.ireduce=function ireduce(num){var r=num;var rlen;do{this.split(r,this.tmp);r=this.imulK(r);r=r.iadd(this.tmp);rlen=r.bitLength()}while(rlen>this.n);var cmp=rlen<this.n?-1:r.ucmp(this.p);if(cmp===0){r.words[0]=0;r.length=1}else if(cmp>0){r.isub(this.p)}else{if(r.strip!==undefined){r.strip()}else{r._strip()}}return r};MPrime.prototype.split=function split(input,out){input.iushrn(this.n,0,out)};MPrime.prototype.imulK=function imulK(num){return num.imul(this.k)};function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}inherits(K256,MPrime);K256.prototype.split=function split(input,output){var mask=4194303;var outLen=Math.min(input.length,9);for(var i=0;i<outLen;i++){output.words[i]=input.words[i]}output.length=outLen;if(input.length<=9){input.words[0]=0;input.length=1;return}var prev=input.words[9];output.words[output.length++]=prev&mask;for(i=10;i<input.length;i++){var next=input.words[i]|0;input.words[i-10]=(next&mask)<<4|prev>>>22;prev=next}prev>>>=22;input.words[i-10]=prev;if(prev===0&&input.length>10){input.length-=10}else{input.length-=9}};K256.prototype.imulK=function imulK(num){num.words[num.length]=0;num.words[num.length+1]=0;num.length+=2;var lo=0;for(var i=0;i<num.length;i++){var w=num.words[i]|0;lo+=w*977;num.words[i]=lo&67108863;lo=w*64+(lo/67108864|0)}if(num.words[num.length-1]===0){num.length--;if(num.words[num.length-1]===0){num.length--}}return num};function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}inherits(P224,MPrime);function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}inherits(P192,MPrime);function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}inherits(P25519,MPrime);P25519.prototype.imulK=function imulK(num){var carry=0;for(var i=0;i<num.length;i++){var hi=(num.words[i]|0)*19+carry;var lo=hi&67108863;hi>>>=26;num.words[i]=lo;carry=hi}if(carry!==0){num.words[num.length++]=carry}return num};BN._prime=function prime(name){if(primes[name])return primes[name];var prime;if(name==="k256"){prime=new K256}else if(name==="p224"){prime=new P224}else if(name==="p192"){prime=new P192}else if(name==="p25519"){prime=new P25519}else{throw new Error("Unknown prime "+name)}primes[name]=prime;return prime};function Red(m){if(typeof m==="string"){var prime=BN._prime(m);this.m=prime.p;this.prime=prime}else{assert(m.gtn(1),"modulus must be greater than 1");this.m=m;this.prime=null}}Red.prototype._verify1=function _verify1(a){assert(a.negative===0,"red works only with positives");assert(a.red,"red works only with red numbers")};Red.prototype._verify2=function _verify2(a,b){assert((a.negative|b.negative)===0,"red works only with positives");assert(a.red&&a.red===b.red,"red works only with red numbers")};Red.prototype.imod=function imod(a){if(this.prime)return this.prime.ireduce(a)._forceRed(this);return a.umod(this.m)._forceRed(this)};Red.prototype.neg=function neg(a){if(a.isZero()){return a.clone()}return this.m.sub(a)._forceRed(this)};Red.prototype.add=function add(a,b){this._verify2(a,b);var res=a.add(b);if(res.cmp(this.m)>=0){res.isub(this.m)}return res._forceRed(this)};Red.prototype.iadd=function iadd(a,b){this._verify2(a,b);var res=a.iadd(b);if(res.cmp(this.m)>=0){res.isub(this.m)}return res};Red.prototype.sub=function sub(a,b){this._verify2(a,b);var res=a.sub(b);if(res.cmpn(0)<0){res.iadd(this.m)}return res._forceRed(this)};Red.prototype.isub=function isub(a,b){this._verify2(a,b);var res=a.isub(b);if(res.cmpn(0)<0){res.iadd(this.m)}return res};Red.prototype.shl=function shl(a,num){this._verify1(a);return this.imod(a.ushln(num))};Red.prototype.imul=function imul(a,b){this._verify2(a,b);return this.imod(a.imul(b))};Red.prototype.mul=function mul(a,b){this._verify2(a,b);return this.imod(a.mul(b))};Red.prototype.isqr=function isqr(a){return this.imul(a,a.clone())};Red.prototype.sqr=function sqr(a){return this.mul(a,a)};Red.prototype.sqrt=function sqrt(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);assert(mod3%2===1);if(mod3===3){var pow=this.m.add(new BN(1)).iushrn(2);return this.pow(a,pow)}var q=this.m.subn(1);var s=0;while(!q.isZero()&&q.andln(1)===0){s++;q.iushrn(1)}assert(!q.isZero());var one=new BN(1).toRed(this);var nOne=one.redNeg();var lpow=this.m.subn(1).iushrn(1);var z=this.m.bitLength();z=new BN(2*z*z).toRed(this);while(this.pow(z,lpow).cmp(nOne)!==0){z.redIAdd(nOne)}var c=this.pow(z,q);var r=this.pow(a,q.addn(1).iushrn(1));var t=this.pow(a,q);var m=s;while(t.cmp(one)!==0){var tmp=t;for(var i=0;tmp.cmp(one)!==0;i++){tmp=tmp.redSqr()}assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1));r=r.redMul(b);c=b.redSqr();t=t.redMul(c);m=i}return r};Red.prototype.invm=function invm(a){var inv=a._invmp(this.m);if(inv.negative!==0){inv.negative=0;return this.imod(inv).redNeg()}else{return this.imod(inv)}};Red.prototype.pow=function pow(a,num){if(num.isZero())return new BN(1).toRed(this);if(num.cmpn(1)===0)return a.clone();var windowSize=4;var wnd=new Array(1<<windowSize);wnd[0]=new BN(1).toRed(this);wnd[1]=a;for(var i=2;i<wnd.length;i++){wnd[i]=this.mul(wnd[i-1],a)}var res=wnd[0];var current=0;var currentLen=0;var start=num.bitLength()%26;if(start===0){start=26}for(i=num.length-1;i>=0;i--){var word=num.words[i];for(var j=start-1;j>=0;j--){var bit=word>>j&1;if(res!==wnd[0]){res=this.sqr(res)}if(bit===0&&current===0){currentLen=0;continue}current<<=1;current|=bit;currentLen++;if(currentLen!==windowSize&&(i!==0||j!==0))continue;res=this.mul(res,wnd[current]);currentLen=0;current=0}start=26}return res};Red.prototype.convertTo=function convertTo(num){var r=num.umod(this.m);return r===num?r.clone():r};Red.prototype.convertFrom=function convertFrom(num){var res=num.clone();res.red=null;return res};BN.mont=function mont(num){return new Mont(num)};function Mont(m){Red.call(this,m);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-this.shift%26}this.r=new BN(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}inherits(Mont,Red);Mont.prototype.convertTo=function convertTo(num){return this.imod(num.ushln(this.shift))};Mont.prototype.convertFrom=function convertFrom(num){var r=this.imod(num.mul(this.rinv));r.red=null;return r};Mont.prototype.imul=function imul(a,b){if(a.isZero()||b.isZero()){a.words[0]=0;a.length=1;return a}var t=a.imul(b);var c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var u=t.isub(c).iushrn(this.shift);var res=u;if(u.cmp(this.m)>=0){res=u.isub(this.m)}else if(u.cmpn(0)<0){res=u.iadd(this.m)}return res._forceRed(this)};Mont.prototype.mul=function mul(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);var t=a.mul(b);var c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var u=t.isub(c).iushrn(this.shift);var res=u;if(u.cmp(this.m)>=0){res=u.isub(this.m)}else if(u.cmpn(0)<0){res=u.iadd(this.m)}return res._forceRed(this)};Mont.prototype.invm=function invm(a){var res=this.imod(a._invmp(this.m).mul(this.r2));return res._forceRed(this)}})(typeof module==="undefined"||module,this)},{buffer:88}],35:[function(require,module,exports){(function(global){(function(){"use strict";var objectAssign=require("object.assign/polyfill")();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function compare(a,b){if(a===b){return 0}var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y){return-1}if(y<x){return 1}return 0}function isBuffer(b){if(global.Buffer&&typeof global.Buffer.isBuffer==="function"){return global.Buffer.isBuffer(b)}return!!(b!=null&&b._isBuffer)}var util=require("util/");var hasOwn=Object.prototype.hasOwnProperty;var pSlice=Array.prototype.slice;var functionsHaveNames=function(){return function foo(){}.name==="foo"}();function pToString(obj){return Object.prototype.toString.call(obj)}function isView(arrbuf){if(isBuffer(arrbuf)){return false}if(typeof global.ArrayBuffer!=="function"){return false}if(typeof ArrayBuffer.isView==="function"){return ArrayBuffer.isView(arrbuf)}if(!arrbuf){return false}if(arrbuf instanceof DataView){return true}if(arrbuf.buffer&&arrbuf.buffer instanceof ArrayBuffer){return true}return false}var assert=module.exports=ok;var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(func){if(!util.isFunction(func)){return}if(functionsHaveNames){return func.name}var str=func.toString();var match=str.match(regex);return match&&match[1]}assert.AssertionError=function AssertionError(options){this.name="AssertionError";this.actual=options.actual;this.expected=options.expected;this.operator=options.operator;if(options.message){this.message=options.message;this.generatedMessage=false}else{this.message=getMessage(this);this.generatedMessage=true}var stackStartFunction=options.stackStartFunction||fail;if(Error.captureStackTrace){Error.captureStackTrace(this,stackStartFunction)}else{var err=new Error;if(err.stack){var out=err.stack;var fn_name=getName(stackStartFunction);var idx=out.indexOf("\n"+fn_name);if(idx>=0){var next_line=out.indexOf("\n",idx+1);out=out.substring(next_line+1)}this.stack=out}}};util.inherits(assert.AssertionError,Error);function truncate(s,n){if(typeof s==="string"){return s.length<n?s:s.slice(0,n)}else{return s}}function inspect(something){if(functionsHaveNames||!util.isFunction(something)){return util.inspect(something)}var rawname=getName(something);var name=rawname?": "+rawname:"";return"[Function"+name+"]"}function getMessage(self){return truncate(inspect(self.actual),128)+" "+self.operator+" "+truncate(inspect(self.expected),128)}function fail(actual,expected,message,operator,stackStartFunction){throw new assert.AssertionError({message:message,actual:actual,expected:expected,operator:operator,stackStartFunction:stackStartFunction})}assert.fail=fail;function ok(value,message){if(!value)fail(value,true,message,"==",assert.ok)}assert.ok=ok;assert.equal=function equal(actual,expected,message){if(actual!=expected)fail(actual,expected,message,"==",assert.equal)};assert.notEqual=function notEqual(actual,expected,message){if(actual==expected){fail(actual,expected,message,"!=",assert.notEqual)}};assert.deepEqual=function deepEqual(actual,expected,message){if(!_deepEqual(actual,expected,false)){fail(actual,expected,message,"deepEqual",assert.deepEqual)}};assert.deepStrictEqual=function deepStrictEqual(actual,expected,message){if(!_deepEqual(actual,expected,true)){fail(actual,expected,message,"deepStrictEqual",assert.deepStrictEqual)}};function _deepEqual(actual,expected,strict,memos){if(actual===expected){return true}else if(isBuffer(actual)&&isBuffer(expected)){return compare(actual,expected)===0}else if(util.isDate(actual)&&util.isDate(expected)){return actual.getTime()===expected.getTime()}else if(util.isRegExp(actual)&&util.isRegExp(expected)){return actual.source===expected.source&&actual.global===expected.global&&actual.multiline===expected.multiline&&actual.lastIndex===expected.lastIndex&&actual.ignoreCase===expected.ignoreCase}else if((actual===null||typeof actual!=="object")&&(expected===null||typeof expected!=="object")){return strict?actual===expected:actual==expected}else if(isView(actual)&&isView(expected)&&pToString(actual)===pToString(expected)&&!(actual instanceof Float32Array||actual instanceof Float64Array)){return compare(new Uint8Array(actual.buffer),new Uint8Array(expected.buffer))===0}else if(isBuffer(actual)!==isBuffer(expected)){return false}else{memos=memos||{actual:[],expected:[]};var actualIndex=memos.actual.indexOf(actual);if(actualIndex!==-1){if(actualIndex===memos.expected.indexOf(expected)){return true}}memos.actual.push(actual);memos.expected.push(expected);return objEquiv(actual,expected,strict,memos)}}function isArguments(object){return Object.prototype.toString.call(object)=="[object Arguments]"}function objEquiv(a,b,strict,actualVisitedObjects){if(a===null||a===undefined||b===null||b===undefined)return false;if(util.isPrimitive(a)||util.isPrimitive(b))return a===b;if(strict&&Object.getPrototypeOf(a)!==Object.getPrototypeOf(b))return false;var aIsArgs=isArguments(a);var bIsArgs=isArguments(b);if(aIsArgs&&!bIsArgs||!aIsArgs&&bIsArgs)return false;if(aIsArgs){a=pSlice.call(a);b=pSlice.call(b);return _deepEqual(a,b,strict)}var ka=objectKeys(a);var kb=objectKeys(b);var key,i;if(ka.length!==kb.length)return false;ka.sort();kb.sort();for(i=ka.length-1;i>=0;i--){if(ka[i]!==kb[i])return false}for(i=ka.length-1;i>=0;i--){key=ka[i];if(!_deepEqual(a[key],b[key],strict,actualVisitedObjects))return false}return true}assert.notDeepEqual=function notDeepEqual(actual,expected,message){if(_deepEqual(actual,expected,false)){fail(actual,expected,message,"notDeepEqual",assert.notDeepEqual)}};assert.notDeepStrictEqual=notDeepStrictEqual;function notDeepStrictEqual(actual,expected,message){if(_deepEqual(actual,expected,true)){fail(actual,expected,message,"notDeepStrictEqual",notDeepStrictEqual)}}assert.strictEqual=function strictEqual(actual,expected,message){if(actual!==expected){fail(actual,expected,message,"===",assert.strictEqual)}};assert.notStrictEqual=function notStrictEqual(actual,expected,message){if(actual===expected){fail(actual,expected,message,"!==",assert.notStrictEqual)}};function expectedException(actual,expected){if(!actual||!expected){return false}if(Object.prototype.toString.call(expected)=="[object RegExp]"){return expected.test(actual)}try{if(actual instanceof expected){return true}}catch(e){}if(Error.isPrototypeOf(expected)){return false}return expected.call({},actual)===true}function _tryBlock(block){var error;try{block()}catch(e){error=e}return error}function _throws(shouldThrow,block,expected,message){var actual;if(typeof block!=="function"){throw new TypeError('"block" argument must be a function')}if(typeof expected==="string"){message=expected;expected=null}actual=_tryBlock(block);message=(expected&&expected.name?" ("+expected.name+").":".")+(message?" "+message:".");if(shouldThrow&&!actual){fail(actual,expected,"Missing expected exception"+message)}var userProvidedMessage=typeof message==="string";var isUnwantedException=!shouldThrow&&util.isError(actual);var isUnexpectedException=!shouldThrow&&actual&&!expected;if(isUnwantedException&&userProvidedMessage&&expectedException(actual,expected)||isUnexpectedException){fail(actual,expected,"Got unwanted exception"+message)}if(shouldThrow&&actual&&expected&&!expectedException(actual,expected)||!shouldThrow&&actual){throw actual}}assert.throws=function(block,error,message){_throws(true,block,error,message)};assert.doesNotThrow=function(block,error,message){_throws(false,block,error,message)};assert.ifError=function(err){if(err)throw err};function strict(value,message){if(!value)fail(value,true,message,"==",strict)}assert.strict=objectAssign(strict,assert,{equal:assert.strictEqual,deepEqual:assert.deepStrictEqual,notEqual:assert.notStrictEqual,notDeepEqual:assert.notDeepStrictEqual});assert.strict.strict=assert.strict;var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj){if(hasOwn.call(obj,key))keys.push(key)}return keys}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"object.assign/polyfill":335,"util/":38}],36:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}else{module.exports=function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}},{}],37:[function(require,module,exports){module.exports=function isBuffer(arg){return arg&&typeof arg==="object"&&typeof arg.copy==="function"&&typeof arg.fill==="function"&&typeof arg.readUInt8==="function"}},{}],38:[function(require,module,exports){(function(process,global){(function(){var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,(function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}));for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};exports.deprecate=function(fn,msg){if(isUndefined(global.process)){return function(){return exports.deprecate(fn,msg).apply(this,arguments)}}if(process.noDeprecation===true){return fn}var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg)}else if(process.traceDeprecation){console.trace(msg)}else{console.error(msg)}warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnviron;exports.debuglog=function(set){if(isUndefined(debugEnviron))debugEnviron=process.env.NODE_DEBUG||"";set=set.toUpperCase();if(!debugs[set]){if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else{debugs[set]=function(){}}}return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach((function(val,idx){hash[val]=true}));return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value)}if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0)){return formatError(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}))}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}keys.forEach((function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}}));return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map((function(line){return"  "+line})).join("\n").substr(2)}else{str="\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.substr(1,name.length-2);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce((function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=require("./support/isBuffer");function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=require("inherits");exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./support/isBuffer":37,_process:88,inherits:36}],39:[function(require,module,exports){(function(global){(function(){"use strict";var possibleNames=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];var g=typeof globalThis==="undefined"?global:globalThis;module.exports=function availableTypedArrays(){var out=[];for(var i=0;i<possibleNames.length;i++){if(typeof g[possibleNames[i]]==="function"){out[out.length]=possibleNames[i]}}return out}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],40:[function(require,module,exports){(function(module,exports){"use strict";function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}function BN(number,base,endian){if(BN.isBN(number)){return number}this.negative=0;this.words=null;this.length=0;this.red=null;if(number!==null){if(base==="le"||base==="be"){endian=base;base=10}this._init(number||0,base||10,endian||"be")}}if(typeof module==="object"){module.exports=BN}else{exports.BN=BN}BN.BN=BN;BN.wordSize=26;var Buffer;try{if(typeof window!=="undefined"&&typeof window.Buffer!=="undefined"){Buffer=window.Buffer}else{Buffer=require("buffer").Buffer}}catch(e){}BN.isBN=function isBN(num){if(num instanceof BN){return true}return num!==null&&typeof num==="object"&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)};BN.max=function max(left,right){if(left.cmp(right)>0)return left;return right};BN.min=function min(left,right){if(left.cmp(right)<0)return left;return right};BN.prototype._init=function init(number,base,endian){if(typeof number==="number"){return this._initNumber(number,base,endian)}if(typeof number==="object"){return this._initArray(number,base,endian)}if(base==="hex"){base=16}assert(base===(base|0)&&base>=2&&base<=36);number=number.toString().replace(/\s+/g,"");var start=0;if(number[0]==="-"){start++;this.negative=1}if(start<number.length){if(base===16){this._parseHex(number,start,endian)}else{this._parseBase(number,base,start);if(endian==="le"){this._initArray(this.toArray(),base,endian)}}}};BN.prototype._initNumber=function _initNumber(number,base,endian){if(number<0){this.negative=1;number=-number}if(number<67108864){this.words=[number&67108863];this.length=1}else if(number<4503599627370496){this.words=[number&67108863,number/67108864&67108863];this.length=2}else{assert(number<9007199254740992);this.words=[number&67108863,number/67108864&67108863,1];this.length=3}if(endian!=="le")return;this._initArray(this.toArray(),base,endian)};BN.prototype._initArray=function _initArray(number,base,endian){assert(typeof number.length==="number");if(number.length<=0){this.words=[0];this.length=1;return this}this.length=Math.ceil(number.length/3);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}var j,w;var off=0;if(endian==="be"){for(i=number.length-1,j=0;i>=0;i-=3){w=number[i]|number[i-1]<<8|number[i-2]<<16;this.words[j]|=w<<off&67108863;this.words[j+1]=w>>>26-off&67108863;off+=24;if(off>=26){off-=26;j++}}}else if(endian==="le"){for(i=0,j=0;i<number.length;i+=3){w=number[i]|number[i+1]<<8|number[i+2]<<16;this.words[j]|=w<<off&67108863;this.words[j+1]=w>>>26-off&67108863;off+=24;if(off>=26){off-=26;j++}}}return this._strip()};function parseHex4Bits(string,index){var c=string.charCodeAt(index);if(c>=48&&c<=57){return c-48}else if(c>=65&&c<=70){return c-55}else if(c>=97&&c<=102){return c-87}else{assert(false,"Invalid character in "+string)}}function parseHexByte(string,lowerBound,index){var r=parseHex4Bits(string,index);if(index-1>=lowerBound){r|=parseHex4Bits(string,index-1)<<4}return r}BN.prototype._parseHex=function _parseHex(number,start,endian){this.length=Math.ceil((number.length-start)/6);this.words=new Array(this.length);for(var i=0;i<this.length;i++){this.words[i]=0}var off=0;var j=0;var w;if(endian==="be"){for(i=number.length-1;i>=start;i-=2){w=parseHexByte(number,start,i)<<off;this.words[j]|=w&67108863;if(off>=18){off-=18;j+=1;this.words[j]|=w>>>26}else{off+=8}}}else{var parseLength=number.length-start;for(i=parseLength%2===0?start+1:start;i<number.length;i+=2){w=parseHexByte(number,start,i)<<off;this.words[j]|=w&67108863;if(off>=18){off-=18;j+=1;this.words[j]|=w>>>26}else{off+=8}}}this._strip()};function parseBase(str,start,end,mul){var r=0;var b=0;var len=Math.min(str.length,end);for(var i=start;i<len;i++){var c=str.charCodeAt(i)-48;r*=mul;if(c>=49){b=c-49+10}else if(c>=17){b=c-17+10}else{b=c}assert(c>=0&&b<mul,"Invalid character");r+=b}return r}BN.prototype._parseBase=function _parseBase(number,base,start){this.words=[0];this.length=1;for(var limbLen=0,limbPow=1;limbPow<=67108863;limbPow*=base){limbLen++}limbLen--;limbPow=limbPow/base|0;var total=number.length-start;var mod=total%limbLen;var end=Math.min(total,total-mod)+start;var word=0;for(var i=start;i<end;i+=limbLen){word=parseBase(number,i,i+limbLen,base);this.imuln(limbPow);if(this.words[0]+word<67108864){this.words[0]+=word}else{this._iaddn(word)}}if(mod!==0){var pow=1;word=parseBase(number,i,number.length,base);for(i=0;i<mod;i++){pow*=base}this.imuln(pow);if(this.words[0]+word<67108864){this.words[0]+=word}else{this._iaddn(word)}}this._strip()};BN.prototype.copy=function copy(dest){dest.words=new Array(this.length);for(var i=0;i<this.length;i++){dest.words[i]=this.words[i]}dest.length=this.length;dest.negative=this.negative;dest.red=this.red};function move(dest,src){dest.words=src.words;dest.length=src.length;dest.negative=src.negative;dest.red=src.red}BN.prototype._move=function _move(dest){move(dest,this)};BN.prototype.clone=function clone(){var r=new BN(null);this.copy(r);return r};BN.prototype._expand=function _expand(size){while(this.length<size){this.words[this.length++]=0}return this};BN.prototype._strip=function strip(){while(this.length>1&&this.words[this.length-1]===0){this.length--}return this._normSign()};BN.prototype._normSign=function _normSign(){if(this.length===1&&this.words[0]===0){this.negative=0}return this};if(typeof Symbol!=="undefined"&&typeof Symbol.for==="function"){try{BN.prototype[Symbol.for("nodejs.util.inspect.custom")]=inspect}catch(e){BN.prototype.inspect=inspect}}else{BN.prototype.inspect=inspect}function inspect(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"];var groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];BN.prototype.toString=function toString(base,padding){base=base||10;padding=padding|0||1;var out;if(base===16||base==="hex"){out="";var off=0;var carry=0;for(var i=0;i<this.length;i++){var w=this.words[i];var word=((w<<off|carry)&16777215).toString(16);carry=w>>>24-off&16777215;off+=2;if(off>=26){off-=26;i--}if(carry!==0||i!==this.length-1){out=zeros[6-word.length]+word+out}else{out=word+out}}if(carry!==0){out=carry.toString(16)+out}while(out.length%padding!==0){out="0"+out}if(this.negative!==0){out="-"+out}return out}if(base===(base|0)&&base>=2&&base<=36){var groupSize=groupSizes[base];var groupBase=groupBases[base];out="";var c=this.clone();c.negative=0;while(!c.isZero()){var r=c.modrn(groupBase).toString(base);c=c.idivn(groupBase);if(!c.isZero()){out=zeros[groupSize-r.length]+r+out}else{out=r+out}}if(this.isZero()){out="0"+out}while(out.length%padding!==0){out="0"+out}if(this.negative!==0){out="-"+out}return out}assert(false,"Base should be between 2 and 36")};BN.prototype.toNumber=function toNumber(){var ret=this.words[0];if(this.length===2){ret+=this.words[1]*67108864}else if(this.length===3&&this.words[2]===1){ret+=4503599627370496+this.words[1]*67108864}else if(this.length>2){assert(false,"Number can only safely store up to 53 bits")}return this.negative!==0?-ret:ret};BN.prototype.toJSON=function toJSON(){return this.toString(16,2)};if(Buffer){BN.prototype.toBuffer=function toBuffer(endian,length){return this.toArrayLike(Buffer,endian,length)}}BN.prototype.toArray=function toArray(endian,length){return this.toArrayLike(Array,endian,length)};var allocate=function allocate(ArrayType,size){if(ArrayType.allocUnsafe){return ArrayType.allocUnsafe(size)}return new ArrayType(size)};BN.prototype.toArrayLike=function toArrayLike(ArrayType,endian,length){this._strip();var byteLength=this.byteLength();var reqLength=length||Math.max(1,byteLength);assert(byteLength<=reqLength,"byte array longer than desired length");assert(reqLength>0,"Requested array length <= 0");var res=allocate(ArrayType,reqLength);var postfix=endian==="le"?"LE":"BE";this["_toArrayLike"+postfix](res,byteLength);return res};BN.prototype._toArrayLikeLE=function _toArrayLikeLE(res,byteLength){var position=0;var carry=0;for(var i=0,shift=0;i<this.length;i++){var word=this.words[i]<<shift|carry;res[position++]=word&255;if(position<res.length){res[position++]=word>>8&255}if(position<res.length){res[position++]=word>>16&255}if(shift===6){if(position<res.length){res[position++]=word>>24&255}carry=0;shift=0}else{carry=word>>>24;shift+=2}}if(position<res.length){res[position++]=carry;while(position<res.length){res[position++]=0}}};BN.prototype._toArrayLikeBE=function _toArrayLikeBE(res,byteLength){var position=res.length-1;var carry=0;for(var i=0,shift=0;i<this.length;i++){var word=this.words[i]<<shift|carry;res[position--]=word&255;if(position>=0){res[position--]=word>>8&255}if(position>=0){res[position--]=word>>16&255}if(shift===6){if(position>=0){res[position--]=word>>24&255}carry=0;shift=0}else{carry=word>>>24;shift+=2}}if(position>=0){res[position--]=carry;while(position>=0){res[position--]=0}}};if(Math.clz32){BN.prototype._countBits=function _countBits(w){return 32-Math.clz32(w)}}else{BN.prototype._countBits=function _countBits(w){var t=w;var r=0;if(t>=4096){r+=13;t>>>=13}if(t>=64){r+=7;t>>>=7}if(t>=8){r+=4;t>>>=4}if(t>=2){r+=2;t>>>=2}return r+t}}BN.prototype._zeroBits=function _zeroBits(w){if(w===0)return 26;var t=w;var r=0;if((t&8191)===0){r+=13;t>>>=13}if((t&127)===0){r+=7;t>>>=7}if((t&15)===0){r+=4;t>>>=4}if((t&3)===0){r+=2;t>>>=2}if((t&1)===0){r++}return r};BN.prototype.bitLength=function bitLength(){var w=this.words[this.length-1];var hi=this._countBits(w);return(this.length-1)*26+hi};function toBitArray(num){var w=new Array(num.bitLength());for(var bit=0;bit<w.length;bit++){var off=bit/26|0;var wbit=bit%26;w[bit]=num.words[off]>>>wbit&1}return w}BN.prototype.zeroBits=function zeroBits(){if(this.isZero())return 0;var r=0;for(var i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);r+=b;if(b!==26)break}return r};BN.prototype.byteLength=function byteLength(){return Math.ceil(this.bitLength()/8)};BN.prototype.toTwos=function toTwos(width){if(this.negative!==0){return this.abs().inotn(width).iaddn(1)}return this.clone()};BN.prototype.fromTwos=function fromTwos(width){if(this.testn(width-1)){return this.notn(width).iaddn(1).ineg()}return this.clone()};BN.prototype.isNeg=function isNeg(){return this.negative!==0};BN.prototype.neg=function neg(){return this.clone().ineg()};BN.prototype.ineg=function ineg(){if(!this.isZero()){this.negative^=1}return this};BN.prototype.iuor=function iuor(num){while(this.length<num.length){this.words[this.length++]=0}for(var i=0;i<num.length;i++){this.words[i]=this.words[i]|num.words[i]}return this._strip()};BN.prototype.ior=function ior(num){assert((this.negative|num.negative)===0);return this.iuor(num)};BN.prototype.or=function or(num){if(this.length>num.length)return this.clone().ior(num);return num.clone().ior(this)};BN.prototype.uor=function uor(num){if(this.length>num.length)return this.clone().iuor(num);return num.clone().iuor(this)};BN.prototype.iuand=function iuand(num){var b;if(this.length>num.length){b=num}else{b=this}for(var i=0;i<b.length;i++){this.words[i]=this.words[i]&num.words[i]}this.length=b.length;return this._strip()};BN.prototype.iand=function iand(num){assert((this.negative|num.negative)===0);return this.iuand(num)};BN.prototype.and=function and(num){if(this.length>num.length)return this.clone().iand(num);return num.clone().iand(this)};BN.prototype.uand=function uand(num){if(this.length>num.length)return this.clone().iuand(num);return num.clone().iuand(this)};BN.prototype.iuxor=function iuxor(num){var a;var b;if(this.length>num.length){a=this;b=num}else{a=num;b=this}for(var i=0;i<b.length;i++){this.words[i]=a.words[i]^b.words[i]}if(this!==a){for(;i<a.length;i++){this.words[i]=a.words[i]}}this.length=a.length;return this._strip()};BN.prototype.ixor=function ixor(num){assert((this.negative|num.negative)===0);return this.iuxor(num)};BN.prototype.xor=function xor(num){if(this.length>num.length)return this.clone().ixor(num);return num.clone().ixor(this)};BN.prototype.uxor=function uxor(num){if(this.length>num.length)return this.clone().iuxor(num);return num.clone().iuxor(this)};BN.prototype.inotn=function inotn(width){assert(typeof width==="number"&&width>=0);var bytesNeeded=Math.ceil(width/26)|0;var bitsLeft=width%26;this._expand(bytesNeeded);if(bitsLeft>0){bytesNeeded--}for(var i=0;i<bytesNeeded;i++){this.words[i]=~this.words[i]&67108863}if(bitsLeft>0){this.words[i]=~this.words[i]&67108863>>26-bitsLeft}return this._strip()};BN.prototype.notn=function notn(width){return this.clone().inotn(width)};BN.prototype.setn=function setn(bit,val){assert(typeof bit==="number"&&bit>=0);var off=bit/26|0;var wbit=bit%26;this._expand(off+1);if(val){this.words[off]=this.words[off]|1<<wbit}else{this.words[off]=this.words[off]&~(1<<wbit)}return this._strip()};BN.prototype.iadd=function iadd(num){var r;if(this.negative!==0&&num.negative===0){this.negative=0;r=this.isub(num);this.negative^=1;return this._normSign()}else if(this.negative===0&&num.negative!==0){num.negative=0;r=this.isub(num);num.negative=1;return r._normSign()}var a,b;if(this.length>num.length){a=this;b=num}else{a=num;b=this}var carry=0;for(var i=0;i<b.length;i++){r=(a.words[i]|0)+(b.words[i]|0)+carry;this.words[i]=r&67108863;carry=r>>>26}for(;carry!==0&&i<a.length;i++){r=(a.words[i]|0)+carry;this.words[i]=r&67108863;carry=r>>>26}this.length=a.length;if(carry!==0){this.words[this.length]=carry;this.length++}else if(a!==this){for(;i<a.length;i++){this.words[i]=a.words[i]}}return this};BN.prototype.add=function add(num){var res;if(num.negative!==0&&this.negative===0){num.negative=0;res=this.sub(num);num.negative^=1;return res}else if(num.negative===0&&this.negative!==0){this.negative=0;res=num.sub(this);this.negative=1;return res}if(this.length>num.length)return this.clone().iadd(num);return num.clone().iadd(this)};BN.prototype.isub=function isub(num){if(num.negative!==0){num.negative=0;var r=this.iadd(num);num.negative=1;return r._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(num);this.negative=1;return this._normSign()}var cmp=this.cmp(num);if(cmp===0){this.negative=0;this.length=1;this.words[0]=0;return this}var a,b;if(cmp>0){a=this;b=num}else{a=num;b=this}var carry=0;for(var i=0;i<b.length;i++){r=(a.words[i]|0)-(b.words[i]|0)+carry;carry=r>>26;this.words[i]=r&67108863}for(;carry!==0&&i<a.length;i++){r=(a.words[i]|0)+carry;carry=r>>26;this.words[i]=r&67108863}if(carry===0&&i<a.length&&a!==this){for(;i<a.length;i++){this.words[i]=a.words[i]}}this.length=Math.max(this.length,i);if(a!==this){this.negative=1}return this._strip()};BN.prototype.sub=function sub(num){return this.clone().isub(num)};function smallMulTo(self,num,out){out.negative=num.negative^self.negative;var len=self.length+num.length|0;out.length=len;len=len-1|0;var a=self.words[0]|0;var b=num.words[0]|0;var r=a*b;var lo=r&67108863;var carry=r/67108864|0;out.words[0]=lo;for(var k=1;k<len;k++){var ncarry=carry>>>26;var rword=carry&67108863;var maxJ=Math.min(k,num.length-1);for(var j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j|0;a=self.words[i]|0;b=num.words[j]|0;r=a*b+rword;ncarry+=r/67108864|0;rword=r&67108863}out.words[k]=rword|0;carry=ncarry|0}if(carry!==0){out.words[k]=carry|0}else{out.length--}return out._strip()}var comb10MulTo=function comb10MulTo(self,num,out){var a=self.words;var b=num.words;var o=out.words;var c=0;var lo;var mid;var hi;var a0=a[0]|0;var al0=a0&8191;var ah0=a0>>>13;var a1=a[1]|0;var al1=a1&8191;var ah1=a1>>>13;var a2=a[2]|0;var al2=a2&8191;var ah2=a2>>>13;var a3=a[3]|0;var al3=a3&8191;var ah3=a3>>>13;var a4=a[4]|0;var al4=a4&8191;var ah4=a4>>>13;var a5=a[5]|0;var al5=a5&8191;var ah5=a5>>>13;var a6=a[6]|0;var al6=a6&8191;var ah6=a6>>>13;var a7=a[7]|0;var al7=a7&8191;var ah7=a7>>>13;var a8=a[8]|0;var al8=a8&8191;var ah8=a8>>>13;var a9=a[9]|0;var al9=a9&8191;var ah9=a9>>>13;var b0=b[0]|0;var bl0=b0&8191;var bh0=b0>>>13;var b1=b[1]|0;var bl1=b1&8191;var bh1=b1>>>13;var b2=b[2]|0;var bl2=b2&8191;var bh2=b2>>>13;var b3=b[3]|0;var bl3=b3&8191;var bh3=b3>>>13;var b4=b[4]|0;var bl4=b4&8191;var bh4=b4>>>13;var b5=b[5]|0;var bl5=b5&8191;var bh5=b5>>>13;var b6=b[6]|0;var bl6=b6&8191;var bh6=b6>>>13;var b7=b[7]|0;var bl7=b7&8191;var bh7=b7>>>13;var b8=b[8]|0;var bl8=b8&8191;var bh8=b8>>>13;var b9=b[9]|0;var bl9=b9&8191;var bh9=b9>>>13;out.negative=self.negative^num.negative;out.length=19;lo=Math.imul(al0,bl0);mid=Math.imul(al0,bh0);mid=mid+Math.imul(ah0,bl0)|0;hi=Math.imul(ah0,bh0);var w0=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w0>>>26)|0;w0&=67108863;lo=Math.imul(al1,bl0);mid=Math.imul(al1,bh0);mid=mid+Math.imul(ah1,bl0)|0;hi=Math.imul(ah1,bh0);lo=lo+Math.imul(al0,bl1)|0;mid=mid+Math.imul(al0,bh1)|0;mid=mid+Math.imul(ah0,bl1)|0;hi=hi+Math.imul(ah0,bh1)|0;var w1=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w1>>>26)|0;w1&=67108863;lo=Math.imul(al2,bl0);mid=Math.imul(al2,bh0);mid=mid+Math.imul(ah2,bl0)|0;hi=Math.imul(ah2,bh0);lo=lo+Math.imul(al1,bl1)|0;mid=mid+Math.imul(al1,bh1)|0;mid=mid+Math.imul(ah1,bl1)|0;hi=hi+Math.imul(ah1,bh1)|0;lo=lo+Math.imul(al0,bl2)|0;mid=mid+Math.imul(al0,bh2)|0;mid=mid+Math.imul(ah0,bl2)|0;hi=hi+Math.imul(ah0,bh2)|0;var w2=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w2>>>26)|0;w2&=67108863;lo=Math.imul(al3,bl0);mid=Math.imul(al3,bh0);mid=mid+Math.imul(ah3,bl0)|0;hi=Math.imul(ah3,bh0);lo=lo+Math.imul(al2,bl1)|0;mid=mid+Math.imul(al2,bh1)|0;mid=mid+Math.imul(ah2,bl1)|0;hi=hi+Math.imul(ah2,bh1)|0;lo=lo+Math.imul(al1,bl2)|0;mid=mid+Math.imul(al1,bh2)|0;mid=mid+Math.imul(ah1,bl2)|0;hi=hi+Math.imul(ah1,bh2)|0;lo=lo+Math.imul(al0,bl3)|0;mid=mid+Math.imul(al0,bh3)|0;mid=mid+Math.imul(ah0,bl3)|0;hi=hi+Math.imul(ah0,bh3)|0;var w3=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w3>>>26)|0;w3&=67108863;lo=Math.imul(al4,bl0);mid=Math.imul(al4,bh0);mid=mid+Math.imul(ah4,bl0)|0;hi=Math.imul(ah4,bh0);lo=lo+Math.imul(al3,bl1)|0;mid=mid+Math.imul(al3,bh1)|0;mid=mid+Math.imul(ah3,bl1)|0;hi=hi+Math.imul(ah3,bh1)|0;lo=lo+Math.imul(al2,bl2)|0;mid=mid+Math.imul(al2,bh2)|0;mid=mid+Math.imul(ah2,bl2)|0;hi=hi+Math.imul(ah2,bh2)|0;lo=lo+Math.imul(al1,bl3)|0;mid=mid+Math.imul(al1,bh3)|0;mid=mid+Math.imul(ah1,bl3)|0;hi=hi+Math.imul(ah1,bh3)|0;lo=lo+Math.imul(al0,bl4)|0;mid=mid+Math.imul(al0,bh4)|0;mid=mid+Math.imul(ah0,bl4)|0;hi=hi+Math.imul(ah0,bh4)|0;var w4=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w4>>>26)|0;w4&=67108863;lo=Math.imul(al5,bl0);mid=Math.imul(al5,bh0);mid=mid+Math.imul(ah5,bl0)|0;hi=Math.imul(ah5,bh0);lo=lo+Math.imul(al4,bl1)|0;mid=mid+Math.imul(al4,bh1)|0;mid=mid+Math.imul(ah4,bl1)|0;hi=hi+Math.imul(ah4,bh1)|0;lo=lo+Math.imul(al3,bl2)|0;mid=mid+Math.imul(al3,bh2)|0;mid=mid+Math.imul(ah3,bl2)|0;hi=hi+Math.imul(ah3,bh2)|0;lo=lo+Math.imul(al2,bl3)|0;mid=mid+Math.imul(al2,bh3)|0;mid=mid+Math.imul(ah2,bl3)|0;hi=hi+Math.imul(ah2,bh3)|0;lo=lo+Math.imul(al1,bl4)|0;mid=mid+Math.imul(al1,bh4)|0;mid=mid+Math.imul(ah1,bl4)|0;hi=hi+Math.imul(ah1,bh4)|0;lo=lo+Math.imul(al0,bl5)|0;mid=mid+Math.imul(al0,bh5)|0;mid=mid+Math.imul(ah0,bl5)|0;hi=hi+Math.imul(ah0,bh5)|0;var w5=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w5>>>26)|0;w5&=67108863;lo=Math.imul(al6,bl0);mid=Math.imul(al6,bh0);mid=mid+Math.imul(ah6,bl0)|0;hi=Math.imul(ah6,bh0);lo=lo+Math.imul(al5,bl1)|0;mid=mid+Math.imul(al5,bh1)|0;mid=mid+Math.imul(ah5,bl1)|0;hi=hi+Math.imul(ah5,bh1)|0;lo=lo+Math.imul(al4,bl2)|0;mid=mid+Math.imul(al4,bh2)|0;mid=mid+Math.imul(ah4,bl2)|0;hi=hi+Math.imul(ah4,bh2)|0;lo=lo+Math.imul(al3,bl3)|0;mid=mid+Math.imul(al3,bh3)|0;mid=mid+Math.imul(ah3,bl3)|0;hi=hi+Math.imul(ah3,bh3)|0;lo=lo+Math.imul(al2,bl4)|0;mid=mid+Math.imul(al2,bh4)|0;mid=mid+Math.imul(ah2,bl4)|0;hi=hi+Math.imul(ah2,bh4)|0;lo=lo+Math.imul(al1,bl5)|0;mid=mid+Math.imul(al1,bh5)|0;mid=mid+Math.imul(ah1,bl5)|0;hi=hi+Math.imul(ah1,bh5)|0;lo=lo+Math.imul(al0,bl6)|0;mid=mid+Math.imul(al0,bh6)|0;mid=mid+Math.imul(ah0,bl6)|0;hi=hi+Math.imul(ah0,bh6)|0;var w6=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w6>>>26)|0;w6&=67108863;lo=Math.imul(al7,bl0);mid=Math.imul(al7,bh0);mid=mid+Math.imul(ah7,bl0)|0;hi=Math.imul(ah7,bh0);lo=lo+Math.imul(al6,bl1)|0;mid=mid+Math.imul(al6,bh1)|0;mid=mid+Math.imul(ah6,bl1)|0;hi=hi+Math.imul(ah6,bh1)|0;lo=lo+Math.imul(al5,bl2)|0;mid=mid+Math.imul(al5,bh2)|0;mid=mid+Math.imul(ah5,bl2)|0;hi=hi+Math.imul(ah5,bh2)|0;lo=lo+Math.imul(al4,bl3)|0;mid=mid+Math.imul(al4,bh3)|0;mid=mid+Math.imul(ah4,bl3)|0;hi=hi+Math.imul(ah4,bh3)|0;lo=lo+Math.imul(al3,bl4)|0;mid=mid+Math.imul(al3,bh4)|0;mid=mid+Math.imul(ah3,bl4)|0;hi=hi+Math.imul(ah3,bh4)|0;lo=lo+Math.imul(al2,bl5)|0;mid=mid+Math.imul(al2,bh5)|0;mid=mid+Math.imul(ah2,bl5)|0;hi=hi+Math.imul(ah2,bh5)|0;lo=lo+Math.imul(al1,bl6)|0;mid=mid+Math.imul(al1,bh6)|0;mid=mid+Math.imul(ah1,bl6)|0;hi=hi+Math.imul(ah1,bh6)|0;lo=lo+Math.imul(al0,bl7)|0;mid=mid+Math.imul(al0,bh7)|0;mid=mid+Math.imul(ah0,bl7)|0;hi=hi+Math.imul(ah0,bh7)|0;var w7=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w7>>>26)|0;w7&=67108863;lo=Math.imul(al8,bl0);mid=Math.imul(al8,bh0);mid=mid+Math.imul(ah8,bl0)|0;hi=Math.imul(ah8,bh0);lo=lo+Math.imul(al7,bl1)|0;mid=mid+Math.imul(al7,bh1)|0;mid=mid+Math.imul(ah7,bl1)|0;hi=hi+Math.imul(ah7,bh1)|0;lo=lo+Math.imul(al6,bl2)|0;mid=mid+Math.imul(al6,bh2)|0;mid=mid+Math.imul(ah6,bl2)|0;hi=hi+Math.imul(ah6,bh2)|0;lo=lo+Math.imul(al5,bl3)|0;mid=mid+Math.imul(al5,bh3)|0;mid=mid+Math.imul(ah5,bl3)|0;hi=hi+Math.imul(ah5,bh3)|0;lo=lo+Math.imul(al4,bl4)|0;mid=mid+Math.imul(al4,bh4)|0;mid=mid+Math.imul(ah4,bl4)|0;hi=hi+Math.imul(ah4,bh4)|0;lo=lo+Math.imul(al3,bl5)|0;mid=mid+Math.imul(al3,bh5)|0;mid=mid+Math.imul(ah3,bl5)|0;hi=hi+Math.imul(ah3,bh5)|0;lo=lo+Math.imul(al2,bl6)|0;mid=mid+Math.imul(al2,bh6)|0;mid=mid+Math.imul(ah2,bl6)|0;hi=hi+Math.imul(ah2,bh6)|0;lo=lo+Math.imul(al1,bl7)|0;mid=mid+Math.imul(al1,bh7)|0;mid=mid+Math.imul(ah1,bl7)|0;hi=hi+Math.imul(ah1,bh7)|0;lo=lo+Math.imul(al0,bl8)|0;mid=mid+Math.imul(al0,bh8)|0;mid=mid+Math.imul(ah0,bl8)|0;hi=hi+Math.imul(ah0,bh8)|0;var w8=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w8>>>26)|0;w8&=67108863;lo=Math.imul(al9,bl0);mid=Math.imul(al9,bh0);mid=mid+Math.imul(ah9,bl0)|0;hi=Math.imul(ah9,bh0);lo=lo+Math.imul(al8,bl1)|0;mid=mid+Math.imul(al8,bh1)|0;mid=mid+Math.imul(ah8,bl1)|0;hi=hi+Math.imul(ah8,bh1)|0;lo=lo+Math.imul(al7,bl2)|0;mid=mid+Math.imul(al7,bh2)|0;mid=mid+Math.imul(ah7,bl2)|0;hi=hi+Math.imul(ah7,bh2)|0;lo=lo+Math.imul(al6,bl3)|0;mid=mid+Math.imul(al6,bh3)|0;mid=mid+Math.imul(ah6,bl3)|0;hi=hi+Math.imul(ah6,bh3)|0;lo=lo+Math.imul(al5,bl4)|0;mid=mid+Math.imul(al5,bh4)|0;mid=mid+Math.imul(ah5,bl4)|0;hi=hi+Math.imul(ah5,bh4)|0;lo=lo+Math.imul(al4,bl5)|0;mid=mid+Math.imul(al4,bh5)|0;mid=mid+Math.imul(ah4,bl5)|0;hi=hi+Math.imul(ah4,bh5)|0;lo=lo+Math.imul(al3,bl6)|0;mid=mid+Math.imul(al3,bh6)|0;mid=mid+Math.imul(ah3,bl6)|0;hi=hi+Math.imul(ah3,bh6)|0;lo=lo+Math.imul(al2,bl7)|0;mid=mid+Math.imul(al2,bh7)|0;mid=mid+Math.imul(ah2,bl7)|0;hi=hi+Math.imul(ah2,bh7)|0;lo=lo+Math.imul(al1,bl8)|0;mid=mid+Math.imul(al1,bh8)|0;mid=mid+Math.imul(ah1,bl8)|0;hi=hi+Math.imul(ah1,bh8)|0;lo=lo+Math.imul(al0,bl9)|0;mid=mid+Math.imul(al0,bh9)|0;mid=mid+Math.imul(ah0,bl9)|0;hi=hi+Math.imul(ah0,bh9)|0;var w9=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w9>>>26)|0;w9&=67108863;lo=Math.imul(al9,bl1);mid=Math.imul(al9,bh1);mid=mid+Math.imul(ah9,bl1)|0;hi=Math.imul(ah9,bh1);lo=lo+Math.imul(al8,bl2)|0;mid=mid+Math.imul(al8,bh2)|0;mid=mid+Math.imul(ah8,bl2)|0;hi=hi+Math.imul(ah8,bh2)|0;lo=lo+Math.imul(al7,bl3)|0;mid=mid+Math.imul(al7,bh3)|0;mid=mid+Math.imul(ah7,bl3)|0;hi=hi+Math.imul(ah7,bh3)|0;lo=lo+Math.imul(al6,bl4)|0;mid=mid+Math.imul(al6,bh4)|0;mid=mid+Math.imul(ah6,bl4)|0;hi=hi+Math.imul(ah6,bh4)|0;lo=lo+Math.imul(al5,bl5)|0;mid=mid+Math.imul(al5,bh5)|0;mid=mid+Math.imul(ah5,bl5)|0;hi=hi+Math.imul(ah5,bh5)|0;lo=lo+Math.imul(al4,bl6)|0;mid=mid+Math.imul(al4,bh6)|0;mid=mid+Math.imul(ah4,bl6)|0;hi=hi+Math.imul(ah4,bh6)|0;lo=lo+Math.imul(al3,bl7)|0;mid=mid+Math.imul(al3,bh7)|0;mid=mid+Math.imul(ah3,bl7)|0;hi=hi+Math.imul(ah3,bh7)|0;lo=lo+Math.imul(al2,bl8)|0;mid=mid+Math.imul(al2,bh8)|0;mid=mid+Math.imul(ah2,bl8)|0;hi=hi+Math.imul(ah2,bh8)|0;lo=lo+Math.imul(al1,bl9)|0;mid=mid+Math.imul(al1,bh9)|0;mid=mid+Math.imul(ah1,bl9)|0;hi=hi+Math.imul(ah1,bh9)|0;var w10=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w10>>>26)|0;w10&=67108863;lo=Math.imul(al9,bl2);mid=Math.imul(al9,bh2);mid=mid+Math.imul(ah9,bl2)|0;hi=Math.imul(ah9,bh2);lo=lo+Math.imul(al8,bl3)|0;mid=mid+Math.imul(al8,bh3)|0;mid=mid+Math.imul(ah8,bl3)|0;hi=hi+Math.imul(ah8,bh3)|0;lo=lo+Math.imul(al7,bl4)|0;mid=mid+Math.imul(al7,bh4)|0;mid=mid+Math.imul(ah7,bl4)|0;hi=hi+Math.imul(ah7,bh4)|0;lo=lo+Math.imul(al6,bl5)|0;mid=mid+Math.imul(al6,bh5)|0;mid=mid+Math.imul(ah6,bl5)|0;hi=hi+Math.imul(ah6,bh5)|0;lo=lo+Math.imul(al5,bl6)|0;mid=mid+Math.imul(al5,bh6)|0;mid=mid+Math.imul(ah5,bl6)|0;hi=hi+Math.imul(ah5,bh6)|0;lo=lo+Math.imul(al4,bl7)|0;mid=mid+Math.imul(al4,bh7)|0;mid=mid+Math.imul(ah4,bl7)|0;hi=hi+Math.imul(ah4,bh7)|0;lo=lo+Math.imul(al3,bl8)|0;mid=mid+Math.imul(al3,bh8)|0;mid=mid+Math.imul(ah3,bl8)|0;hi=hi+Math.imul(ah3,bh8)|0;lo=lo+Math.imul(al2,bl9)|0;mid=mid+Math.imul(al2,bh9)|0;mid=mid+Math.imul(ah2,bl9)|0;hi=hi+Math.imul(ah2,bh9)|0;var w11=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w11>>>26)|0;w11&=67108863;lo=Math.imul(al9,bl3);mid=Math.imul(al9,bh3);mid=mid+Math.imul(ah9,bl3)|0;hi=Math.imul(ah9,bh3);lo=lo+Math.imul(al8,bl4)|0;mid=mid+Math.imul(al8,bh4)|0;mid=mid+Math.imul(ah8,bl4)|0;hi=hi+Math.imul(ah8,bh4)|0;lo=lo+Math.imul(al7,bl5)|0;mid=mid+Math.imul(al7,bh5)|0;mid=mid+Math.imul(ah7,bl5)|0;hi=hi+Math.imul(ah7,bh5)|0;lo=lo+Math.imul(al6,bl6)|0;mid=mid+Math.imul(al6,bh6)|0;mid=mid+Math.imul(ah6,bl6)|0;hi=hi+Math.imul(ah6,bh6)|0;lo=lo+Math.imul(al5,bl7)|0;mid=mid+Math.imul(al5,bh7)|0;mid=mid+Math.imul(ah5,bl7)|0;hi=hi+Math.imul(ah5,bh7)|0;lo=lo+Math.imul(al4,bl8)|0;mid=mid+Math.imul(al4,bh8)|0;mid=mid+Math.imul(ah4,bl8)|0;hi=hi+Math.imul(ah4,bh8)|0;lo=lo+Math.imul(al3,bl9)|0;mid=mid+Math.imul(al3,bh9)|0;mid=mid+Math.imul(ah3,bl9)|0;hi=hi+Math.imul(ah3,bh9)|0;var w12=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w12>>>26)|0;w12&=67108863;lo=Math.imul(al9,bl4);mid=Math.imul(al9,bh4);mid=mid+Math.imul(ah9,bl4)|0;hi=Math.imul(ah9,bh4);lo=lo+Math.imul(al8,bl5)|0;mid=mid+Math.imul(al8,bh5)|0;mid=mid+Math.imul(ah8,bl5)|0;hi=hi+Math.imul(ah8,bh5)|0;lo=lo+Math.imul(al7,bl6)|0;mid=mid+Math.imul(al7,bh6)|0;mid=mid+Math.imul(ah7,bl6)|0;hi=hi+Math.imul(ah7,bh6)|0;lo=lo+Math.imul(al6,bl7)|0;mid=mid+Math.imul(al6,bh7)|0;mid=mid+Math.imul(ah6,bl7)|0;hi=hi+Math.imul(ah6,bh7)|0;lo=lo+Math.imul(al5,bl8)|0;mid=mid+Math.imul(al5,bh8)|0;mid=mid+Math.imul(ah5,bl8)|0;hi=hi+Math.imul(ah5,bh8)|0;lo=lo+Math.imul(al4,bl9)|0;mid=mid+Math.imul(al4,bh9)|0;mid=mid+Math.imul(ah4,bl9)|0;hi=hi+Math.imul(ah4,bh9)|0;var w13=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w13>>>26)|0;w13&=67108863;lo=Math.imul(al9,bl5);mid=Math.imul(al9,bh5);mid=mid+Math.imul(ah9,bl5)|0;hi=Math.imul(ah9,bh5);lo=lo+Math.imul(al8,bl6)|0;mid=mid+Math.imul(al8,bh6)|0;mid=mid+Math.imul(ah8,bl6)|0;hi=hi+Math.imul(ah8,bh6)|0;lo=lo+Math.imul(al7,bl7)|0;mid=mid+Math.imul(al7,bh7)|0;mid=mid+Math.imul(ah7,bl7)|0;hi=hi+Math.imul(ah7,bh7)|0;lo=lo+Math.imul(al6,bl8)|0;mid=mid+Math.imul(al6,bh8)|0;mid=mid+Math.imul(ah6,bl8)|0;hi=hi+Math.imul(ah6,bh8)|0;lo=lo+Math.imul(al5,bl9)|0;mid=mid+Math.imul(al5,bh9)|0;mid=mid+Math.imul(ah5,bl9)|0;hi=hi+Math.imul(ah5,bh9)|0;var w14=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w14>>>26)|0;w14&=67108863;lo=Math.imul(al9,bl6);mid=Math.imul(al9,bh6);mid=mid+Math.imul(ah9,bl6)|0;hi=Math.imul(ah9,bh6);lo=lo+Math.imul(al8,bl7)|0;mid=mid+Math.imul(al8,bh7)|0;mid=mid+Math.imul(ah8,bl7)|0;hi=hi+Math.imul(ah8,bh7)|0;lo=lo+Math.imul(al7,bl8)|0;mid=mid+Math.imul(al7,bh8)|0;mid=mid+Math.imul(ah7,bl8)|0;hi=hi+Math.imul(ah7,bh8)|0;lo=lo+Math.imul(al6,bl9)|0;mid=mid+Math.imul(al6,bh9)|0;mid=mid+Math.imul(ah6,bl9)|0;hi=hi+Math.imul(ah6,bh9)|0;var w15=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w15>>>26)|0;w15&=67108863;lo=Math.imul(al9,bl7);mid=Math.imul(al9,bh7);mid=mid+Math.imul(ah9,bl7)|0;hi=Math.imul(ah9,bh7);lo=lo+Math.imul(al8,bl8)|0;mid=mid+Math.imul(al8,bh8)|0;mid=mid+Math.imul(ah8,bl8)|0;hi=hi+Math.imul(ah8,bh8)|0;lo=lo+Math.imul(al7,bl9)|0;mid=mid+Math.imul(al7,bh9)|0;mid=mid+Math.imul(ah7,bl9)|0;hi=hi+Math.imul(ah7,bh9)|0;var w16=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w16>>>26)|0;w16&=67108863;lo=Math.imul(al9,bl8);mid=Math.imul(al9,bh8);mid=mid+Math.imul(ah9,bl8)|0;hi=Math.imul(ah9,bh8);lo=lo+Math.imul(al8,bl9)|0;mid=mid+Math.imul(al8,bh9)|0;mid=mid+Math.imul(ah8,bl9)|0;hi=hi+Math.imul(ah8,bh9)|0;var w17=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w17>>>26)|0;w17&=67108863;lo=Math.imul(al9,bl9);mid=Math.imul(al9,bh9);mid=mid+Math.imul(ah9,bl9)|0;hi=Math.imul(ah9,bh9);var w18=(c+lo|0)+((mid&8191)<<13)|0;c=(hi+(mid>>>13)|0)+(w18>>>26)|0;w18&=67108863;o[0]=w0;o[1]=w1;o[2]=w2;o[3]=w3;o[4]=w4;o[5]=w5;o[6]=w6;o[7]=w7;o[8]=w8;o[9]=w9;o[10]=w10;o[11]=w11;o[12]=w12;o[13]=w13;o[14]=w14;o[15]=w15;o[16]=w16;o[17]=w17;o[18]=w18;if(c!==0){o[19]=c;out.length++}return out};if(!Math.imul){comb10MulTo=smallMulTo}function bigMulTo(self,num,out){out.negative=num.negative^self.negative;out.length=self.length+num.length;var carry=0;var hncarry=0;for(var k=0;k<out.length-1;k++){var ncarry=hncarry;hncarry=0;var rword=carry&67108863;var maxJ=Math.min(k,num.length-1);for(var j=Math.max(0,k-self.length+1);j<=maxJ;j++){var i=k-j;var a=self.words[i]|0;var b=num.words[j]|0;var r=a*b;var lo=r&67108863;ncarry=ncarry+(r/67108864|0)|0;lo=lo+rword|0;rword=lo&67108863;ncarry=ncarry+(lo>>>26)|0;hncarry+=ncarry>>>26;ncarry&=67108863}out.words[k]=rword;carry=ncarry;ncarry=hncarry}if(carry!==0){out.words[k]=carry}else{out.length--}return out._strip()}function jumboMulTo(self,num,out){return bigMulTo(self,num,out)}BN.prototype.mulTo=function mulTo(num,out){var res;var len=this.length+num.length;if(this.length===10&&num.length===10){res=comb10MulTo(this,num,out)}else if(len<63){res=smallMulTo(this,num,out)}else if(len<1024){res=bigMulTo(this,num,out)}else{res=jumboMulTo(this,num,out)}return res};function FFTM(x,y){this.x=x;this.y=y}FFTM.prototype.makeRBT=function makeRBT(N){var t=new Array(N);var l=BN.prototype._countBits(N)-1;for(var i=0;i<N;i++){t[i]=this.revBin(i,l,N)}return t};FFTM.prototype.revBin=function revBin(x,l,N){if(x===0||x===N-1)return x;var rb=0;for(var i=0;i<l;i++){rb|=(x&1)<<l-i-1;x>>=1}return rb};FFTM.prototype.permute=function permute(rbt,rws,iws,rtws,itws,N){for(var i=0;i<N;i++){rtws[i]=rws[rbt[i]];itws[i]=iws[rbt[i]]}};FFTM.prototype.transform=function transform(rws,iws,rtws,itws,N,rbt){this.permute(rbt,rws,iws,rtws,itws,N);for(var s=1;s<N;s<<=1){var l=s<<1;var rtwdf=Math.cos(2*Math.PI/l);var itwdf=Math.sin(2*Math.PI/l);for(var p=0;p<N;p+=l){var rtwdf_=rtwdf;var itwdf_=itwdf;for(var j=0;j<s;j++){var re=rtws[p+j];var ie=itws[p+j];var ro=rtws[p+j+s];var io=itws[p+j+s];var rx=rtwdf_*ro-itwdf_*io;io=rtwdf_*io+itwdf_*ro;ro=rx;rtws[p+j]=re+ro;itws[p+j]=ie+io;rtws[p+j+s]=re-ro;itws[p+j+s]=ie-io;if(j!==l){rx=rtwdf*rtwdf_-itwdf*itwdf_;itwdf_=rtwdf*itwdf_+itwdf*rtwdf_;rtwdf_=rx}}}}};FFTM.prototype.guessLen13b=function guessLen13b(n,m){var N=Math.max(m,n)|1;var odd=N&1;var i=0;for(N=N/2|0;N;N=N>>>1){i++}return 1<<i+1+odd};FFTM.prototype.conjugate=function conjugate(rws,iws,N){if(N<=1)return;for(var i=0;i<N/2;i++){var t=rws[i];rws[i]=rws[N-i-1];rws[N-i-1]=t;t=iws[i];iws[i]=-iws[N-i-1];iws[N-i-1]=-t}};FFTM.prototype.normalize13b=function normalize13b(ws,N){var carry=0;for(var i=0;i<N/2;i++){var w=Math.round(ws[2*i+1]/N)*8192+Math.round(ws[2*i]/N)+carry;ws[i]=w&67108863;if(w<67108864){carry=0}else{carry=w/67108864|0}}return ws};FFTM.prototype.convert13b=function convert13b(ws,len,rws,N){var carry=0;for(var i=0;i<len;i++){carry=carry+(ws[i]|0);rws[2*i]=carry&8191;carry=carry>>>13;rws[2*i+1]=carry&8191;carry=carry>>>13}for(i=2*len;i<N;++i){rws[i]=0}assert(carry===0);assert((carry&~8191)===0)};FFTM.prototype.stub=function stub(N){var ph=new Array(N);for(var i=0;i<N;i++){ph[i]=0}return ph};FFTM.prototype.mulp=function mulp(x,y,out){var N=2*this.guessLen13b(x.length,y.length);var rbt=this.makeRBT(N);var _=this.stub(N);var rws=new Array(N);var rwst=new Array(N);var iwst=new Array(N);var nrws=new Array(N);var nrwst=new Array(N);var niwst=new Array(N);var rmws=out.words;rmws.length=N;this.convert13b(x.words,x.length,rws,N);this.convert13b(y.words,y.length,nrws,N);this.transform(rws,_,rwst,iwst,N,rbt);this.transform(nrws,_,nrwst,niwst,N,rbt);for(var i=0;i<N;i++){var rx=rwst[i]*nrwst[i]-iwst[i]*niwst[i];iwst[i]=rwst[i]*niwst[i]+iwst[i]*nrwst[i];rwst[i]=rx}this.conjugate(rwst,iwst,N);this.transform(rwst,iwst,rmws,_,N,rbt);this.conjugate(rmws,_,N);this.normalize13b(rmws,N);out.negative=x.negative^y.negative;out.length=x.length+y.length;return out._strip()};BN.prototype.mul=function mul(num){var out=new BN(null);out.words=new Array(this.length+num.length);return this.mulTo(num,out)};BN.prototype.mulf=function mulf(num){var out=new BN(null);out.words=new Array(this.length+num.length);return jumboMulTo(this,num,out)};BN.prototype.imul=function imul(num){return this.clone().mulTo(num,this)};BN.prototype.imuln=function imuln(num){var isNegNum=num<0;if(isNegNum)num=-num;assert(typeof num==="number");assert(num<67108864);var carry=0;for(var i=0;i<this.length;i++){var w=(this.words[i]|0)*num;var lo=(w&67108863)+(carry&67108863);carry>>=26;carry+=w/67108864|0;carry+=lo>>>26;this.words[i]=lo&67108863}if(carry!==0){this.words[i]=carry;this.length++}return isNegNum?this.ineg():this};BN.prototype.muln=function muln(num){return this.clone().imuln(num)};BN.prototype.sqr=function sqr(){return this.mul(this)};BN.prototype.isqr=function isqr(){return this.imul(this.clone())};BN.prototype.pow=function pow(num){var w=toBitArray(num);if(w.length===0)return new BN(1);var res=this;for(var i=0;i<w.length;i++,res=res.sqr()){if(w[i]!==0)break}if(++i<w.length){for(var q=res.sqr();i<w.length;i++,q=q.sqr()){if(w[i]===0)continue;res=res.mul(q)}}return res};BN.prototype.iushln=function iushln(bits){assert(typeof bits==="number"&&bits>=0);var r=bits%26;var s=(bits-r)/26;var carryMask=67108863>>>26-r<<26-r;var i;if(r!==0){var carry=0;for(i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask;var c=(this.words[i]|0)-newCarry<<r;this.words[i]=c|carry;carry=newCarry>>>26-r}if(carry){this.words[i]=carry;this.length++}}if(s!==0){for(i=this.length-1;i>=0;i--){this.words[i+s]=this.words[i]}for(i=0;i<s;i++){this.words[i]=0}this.length+=s}return this._strip()};BN.prototype.ishln=function ishln(bits){assert(this.negative===0);return this.iushln(bits)};BN.prototype.iushrn=function iushrn(bits,hint,extended){assert(typeof bits==="number"&&bits>=0);var h;if(hint){h=(hint-hint%26)/26}else{h=0}var r=bits%26;var s=Math.min((bits-r)/26,this.length);var mask=67108863^67108863>>>r<<r;var maskedWords=extended;h-=s;h=Math.max(0,h);if(maskedWords){for(var i=0;i<s;i++){maskedWords.words[i]=this.words[i]}maskedWords.length=s}if(s===0){}else if(this.length>s){this.length-=s;for(i=0;i<this.length;i++){this.words[i]=this.words[i+s]}}else{this.words[0]=0;this.length=1}var carry=0;for(i=this.length-1;i>=0&&(carry!==0||i>=h);i--){var word=this.words[i]|0;this.words[i]=carry<<26-r|word>>>r;carry=word&mask}if(maskedWords&&carry!==0){maskedWords.words[maskedWords.length++]=carry}if(this.length===0){this.words[0]=0;this.length=1}return this._strip()};BN.prototype.ishrn=function ishrn(bits,hint,extended){assert(this.negative===0);return this.iushrn(bits,hint,extended)};BN.prototype.shln=function shln(bits){return this.clone().ishln(bits)};BN.prototype.ushln=function ushln(bits){return this.clone().iushln(bits)};BN.prototype.shrn=function shrn(bits){return this.clone().ishrn(bits)};BN.prototype.ushrn=function ushrn(bits){return this.clone().iushrn(bits)};BN.prototype.testn=function testn(bit){assert(typeof bit==="number"&&bit>=0);var r=bit%26;var s=(bit-r)/26;var q=1<<r;if(this.length<=s)return false;var w=this.words[s];return!!(w&q)};BN.prototype.imaskn=function imaskn(bits){assert(typeof bits==="number"&&bits>=0);var r=bits%26;var s=(bits-r)/26;assert(this.negative===0,"imaskn works only with positive numbers");if(this.length<=s){return this}if(r!==0){s++}this.length=Math.min(s,this.length);if(r!==0){var mask=67108863^67108863>>>r<<r;this.words[this.length-1]&=mask}return this._strip()};BN.prototype.maskn=function maskn(bits){return this.clone().imaskn(bits)};BN.prototype.iaddn=function iaddn(num){assert(typeof num==="number");assert(num<67108864);if(num<0)return this.isubn(-num);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<=num){this.words[0]=num-(this.words[0]|0);this.negative=0;return this}this.negative=0;this.isubn(num);this.negative=1;return this}return this._iaddn(num)};BN.prototype._iaddn=function _iaddn(num){this.words[0]+=num;for(var i=0;i<this.length&&this.words[i]>=67108864;i++){this.words[i]-=67108864;if(i===this.length-1){this.words[i+1]=1}else{this.words[i+1]++}}this.length=Math.max(this.length,i+1);return this};BN.prototype.isubn=function isubn(num){assert(typeof num==="number");assert(num<67108864);if(num<0)return this.iaddn(-num);if(this.negative!==0){this.negative=0;this.iaddn(num);this.negative=1;return this}this.words[0]-=num;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var i=0;i<this.length&&this.words[i]<0;i++){this.words[i]+=67108864;this.words[i+1]-=1}}return this._strip()};BN.prototype.addn=function addn(num){return this.clone().iaddn(num)};BN.prototype.subn=function subn(num){return this.clone().isubn(num)};BN.prototype.iabs=function iabs(){this.negative=0;return this};BN.prototype.abs=function abs(){return this.clone().iabs()};BN.prototype._ishlnsubmul=function _ishlnsubmul(num,mul,shift){var len=num.length+shift;var i;this._expand(len);var w;var carry=0;for(i=0;i<num.length;i++){w=(this.words[i+shift]|0)+carry;var right=(num.words[i]|0)*mul;w-=right&67108863;carry=(w>>26)-(right/67108864|0);this.words[i+shift]=w&67108863}for(;i<this.length-shift;i++){w=(this.words[i+shift]|0)+carry;carry=w>>26;this.words[i+shift]=w&67108863}if(carry===0)return this._strip();assert(carry===-1);carry=0;for(i=0;i<this.length;i++){w=-(this.words[i]|0)+carry;carry=w>>26;this.words[i]=w&67108863}this.negative=1;return this._strip()};BN.prototype._wordDiv=function _wordDiv(num,mode){var shift=this.length-num.length;var a=this.clone();var b=num;var bhi=b.words[b.length-1]|0;var bhiBits=this._countBits(bhi);shift=26-bhiBits;if(shift!==0){b=b.ushln(shift);a.iushln(shift);bhi=b.words[b.length-1]|0}var m=a.length-b.length;var q;if(mode!=="mod"){q=new BN(null);q.length=m+1;q.words=new Array(q.length);for(var i=0;i<q.length;i++){q.words[i]=0}}var diff=a.clone()._ishlnsubmul(b,1,m);if(diff.negative===0){a=diff;if(q){q.words[m]=1}}for(var j=m-1;j>=0;j--){var qj=(a.words[b.length+j]|0)*67108864+(a.words[b.length+j-1]|0);qj=Math.min(qj/bhi|0,67108863);a._ishlnsubmul(b,qj,j);while(a.negative!==0){qj--;a.negative=0;a._ishlnsubmul(b,1,j);if(!a.isZero()){a.negative^=1}}if(q){q.words[j]=qj}}if(q){q._strip()}a._strip();if(mode!=="div"&&shift!==0){a.iushrn(shift)}return{div:q||null,mod:a}};BN.prototype.divmod=function divmod(num,mode,positive){assert(!num.isZero());if(this.isZero()){return{div:new BN(0),mod:new BN(0)}}var div,mod,res;if(this.negative!==0&&num.negative===0){res=this.neg().divmod(num,mode);if(mode!=="mod"){div=res.div.neg()}if(mode!=="div"){mod=res.mod.neg();if(positive&&mod.negative!==0){mod.iadd(num)}}return{div:div,mod:mod}}if(this.negative===0&&num.negative!==0){res=this.divmod(num.neg(),mode);if(mode!=="mod"){div=res.div.neg()}return{div:div,mod:res.mod}}if((this.negative&num.negative)!==0){res=this.neg().divmod(num.neg(),mode);if(mode!=="div"){mod=res.mod.neg();if(positive&&mod.negative!==0){mod.isub(num)}}return{div:res.div,mod:mod}}if(num.length>this.length||this.cmp(num)<0){return{div:new BN(0),mod:this}}if(num.length===1){if(mode==="div"){return{div:this.divn(num.words[0]),mod:null}}if(mode==="mod"){return{div:null,mod:new BN(this.modrn(num.words[0]))}}return{div:this.divn(num.words[0]),mod:new BN(this.modrn(num.words[0]))}}return this._wordDiv(num,mode)};BN.prototype.div=function div(num){return this.divmod(num,"div",false).div};BN.prototype.mod=function mod(num){return this.divmod(num,"mod",false).mod};BN.prototype.umod=function umod(num){return this.divmod(num,"mod",true).mod};BN.prototype.divRound=function divRound(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=dm.div.negative!==0?dm.mod.isub(num):dm.mod;var half=num.ushrn(1);var r2=num.andln(1);var cmp=mod.cmp(half);if(cmp<0||r2===1&&cmp===0)return dm.div;return dm.div.negative!==0?dm.div.isubn(1):dm.div.iaddn(1)};BN.prototype.modrn=function modrn(num){var isNegNum=num<0;if(isNegNum)num=-num;assert(num<=67108863);var p=(1<<26)%num;var acc=0;for(var i=this.length-1;i>=0;i--){acc=(p*acc+(this.words[i]|0))%num}return isNegNum?-acc:acc};BN.prototype.modn=function modn(num){return this.modrn(num)};BN.prototype.idivn=function idivn(num){var isNegNum=num<0;if(isNegNum)num=-num;assert(num<=67108863);var carry=0;for(var i=this.length-1;i>=0;i--){var w=(this.words[i]|0)+carry*67108864;this.words[i]=w/num|0;carry=w%num}this._strip();return isNegNum?this.ineg():this};BN.prototype.divn=function divn(num){return this.clone().idivn(num)};BN.prototype.egcd=function egcd(p){assert(p.negative===0);assert(!p.isZero());var x=this;var y=p.clone();if(x.negative!==0){x=x.umod(p)}else{x=x.clone()}var A=new BN(1);var B=new BN(0);var C=new BN(0);var D=new BN(1);var g=0;while(x.isEven()&&y.isEven()){x.iushrn(1);y.iushrn(1);++g}var yp=y.clone();var xp=x.clone();while(!x.isZero()){for(var i=0,im=1;(x.words[0]&im)===0&&i<26;++i,im<<=1);if(i>0){x.iushrn(i);while(i-- >0){if(A.isOdd()||B.isOdd()){A.iadd(yp);B.isub(xp)}A.iushrn(1);B.iushrn(1)}}for(var j=0,jm=1;(y.words[0]&jm)===0&&j<26;++j,jm<<=1);if(j>0){y.iushrn(j);while(j-- >0){if(C.isOdd()||D.isOdd()){C.iadd(yp);D.isub(xp)}C.iushrn(1);D.iushrn(1)}}if(x.cmp(y)>=0){x.isub(y);A.isub(C);B.isub(D)}else{y.isub(x);C.isub(A);D.isub(B)}}return{a:C,b:D,gcd:y.iushln(g)}};BN.prototype._invmp=function _invmp(p){assert(p.negative===0);assert(!p.isZero());var a=this;var b=p.clone();if(a.negative!==0){a=a.umod(p)}else{a=a.clone()}var x1=new BN(1);var x2=new BN(0);var delta=b.clone();while(a.cmpn(1)>0&&b.cmpn(1)>0){for(var i=0,im=1;(a.words[0]&im)===0&&i<26;++i,im<<=1);if(i>0){a.iushrn(i);while(i-- >0){if(x1.isOdd()){x1.iadd(delta)}x1.iushrn(1)}}for(var j=0,jm=1;(b.words[0]&jm)===0&&j<26;++j,jm<<=1);if(j>0){b.iushrn(j);while(j-- >0){if(x2.isOdd()){x2.iadd(delta)}x2.iushrn(1)}}if(a.cmp(b)>=0){a.isub(b);x1.isub(x2)}else{b.isub(a);x2.isub(x1)}}var res;if(a.cmpn(1)===0){res=x1}else{res=x2}if(res.cmpn(0)<0){res.iadd(p)}return res};BN.prototype.gcd=function gcd(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone();var b=num.clone();a.negative=0;b.negative=0;for(var shift=0;a.isEven()&&b.isEven();shift++){a.iushrn(1);b.iushrn(1)}do{while(a.isEven()){a.iushrn(1)}while(b.isEven()){b.iushrn(1)}var r=a.cmp(b);if(r<0){var t=a;a=b;b=t}else if(r===0||b.cmpn(1)===0){break}a.isub(b)}while(true);return b.iushln(shift)};BN.prototype.invm=function invm(num){return this.egcd(num).a.umod(num)};BN.prototype.isEven=function isEven(){return(this.words[0]&1)===0};BN.prototype.isOdd=function isOdd(){return(this.words[0]&1)===1};BN.prototype.andln=function andln(num){return this.words[0]&num};BN.prototype.bincn=function bincn(bit){assert(typeof bit==="number");var r=bit%26;var s=(bit-r)/26;var q=1<<r;if(this.length<=s){this._expand(s+1);this.words[s]|=q;return this}var carry=q;for(var i=s;carry!==0&&i<this.length;i++){var w=this.words[i]|0;w+=carry;carry=w>>>26;w&=67108863;this.words[i]=w}if(carry!==0){this.words[i]=carry;this.length++}return this};BN.prototype.isZero=function isZero(){return this.length===1&&this.words[0]===0};BN.prototype.cmpn=function cmpn(num){var negative=num<0;if(this.negative!==0&&!negative)return-1;if(this.negative===0&&negative)return 1;this._strip();var res;if(this.length>1){res=1}else{if(negative){num=-num}assert(num<=67108863,"Number is too big");var w=this.words[0]|0;res=w===num?0:w<num?-1:1}if(this.negative!==0)return-res|0;return res};BN.prototype.cmp=function cmp(num){if(this.negative!==0&&num.negative===0)return-1;if(this.negative===0&&num.negative!==0)return 1;var res=this.ucmp(num);if(this.negative!==0)return-res|0;return res};BN.prototype.ucmp=function ucmp(num){if(this.length>num.length)return 1;if(this.length<num.length)return-1;var res=0;for(var i=this.length-1;i>=0;i--){var a=this.words[i]|0;var b=num.words[i]|0;if(a===b)continue;if(a<b){res=-1}else if(a>b){res=1}break}return res};BN.prototype.gtn=function gtn(num){return this.cmpn(num)===1};BN.prototype.gt=function gt(num){return this.cmp(num)===1};BN.prototype.gten=function gten(num){return this.cmpn(num)>=0};BN.prototype.gte=function gte(num){return this.cmp(num)>=0};BN.prototype.ltn=function ltn(num){return this.cmpn(num)===-1};BN.prototype.lt=function lt(num){return this.cmp(num)===-1};BN.prototype.lten=function lten(num){return this.cmpn(num)<=0};BN.prototype.lte=function lte(num){return this.cmp(num)<=0};BN.prototype.eqn=function eqn(num){return this.cmpn(num)===0};BN.prototype.eq=function eq(num){return this.cmp(num)===0};BN.red=function red(num){return new Red(num)};BN.prototype.toRed=function toRed(ctx){assert(!this.red,"Already a number in reduction context");assert(this.negative===0,"red works only with positives");return ctx.convertTo(this)._forceRed(ctx)};BN.prototype.fromRed=function fromRed(){assert(this.red,"fromRed works only with numbers in reduction context");return this.red.convertFrom(this)};BN.prototype._forceRed=function _forceRed(ctx){this.red=ctx;return this};BN.prototype.forceRed=function forceRed(ctx){assert(!this.red,"Already a number in reduction context");return this._forceRed(ctx)};BN.prototype.redAdd=function redAdd(num){assert(this.red,"redAdd works only with red numbers");return this.red.add(this,num)};BN.prototype.redIAdd=function redIAdd(num){assert(this.red,"redIAdd works only with red numbers");return this.red.iadd(this,num)};BN.prototype.redSub=function redSub(num){assert(this.red,"redSub works only with red numbers");return this.red.sub(this,num)};BN.prototype.redISub=function redISub(num){assert(this.red,"redISub works only with red numbers");return this.red.isub(this,num)};BN.prototype.redShl=function redShl(num){assert(this.red,"redShl works only with red numbers");return this.red.shl(this,num)};BN.prototype.redMul=function redMul(num){assert(this.red,"redMul works only with red numbers");this.red._verify2(this,num);return this.red.mul(this,num)};BN.prototype.redIMul=function redIMul(num){assert(this.red,"redMul works only with red numbers");this.red._verify2(this,num);return this.red.imul(this,num)};BN.prototype.redSqr=function redSqr(){assert(this.red,"redSqr works only with red numbers");this.red._verify1(this);return this.red.sqr(this)};BN.prototype.redISqr=function redISqr(){assert(this.red,"redISqr works only with red numbers");this.red._verify1(this);return this.red.isqr(this)};BN.prototype.redSqrt=function redSqrt(){assert(this.red,"redSqrt works only with red numbers");this.red._verify1(this);return this.red.sqrt(this)};BN.prototype.redInvm=function redInvm(){assert(this.red,"redInvm works only with red numbers");this.red._verify1(this);return this.red.invm(this)};BN.prototype.redNeg=function redNeg(){assert(this.red,"redNeg works only with red numbers");this.red._verify1(this);return this.red.neg(this)};BN.prototype.redPow=function redPow(num){assert(this.red&&!num.red,"redPow(normalNum)");this.red._verify1(this);return this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};function MPrime(name,p){this.name=name;this.p=new BN(p,16);this.n=this.p.bitLength();this.k=new BN(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}MPrime.prototype._tmp=function _tmp(){var tmp=new BN(null);tmp.words=new Array(Math.ceil(this.n/13));return tmp};MPrime.prototype.ireduce=function ireduce(num){var r=num;var rlen;do{this.split(r,this.tmp);r=this.imulK(r);r=r.iadd(this.tmp);rlen=r.bitLength()}while(rlen>this.n);var cmp=rlen<this.n?-1:r.ucmp(this.p);if(cmp===0){r.words[0]=0;r.length=1}else if(cmp>0){r.isub(this.p)}else{if(r.strip!==undefined){r.strip()}else{r._strip()}}return r};MPrime.prototype.split=function split(input,out){input.iushrn(this.n,0,out)};MPrime.prototype.imulK=function imulK(num){return num.imul(this.k)};function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}inherits(K256,MPrime);K256.prototype.split=function split(input,output){var mask=4194303;var outLen=Math.min(input.length,9);for(var i=0;i<outLen;i++){output.words[i]=input.words[i]}output.length=outLen;if(input.length<=9){input.words[0]=0;input.length=1;return}var prev=input.words[9];output.words[output.length++]=prev&mask;for(i=10;i<input.length;i++){var next=input.words[i]|0;input.words[i-10]=(next&mask)<<4|prev>>>22;prev=next}prev>>>=22;input.words[i-10]=prev;if(prev===0&&input.length>10){input.length-=10}else{input.length-=9}};K256.prototype.imulK=function imulK(num){num.words[num.length]=0;num.words[num.length+1]=0;num.length+=2;var lo=0;for(var i=0;i<num.length;i++){var w=num.words[i]|0;lo+=w*977;num.words[i]=lo&67108863;lo=w*64+(lo/67108864|0)}if(num.words[num.length-1]===0){num.length--;if(num.words[num.length-1]===0){num.length--}}return num};function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}inherits(P224,MPrime);function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}inherits(P192,MPrime);function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}inherits(P25519,MPrime);P25519.prototype.imulK=function imulK(num){var carry=0;for(var i=0;i<num.length;i++){var hi=(num.words[i]|0)*19+carry;var lo=hi&67108863;hi>>>=26;num.words[i]=lo;carry=hi}if(carry!==0){num.words[num.length++]=carry}return num};BN._prime=function prime(name){if(primes[name])return primes[name];var prime;if(name==="k256"){prime=new K256}else if(name==="p224"){prime=new P224}else if(name==="p192"){prime=new P192}else if(name==="p25519"){prime=new P25519}else{throw new Error("Unknown prime "+name)}primes[name]=prime;return prime};function Red(m){if(typeof m==="string"){var prime=BN._prime(m);this.m=prime.p;this.prime=prime}else{assert(m.gtn(1),"modulus must be greater than 1");this.m=m;this.prime=null}}Red.prototype._verify1=function _verify1(a){assert(a.negative===0,"red works only with positives");assert(a.red,"red works only with red numbers")};Red.prototype._verify2=function _verify2(a,b){assert((a.negative|b.negative)===0,"red works only with positives");assert(a.red&&a.red===b.red,"red works only with red numbers")};Red.prototype.imod=function imod(a){if(this.prime)return this.prime.ireduce(a)._forceRed(this);move(a,a.umod(this.m)._forceRed(this));return a};Red.prototype.neg=function neg(a){if(a.isZero()){return a.clone()}return this.m.sub(a)._forceRed(this)};Red.prototype.add=function add(a,b){this._verify2(a,b);var res=a.add(b);if(res.cmp(this.m)>=0){res.isub(this.m)}return res._forceRed(this)};Red.prototype.iadd=function iadd(a,b){this._verify2(a,b);var res=a.iadd(b);if(res.cmp(this.m)>=0){res.isub(this.m)}return res};Red.prototype.sub=function sub(a,b){this._verify2(a,b);var res=a.sub(b);if(res.cmpn(0)<0){res.iadd(this.m)}return res._forceRed(this)};Red.prototype.isub=function isub(a,b){this._verify2(a,b);var res=a.isub(b);if(res.cmpn(0)<0){res.iadd(this.m)}return res};Red.prototype.shl=function shl(a,num){this._verify1(a);return this.imod(a.ushln(num))};Red.prototype.imul=function imul(a,b){this._verify2(a,b);return this.imod(a.imul(b))};Red.prototype.mul=function mul(a,b){this._verify2(a,b);return this.imod(a.mul(b))};Red.prototype.isqr=function isqr(a){return this.imul(a,a.clone())};Red.prototype.sqr=function sqr(a){return this.mul(a,a)};Red.prototype.sqrt=function sqrt(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);assert(mod3%2===1);if(mod3===3){var pow=this.m.add(new BN(1)).iushrn(2);return this.pow(a,pow)}var q=this.m.subn(1);var s=0;while(!q.isZero()&&q.andln(1)===0){s++;q.iushrn(1)}assert(!q.isZero());var one=new BN(1).toRed(this);var nOne=one.redNeg();var lpow=this.m.subn(1).iushrn(1);var z=this.m.bitLength();z=new BN(2*z*z).toRed(this);while(this.pow(z,lpow).cmp(nOne)!==0){z.redIAdd(nOne)}var c=this.pow(z,q);var r=this.pow(a,q.addn(1).iushrn(1));var t=this.pow(a,q);var m=s;while(t.cmp(one)!==0){var tmp=t;for(var i=0;tmp.cmp(one)!==0;i++){tmp=tmp.redSqr()}assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1));r=r.redMul(b);c=b.redSqr();t=t.redMul(c);m=i}return r};Red.prototype.invm=function invm(a){var inv=a._invmp(this.m);if(inv.negative!==0){inv.negative=0;return this.imod(inv).redNeg()}else{return this.imod(inv)}};Red.prototype.pow=function pow(a,num){if(num.isZero())return new BN(1).toRed(this);if(num.cmpn(1)===0)return a.clone();var windowSize=4;var wnd=new Array(1<<windowSize);wnd[0]=new BN(1).toRed(this);wnd[1]=a;for(var i=2;i<wnd.length;i++){wnd[i]=this.mul(wnd[i-1],a)}var res=wnd[0];var current=0;var currentLen=0;var start=num.bitLength()%26;if(start===0){start=26}for(i=num.length-1;i>=0;i--){var word=num.words[i];for(var j=start-1;j>=0;j--){var bit=word>>j&1;if(res!==wnd[0]){res=this.sqr(res)}if(bit===0&&current===0){currentLen=0;continue}current<<=1;current|=bit;currentLen++;if(currentLen!==windowSize&&(i!==0||j!==0))continue;res=this.mul(res,wnd[current]);currentLen=0;current=0}start=26}return res};Red.prototype.convertTo=function convertTo(num){var r=num.umod(this.m);return r===num?r.clone():r};Red.prototype.convertFrom=function convertFrom(num){var res=num.clone();res.red=null;return res};BN.mont=function mont(num){return new Mont(num)};function Mont(m){Red.call(this,m);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-this.shift%26}this.r=new BN(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}inherits(Mont,Red);Mont.prototype.convertTo=function convertTo(num){return this.imod(num.ushln(this.shift))};Mont.prototype.convertFrom=function convertFrom(num){var r=this.imod(num.mul(this.rinv));r.red=null;return r};Mont.prototype.imul=function imul(a,b){if(a.isZero()||b.isZero()){a.words[0]=0;a.length=1;return a}var t=a.imul(b);var c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var u=t.isub(c).iushrn(this.shift);var res=u;if(u.cmp(this.m)>=0){res=u.isub(this.m)}else if(u.cmpn(0)<0){res=u.iadd(this.m)}return res._forceRed(this)};Mont.prototype.mul=function mul(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);var t=a.mul(b);var c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var u=t.isub(c).iushrn(this.shift);var res=u;if(u.cmp(this.m)>=0){res=u.isub(this.m)}else if(u.cmpn(0)<0){res=u.iadd(this.m)}return res._forceRed(this)};Mont.prototype.invm=function invm(a){var res=this.imod(a._invmp(this.m).mul(this.r2));return res._forceRed(this)}})(typeof module==="undefined"||module,this)},{buffer:88}],41:[function(require,module,exports){module.exports={trueFunc:function trueFunc(){return true},falseFunc:function falseFunc(){return false}}},{}],42:[function(require,module,exports){var r;module.exports=function rand(len){if(!r)r=new Rand(null);return r.generate(len)};function Rand(rand){this.rand=rand}module.exports.Rand=Rand;Rand.prototype.generate=function generate(len){return this._rand(len)};Rand.prototype._rand=function _rand(n){if(this.rand.getBytes)return this.rand.getBytes(n);var res=new Uint8Array(n);for(var i=0;i<res.length;i++)res[i]=this.rand.getByte();return res};if(typeof self==="object"){if(self.crypto&&self.crypto.getRandomValues){Rand.prototype._rand=function _rand(n){var arr=new Uint8Array(n);self.crypto.getRandomValues(arr);return arr}}else if(self.msCrypto&&self.msCrypto.getRandomValues){Rand.prototype._rand=function _rand(n){var arr=new Uint8Array(n);self.msCrypto.getRandomValues(arr);return arr}}else if(typeof window==="object"){Rand.prototype._rand=function(){throw new Error("Not implemented yet")}}}else{try{var crypto=require("crypto");if(typeof crypto.randomBytes!=="function")throw new Error("Not supported");Rand.prototype._rand=function _rand(n){return crypto.randomBytes(n)}}catch(e){}}},{crypto:43}],43:[function(require,module,exports){},{}],44:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;function asUInt32Array(buf){if(!Buffer.isBuffer(buf))buf=Buffer.from(buf);var len=buf.length/4|0;var out=new Array(len);for(var i=0;i<len;i++){out[i]=buf.readUInt32BE(i*4)}return out}function scrubVec(v){for(var i=0;i<v.length;v++){v[i]=0}}function cryptBlock(M,keySchedule,SUB_MIX,SBOX,nRounds){var SUB_MIX0=SUB_MIX[0];var SUB_MIX1=SUB_MIX[1];var SUB_MIX2=SUB_MIX[2];var SUB_MIX3=SUB_MIX[3];var s0=M[0]^keySchedule[0];var s1=M[1]^keySchedule[1];var s2=M[2]^keySchedule[2];var s3=M[3]^keySchedule[3];var t0,t1,t2,t3;var ksRow=4;for(var round=1;round<nRounds;round++){t0=SUB_MIX0[s0>>>24]^SUB_MIX1[s1>>>16&255]^SUB_MIX2[s2>>>8&255]^SUB_MIX3[s3&255]^keySchedule[ksRow++];t1=SUB_MIX0[s1>>>24]^SUB_MIX1[s2>>>16&255]^SUB_MIX2[s3>>>8&255]^SUB_MIX3[s0&255]^keySchedule[ksRow++];t2=SUB_MIX0[s2>>>24]^SUB_MIX1[s3>>>16&255]^SUB_MIX2[s0>>>8&255]^SUB_MIX3[s1&255]^keySchedule[ksRow++];t3=SUB_MIX0[s3>>>24]^SUB_MIX1[s0>>>16&255]^SUB_MIX2[s1>>>8&255]^SUB_MIX3[s2&255]^keySchedule[ksRow++];s0=t0;s1=t1;s2=t2;s3=t3}t0=(SBOX[s0>>>24]<<24|SBOX[s1>>>16&255]<<16|SBOX[s2>>>8&255]<<8|SBOX[s3&255])^keySchedule[ksRow++];t1=(SBOX[s1>>>24]<<24|SBOX[s2>>>16&255]<<16|SBOX[s3>>>8&255]<<8|SBOX[s0&255])^keySchedule[ksRow++];t2=(SBOX[s2>>>24]<<24|SBOX[s3>>>16&255]<<16|SBOX[s0>>>8&255]<<8|SBOX[s1&255])^keySchedule[ksRow++];t3=(SBOX[s3>>>24]<<24|SBOX[s0>>>16&255]<<16|SBOX[s1>>>8&255]<<8|SBOX[s2&255])^keySchedule[ksRow++];t0=t0>>>0;t1=t1>>>0;t2=t2>>>0;t3=t3>>>0;return[t0,t1,t2,t3]}var RCON=[0,1,2,4,8,16,32,64,128,27,54];var G=function(){var d=new Array(256);for(var j=0;j<256;j++){if(j<128){d[j]=j<<1}else{d[j]=j<<1^283}}var SBOX=[];var INV_SBOX=[];var SUB_MIX=[[],[],[],[]];var INV_SUB_MIX=[[],[],[],[]];var x=0;var xi=0;for(var i=0;i<256;++i){var sx=xi^xi<<1^xi<<2^xi<<3^xi<<4;sx=sx>>>8^sx&255^99;SBOX[x]=sx;INV_SBOX[sx]=x;var x2=d[x];var x4=d[x2];var x8=d[x4];var t=d[sx]*257^sx*16843008;SUB_MIX[0][x]=t<<24|t>>>8;SUB_MIX[1][x]=t<<16|t>>>16;SUB_MIX[2][x]=t<<8|t>>>24;SUB_MIX[3][x]=t;t=x8*16843009^x4*65537^x2*257^x*16843008;INV_SUB_MIX[0][sx]=t<<24|t>>>8;INV_SUB_MIX[1][sx]=t<<16|t>>>16;INV_SUB_MIX[2][sx]=t<<8|t>>>24;INV_SUB_MIX[3][sx]=t;if(x===0){x=xi=1}else{x=x2^d[d[d[x8^x2]]];xi^=d[d[xi]]}}return{SBOX:SBOX,INV_SBOX:INV_SBOX,SUB_MIX:SUB_MIX,INV_SUB_MIX:INV_SUB_MIX}}();function AES(key){this._key=asUInt32Array(key);this._reset()}AES.blockSize=4*4;AES.keySize=256/8;AES.prototype.blockSize=AES.blockSize;AES.prototype.keySize=AES.keySize;AES.prototype._reset=function(){var keyWords=this._key;var keySize=keyWords.length;var nRounds=keySize+6;var ksRows=(nRounds+1)*4;var keySchedule=[];for(var k=0;k<keySize;k++){keySchedule[k]=keyWords[k]}for(k=keySize;k<ksRows;k++){var t=keySchedule[k-1];if(k%keySize===0){t=t<<8|t>>>24;t=G.SBOX[t>>>24]<<24|G.SBOX[t>>>16&255]<<16|G.SBOX[t>>>8&255]<<8|G.SBOX[t&255];t^=RCON[k/keySize|0]<<24}else if(keySize>6&&k%keySize===4){t=G.SBOX[t>>>24]<<24|G.SBOX[t>>>16&255]<<16|G.SBOX[t>>>8&255]<<8|G.SBOX[t&255]}keySchedule[k]=keySchedule[k-keySize]^t}var invKeySchedule=[];for(var ik=0;ik<ksRows;ik++){var ksR=ksRows-ik;var tt=keySchedule[ksR-(ik%4?0:4)];if(ik<4||ksR<=4){invKeySchedule[ik]=tt}else{invKeySchedule[ik]=G.INV_SUB_MIX[0][G.SBOX[tt>>>24]]^G.INV_SUB_MIX[1][G.SBOX[tt>>>16&255]]^G.INV_SUB_MIX[2][G.SBOX[tt>>>8&255]]^G.INV_SUB_MIX[3][G.SBOX[tt&255]]}}this._nRounds=nRounds;this._keySchedule=keySchedule;this._invKeySchedule=invKeySchedule};AES.prototype.encryptBlockRaw=function(M){M=asUInt32Array(M);return cryptBlock(M,this._keySchedule,G.SUB_MIX,G.SBOX,this._nRounds)};AES.prototype.encryptBlock=function(M){var out=this.encryptBlockRaw(M);var buf=Buffer.allocUnsafe(16);buf.writeUInt32BE(out[0],0);buf.writeUInt32BE(out[1],4);buf.writeUInt32BE(out[2],8);buf.writeUInt32BE(out[3],12);return buf};AES.prototype.decryptBlock=function(M){M=asUInt32Array(M);var m1=M[1];M[1]=M[3];M[3]=m1;var out=cryptBlock(M,this._invKeySchedule,G.INV_SUB_MIX,G.INV_SBOX,this._nRounds);var buf=Buffer.allocUnsafe(16);buf.writeUInt32BE(out[0],0);buf.writeUInt32BE(out[3],4);buf.writeUInt32BE(out[2],8);buf.writeUInt32BE(out[1],12);return buf};AES.prototype.scrub=function(){scrubVec(this._keySchedule);scrubVec(this._invKeySchedule);scrubVec(this._key)};module.exports.AES=AES},{"safe-buffer":385}],45:[function(require,module,exports){var aes=require("./aes");var Buffer=require("safe-buffer").Buffer;var Transform=require("cipher-base");var inherits=require("inherits");var GHASH=require("./ghash");var xor=require("buffer-xor");var incr32=require("./incr32");function xorTest(a,b){var out=0;if(a.length!==b.length)out++;var len=Math.min(a.length,b.length);for(var i=0;i<len;++i){out+=a[i]^b[i]}return out}function calcIv(self,iv,ck){if(iv.length===12){self._finID=Buffer.concat([iv,Buffer.from([0,0,0,1])]);return Buffer.concat([iv,Buffer.from([0,0,0,2])])}var ghash=new GHASH(ck);var len=iv.length;var toPad=len%16;ghash.update(iv);if(toPad){toPad=16-toPad;ghash.update(Buffer.alloc(toPad,0))}ghash.update(Buffer.alloc(8,0));var ivBits=len*8;var tail=Buffer.alloc(8);tail.writeUIntBE(ivBits,0,8);ghash.update(tail);self._finID=ghash.state;var out=Buffer.from(self._finID);incr32(out);return out}function StreamCipher(mode,key,iv,decrypt){Transform.call(this);var h=Buffer.alloc(4,0);this._cipher=new aes.AES(key);var ck=this._cipher.encryptBlock(h);this._ghash=new GHASH(ck);iv=calcIv(this,iv,ck);this._prev=Buffer.from(iv);this._cache=Buffer.allocUnsafe(0);this._secCache=Buffer.allocUnsafe(0);this._decrypt=decrypt;this._alen=0;this._len=0;this._mode=mode;this._authTag=null;this._called=false}inherits(StreamCipher,Transform);StreamCipher.prototype._update=function(chunk){if(!this._called&&this._alen){var rump=16-this._alen%16;if(rump<16){rump=Buffer.alloc(rump,0);this._ghash.update(rump)}}this._called=true;var out=this._mode.encrypt(this,chunk);if(this._decrypt){this._ghash.update(chunk)}else{this._ghash.update(out)}this._len+=chunk.length;return out};StreamCipher.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var tag=xor(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt&&xorTest(tag,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=tag;this._cipher.scrub()};StreamCipher.prototype.getAuthTag=function getAuthTag(){if(this._decrypt||!Buffer.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag};StreamCipher.prototype.setAuthTag=function setAuthTag(tag){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=tag};StreamCipher.prototype.setAAD=function setAAD(buf){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(buf);this._alen+=buf.length};module.exports=StreamCipher},{"./aes":44,"./ghash":49,"./incr32":50,"buffer-xor":90,"cipher-base":111,inherits:233,"safe-buffer":385}],46:[function(require,module,exports){var ciphers=require("./encrypter");var deciphers=require("./decrypter");var modes=require("./modes/list.json");function getCiphers(){return Object.keys(modes)}exports.createCipher=exports.Cipher=ciphers.createCipher;exports.createCipheriv=exports.Cipheriv=ciphers.createCipheriv;exports.createDecipher=exports.Decipher=deciphers.createDecipher;exports.createDecipheriv=exports.Decipheriv=deciphers.createDecipheriv;exports.listCiphers=exports.getCiphers=getCiphers},{"./decrypter":47,"./encrypter":48,"./modes/list.json":58}],47:[function(require,module,exports){var AuthCipher=require("./authCipher");var Buffer=require("safe-buffer").Buffer;var MODES=require("./modes");var StreamCipher=require("./streamCipher");var Transform=require("cipher-base");var aes=require("./aes");var ebtk=require("evp_bytestokey");var inherits=require("inherits");function Decipher(mode,key,iv){Transform.call(this);this._cache=new Splitter;this._last=void 0;this._cipher=new aes.AES(key);this._prev=Buffer.from(iv);this._mode=mode;this._autopadding=true}inherits(Decipher,Transform);Decipher.prototype._update=function(data){this._cache.add(data);var chunk;var thing;var out=[];while(chunk=this._cache.get(this._autopadding)){thing=this._mode.decrypt(this,chunk);out.push(thing)}return Buffer.concat(out)};Decipher.prototype._final=function(){var chunk=this._cache.flush();if(this._autopadding){return unpad(this._mode.decrypt(this,chunk))}else if(chunk){throw new Error("data not multiple of block length")}};Decipher.prototype.setAutoPadding=function(setTo){this._autopadding=!!setTo;return this};function Splitter(){this.cache=Buffer.allocUnsafe(0)}Splitter.prototype.add=function(data){this.cache=Buffer.concat([this.cache,data])};Splitter.prototype.get=function(autoPadding){var out;if(autoPadding){if(this.cache.length>16){out=this.cache.slice(0,16);this.cache=this.cache.slice(16);return out}}else{if(this.cache.length>=16){out=this.cache.slice(0,16);this.cache=this.cache.slice(16);return out}}return null};Splitter.prototype.flush=function(){if(this.cache.length)return this.cache};function unpad(last){var padded=last[15];if(padded<1||padded>16){throw new Error("unable to decrypt data")}var i=-1;while(++i<padded){if(last[i+(16-padded)]!==padded){throw new Error("unable to decrypt data")}}if(padded===16)return;return last.slice(0,16-padded)}function createDecipheriv(suite,password,iv){var config=MODES[suite.toLowerCase()];if(!config)throw new TypeError("invalid suite type");if(typeof iv==="string")iv=Buffer.from(iv);if(config.mode!=="GCM"&&iv.length!==config.iv)throw new TypeError("invalid iv length "+iv.length);if(typeof password==="string")password=Buffer.from(password);if(password.length!==config.key/8)throw new TypeError("invalid key length "+password.length);if(config.type==="stream"){return new StreamCipher(config.module,password,iv,true)}else if(config.type==="auth"){return new AuthCipher(config.module,password,iv,true)}return new Decipher(config.module,password,iv)}function createDecipher(suite,password){var config=MODES[suite.toLowerCase()];if(!config)throw new TypeError("invalid suite type");var keys=ebtk(password,false,config.key,config.iv);return createDecipheriv(suite,keys.key,keys.iv)}exports.createDecipher=createDecipher;exports.createDecipheriv=createDecipheriv},{"./aes":44,"./authCipher":45,"./modes":57,"./streamCipher":60,"cipher-base":111,evp_bytestokey:188,inherits:233,"safe-buffer":385}],48:[function(require,module,exports){var MODES=require("./modes");var AuthCipher=require("./authCipher");var Buffer=require("safe-buffer").Buffer;var StreamCipher=require("./streamCipher");var Transform=require("cipher-base");var aes=require("./aes");var ebtk=require("evp_bytestokey");var inherits=require("inherits");function Cipher(mode,key,iv){Transform.call(this);this._cache=new Splitter;this._cipher=new aes.AES(key);this._prev=Buffer.from(iv);this._mode=mode;this._autopadding=true}inherits(Cipher,Transform);Cipher.prototype._update=function(data){this._cache.add(data);var chunk;var thing;var out=[];while(chunk=this._cache.get()){thing=this._mode.encrypt(this,chunk);out.push(thing)}return Buffer.concat(out)};var PADDING=Buffer.alloc(16,16);Cipher.prototype._final=function(){var chunk=this._cache.flush();if(this._autopadding){chunk=this._mode.encrypt(this,chunk);this._cipher.scrub();return chunk}if(!chunk.equals(PADDING)){this._cipher.scrub();throw new Error("data not multiple of block length")}};Cipher.prototype.setAutoPadding=function(setTo){this._autopadding=!!setTo;return this};function Splitter(){this.cache=Buffer.allocUnsafe(0)}Splitter.prototype.add=function(data){this.cache=Buffer.concat([this.cache,data])};Splitter.prototype.get=function(){if(this.cache.length>15){var out=this.cache.slice(0,16);this.cache=this.cache.slice(16);return out}return null};Splitter.prototype.flush=function(){var len=16-this.cache.length;var padBuff=Buffer.allocUnsafe(len);var i=-1;while(++i<len){padBuff.writeUInt8(len,i)}return Buffer.concat([this.cache,padBuff])};function createCipheriv(suite,password,iv){var config=MODES[suite.toLowerCase()];if(!config)throw new TypeError("invalid suite type");if(typeof password==="string")password=Buffer.from(password);if(password.length!==config.key/8)throw new TypeError("invalid key length "+password.length);if(typeof iv==="string")iv=Buffer.from(iv);if(config.mode!=="GCM"&&iv.length!==config.iv)throw new TypeError("invalid iv length "+iv.length);if(config.type==="stream"){return new StreamCipher(config.module,password,iv)}else if(config.type==="auth"){return new AuthCipher(config.module,password,iv)}return new Cipher(config.module,password,iv)}function createCipher(suite,password){var config=MODES[suite.toLowerCase()];if(!config)throw new TypeError("invalid suite type");var keys=ebtk(password,false,config.key,config.iv);return createCipheriv(suite,keys.key,keys.iv)}exports.createCipheriv=createCipheriv;exports.createCipher=createCipher},{"./aes":44,"./authCipher":45,"./modes":57,"./streamCipher":60,"cipher-base":111,evp_bytestokey:188,inherits:233,"safe-buffer":385}],49:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;var ZEROES=Buffer.alloc(16,0);function toArray(buf){return[buf.readUInt32BE(0),buf.readUInt32BE(4),buf.readUInt32BE(8),buf.readUInt32BE(12)]}function fromArray(out){var buf=Buffer.allocUnsafe(16);buf.writeUInt32BE(out[0]>>>0,0);buf.writeUInt32BE(out[1]>>>0,4);buf.writeUInt32BE(out[2]>>>0,8);buf.writeUInt32BE(out[3]>>>0,12);return buf}function GHASH(key){this.h=key;this.state=Buffer.alloc(16,0);this.cache=Buffer.allocUnsafe(0)}GHASH.prototype.ghash=function(block){var i=-1;while(++i<block.length){this.state[i]^=block[i]}this._multiply()};GHASH.prototype._multiply=function(){var Vi=toArray(this.h);var Zi=[0,0,0,0];var j,xi,lsbVi;var i=-1;while(++i<128){xi=(this.state[~~(i/8)]&1<<7-i%8)!==0;if(xi){Zi[0]^=Vi[0];Zi[1]^=Vi[1];Zi[2]^=Vi[2];Zi[3]^=Vi[3]}lsbVi=(Vi[3]&1)!==0;for(j=3;j>0;j--){Vi[j]=Vi[j]>>>1|(Vi[j-1]&1)<<31}Vi[0]=Vi[0]>>>1;if(lsbVi){Vi[0]=Vi[0]^225<<24}}this.state=fromArray(Zi)};GHASH.prototype.update=function(buf){this.cache=Buffer.concat([this.cache,buf]);var chunk;while(this.cache.length>=16){chunk=this.cache.slice(0,16);this.cache=this.cache.slice(16);this.ghash(chunk)}};GHASH.prototype.final=function(abl,bl){if(this.cache.length){this.ghash(Buffer.concat([this.cache,ZEROES],16))}this.ghash(fromArray([0,abl,0,bl]));return this.state};module.exports=GHASH},{"safe-buffer":385}],50:[function(require,module,exports){function incr32(iv){var len=iv.length;var item;while(len--){item=iv.readUInt8(len);if(item===255){iv.writeUInt8(0,len)}else{item++;iv.writeUInt8(item,len);break}}}module.exports=incr32},{}],51:[function(require,module,exports){var xor=require("buffer-xor");exports.encrypt=function(self,block){var data=xor(block,self._prev);self._prev=self._cipher.encryptBlock(data);return self._prev};exports.decrypt=function(self,block){var pad=self._prev;self._prev=block;var out=self._cipher.decryptBlock(block);return xor(out,pad)}},{"buffer-xor":90}],52:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;var xor=require("buffer-xor");function encryptStart(self,data,decrypt){var len=data.length;var out=xor(data,self._cache);self._cache=self._cache.slice(len);self._prev=Buffer.concat([self._prev,decrypt?data:out]);return out}exports.encrypt=function(self,data,decrypt){var out=Buffer.allocUnsafe(0);var len;while(data.length){if(self._cache.length===0){self._cache=self._cipher.encryptBlock(self._prev);self._prev=Buffer.allocUnsafe(0)}if(self._cache.length<=data.length){len=self._cache.length;out=Buffer.concat([out,encryptStart(self,data.slice(0,len),decrypt)]);data=data.slice(len)}else{out=Buffer.concat([out,encryptStart(self,data,decrypt)]);break}}return out}},{"buffer-xor":90,"safe-buffer":385}],53:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;function encryptByte(self,byteParam,decrypt){var pad;var i=-1;var len=8;var out=0;var bit,value;while(++i<len){pad=self._cipher.encryptBlock(self._prev);bit=byteParam&1<<7-i?128:0;value=pad[0]^bit;out+=(value&128)>>i%8;self._prev=shiftIn(self._prev,decrypt?bit:value)}return out}function shiftIn(buffer,value){var len=buffer.length;var i=-1;var out=Buffer.allocUnsafe(buffer.length);buffer=Buffer.concat([buffer,Buffer.from([value])]);while(++i<len){out[i]=buffer[i]<<1|buffer[i+1]>>7}return out}exports.encrypt=function(self,chunk,decrypt){var len=chunk.length;var out=Buffer.allocUnsafe(len);var i=-1;while(++i<len){out[i]=encryptByte(self,chunk[i],decrypt)}return out}},{"safe-buffer":385}],54:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;function encryptByte(self,byteParam,decrypt){var pad=self._cipher.encryptBlock(self._prev);var out=pad[0]^byteParam;self._prev=Buffer.concat([self._prev.slice(1),Buffer.from([decrypt?byteParam:out])]);return out}exports.encrypt=function(self,chunk,decrypt){var len=chunk.length;var out=Buffer.allocUnsafe(len);var i=-1;while(++i<len){out[i]=encryptByte(self,chunk[i],decrypt)}return out}},{"safe-buffer":385}],55:[function(require,module,exports){var xor=require("buffer-xor");var Buffer=require("safe-buffer").Buffer;var incr32=require("../incr32");function getBlock(self){var out=self._cipher.encryptBlockRaw(self._prev);incr32(self._prev);return out}var blockSize=16;exports.encrypt=function(self,chunk){var chunkNum=Math.ceil(chunk.length/blockSize);var start=self._cache.length;self._cache=Buffer.concat([self._cache,Buffer.allocUnsafe(chunkNum*blockSize)]);for(var i=0;i<chunkNum;i++){var out=getBlock(self);var offset=start+i*blockSize;self._cache.writeUInt32BE(out[0],offset+0);self._cache.writeUInt32BE(out[1],offset+4);self._cache.writeUInt32BE(out[2],offset+8);self._cache.writeUInt32BE(out[3],offset+12)}var pad=self._cache.slice(0,chunk.length);self._cache=self._cache.slice(chunk.length);return xor(chunk,pad)}},{"../incr32":50,"buffer-xor":90,"safe-buffer":385}],56:[function(require,module,exports){exports.encrypt=function(self,block){return self._cipher.encryptBlock(block)};exports.decrypt=function(self,block){return self._cipher.decryptBlock(block)}},{}],57:[function(require,module,exports){var modeModules={ECB:require("./ecb"),CBC:require("./cbc"),CFB:require("./cfb"),CFB8:require("./cfb8"),CFB1:require("./cfb1"),OFB:require("./ofb"),CTR:require("./ctr"),GCM:require("./ctr")};var modes=require("./list.json");for(var key in modes){modes[key].module=modeModules[modes[key].mode]}module.exports=modes},{"./cbc":51,"./cfb":52,"./cfb1":53,"./cfb8":54,"./ctr":55,"./ecb":56,"./list.json":58,"./ofb":59}],58:[function(require,module,exports){module.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],59:[function(require,module,exports){(function(Buffer){(function(){var xor=require("buffer-xor");function getBlock(self){self._prev=self._cipher.encryptBlock(self._prev);return self._prev}exports.encrypt=function(self,chunk){while(self._cache.length<chunk.length){self._cache=Buffer.concat([self._cache,getBlock(self)])}var pad=self._cache.slice(0,chunk.length);self._cache=self._cache.slice(chunk.length);return xor(chunk,pad)}}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88,"buffer-xor":90}],60:[function(require,module,exports){var aes=require("./aes");var Buffer=require("safe-buffer").Buffer;var Transform=require("cipher-base");var inherits=require("inherits");function StreamCipher(mode,key,iv,decrypt){Transform.call(this);this._cipher=new aes.AES(key);this._prev=Buffer.from(iv);this._cache=Buffer.allocUnsafe(0);this._secCache=Buffer.allocUnsafe(0);this._decrypt=decrypt;this._mode=mode}inherits(StreamCipher,Transform);StreamCipher.prototype._update=function(chunk){return this._mode.encrypt(this,chunk,this._decrypt)};StreamCipher.prototype._final=function(){this._cipher.scrub()};module.exports=StreamCipher},{"./aes":44,"cipher-base":111,inherits:233,"safe-buffer":385}],61:[function(require,module,exports){var DES=require("browserify-des");var aes=require("browserify-aes/browser");var aesModes=require("browserify-aes/modes");var desModes=require("browserify-des/modes");var ebtk=require("evp_bytestokey");function createCipher(suite,password){suite=suite.toLowerCase();var keyLen,ivLen;if(aesModes[suite]){keyLen=aesModes[suite].key;ivLen=aesModes[suite].iv}else if(desModes[suite]){keyLen=desModes[suite].key*8;ivLen=desModes[suite].iv}else{throw new TypeError("invalid suite type")}var keys=ebtk(password,false,keyLen,ivLen);return createCipheriv(suite,keys.key,keys.iv)}function createDecipher(suite,password){suite=suite.toLowerCase();var keyLen,ivLen;if(aesModes[suite]){keyLen=aesModes[suite].key;ivLen=aesModes[suite].iv}else if(desModes[suite]){keyLen=desModes[suite].key*8;ivLen=desModes[suite].iv}else{throw new TypeError("invalid suite type")}var keys=ebtk(password,false,keyLen,ivLen);return createDecipheriv(suite,keys.key,keys.iv)}function createCipheriv(suite,key,iv){suite=suite.toLowerCase();if(aesModes[suite])return aes.createCipheriv(suite,key,iv);if(desModes[suite])return new DES({key:key,iv:iv,mode:suite});throw new TypeError("invalid suite type")}function createDecipheriv(suite,key,iv){suite=suite.toLowerCase();if(aesModes[suite])return aes.createDecipheriv(suite,key,iv);if(desModes[suite])return new DES({key:key,iv:iv,mode:suite,decrypt:true});throw new TypeError("invalid suite type")}function getCiphers(){return Object.keys(desModes).concat(aes.getCiphers())}exports.createCipher=exports.Cipher=createCipher;exports.createCipheriv=exports.Cipheriv=createCipheriv;exports.createDecipher=exports.Decipher=createDecipher;exports.createDecipheriv=exports.Decipheriv=createDecipheriv;exports.listCiphers=exports.getCiphers=getCiphers},{"browserify-aes/browser":46,"browserify-aes/modes":57,"browserify-des":62,"browserify-des/modes":63,evp_bytestokey:188}],62:[function(require,module,exports){var CipherBase=require("cipher-base");var des=require("des.js");var inherits=require("inherits");var Buffer=require("safe-buffer").Buffer;var modes={"des-ede3-cbc":des.CBC.instantiate(des.EDE),"des-ede3":des.EDE,"des-ede-cbc":des.CBC.instantiate(des.EDE),"des-ede":des.EDE,"des-cbc":des.CBC.instantiate(des.DES),"des-ecb":des.DES};modes.des=modes["des-cbc"];modes.des3=modes["des-ede3-cbc"];module.exports=DES;inherits(DES,CipherBase);function DES(opts){CipherBase.call(this);var modeName=opts.mode.toLowerCase();var mode=modes[modeName];var type;if(opts.decrypt){type="decrypt"}else{type="encrypt"}var key=opts.key;if(!Buffer.isBuffer(key)){key=Buffer.from(key)}if(modeName==="des-ede"||modeName==="des-ede-cbc"){key=Buffer.concat([key,key.slice(0,8)])}var iv=opts.iv;if(!Buffer.isBuffer(iv)){iv=Buffer.from(iv)}this._des=mode.create({key:key,iv:iv,type:type})}DES.prototype._update=function(data){return Buffer.from(this._des.update(data))};DES.prototype._final=function(){return Buffer.from(this._des.final())}},{"cipher-base":111,"des.js":138,inherits:233,"safe-buffer":385}],63:[function(require,module,exports){exports["des-ecb"]={key:8,iv:0};exports["des-cbc"]=exports.des={key:8,iv:8};exports["des-ede3-cbc"]=exports.des3={key:24,iv:8};exports["des-ede3"]={key:24,iv:0};exports["des-ede-cbc"]={key:16,iv:8};exports["des-ede"]={key:16,iv:0}},{}],64:[function(require,module,exports){(function(Buffer){(function(){var BN=require("bn.js");var randomBytes=require("randombytes");function blind(priv){var r=getr(priv);var blinder=r.toRed(BN.mont(priv.modulus)).redPow(new BN(priv.publicExponent)).fromRed();return{blinder:blinder,unblinder:r.invm(priv.modulus)}}function getr(priv){var len=priv.modulus.byteLength();var r;do{r=new BN(randomBytes(len))}while(r.cmp(priv.modulus)>=0||!r.umod(priv.prime1)||!r.umod(priv.prime2));return r}function crt(msg,priv){var blinds=blind(priv);var len=priv.modulus.byteLength();var blinded=new BN(msg).mul(blinds.blinder).umod(priv.modulus);var c1=blinded.toRed(BN.mont(priv.prime1));var c2=blinded.toRed(BN.mont(priv.prime2));var qinv=priv.coefficient;var p=priv.prime1;var q=priv.prime2;var m1=c1.redPow(priv.exponent1).fromRed();var m2=c2.redPow(priv.exponent2).fromRed();var h=m1.isub(m2).imul(qinv).umod(p).imul(q);return m2.iadd(h).imul(blinds.unblinder).umod(priv.modulus).toArrayLike(Buffer,"be",len)}crt.getr=getr;module.exports=crt}).call(this)}).call(this,require("buffer").Buffer)},{"bn.js":40,buffer:88,randombytes:382}],65:[function(require,module,exports){"use strict";module.exports=require("./browser/algorithms.json")},{"./browser/algorithms.json":66}],66:[function(require,module,exports){module.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],67:[function(require,module,exports){module.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],68:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer;var createHash=require("create-hash");var stream=require("readable-stream");var inherits=require("inherits");var sign=require("./sign");var verify=require("./verify");var algorithms=require("./algorithms.json");Object.keys(algorithms).forEach((function(key){algorithms[key].id=Buffer.from(algorithms[key].id,"hex");algorithms[key.toLowerCase()]=algorithms[key]}));function Sign(algorithm){stream.Writable.call(this);var data=algorithms[algorithm];if(!data){throw new Error("Unknown message digest")}this._hashType=data.hash;this._hash=createHash(data.hash);this._tag=data.id;this._signType=data.sign}inherits(Sign,stream.Writable);Sign.prototype._write=function _write(data,_,done){this._hash.update(data);done()};Sign.prototype.update=function update(data,enc){this._hash.update(typeof data==="string"?Buffer.from(data,enc):data);return this};Sign.prototype.sign=function signMethod(key,enc){this.end();var hash=this._hash.digest();var sig=sign(hash,key,this._hashType,this._signType,this._tag);return enc?sig.toString(enc):sig};function Verify(algorithm){stream.Writable.call(this);var data=algorithms[algorithm];if(!data){throw new Error("Unknown message digest")}this._hash=createHash(data.hash);this._tag=data.id;this._signType=data.sign}inherits(Verify,stream.Writable);Verify.prototype._write=function _write(data,_,done){this._hash.update(data);done()};Verify.prototype.update=function update(data,enc){this._hash.update(typeof data==="string"?Buffer.from(data,enc):data);return this};Verify.prototype.verify=function verifyMethod(key,sig,enc){var sigBuffer=typeof sig==="string"?Buffer.from(sig,enc):sig;this.end();var hash=this._hash.digest();return verify(sigBuffer,hash,key,this._signType,this._tag)};function createSign(algorithm){return new Sign(algorithm)}function createVerify(algorithm){return new Verify(algorithm)}module.exports={Sign:createSign,Verify:createVerify,createSign:createSign,createVerify:createVerify}},{"./algorithms.json":66,"./sign":69,"./verify":70,"create-hash":114,inherits:233,"readable-stream":85,"safe-buffer":385}],69:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer;var createHmac=require("create-hmac");var crt=require("browserify-rsa");var EC=require("elliptic").ec;var BN=require("bn.js");var parseKeys=require("parse-asn1");var curves=require("./curves.json");var RSA_PKCS1_PADDING=1;function sign(hash,key,hashType,signType,tag){var priv=parseKeys(key);if(priv.curve){if(signType!=="ecdsa"&&signType!=="ecdsa/rsa"){throw new Error("wrong private key type")}return ecSign(hash,priv)}else if(priv.type==="dsa"){if(signType!=="dsa"){throw new Error("wrong private key type")}return dsaSign(hash,priv,hashType)}if(signType!=="rsa"&&signType!=="ecdsa/rsa"){throw new Error("wrong private key type")}if(key.padding!==undefined&&key.padding!==RSA_PKCS1_PADDING){throw new Error("illegal or unsupported padding mode")}hash=Buffer.concat([tag,hash]);var len=priv.modulus.byteLength();var pad=[0,1];while(hash.length+pad.length+1<len){pad.push(255)}pad.push(0);var i=-1;while(++i<hash.length){pad.push(hash[i])}var out=crt(pad,priv);return out}function ecSign(hash,priv){var curveId=curves[priv.curve.join(".")];if(!curveId){throw new Error("unknown curve "+priv.curve.join("."))}var curve=new EC(curveId);var key=curve.keyFromPrivate(priv.privateKey);var out=key.sign(hash);return Buffer.from(out.toDER())}function dsaSign(hash,priv,algo){var x=priv.params.priv_key;var p=priv.params.p;var q=priv.params.q;var g=priv.params.g;var r=new BN(0);var k;var H=bits2int(hash,q).mod(q);var s=false;var kv=getKey(x,q,hash,algo);while(s===false){k=makeKey(q,kv,algo);r=makeR(g,k,p,q);s=k.invm(q).imul(H.add(x.mul(r))).mod(q);if(s.cmpn(0)===0){s=false;r=new BN(0)}}return toDER(r,s)}function toDER(r,s){r=r.toArray();s=s.toArray();if(r[0]&128){r=[0].concat(r)}if(s[0]&128){s=[0].concat(s)}var total=r.length+s.length+4;var res=[48,total,2,r.length];res=res.concat(r,[2,s.length],s);return Buffer.from(res)}function getKey(x,q,hash,algo){x=Buffer.from(x.toArray());if(x.length<q.byteLength()){var zeros=Buffer.alloc(q.byteLength()-x.length);x=Buffer.concat([zeros,x])}var hlen=hash.length;var hbits=bits2octets(hash,q);var v=Buffer.alloc(hlen);v.fill(1);var k=Buffer.alloc(hlen);k=createHmac(algo,k).update(v).update(Buffer.from([0])).update(x).update(hbits).digest();v=createHmac(algo,k).update(v).digest();k=createHmac(algo,k).update(v).update(Buffer.from([1])).update(x).update(hbits).digest();v=createHmac(algo,k).update(v).digest();return{k:k,v:v}}function bits2int(obits,q){var bits=new BN(obits);var shift=(obits.length<<3)-q.bitLength();if(shift>0){bits.ishrn(shift)}return bits}function bits2octets(bits,q){bits=bits2int(bits,q);bits=bits.mod(q);var out=Buffer.from(bits.toArray());if(out.length<q.byteLength()){var zeros=Buffer.alloc(q.byteLength()-out.length);out=Buffer.concat([zeros,out])}return out}function makeKey(q,kv,algo){var t;var k;do{t=Buffer.alloc(0);while(t.length*8<q.bitLength()){kv.v=createHmac(algo,kv.k).update(kv.v).digest();t=Buffer.concat([t,kv.v])}k=bits2int(t,q);kv.k=createHmac(algo,kv.k).update(kv.v).update(Buffer.from([0])).digest();kv.v=createHmac(algo,kv.k).update(kv.v).digest()}while(k.cmp(q)!==-1);return k}function makeR(g,k,p,q){return g.toRed(BN.mont(p)).redPow(k).fromRed().mod(q)}module.exports=sign;module.exports.getKey=getKey;module.exports.makeKey=makeKey},{"./curves.json":67,"bn.js":40,"browserify-rsa":64,"create-hmac":116,elliptic:162,"parse-asn1":352,"safe-buffer":385}],70:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer;var BN=require("bn.js");var EC=require("elliptic").ec;var parseKeys=require("parse-asn1");var curves=require("./curves.json");function verify(sig,hash,key,signType,tag){var pub=parseKeys(key);if(pub.type==="ec"){if(signType!=="ecdsa"&&signType!=="ecdsa/rsa"){throw new Error("wrong public key type")}return ecVerify(sig,hash,pub)}else if(pub.type==="dsa"){if(signType!=="dsa"){throw new Error("wrong public key type")}return dsaVerify(sig,hash,pub)}if(signType!=="rsa"&&signType!=="ecdsa/rsa"){throw new Error("wrong public key type")}hash=Buffer.concat([tag,hash]);var len=pub.modulus.byteLength();var pad=[1];var padNum=0;while(hash.length+pad.length+2<len){pad.push(255);padNum+=1}pad.push(0);var i=-1;while(++i<hash.length){pad.push(hash[i])}pad=Buffer.from(pad);var red=BN.mont(pub.modulus);sig=new BN(sig).toRed(red);sig=sig.redPow(new BN(pub.publicExponent));sig=Buffer.from(sig.fromRed().toArray());var out=padNum<8?1:0;len=Math.min(sig.length,pad.length);if(sig.length!==pad.length){out=1}i=-1;while(++i<len){out|=sig[i]^pad[i]}return out===0}function ecVerify(sig,hash,pub){var curveId=curves[pub.data.algorithm.curve.join(".")];if(!curveId){throw new Error("unknown curve "+pub.data.algorithm.curve.join("."))}var curve=new EC(curveId);var pubkey=pub.data.subjectPrivateKey.data;return curve.verify(hash,sig,pubkey)}function dsaVerify(sig,hash,pub){var p=pub.data.p;var q=pub.data.q;var g=pub.data.g;var y=pub.data.pub_key;var unpacked=parseKeys.signature.decode(sig,"der");var s=unpacked.s;var r=unpacked.r;checkValue(s,q);checkValue(r,q);var montp=BN.mont(p);var w=s.invm(q);var v=g.toRed(montp).redPow(new BN(hash).mul(w).mod(q)).fromRed().mul(y.toRed(montp).redPow(r.mul(w).mod(q)).fromRed()).mod(p).mod(q);return v.cmp(r)===0}function checkValue(b,q){if(b.cmpn(0)<=0){throw new Error("invalid sig")}if(b.cmp(q)>=0){throw new Error("invalid sig")}}module.exports=verify},{"./curves.json":67,"bn.js":40,elliptic:162,"parse-asn1":352,"safe-buffer":385}],71:[function(require,module,exports){"use strict";function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var codes={};function createErrorType(code,message,Base){if(!Base){Base=Error}function getMessage(arg1,arg2,arg3){if(typeof message==="string"){return message}else{return message(arg1,arg2,arg3)}}var NodeError=function(_Base){_inheritsLoose(NodeError,_Base);function NodeError(arg1,arg2,arg3){return _Base.call(this,getMessage(arg1,arg2,arg3))||this}return NodeError}(Base);NodeError.prototype.name=Base.name;NodeError.prototype.code=code;codes[code]=NodeError}function oneOf(expected,thing){if(Array.isArray(expected)){var len=expected.length;expected=expected.map((function(i){return String(i)}));if(len>2){return"one of ".concat(thing," ").concat(expected.slice(0,len-1).join(", "),", or ")+expected[len-1]}else if(len===2){return"one of ".concat(thing," ").concat(expected[0]," or ").concat(expected[1])}else{return"of ".concat(thing," ").concat(expected[0])}}else{return"of ".concat(thing," ").concat(String(expected))}}function startsWith(str,search,pos){return str.substr(!pos||pos<0?0:+pos,search.length)===search}function endsWith(str,search,this_len){if(this_len===undefined||this_len>str.length){this_len=str.length}return str.substring(this_len-search.length,this_len)===search}function includes(str,search,start){if(typeof start!=="number"){start=0}if(start+search.length>str.length){return false}else{return str.indexOf(search,start)!==-1}}createErrorType("ERR_INVALID_OPT_VALUE",(function(name,value){return'The value "'+value+'" is invalid for option "'+name+'"'}),TypeError);createErrorType("ERR_INVALID_ARG_TYPE",(function(name,expected,actual){var determiner;if(typeof expected==="string"&&startsWith(expected,"not ")){determiner="must not be";expected=expected.replace(/^not /,"")}else{determiner="must be"}var msg;if(endsWith(name," argument")){msg="The ".concat(name," ").concat(determiner," ").concat(oneOf(expected,"type"))}else{var type=includes(name,".")?"property":"argument";msg='The "'.concat(name,'" ').concat(type," ").concat(determiner," ").concat(oneOf(expected,"type"))}msg+=". Received type ".concat(typeof actual);return msg}),TypeError);createErrorType("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");createErrorType("ERR_METHOD_NOT_IMPLEMENTED",(function(name){return"The "+name+" method is not implemented"}));createErrorType("ERR_STREAM_PREMATURE_CLOSE","Premature close");createErrorType("ERR_STREAM_DESTROYED",(function(name){return"Cannot call "+name+" after a stream was destroyed"}));createErrorType("ERR_MULTIPLE_CALLBACK","Callback called multiple times");createErrorType("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");createErrorType("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);createErrorType("ERR_UNKNOWN_ENCODING",(function(arg){return"Unknown encoding: "+arg}),TypeError);createErrorType("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");module.exports.codes=codes},{}],72:[function(require,module,exports){(function(process){(function(){"use strict";var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var Readable=require("./_stream_readable");var Writable=require("./_stream_writable");require("inherits")(Duplex,Readable);{var keys=objectKeys(Writable.prototype);for(var v=0;v<keys.length;v++){var method=keys[v];if(!Duplex.prototype[method])Duplex.prototype[method]=Writable.prototype[method]}}function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options);Writable.call(this,options);this.allowHalfOpen=true;if(options){if(options.readable===false)this.readable=false;if(options.writable===false)this.writable=false;if(options.allowHalfOpen===false){this.allowHalfOpen=false;this.once("end",onend)}}}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});Object.defineProperty(Duplex.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Duplex.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function onend(){if(this._writableState.ended)return;process.nextTick(onEndNT,this)}function onEndNT(self){self.end()}Object.defineProperty(Duplex.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function set(value){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=value;this._writableState.destroyed=value}})}).call(this)}).call(this,require("_process"))},{"./_stream_readable":74,"./_stream_writable":76,_process:88,inherits:233}],73:[function(require,module,exports){"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform");require("inherits")(PassThrough,Transform);function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":75,inherits:233}],74:[function(require,module,exports){(function(process,global){(function(){"use strict";module.exports=Readable;var Duplex;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;var EElistenerCount=function EElistenerCount(emitter,type){return emitter.listeners(type).length};var Stream=require("./internal/streams/stream");var Buffer=require("buffer").Buffer;var OurUint8Array=(typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{}).Uint8Array||function(){};function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk)}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}var debugUtil=require("util");var debug;if(debugUtil&&debugUtil.debuglog){debug=debugUtil.debuglog("stream")}else{debug=function debug(){}}var BufferList=require("./internal/streams/buffer_list");var destroyImpl=require("./internal/streams/destroy");var _require=require("./internal/streams/state"),getHighWaterMark=_require.getHighWaterMark;var _require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_STREAM_PUSH_AFTER_EOF=_require$codes.ERR_STREAM_PUSH_AFTER_EOF,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_STREAM_UNSHIFT_AFTER_END_EVENT=_require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;var StringDecoder;var createReadableStreamAsyncIterator;var from;require("inherits")(Readable,Stream);var errorOrDestroy=destroyImpl.errorOrDestroy;var kProxyEvents=["error","close","destroy","pause","resume"];function prependListener(emitter,event,fn){if(typeof emitter.prependListener==="function")return emitter.prependListener(event,fn);if(!emitter._events||!emitter._events[event])emitter.on(event,fn);else if(Array.isArray(emitter._events[event]))emitter._events[event].unshift(fn);else emitter._events[event]=[fn,emitter._events[event]]}function ReadableState(options,stream,isDuplex){Duplex=Duplex||require("./_stream_duplex");options=options||{};if(typeof isDuplex!=="boolean")isDuplex=stream instanceof Duplex;this.objectMode=!!options.objectMode;if(isDuplex)this.objectMode=this.objectMode||!!options.readableObjectMode;this.highWaterMark=getHighWaterMark(this,options,"readableHighWaterMark",isDuplex);this.buffer=new BufferList;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.paused=true;this.emitClose=options.emitClose!==false;this.autoDestroy=!!options.autoDestroy;this.destroyed=false;this.defaultEncoding=options.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(options.encoding){if(!StringDecoder)StringDecoder=require("string_decoder/").StringDecoder;this.decoder=new StringDecoder(options.encoding);this.encoding=options.encoding}}function Readable(options){Duplex=Duplex||require("./_stream_duplex");if(!(this instanceof Readable))return new Readable(options);var isDuplex=this instanceof Duplex;this._readableState=new ReadableState(options,this,isDuplex);this.readable=true;if(options){if(typeof options.read==="function")this._read=options.read;if(typeof options.destroy==="function")this._destroy=options.destroy}Stream.call(this)}Object.defineProperty(Readable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function set(value){if(!this._readableState){return}this._readableState.destroyed=value}});Readable.prototype.destroy=destroyImpl.destroy;Readable.prototype._undestroy=destroyImpl.undestroy;Readable.prototype._destroy=function(err,cb){cb(err)};Readable.prototype.push=function(chunk,encoding){var state=this._readableState;var skipChunkCheck;if(!state.objectMode){if(typeof chunk==="string"){encoding=encoding||state.defaultEncoding;if(encoding!==state.encoding){chunk=Buffer.from(chunk,encoding);encoding=""}skipChunkCheck=true}}else{skipChunkCheck=true}return readableAddChunk(this,chunk,encoding,false,skipChunkCheck)};Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,true,false)};function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){debug("readableAddChunk",chunk);var state=stream._readableState;if(chunk===null){state.reading=false;onEofChunk(stream,state)}else{var er;if(!skipChunkCheck)er=chunkInvalid(state,chunk);if(er){errorOrDestroy(stream,er)}else if(state.objectMode||chunk&&chunk.length>0){if(typeof chunk!=="string"&&!state.objectMode&&Object.getPrototypeOf(chunk)!==Buffer.prototype){chunk=_uint8ArrayToBuffer(chunk)}if(addToFront){if(state.endEmitted)errorOrDestroy(stream,new ERR_STREAM_UNSHIFT_AFTER_END_EVENT);else addChunk(stream,state,chunk,true)}else if(state.ended){errorOrDestroy(stream,new ERR_STREAM_PUSH_AFTER_EOF)}else if(state.destroyed){return false}else{state.reading=false;if(state.decoder&&!encoding){chunk=state.decoder.write(chunk);if(state.objectMode||chunk.length!==0)addChunk(stream,state,chunk,false);else maybeReadMore(stream,state)}else{addChunk(stream,state,chunk,false)}}}else if(!addToFront){state.reading=false;maybeReadMore(stream,state)}}return!state.ended&&(state.length<state.highWaterMark||state.length===0)}function addChunk(stream,state,chunk,addToFront){if(state.flowing&&state.length===0&&!state.sync){state.awaitDrain=0;stream.emit("data",chunk)}else{state.length+=state.objectMode?1:chunk.length;if(addToFront)state.buffer.unshift(chunk);else state.buffer.push(chunk);if(state.needReadable)emitReadable(stream)}maybeReadMore(stream,state)}function chunkInvalid(state,chunk){var er;if(!_isUint8Array(chunk)&&typeof chunk!=="string"&&chunk!==undefined&&!state.objectMode){er=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer","Uint8Array"],chunk)}return er}Readable.prototype.isPaused=function(){return this._readableState.flowing===false};Readable.prototype.setEncoding=function(enc){if(!StringDecoder)StringDecoder=require("string_decoder/").StringDecoder;var decoder=new StringDecoder(enc);this._readableState.decoder=decoder;this._readableState.encoding=this._readableState.decoder.encoding;var p=this._readableState.buffer.head;var content="";while(p!==null){content+=decoder.write(p.data);p=p.next}this._readableState.buffer.clear();if(content!=="")this._readableState.buffer.push(content);this._readableState.length=content.length;return this};var MAX_HWM=1073741824;function computeNewHighWaterMark(n){if(n>=MAX_HWM){n=MAX_HWM}else{n--;n|=n>>>1;n|=n>>>2;n|=n>>>4;n|=n>>>8;n|=n>>>16;n++}return n}function howMuchToRead(n,state){if(n<=0||state.length===0&&state.ended)return 0;if(state.objectMode)return 1;if(n!==n){if(state.flowing&&state.length)return state.buffer.head.data.length;else return state.length}if(n>state.highWaterMark)state.highWaterMark=computeNewHighWaterMark(n);if(n<=state.length)return n;if(!state.ended){state.needReadable=true;return 0}return state.length}Readable.prototype.read=function(n){debug("read",n);n=parseInt(n,10);var state=this._readableState;var nOrig=n;if(n!==0)state.emittedReadable=false;if(n===0&&state.needReadable&&((state.highWaterMark!==0?state.length>=state.highWaterMark:state.length>0)||state.ended)){debug("read: emitReadable",state.length,state.ended);if(state.length===0&&state.ended)endReadable(this);else emitReadable(this);return null}n=howMuchToRead(n,state);if(n===0&&state.ended){if(state.length===0)endReadable(this);return null}var doRead=state.needReadable;debug("need readable",doRead);if(state.length===0||state.length-n<state.highWaterMark){doRead=true;debug("length less than watermark",doRead)}if(state.ended||state.reading){doRead=false;debug("reading or ended",doRead)}else if(doRead){debug("do read");state.reading=true;state.sync=true;if(state.length===0)state.needReadable=true;this._read(state.highWaterMark);state.sync=false;if(!state.reading)n=howMuchToRead(nOrig,state)}var ret;if(n>0)ret=fromList(n,state);else ret=null;if(ret===null){state.needReadable=state.length<=state.highWaterMark;n=0}else{state.length-=n;state.awaitDrain=0}if(state.length===0){if(!state.ended)state.needReadable=true;if(nOrig!==n&&state.ended)endReadable(this)}if(ret!==null)this.emit("data",ret);return ret};function onEofChunk(stream,state){debug("onEofChunk");if(state.ended)return;if(state.decoder){var chunk=state.decoder.end();if(chunk&&chunk.length){state.buffer.push(chunk);state.length+=state.objectMode?1:chunk.length}}state.ended=true;if(state.sync){emitReadable(stream)}else{state.needReadable=false;if(!state.emittedReadable){state.emittedReadable=true;emitReadable_(stream)}}}function emitReadable(stream){var state=stream._readableState;debug("emitReadable",state.needReadable,state.emittedReadable);state.needReadable=false;if(!state.emittedReadable){debug("emitReadable",state.flowing);state.emittedReadable=true;process.nextTick(emitReadable_,stream)}}function emitReadable_(stream){var state=stream._readableState;debug("emitReadable_",state.destroyed,state.length,state.ended);if(!state.destroyed&&(state.length||state.ended)){stream.emit("readable");state.emittedReadable=false}state.needReadable=!state.flowing&&!state.ended&&state.length<=state.highWaterMark;flow(stream)}function maybeReadMore(stream,state){if(!state.readingMore){state.readingMore=true;process.nextTick(maybeReadMore_,stream,state)}}function maybeReadMore_(stream,state){while(!state.reading&&!state.ended&&(state.length<state.highWaterMark||state.flowing&&state.length===0)){var len=state.length;debug("maybeReadMore read 0");stream.read(0);if(len===state.length)break}state.readingMore=false}Readable.prototype._read=function(n){errorOrDestroy(this,new ERR_METHOD_NOT_IMPLEMENTED("_read()"))};Readable.prototype.pipe=function(dest,pipeOpts){var src=this;var state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest);break}state.pipesCount+=1;debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==false)&&dest!==process.stdout&&dest!==process.stderr;var endFn=doEnd?onend:unpipe;if(state.endEmitted)process.nextTick(endFn);else src.once("end",endFn);dest.on("unpipe",onunpipe);function onunpipe(readable,unpipeInfo){debug("onunpipe");if(readable===src){if(unpipeInfo&&unpipeInfo.hasUnpiped===false){unpipeInfo.hasUnpiped=true;cleanup()}}}function onend(){debug("onend");dest.end()}var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=false;function cleanup(){debug("cleanup");dest.removeListener("close",onclose);dest.removeListener("finish",onfinish);dest.removeListener("drain",ondrain);dest.removeListener("error",onerror);dest.removeListener("unpipe",onunpipe);src.removeListener("end",onend);src.removeListener("end",unpipe);src.removeListener("data",ondata);cleanedUp=true;if(state.awaitDrain&&(!dest._writableState||dest._writableState.needDrain))ondrain()}src.on("data",ondata);function ondata(chunk){debug("ondata");var ret=dest.write(chunk);debug("dest.write",ret);if(ret===false){if((state.pipesCount===1&&state.pipes===dest||state.pipesCount>1&&indexOf(state.pipes,dest)!==-1)&&!cleanedUp){debug("false write response, pause",state.awaitDrain);state.awaitDrain++}src.pause()}}function onerror(er){debug("onerror",er);unpipe();dest.removeListener("error",onerror);if(EElistenerCount(dest,"error")===0)errorOrDestroy(dest,er)}prependListener(dest,"error",onerror);function onclose(){dest.removeListener("finish",onfinish);unpipe()}dest.once("close",onclose);function onfinish(){debug("onfinish");dest.removeListener("close",onclose);unpipe()}dest.once("finish",onfinish);function unpipe(){debug("unpipe");src.unpipe(dest)}dest.emit("pipe",src);if(!state.flowing){debug("pipe resume");src.resume()}return dest};function pipeOnDrain(src){return function pipeOnDrainFunctionResult(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain);if(state.awaitDrain)state.awaitDrain--;if(state.awaitDrain===0&&EElistenerCount(src,"data")){state.flowing=true;flow(src)}}}Readable.prototype.unpipe=function(dest){var state=this._readableState;var unpipeInfo={hasUnpiped:false};if(state.pipesCount===0)return this;if(state.pipesCount===1){if(dest&&dest!==state.pipes)return this;if(!dest)dest=state.pipes;state.pipes=null;state.pipesCount=0;state.flowing=false;if(dest)dest.emit("unpipe",this,unpipeInfo);return this}if(!dest){var dests=state.pipes;var len=state.pipesCount;state.pipes=null;state.pipesCount=0;state.flowing=false;for(var i=0;i<len;i++)dests[i].emit("unpipe",this,{hasUnpiped:false});return this}var index=indexOf(state.pipes,dest);if(index===-1)return this;state.pipes.splice(index,1);state.pipesCount-=1;if(state.pipesCount===1)state.pipes=state.pipes[0];dest.emit("unpipe",this,unpipeInfo);return this};Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);var state=this._readableState;if(ev==="data"){state.readableListening=this.listenerCount("readable")>0;if(state.flowing!==false)this.resume()}else if(ev==="readable"){if(!state.endEmitted&&!state.readableListening){state.readableListening=state.needReadable=true;state.flowing=false;state.emittedReadable=false;debug("on readable",state.length,state.reading);if(state.length){emitReadable(this)}else if(!state.reading){process.nextTick(nReadingNextTick,this)}}}return res};Readable.prototype.addListener=Readable.prototype.on;Readable.prototype.removeListener=function(ev,fn){var res=Stream.prototype.removeListener.call(this,ev,fn);if(ev==="readable"){process.nextTick(updateReadableListening,this)}return res};Readable.prototype.removeAllListeners=function(ev){var res=Stream.prototype.removeAllListeners.apply(this,arguments);if(ev==="readable"||ev===undefined){process.nextTick(updateReadableListening,this)}return res};function updateReadableListening(self){var state=self._readableState;state.readableListening=self.listenerCount("readable")>0;if(state.resumeScheduled&&!state.paused){state.flowing=true}else if(self.listenerCount("data")>0){self.resume()}}function nReadingNextTick(self){debug("readable nexttick read 0");self.read(0)}Readable.prototype.resume=function(){var state=this._readableState;if(!state.flowing){debug("resume");state.flowing=!state.readableListening;resume(this,state)}state.paused=false;return this};function resume(stream,state){if(!state.resumeScheduled){state.resumeScheduled=true;process.nextTick(resume_,stream,state)}}function resume_(stream,state){debug("resume",state.reading);if(!state.reading){stream.read(0)}state.resumeScheduled=false;stream.emit("resume");flow(stream);if(state.flowing&&!state.reading)stream.read(0)}Readable.prototype.pause=function(){debug("call pause flowing=%j",this._readableState.flowing);if(this._readableState.flowing!==false){debug("pause");this._readableState.flowing=false;this.emit("pause")}this._readableState.paused=true;return this};function flow(stream){var state=stream._readableState;debug("flow",state.flowing);while(state.flowing&&stream.read()!==null);}Readable.prototype.wrap=function(stream){var _this=this;var state=this._readableState;var paused=false;stream.on("end",(function(){debug("wrapped end");if(state.decoder&&!state.ended){var chunk=state.decoder.end();if(chunk&&chunk.length)_this.push(chunk)}_this.push(null)}));stream.on("data",(function(chunk){debug("wrapped data");if(state.decoder)chunk=state.decoder.write(chunk);if(state.objectMode&&(chunk===null||chunk===undefined))return;else if(!state.objectMode&&(!chunk||!chunk.length))return;var ret=_this.push(chunk);if(!ret){paused=true;stream.pause()}}));for(var i in stream){if(this[i]===undefined&&typeof stream[i]==="function"){this[i]=function methodWrap(method){return function methodWrapReturnFunction(){return stream[method].apply(stream,arguments)}}(i)}}for(var n=0;n<kProxyEvents.length;n++){stream.on(kProxyEvents[n],this.emit.bind(this,kProxyEvents[n]))}this._read=function(n){debug("wrapped _read",n);if(paused){paused=false;stream.resume()}};return this};if(typeof Symbol==="function"){Readable.prototype[Symbol.asyncIterator]=function(){if(createReadableStreamAsyncIterator===undefined){createReadableStreamAsyncIterator=require("./internal/streams/async_iterator")}return createReadableStreamAsyncIterator(this)}}Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:false,get:function get(){return this._readableState.highWaterMark}});Object.defineProperty(Readable.prototype,"readableBuffer",{enumerable:false,get:function get(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Readable.prototype,"readableFlowing",{enumerable:false,get:function get(){return this._readableState.flowing},set:function set(state){if(this._readableState){this._readableState.flowing=state}}});Readable._fromList=fromList;Object.defineProperty(Readable.prototype,"readableLength",{enumerable:false,get:function get(){return this._readableState.length}});function fromList(n,state){if(state.length===0)return null;var ret;if(state.objectMode)ret=state.buffer.shift();else if(!n||n>=state.length){if(state.decoder)ret=state.buffer.join("");else if(state.buffer.length===1)ret=state.buffer.first();else ret=state.buffer.concat(state.length);state.buffer.clear()}else{ret=state.buffer.consume(n,state.decoder)}return ret}function endReadable(stream){var state=stream._readableState;debug("endReadable",state.endEmitted);if(!state.endEmitted){state.ended=true;process.nextTick(endReadableNT,state,stream)}}function endReadableNT(state,stream){debug("endReadableNT",state.endEmitted,state.length);if(!state.endEmitted&&state.length===0){state.endEmitted=true;stream.readable=false;stream.emit("end");if(state.autoDestroy){var wState=stream._writableState;if(!wState||wState.autoDestroy&&wState.finished){stream.destroy()}}}}if(typeof Symbol==="function"){Readable.from=function(iterable,opts){if(from===undefined){from=require("./internal/streams/from")}return from(Readable,iterable,opts)}}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x)return i}return-1}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../errors":71,"./_stream_duplex":72,"./internal/streams/async_iterator":77,"./internal/streams/buffer_list":78,"./internal/streams/destroy":79,"./internal/streams/from":81,"./internal/streams/state":83,"./internal/streams/stream":84,_process:88,buffer:88,events:187,inherits:233,"string_decoder/":432,util:43}],75:[function(require,module,exports){"use strict";module.exports=Transform;var _require$codes=require("../errors").codes,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes.ERR_MULTIPLE_CALLBACK,ERR_TRANSFORM_ALREADY_TRANSFORMING=_require$codes.ERR_TRANSFORM_ALREADY_TRANSFORMING,ERR_TRANSFORM_WITH_LENGTH_0=_require$codes.ERR_TRANSFORM_WITH_LENGTH_0;var Duplex=require("./_stream_duplex");require("inherits")(Transform,Duplex);function afterTransform(er,data){var ts=this._transformState;ts.transforming=false;var cb=ts.writecb;if(cb===null){return this.emit("error",new ERR_MULTIPLE_CALLBACK)}ts.writechunk=null;ts.writecb=null;if(data!=null)this.push(data);cb(er);var rs=this._readableState;rs.reading=false;if(rs.needReadable||rs.length<rs.highWaterMark){this._read(rs.highWaterMark)}}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options);this._transformState={afterTransform:afterTransform.bind(this),needTransform:false,transforming:false,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=true;this._readableState.sync=false;if(options){if(typeof options.transform==="function")this._transform=options.transform;if(typeof options.flush==="function")this._flush=options.flush}this.on("prefinish",prefinish)}function prefinish(){var _this=this;if(typeof this._flush==="function"&&!this._readableState.destroyed){this._flush((function(er,data){done(_this,er,data)}))}else{done(this,null,null)}}Transform.prototype.push=function(chunk,encoding){this._transformState.needTransform=false;return Duplex.prototype.push.call(this,chunk,encoding)};Transform.prototype._transform=function(chunk,encoding,cb){cb(new ERR_METHOD_NOT_IMPLEMENTED("_transform()"))};Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;ts.writecb=cb;ts.writechunk=chunk;ts.writeencoding=encoding;if(!ts.transforming){var rs=this._readableState;if(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)this._read(rs.highWaterMark)}};Transform.prototype._read=function(n){var ts=this._transformState;if(ts.writechunk!==null&&!ts.transforming){ts.transforming=true;this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)}else{ts.needTransform=true}};Transform.prototype._destroy=function(err,cb){Duplex.prototype._destroy.call(this,err,(function(err2){cb(err2)}))};function done(stream,er,data){if(er)return stream.emit("error",er);if(data!=null)stream.push(data);if(stream._writableState.length)throw new ERR_TRANSFORM_WITH_LENGTH_0;if(stream._transformState.transforming)throw new ERR_TRANSFORM_ALREADY_TRANSFORMING;return stream.push(null)}},{"../errors":71,"./_stream_duplex":72,inherits:233}],76:[function(require,module,exports){(function(process,global){(function(){"use strict";module.exports=Writable;function WriteReq(chunk,encoding,cb){this.chunk=chunk;this.encoding=encoding;this.callback=cb;this.next=null}function CorkedRequest(state){var _this=this;this.next=null;this.entry=null;this.finish=function(){onCorkedFinish(_this,state)}}var Duplex;Writable.WritableState=WritableState;var internalUtil={deprecate:require("util-deprecate")};var Stream=require("./internal/streams/stream");var Buffer=require("buffer").Buffer;var OurUint8Array=(typeof global!=="undefined"?global:typeof window!=="undefined"?window:typeof self!=="undefined"?self:{}).Uint8Array||function(){};function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk)}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}var destroyImpl=require("./internal/streams/destroy");var _require=require("./internal/streams/state"),getHighWaterMark=_require.getHighWaterMark;var _require$codes=require("../errors").codes,ERR_INVALID_ARG_TYPE=_require$codes.ERR_INVALID_ARG_TYPE,ERR_METHOD_NOT_IMPLEMENTED=_require$codes.ERR_METHOD_NOT_IMPLEMENTED,ERR_MULTIPLE_CALLBACK=_require$codes.ERR_MULTIPLE_CALLBACK,ERR_STREAM_CANNOT_PIPE=_require$codes.ERR_STREAM_CANNOT_PIPE,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED,ERR_STREAM_NULL_VALUES=_require$codes.ERR_STREAM_NULL_VALUES,ERR_STREAM_WRITE_AFTER_END=_require$codes.ERR_STREAM_WRITE_AFTER_END,ERR_UNKNOWN_ENCODING=_require$codes.ERR_UNKNOWN_ENCODING;var errorOrDestroy=destroyImpl.errorOrDestroy;require("inherits")(Writable,Stream);function nop(){}function WritableState(options,stream,isDuplex){Duplex=Duplex||require("./_stream_duplex");options=options||{};if(typeof isDuplex!=="boolean")isDuplex=stream instanceof Duplex;this.objectMode=!!options.objectMode;if(isDuplex)this.objectMode=this.objectMode||!!options.writableObjectMode;this.highWaterMark=getHighWaterMark(this,options,"writableHighWaterMark",isDuplex);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var noDecode=options.decodeStrings===false;this.decodeStrings=!noDecode;this.defaultEncoding=options.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(er){onwrite(stream,er)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.emitClose=options.emitClose!==false;this.autoDestroy=!!options.autoDestroy;this.bufferedRequestCount=0;this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function getBuffer(){var current=this.bufferedRequest;var out=[];while(current){out.push(current);current=current.next}return out};(function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate((function writableStateBufferGetter(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(_){}})();var realHasInstance;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){realHasInstance=Function.prototype[Symbol.hasInstance];Object.defineProperty(Writable,Symbol.hasInstance,{value:function value(object){if(realHasInstance.call(this,object))return true;if(this!==Writable)return false;return object&&object._writableState instanceof WritableState}})}else{realHasInstance=function realHasInstance(object){return object instanceof this}}function Writable(options){Duplex=Duplex||require("./_stream_duplex");var isDuplex=this instanceof Duplex;if(!isDuplex&&!realHasInstance.call(Writable,this))return new Writable(options);this._writableState=new WritableState(options,this,isDuplex);this.writable=true;if(options){if(typeof options.write==="function")this._write=options.write;if(typeof options.writev==="function")this._writev=options.writev;if(typeof options.destroy==="function")this._destroy=options.destroy;if(typeof options.final==="function")this._final=options.final}Stream.call(this)}Writable.prototype.pipe=function(){errorOrDestroy(this,new ERR_STREAM_CANNOT_PIPE)};function writeAfterEnd(stream,cb){var er=new ERR_STREAM_WRITE_AFTER_END;errorOrDestroy(stream,er);process.nextTick(cb,er)}function validChunk(stream,state,chunk,cb){var er;if(chunk===null){er=new ERR_STREAM_NULL_VALUES}else if(typeof chunk!=="string"&&!state.objectMode){er=new ERR_INVALID_ARG_TYPE("chunk",["string","Buffer"],chunk)}if(er){errorOrDestroy(stream,er);process.nextTick(cb,er);return false}return true}Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState;var ret=false;var isBuf=!state.objectMode&&_isUint8Array(chunk);if(isBuf&&!Buffer.isBuffer(chunk)){chunk=_uint8ArrayToBuffer(chunk)}if(typeof encoding==="function"){cb=encoding;encoding=null}if(isBuf)encoding="buffer";else if(!encoding)encoding=state.defaultEncoding;if(typeof cb!=="function")cb=nop;if(state.ending)writeAfterEnd(this,cb);else if(isBuf||validChunk(this,state,chunk,cb)){state.pendingcb++;ret=writeOrBuffer(this,state,isBuf,chunk,encoding,cb)}return ret};Writable.prototype.cork=function(){this._writableState.corked++};Writable.prototype.uncork=function(){var state=this._writableState;if(state.corked){state.corked--;if(!state.writing&&!state.corked&&!state.bufferProcessing&&state.bufferedRequest)clearBuffer(this,state)}};Writable.prototype.setDefaultEncoding=function setDefaultEncoding(encoding){if(typeof encoding==="string")encoding=encoding.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new ERR_UNKNOWN_ENCODING(encoding);this._writableState.defaultEncoding=encoding;return this};Object.defineProperty(Writable.prototype,"writableBuffer",{enumerable:false,get:function get(){return this._writableState&&this._writableState.getBuffer()}});function decodeChunk(state,chunk,encoding){if(!state.objectMode&&state.decodeStrings!==false&&typeof chunk==="string"){chunk=Buffer.from(chunk,encoding)}return chunk}Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:false,get:function get(){return this._writableState.highWaterMark}});function writeOrBuffer(stream,state,isBuf,chunk,encoding,cb){if(!isBuf){var newChunk=decodeChunk(state,chunk,encoding);if(chunk!==newChunk){isBuf=true;encoding="buffer";chunk=newChunk}}var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(!ret)state.needDrain=true;if(state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null};if(last){last.next=state.lastBufferedRequest}else{state.bufferedRequest=state.lastBufferedRequest}state.bufferedRequestCount+=1}else{doWrite(stream,state,false,len,chunk,encoding,cb)}return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len;state.writecb=cb;state.writing=true;state.sync=true;if(state.destroyed)state.onwrite(new ERR_STREAM_DESTROYED("write"));else if(writev)stream._writev(chunk,state.onwrite);else stream._write(chunk,encoding,state.onwrite);state.sync=false}function onwriteError(stream,state,sync,er,cb){--state.pendingcb;if(sync){process.nextTick(cb,er);process.nextTick(finishMaybe,stream,state);stream._writableState.errorEmitted=true;errorOrDestroy(stream,er)}else{cb(er);stream._writableState.errorEmitted=true;errorOrDestroy(stream,er);finishMaybe(stream,state)}}function onwriteStateUpdate(state){state.writing=false;state.writecb=null;state.length-=state.writelen;state.writelen=0}function onwrite(stream,er){var state=stream._writableState;var sync=state.sync;var cb=state.writecb;if(typeof cb!=="function")throw new ERR_MULTIPLE_CALLBACK;onwriteStateUpdate(state);if(er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state)||stream.destroyed;if(!finished&&!state.corked&&!state.bufferProcessing&&state.bufferedRequest){clearBuffer(stream,state)}if(sync){process.nextTick(afterWrite,stream,state,finished,cb)}else{afterWrite(stream,state,finished,cb)}}}function afterWrite(stream,state,finished,cb){if(!finished)onwriteDrain(stream,state);state.pendingcb--;cb();finishMaybe(stream,state)}function onwriteDrain(stream,state){if(state.length===0&&state.needDrain){state.needDrain=false;stream.emit("drain")}}function clearBuffer(stream,state){state.bufferProcessing=true;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount;var buffer=new Array(l);var holder=state.corkedRequestsFree;holder.entry=entry;var count=0;var allBuffers=true;while(entry){buffer[count]=entry;if(!entry.isBuf)allBuffers=false;entry=entry.next;count+=1}buffer.allBuffers=allBuffers;doWrite(stream,state,true,state.length,buffer,"",holder.finish);state.pendingcb++;state.lastBufferedRequest=null;if(holder.next){state.corkedRequestsFree=holder.next;holder.next=null}else{state.corkedRequestsFree=new CorkedRequest(state)}state.bufferedRequestCount=0}else{while(entry){var chunk=entry.chunk;var encoding=entry.encoding;var cb=entry.callback;var len=state.objectMode?1:chunk.length;doWrite(stream,state,false,len,chunk,encoding,cb);entry=entry.next;state.bufferedRequestCount--;if(state.writing){break}}if(entry===null)state.lastBufferedRequest=null}state.bufferedRequest=entry;state.bufferProcessing=false}Writable.prototype._write=function(chunk,encoding,cb){cb(new ERR_METHOD_NOT_IMPLEMENTED("_write()"))};Writable.prototype._writev=null;Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;if(typeof chunk==="function"){cb=chunk;chunk=null;encoding=null}else if(typeof encoding==="function"){cb=encoding;encoding=null}if(chunk!==null&&chunk!==undefined)this.write(chunk,encoding);if(state.corked){state.corked=1;this.uncork()}if(!state.ending)endWritable(this,state,cb);return this};Object.defineProperty(Writable.prototype,"writableLength",{enumerable:false,get:function get(){return this._writableState.length}});function needFinish(state){return state.ending&&state.length===0&&state.bufferedRequest===null&&!state.finished&&!state.writing}function callFinal(stream,state){stream._final((function(err){state.pendingcb--;if(err){errorOrDestroy(stream,err)}state.prefinished=true;stream.emit("prefinish");finishMaybe(stream,state)}))}function prefinish(stream,state){if(!state.prefinished&&!state.finalCalled){if(typeof stream._final==="function"&&!state.destroyed){state.pendingcb++;state.finalCalled=true;process.nextTick(callFinal,stream,state)}else{state.prefinished=true;stream.emit("prefinish")}}}function finishMaybe(stream,state){var need=needFinish(state);if(need){prefinish(stream,state);if(state.pendingcb===0){state.finished=true;stream.emit("finish");if(state.autoDestroy){var rState=stream._readableState;if(!rState||rState.autoDestroy&&rState.endEmitted){stream.destroy()}}}}return need}function endWritable(stream,state,cb){state.ending=true;finishMaybe(stream,state);if(cb){if(state.finished)process.nextTick(cb);else stream.once("finish",cb)}state.ended=true;stream.writable=false}function onCorkedFinish(corkReq,state,err){var entry=corkReq.entry;corkReq.entry=null;while(entry){var cb=entry.callback;state.pendingcb--;cb(err);entry=entry.next}state.corkedRequestsFree.next=corkReq}Object.defineProperty(Writable.prototype,"destroyed",{enumerable:false,get:function get(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function set(value){if(!this._writableState){return}this._writableState.destroyed=value}});Writable.prototype.destroy=destroyImpl.destroy;Writable.prototype._undestroy=destroyImpl.undestroy;Writable.prototype._destroy=function(err,cb){cb(err)}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../errors":71,"./_stream_duplex":72,"./internal/streams/destroy":79,"./internal/streams/state":83,"./internal/streams/stream":84,_process:88,buffer:88,inherits:233,"util-deprecate":440}],77:[function(require,module,exports){(function(process){(function(){"use strict";var _Object$setPrototypeO;function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var finished=require("./end-of-stream");var kLastResolve=Symbol("lastResolve");var kLastReject=Symbol("lastReject");var kError=Symbol("error");var kEnded=Symbol("ended");var kLastPromise=Symbol("lastPromise");var kHandlePromise=Symbol("handlePromise");var kStream=Symbol("stream");function createIterResult(value,done){return{value:value,done:done}}function readAndResolve(iter){var resolve=iter[kLastResolve];if(resolve!==null){var data=iter[kStream].read();if(data!==null){iter[kLastPromise]=null;iter[kLastResolve]=null;iter[kLastReject]=null;resolve(createIterResult(data,false))}}}function onReadable(iter){process.nextTick(readAndResolve,iter)}function wrapForNext(lastPromise,iter){return function(resolve,reject){lastPromise.then((function(){if(iter[kEnded]){resolve(createIterResult(undefined,true));return}iter[kHandlePromise](resolve,reject)}),reject)}}var AsyncIteratorPrototype=Object.getPrototypeOf((function(){}));var ReadableStreamAsyncIteratorPrototype=Object.setPrototypeOf((_Object$setPrototypeO={get stream(){return this[kStream]},next:function next(){var _this=this;var error=this[kError];if(error!==null){return Promise.reject(error)}if(this[kEnded]){return Promise.resolve(createIterResult(undefined,true))}if(this[kStream].destroyed){return new Promise((function(resolve,reject){process.nextTick((function(){if(_this[kError]){reject(_this[kError])}else{resolve(createIterResult(undefined,true))}}))}))}var lastPromise=this[kLastPromise];var promise;if(lastPromise){promise=new Promise(wrapForNext(lastPromise,this))}else{var data=this[kStream].read();if(data!==null){return Promise.resolve(createIterResult(data,false))}promise=new Promise(this[kHandlePromise])}this[kLastPromise]=promise;return promise}},_defineProperty(_Object$setPrototypeO,Symbol.asyncIterator,(function(){return this})),_defineProperty(_Object$setPrototypeO,"return",(function _return(){var _this2=this;return new Promise((function(resolve,reject){_this2[kStream].destroy(null,(function(err){if(err){reject(err);return}resolve(createIterResult(undefined,true))}))}))})),_Object$setPrototypeO),AsyncIteratorPrototype);var createReadableStreamAsyncIterator=function createReadableStreamAsyncIterator(stream){var _Object$create;var iterator=Object.create(ReadableStreamAsyncIteratorPrototype,(_Object$create={},_defineProperty(_Object$create,kStream,{value:stream,writable:true}),_defineProperty(_Object$create,kLastResolve,{value:null,writable:true}),_defineProperty(_Object$create,kLastReject,{value:null,writable:true}),_defineProperty(_Object$create,kError,{value:null,writable:true}),_defineProperty(_Object$create,kEnded,{value:stream._readableState.endEmitted,writable:true}),_defineProperty(_Object$create,kHandlePromise,{value:function value(resolve,reject){var data=iterator[kStream].read();if(data){iterator[kLastPromise]=null;iterator[kLastResolve]=null;iterator[kLastReject]=null;resolve(createIterResult(data,false))}else{iterator[kLastResolve]=resolve;iterator[kLastReject]=reject}},writable:true}),_Object$create));iterator[kLastPromise]=null;finished(stream,(function(err){if(err&&err.code!=="ERR_STREAM_PREMATURE_CLOSE"){var reject=iterator[kLastReject];if(reject!==null){iterator[kLastPromise]=null;iterator[kLastResolve]=null;iterator[kLastReject]=null;reject(err)}iterator[kError]=err;return}var resolve=iterator[kLastResolve];if(resolve!==null){iterator[kLastPromise]=null;iterator[kLastResolve]=null;iterator[kLastReject]=null;resolve(createIterResult(undefined,true))}iterator[kEnded]=true}));stream.on("readable",onReadable.bind(null,iterator));return iterator};module.exports=createReadableStreamAsyncIterator}).call(this)}).call(this,require("_process"))},{"./end-of-stream":80,_process:88}],78:[function(require,module,exports){"use strict";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return typeof key==="symbol"?key:String(key)}function _toPrimitive(input,hint){if(typeof input!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(typeof res!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return(hint==="string"?String:Number)(input)}var _require=require("buffer"),Buffer=_require.Buffer;var _require2=require("util"),inspect=_require2.inspect;var custom=inspect&&inspect.custom||"inspect";function copyBuffer(src,target,offset){Buffer.prototype.copy.call(src,target,offset)}module.exports=function(){function BufferList(){_classCallCheck(this,BufferList);this.head=null;this.tail=null;this.length=0}_createClass(BufferList,[{key:"push",value:function push(v){var entry={data:v,next:null};if(this.length>0)this.tail.next=entry;else this.head=entry;this.tail=entry;++this.length}},{key:"unshift",value:function unshift(v){var entry={data:v,next:this.head};if(this.length===0)this.tail=entry;this.head=entry;++this.length}},{key:"shift",value:function shift(){if(this.length===0)return;var ret=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return ret}},{key:"clear",value:function clear(){this.head=this.tail=null;this.length=0}},{key:"join",value:function join(s){if(this.length===0)return"";var p=this.head;var ret=""+p.data;while(p=p.next)ret+=s+p.data;return ret}},{key:"concat",value:function concat(n){if(this.length===0)return Buffer.alloc(0);var ret=Buffer.allocUnsafe(n>>>0);var p=this.head;var i=0;while(p){copyBuffer(p.data,ret,i);i+=p.data.length;p=p.next}return ret}},{key:"consume",value:function consume(n,hasStrings){var ret;if(n<this.head.data.length){ret=this.head.data.slice(0,n);this.head.data=this.head.data.slice(n)}else if(n===this.head.data.length){ret=this.shift()}else{ret=hasStrings?this._getString(n):this._getBuffer(n)}return ret}},{key:"first",value:function first(){return this.head.data}},{key:"_getString",value:function _getString(n){var p=this.head;var c=1;var ret=p.data;n-=ret.length;while(p=p.next){var str=p.data;var nb=n>str.length?str.length:n;if(nb===str.length)ret+=str;else ret+=str.slice(0,n);n-=nb;if(n===0){if(nb===str.length){++c;if(p.next)this.head=p.next;else this.head=this.tail=null}else{this.head=p;p.data=str.slice(nb)}break}++c}this.length-=c;return ret}},{key:"_getBuffer",value:function _getBuffer(n){var ret=Buffer.allocUnsafe(n);var p=this.head;var c=1;p.data.copy(ret);n-=p.data.length;while(p=p.next){var buf=p.data;var nb=n>buf.length?buf.length:n;buf.copy(ret,ret.length-n,0,nb);n-=nb;if(n===0){if(nb===buf.length){++c;if(p.next)this.head=p.next;else this.head=this.tail=null}else{this.head=p;p.data=buf.slice(nb)}break}++c}this.length-=c;return ret}},{key:custom,value:function value(_,options){return inspect(this,_objectSpread(_objectSpread({},options),{},{depth:0,customInspect:false}))}}]);return BufferList}()},{buffer:88,util:43}],79:[function(require,module,exports){(function(process){(function(){"use strict";function destroy(err,cb){var _this=this;var readableDestroyed=this._readableState&&this._readableState.destroyed;var writableDestroyed=this._writableState&&this._writableState.destroyed;if(readableDestroyed||writableDestroyed){if(cb){cb(err)}else if(err){if(!this._writableState){process.nextTick(emitErrorNT,this,err)}else if(!this._writableState.errorEmitted){this._writableState.errorEmitted=true;process.nextTick(emitErrorNT,this,err)}}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(err||null,(function(err){if(!cb&&err){if(!_this._writableState){process.nextTick(emitErrorAndCloseNT,_this,err)}else if(!_this._writableState.errorEmitted){_this._writableState.errorEmitted=true;process.nextTick(emitErrorAndCloseNT,_this,err)}else{process.nextTick(emitCloseNT,_this)}}else if(cb){process.nextTick(emitCloseNT,_this);cb(err)}else{process.nextTick(emitCloseNT,_this)}}));return this}function emitErrorAndCloseNT(self,err){emitErrorNT(self,err);emitCloseNT(self)}function emitCloseNT(self){if(self._writableState&&!self._writableState.emitClose)return;if(self._readableState&&!self._readableState.emitClose)return;self.emit("close")}function undestroy(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finalCalled=false;this._writableState.prefinished=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function emitErrorNT(self,err){self.emit("error",err)}function errorOrDestroy(stream,err){var rState=stream._readableState;var wState=stream._writableState;if(rState&&rState.autoDestroy||wState&&wState.autoDestroy)stream.destroy(err);else stream.emit("error",err)}module.exports={destroy:destroy,undestroy:undestroy,errorOrDestroy:errorOrDestroy}}).call(this)}).call(this,require("_process"))},{_process:88}],80:[function(require,module,exports){"use strict";var ERR_STREAM_PREMATURE_CLOSE=require("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function once(callback){var called=false;return function(){if(called)return;called=true;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}callback.apply(this,args)}}function noop(){}function isRequest(stream){return stream.setHeader&&typeof stream.abort==="function"}function eos(stream,opts,callback){if(typeof opts==="function")return eos(stream,null,opts);if(!opts)opts={};callback=once(callback||noop);var readable=opts.readable||opts.readable!==false&&stream.readable;var writable=opts.writable||opts.writable!==false&&stream.writable;var onlegacyfinish=function onlegacyfinish(){if(!stream.writable)onfinish()};var writableEnded=stream._writableState&&stream._writableState.finished;var onfinish=function onfinish(){writable=false;writableEnded=true;if(!readable)callback.call(stream)};var readableEnded=stream._readableState&&stream._readableState.endEmitted;var onend=function onend(){readable=false;readableEnded=true;if(!writable)callback.call(stream)};var onerror=function onerror(err){callback.call(stream,err)};var onclose=function onclose(){var err;if(readable&&!readableEnded){if(!stream._readableState||!stream._readableState.ended)err=new ERR_STREAM_PREMATURE_CLOSE;return callback.call(stream,err)}if(writable&&!writableEnded){if(!stream._writableState||!stream._writableState.ended)err=new ERR_STREAM_PREMATURE_CLOSE;return callback.call(stream,err)}};var onrequest=function onrequest(){stream.req.on("finish",onfinish)};if(isRequest(stream)){stream.on("complete",onfinish);stream.on("abort",onclose);if(stream.req)onrequest();else stream.on("request",onrequest)}else if(writable&&!stream._writableState){stream.on("end",onlegacyfinish);stream.on("close",onlegacyfinish)}stream.on("end",onend);stream.on("finish",onfinish);if(opts.error!==false)stream.on("error",onerror);stream.on("close",onclose);return function(){stream.removeListener("complete",onfinish);stream.removeListener("abort",onclose);stream.removeListener("request",onrequest);if(stream.req)stream.req.removeListener("finish",onfinish);stream.removeListener("end",onlegacyfinish);stream.removeListener("close",onlegacyfinish);stream.removeListener("finish",onfinish);stream.removeListener("end",onend);stream.removeListener("error",onerror);stream.removeListener("close",onclose)}}module.exports=eos},{"../../../errors":71}],81:[function(require,module,exports){module.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],82:[function(require,module,exports){"use strict";var eos;function once(callback){var called=false;return function(){if(called)return;called=true;callback.apply(void 0,arguments)}}var _require$codes=require("../../../errors").codes,ERR_MISSING_ARGS=_require$codes.ERR_MISSING_ARGS,ERR_STREAM_DESTROYED=_require$codes.ERR_STREAM_DESTROYED;function noop(err){if(err)throw err}function isRequest(stream){return stream.setHeader&&typeof stream.abort==="function"}function destroyer(stream,reading,writing,callback){callback=once(callback);var closed=false;stream.on("close",(function(){closed=true}));if(eos===undefined)eos=require("./end-of-stream");eos(stream,{readable:reading,writable:writing},(function(err){if(err)return callback(err);closed=true;callback()}));var destroyed=false;return function(err){if(closed)return;if(destroyed)return;destroyed=true;if(isRequest(stream))return stream.abort();if(typeof stream.destroy==="function")return stream.destroy();callback(err||new ERR_STREAM_DESTROYED("pipe"))}}function call(fn){fn()}function pipe(from,to){return from.pipe(to)}function popCallback(streams){if(!streams.length)return noop;if(typeof streams[streams.length-1]!=="function")return noop;return streams.pop()}function pipeline(){for(var _len=arguments.length,streams=new Array(_len),_key=0;_key<_len;_key++){streams[_key]=arguments[_key]}var callback=popCallback(streams);if(Array.isArray(streams[0]))streams=streams[0];if(streams.length<2){throw new ERR_MISSING_ARGS("streams")}var error;var destroys=streams.map((function(stream,i){var reading=i<streams.length-1;var writing=i>0;return destroyer(stream,reading,writing,(function(err){if(!error)error=err;if(err)destroys.forEach(call);if(reading)return;destroys.forEach(call);callback(error)}))}));return streams.reduce(pipe)}module.exports=pipeline},{"../../../errors":71,"./end-of-stream":80}],83:[function(require,module,exports){"use strict";var ERR_INVALID_OPT_VALUE=require("../../../errors").codes.ERR_INVALID_OPT_VALUE;function highWaterMarkFrom(options,isDuplex,duplexKey){return options.highWaterMark!=null?options.highWaterMark:isDuplex?options[duplexKey]:null}function getHighWaterMark(state,options,duplexKey,isDuplex){var hwm=highWaterMarkFrom(options,isDuplex,duplexKey);if(hwm!=null){if(!(isFinite(hwm)&&Math.floor(hwm)===hwm)||hwm<0){var name=isDuplex?duplexKey:"highWaterMark";throw new ERR_INVALID_OPT_VALUE(name,hwm)}return Math.floor(hwm)}return state.objectMode?16:16*1024}module.exports={getHighWaterMark:getHighWaterMark}},{"../../../errors":71}],84:[function(require,module,exports){module.exports=require("events").EventEmitter},{events:187}],85:[function(require,module,exports){exports=module.exports=require("./lib/_stream_readable.js");exports.Stream=exports;exports.Readable=exports;exports.Writable=require("./lib/_stream_writable.js");exports.Duplex=require("./lib/_stream_duplex.js");exports.Transform=require("./lib/_stream_transform.js");exports.PassThrough=require("./lib/_stream_passthrough.js");exports.finished=require("./lib/internal/streams/end-of-stream.js");exports.pipeline=require("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":72,"./lib/_stream_passthrough.js":73,"./lib/_stream_readable.js":74,"./lib/_stream_transform.js":75,"./lib/_stream_writable.js":76,"./lib/internal/streams/end-of-stream.js":80,"./lib/internal/streams/pipeline.js":82}],86:[function(require,module,exports){(function(process,Buffer){(function(){"use strict";var assert=require("assert");var Zstream=require("pako/lib/zlib/zstream");var zlib_deflate=require("pako/lib/zlib/deflate.js");var zlib_inflate=require("pako/lib/zlib/inflate.js");var constants=require("pako/lib/zlib/constants");for(var key in constants){exports[key]=constants[key]}exports.NONE=0;exports.DEFLATE=1;exports.INFLATE=2;exports.GZIP=3;exports.GUNZIP=4;exports.DEFLATERAW=5;exports.INFLATERAW=6;exports.UNZIP=7;var GZIP_HEADER_ID1=31;var GZIP_HEADER_ID2=139;function Zlib(mode){if(typeof mode!=="number"||mode<exports.DEFLATE||mode>exports.UNZIP){throw new TypeError("Bad argument")}this.dictionary=null;this.err=0;this.flush=0;this.init_done=false;this.level=0;this.memLevel=0;this.mode=mode;this.strategy=0;this.windowBits=0;this.write_in_progress=false;this.pending_close=false;this.gzip_id_bytes_read=0}Zlib.prototype.close=function(){if(this.write_in_progress){this.pending_close=true;return}this.pending_close=false;assert(this.init_done,"close before init");assert(this.mode<=exports.UNZIP);if(this.mode===exports.DEFLATE||this.mode===exports.GZIP||this.mode===exports.DEFLATERAW){zlib_deflate.deflateEnd(this.strm)}else if(this.mode===exports.INFLATE||this.mode===exports.GUNZIP||this.mode===exports.INFLATERAW||this.mode===exports.UNZIP){zlib_inflate.inflateEnd(this.strm)}this.mode=exports.NONE;this.dictionary=null};Zlib.prototype.write=function(flush,input,in_off,in_len,out,out_off,out_len){return this._write(true,flush,input,in_off,in_len,out,out_off,out_len)};Zlib.prototype.writeSync=function(flush,input,in_off,in_len,out,out_off,out_len){return this._write(false,flush,input,in_off,in_len,out,out_off,out_len)};Zlib.prototype._write=function(async,flush,input,in_off,in_len,out,out_off,out_len){assert.equal(arguments.length,8);assert(this.init_done,"write before init");assert(this.mode!==exports.NONE,"already finalized");assert.equal(false,this.write_in_progress,"write already in progress");assert.equal(false,this.pending_close,"close is pending");this.write_in_progress=true;assert.equal(false,flush===undefined,"must provide flush value");this.write_in_progress=true;if(flush!==exports.Z_NO_FLUSH&&flush!==exports.Z_PARTIAL_FLUSH&&flush!==exports.Z_SYNC_FLUSH&&flush!==exports.Z_FULL_FLUSH&&flush!==exports.Z_FINISH&&flush!==exports.Z_BLOCK){throw new Error("Invalid flush value")}if(input==null){input=Buffer.alloc(0);in_len=0;in_off=0}this.strm.avail_in=in_len;this.strm.input=input;this.strm.next_in=in_off;this.strm.avail_out=out_len;this.strm.output=out;this.strm.next_out=out_off;this.flush=flush;if(!async){this._process();if(this._checkError()){return this._afterSync()}return}var self=this;process.nextTick((function(){self._process();self._after()}));return this};Zlib.prototype._afterSync=function(){var avail_out=this.strm.avail_out;var avail_in=this.strm.avail_in;this.write_in_progress=false;return[avail_in,avail_out]};Zlib.prototype._process=function(){var next_expected_header_byte=null;switch(this.mode){case exports.DEFLATE:case exports.GZIP:case exports.DEFLATERAW:this.err=zlib_deflate.deflate(this.strm,this.flush);break;case exports.UNZIP:if(this.strm.avail_in>0){next_expected_header_byte=this.strm.next_in}switch(this.gzip_id_bytes_read){case 0:if(next_expected_header_byte===null){break}if(this.strm.input[next_expected_header_byte]===GZIP_HEADER_ID1){this.gzip_id_bytes_read=1;next_expected_header_byte++;if(this.strm.avail_in===1){break}}else{this.mode=exports.INFLATE;break}case 1:if(next_expected_header_byte===null){break}if(this.strm.input[next_expected_header_byte]===GZIP_HEADER_ID2){this.gzip_id_bytes_read=2;this.mode=exports.GUNZIP}else{this.mode=exports.INFLATE}break;default:throw new Error("invalid number of gzip magic number bytes read")}case exports.INFLATE:case exports.GUNZIP:case exports.INFLATERAW:this.err=zlib_inflate.inflate(this.strm,this.flush);if(this.err===exports.Z_NEED_DICT&&this.dictionary){this.err=zlib_inflate.inflateSetDictionary(this.strm,this.dictionary);if(this.err===exports.Z_OK){this.err=zlib_inflate.inflate(this.strm,this.flush)}else if(this.err===exports.Z_DATA_ERROR){this.err=exports.Z_NEED_DICT}}while(this.strm.avail_in>0&&this.mode===exports.GUNZIP&&this.err===exports.Z_STREAM_END&&this.strm.next_in[0]!==0){this.reset();this.err=zlib_inflate.inflate(this.strm,this.flush)}break;default:throw new Error("Unknown mode "+this.mode)}};Zlib.prototype._checkError=function(){switch(this.err){case exports.Z_OK:case exports.Z_BUF_ERROR:if(this.strm.avail_out!==0&&this.flush===exports.Z_FINISH){this._error("unexpected end of file");return false}break;case exports.Z_STREAM_END:break;case exports.Z_NEED_DICT:if(this.dictionary==null){this._error("Missing dictionary")}else{this._error("Bad dictionary")}return false;default:this._error("Zlib error");return false}return true};Zlib.prototype._after=function(){if(!this._checkError()){return}var avail_out=this.strm.avail_out;var avail_in=this.strm.avail_in;this.write_in_progress=false;this.callback(avail_in,avail_out);if(this.pending_close){this.close()}};Zlib.prototype._error=function(message){if(this.strm.msg){message=this.strm.msg}this.onerror(message,this.err);this.write_in_progress=false;if(this.pending_close){this.close()}};Zlib.prototype.init=function(windowBits,level,memLevel,strategy,dictionary){assert(arguments.length===4||arguments.length===5,"init(windowBits, level, memLevel, strategy, [dictionary])");assert(windowBits>=8&&windowBits<=15,"invalid windowBits");assert(level>=-1&&level<=9,"invalid compression level");assert(memLevel>=1&&memLevel<=9,"invalid memlevel");assert(strategy===exports.Z_FILTERED||strategy===exports.Z_HUFFMAN_ONLY||strategy===exports.Z_RLE||strategy===exports.Z_FIXED||strategy===exports.Z_DEFAULT_STRATEGY,"invalid strategy");this._init(level,windowBits,memLevel,strategy,dictionary);this._setDictionary()};Zlib.prototype.params=function(){throw new Error("deflateParams Not supported")};Zlib.prototype.reset=function(){this._reset();this._setDictionary()};Zlib.prototype._init=function(level,windowBits,memLevel,strategy,dictionary){this.level=level;this.windowBits=windowBits;this.memLevel=memLevel;this.strategy=strategy;this.flush=exports.Z_NO_FLUSH;this.err=exports.Z_OK;if(this.mode===exports.GZIP||this.mode===exports.GUNZIP){this.windowBits+=16}if(this.mode===exports.UNZIP){this.windowBits+=32}if(this.mode===exports.DEFLATERAW||this.mode===exports.INFLATERAW){this.windowBits=-1*this.windowBits}this.strm=new Zstream;switch(this.mode){case exports.DEFLATE:case exports.GZIP:case exports.DEFLATERAW:this.err=zlib_deflate.deflateInit2(this.strm,this.level,exports.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case exports.INFLATE:case exports.GUNZIP:case exports.INFLATERAW:case exports.UNZIP:this.err=zlib_inflate.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}if(this.err!==exports.Z_OK){this._error("Init error")}this.dictionary=dictionary;this.write_in_progress=false;this.init_done=true};Zlib.prototype._setDictionary=function(){if(this.dictionary==null){return}this.err=exports.Z_OK;switch(this.mode){case exports.DEFLATE:case exports.DEFLATERAW:this.err=zlib_deflate.deflateSetDictionary(this.strm,this.dictionary);break;default:break}if(this.err!==exports.Z_OK){this._error("Failed to set dictionary")}};Zlib.prototype._reset=function(){this.err=exports.Z_OK;switch(this.mode){case exports.DEFLATE:case exports.DEFLATERAW:case exports.GZIP:this.err=zlib_deflate.deflateReset(this.strm);break;case exports.INFLATE:case exports.INFLATERAW:case exports.GUNZIP:this.err=zlib_inflate.inflateReset(this.strm);break;default:break}if(this.err!==exports.Z_OK){this._error("Failed to reset stream")}};exports.Zlib=Zlib}).call(this)}).call(this,require("_process"),require("buffer").Buffer)},{_process:88,assert:35,buffer:88,"pako/lib/zlib/constants":339,"pako/lib/zlib/deflate.js":341,"pako/lib/zlib/inflate.js":343,"pako/lib/zlib/zstream":347}],87:[function(require,module,exports){(function(process){(function(){"use strict";var Buffer=require("buffer").Buffer;var Transform=require("stream").Transform;var binding=require("./binding");var util=require("util");var assert=require("assert").ok;var kMaxLength=require("buffer").kMaxLength;var kRangeErrorMessage="Cannot create final Buffer. It would be larger "+"than 0x"+kMaxLength.toString(16)+" bytes";binding.Z_MIN_WINDOWBITS=8;binding.Z_MAX_WINDOWBITS=15;binding.Z_DEFAULT_WINDOWBITS=15;binding.Z_MIN_CHUNK=64;binding.Z_MAX_CHUNK=Infinity;binding.Z_DEFAULT_CHUNK=16*1024;binding.Z_MIN_MEMLEVEL=1;binding.Z_MAX_MEMLEVEL=9;binding.Z_DEFAULT_MEMLEVEL=8;binding.Z_MIN_LEVEL=-1;binding.Z_MAX_LEVEL=9;binding.Z_DEFAULT_LEVEL=binding.Z_DEFAULT_COMPRESSION;var bkeys=Object.keys(binding);for(var bk=0;bk<bkeys.length;bk++){var bkey=bkeys[bk];if(bkey.match(/^Z/)){Object.defineProperty(exports,bkey,{enumerable:true,value:binding[bkey],writable:false})}}var codes={Z_OK:binding.Z_OK,Z_STREAM_END:binding.Z_STREAM_END,Z_NEED_DICT:binding.Z_NEED_DICT,Z_ERRNO:binding.Z_ERRNO,Z_STREAM_ERROR:binding.Z_STREAM_ERROR,Z_DATA_ERROR:binding.Z_DATA_ERROR,Z_MEM_ERROR:binding.Z_MEM_ERROR,Z_BUF_ERROR:binding.Z_BUF_ERROR,Z_VERSION_ERROR:binding.Z_VERSION_ERROR};var ckeys=Object.keys(codes);for(var ck=0;ck<ckeys.length;ck++){var ckey=ckeys[ck];codes[codes[ckey]]=ckey}Object.defineProperty(exports,"codes",{enumerable:true,value:Object.freeze(codes),writable:false});exports.Deflate=Deflate;exports.Inflate=Inflate;exports.Gzip=Gzip;exports.Gunzip=Gunzip;exports.DeflateRaw=DeflateRaw;exports.InflateRaw=InflateRaw;exports.Unzip=Unzip;exports.createDeflate=function(o){return new Deflate(o)};exports.createInflate=function(o){return new Inflate(o)};exports.createDeflateRaw=function(o){return new DeflateRaw(o)};exports.createInflateRaw=function(o){return new InflateRaw(o)};exports.createGzip=function(o){return new Gzip(o)};exports.createGunzip=function(o){return new Gunzip(o)};exports.createUnzip=function(o){return new Unzip(o)};exports.deflate=function(buffer,opts,callback){if(typeof opts==="function"){callback=opts;opts={}}return zlibBuffer(new Deflate(opts),buffer,callback)};exports.deflateSync=function(buffer,opts){return zlibBufferSync(new Deflate(opts),buffer)};exports.gzip=function(buffer,opts,callback){if(typeof opts==="function"){callback=opts;opts={}}return zlibBuffer(new Gzip(opts),buffer,callback)};exports.gzipSync=function(buffer,opts){return zlibBufferSync(new Gzip(opts),buffer)};exports.deflateRaw=function(buffer,opts,callback){if(typeof opts==="function"){callback=opts;opts={}}return zlibBuffer(new DeflateRaw(opts),buffer,callback)};exports.deflateRawSync=function(buffer,opts){return zlibBufferSync(new DeflateRaw(opts),buffer)};exports.unzip=function(buffer,opts,callback){if(typeof opts==="function"){callback=opts;opts={}}return zlibBuffer(new Unzip(opts),buffer,callback)};exports.unzipSync=function(buffer,opts){return zlibBufferSync(new Unzip(opts),buffer)};exports.inflate=function(buffer,opts,callback){if(typeof opts==="function"){callback=opts;opts={}}return zlibBuffer(new Inflate(opts),buffer,callback)};exports.inflateSync=function(buffer,opts){return zlibBufferSync(new Inflate(opts),buffer)};exports.gunzip=function(buffer,opts,callback){if(typeof opts==="function"){callback=opts;opts={}}return zlibBuffer(new Gunzip(opts),buffer,callback)};exports.gunzipSync=function(buffer,opts){return zlibBufferSync(new Gunzip(opts),buffer)};exports.inflateRaw=function(buffer,opts,callback){if(typeof opts==="function"){callback=opts;opts={}}return zlibBuffer(new InflateRaw(opts),buffer,callback)};exports.inflateRawSync=function(buffer,opts){return zlibBufferSync(new InflateRaw(opts),buffer)};function zlibBuffer(engine,buffer,callback){var buffers=[];var nread=0;engine.on("error",onError);engine.on("end",onEnd);engine.end(buffer);flow();function flow(){var chunk;while(null!==(chunk=engine.read())){buffers.push(chunk);nread+=chunk.length}engine.once("readable",flow)}function onError(err){engine.removeListener("end",onEnd);engine.removeListener("readable",flow);callback(err)}function onEnd(){var buf;var err=null;if(nread>=kMaxLength){err=new RangeError(kRangeErrorMessage)}else{buf=Buffer.concat(buffers,nread)}buffers=[];engine.close();callback(err,buf)}}function zlibBufferSync(engine,buffer){if(typeof buffer==="string")buffer=Buffer.from(buffer);if(!Buffer.isBuffer(buffer))throw new TypeError("Not a string or buffer");var flushFlag=engine._finishFlushFlag;return engine._processChunk(buffer,flushFlag)}function Deflate(opts){if(!(this instanceof Deflate))return new Deflate(opts);Zlib.call(this,opts,binding.DEFLATE)}function Inflate(opts){if(!(this instanceof Inflate))return new Inflate(opts);Zlib.call(this,opts,binding.INFLATE)}function Gzip(opts){if(!(this instanceof Gzip))return new Gzip(opts);Zlib.call(this,opts,binding.GZIP)}function Gunzip(opts){if(!(this instanceof Gunzip))return new Gunzip(opts);Zlib.call(this,opts,binding.GUNZIP)}function DeflateRaw(opts){if(!(this instanceof DeflateRaw))return new DeflateRaw(opts);Zlib.call(this,opts,binding.DEFLATERAW)}function InflateRaw(opts){if(!(this instanceof InflateRaw))return new InflateRaw(opts);Zlib.call(this,opts,binding.INFLATERAW)}function Unzip(opts){if(!(this instanceof Unzip))return new Unzip(opts);Zlib.call(this,opts,binding.UNZIP)}function isValidFlushFlag(flag){return flag===binding.Z_NO_FLUSH||flag===binding.Z_PARTIAL_FLUSH||flag===binding.Z_SYNC_FLUSH||flag===binding.Z_FULL_FLUSH||flag===binding.Z_FINISH||flag===binding.Z_BLOCK}function Zlib(opts,mode){var _this=this;this._opts=opts=opts||{};this._chunkSize=opts.chunkSize||exports.Z_DEFAULT_CHUNK;Transform.call(this,opts);if(opts.flush&&!isValidFlushFlag(opts.flush)){throw new Error("Invalid flush flag: "+opts.flush)}if(opts.finishFlush&&!isValidFlushFlag(opts.finishFlush)){throw new Error("Invalid flush flag: "+opts.finishFlush)}this._flushFlag=opts.flush||binding.Z_NO_FLUSH;this._finishFlushFlag=typeof opts.finishFlush!=="undefined"?opts.finishFlush:binding.Z_FINISH;if(opts.chunkSize){if(opts.chunkSize<exports.Z_MIN_CHUNK||opts.chunkSize>exports.Z_MAX_CHUNK){throw new Error("Invalid chunk size: "+opts.chunkSize)}}if(opts.windowBits){if(opts.windowBits<exports.Z_MIN_WINDOWBITS||opts.windowBits>exports.Z_MAX_WINDOWBITS){throw new Error("Invalid windowBits: "+opts.windowBits)}}if(opts.level){if(opts.level<exports.Z_MIN_LEVEL||opts.level>exports.Z_MAX_LEVEL){throw new Error("Invalid compression level: "+opts.level)}}if(opts.memLevel){if(opts.memLevel<exports.Z_MIN_MEMLEVEL||opts.memLevel>exports.Z_MAX_MEMLEVEL){throw new Error("Invalid memLevel: "+opts.memLevel)}}if(opts.strategy){if(opts.strategy!=exports.Z_FILTERED&&opts.strategy!=exports.Z_HUFFMAN_ONLY&&opts.strategy!=exports.Z_RLE&&opts.strategy!=exports.Z_FIXED&&opts.strategy!=exports.Z_DEFAULT_STRATEGY){throw new Error("Invalid strategy: "+opts.strategy)}}if(opts.dictionary){if(!Buffer.isBuffer(opts.dictionary)){throw new Error("Invalid dictionary: it should be a Buffer instance")}}this._handle=new binding.Zlib(mode);var self=this;this._hadError=false;this._handle.onerror=function(message,errno){_close(self);self._hadError=true;var error=new Error(message);error.errno=errno;error.code=exports.codes[errno];self.emit("error",error)};var level=exports.Z_DEFAULT_COMPRESSION;if(typeof opts.level==="number")level=opts.level;var strategy=exports.Z_DEFAULT_STRATEGY;if(typeof opts.strategy==="number")strategy=opts.strategy;this._handle.init(opts.windowBits||exports.Z_DEFAULT_WINDOWBITS,level,opts.memLevel||exports.Z_DEFAULT_MEMLEVEL,strategy,opts.dictionary);this._buffer=Buffer.allocUnsafe(this._chunkSize);this._offset=0;this._level=level;this._strategy=strategy;this.once("end",this.close);Object.defineProperty(this,"_closed",{get:function(){return!_this._handle},configurable:true,enumerable:true})}util.inherits(Zlib,Transform);Zlib.prototype.params=function(level,strategy,callback){if(level<exports.Z_MIN_LEVEL||level>exports.Z_MAX_LEVEL){throw new RangeError("Invalid compression level: "+level)}if(strategy!=exports.Z_FILTERED&&strategy!=exports.Z_HUFFMAN_ONLY&&strategy!=exports.Z_RLE&&strategy!=exports.Z_FIXED&&strategy!=exports.Z_DEFAULT_STRATEGY){throw new TypeError("Invalid strategy: "+strategy)}if(this._level!==level||this._strategy!==strategy){var self=this;this.flush(binding.Z_SYNC_FLUSH,(function(){assert(self._handle,"zlib binding closed");self._handle.params(level,strategy);if(!self._hadError){self._level=level;self._strategy=strategy;if(callback)callback()}}))}else{process.nextTick(callback)}};Zlib.prototype.reset=function(){assert(this._handle,"zlib binding closed");return this._handle.reset()};Zlib.prototype._flush=function(callback){this._transform(Buffer.alloc(0),"",callback)};Zlib.prototype.flush=function(kind,callback){var _this2=this;var ws=this._writableState;if(typeof kind==="function"||kind===undefined&&!callback){callback=kind;kind=binding.Z_FULL_FLUSH}if(ws.ended){if(callback)process.nextTick(callback)}else if(ws.ending){if(callback)this.once("end",callback)}else if(ws.needDrain){if(callback){this.once("drain",(function(){return _this2.flush(kind,callback)}))}}else{this._flushFlag=kind;this.write(Buffer.alloc(0),"",callback)}};Zlib.prototype.close=function(callback){_close(this,callback);process.nextTick(emitCloseNT,this)};function _close(engine,callback){if(callback)process.nextTick(callback);if(!engine._handle)return;engine._handle.close();engine._handle=null}function emitCloseNT(self){self.emit("close")}Zlib.prototype._transform=function(chunk,encoding,cb){var flushFlag;var ws=this._writableState;var ending=ws.ending||ws.ended;var last=ending&&(!chunk||ws.length===chunk.length);if(chunk!==null&&!Buffer.isBuffer(chunk))return cb(new Error("invalid input"));if(!this._handle)return cb(new Error("zlib binding closed"));if(last)flushFlag=this._finishFlushFlag;else{flushFlag=this._flushFlag;if(chunk.length>=ws.length){this._flushFlag=this._opts.flush||binding.Z_NO_FLUSH}}this._processChunk(chunk,flushFlag,cb)};Zlib.prototype._processChunk=function(chunk,flushFlag,cb){var availInBefore=chunk&&chunk.length;var availOutBefore=this._chunkSize-this._offset;var inOff=0;var self=this;var async=typeof cb==="function";if(!async){var buffers=[];var nread=0;var error;this.on("error",(function(er){error=er}));assert(this._handle,"zlib binding closed");do{var res=this._handle.writeSync(flushFlag,chunk,inOff,availInBefore,this._buffer,this._offset,availOutBefore)}while(!this._hadError&&callback(res[0],res[1]));if(this._hadError){throw error}if(nread>=kMaxLength){_close(this);throw new RangeError(kRangeErrorMessage)}var buf=Buffer.concat(buffers,nread);_close(this);return buf}assert(this._handle,"zlib binding closed");var req=this._handle.write(flushFlag,chunk,inOff,availInBefore,this._buffer,this._offset,availOutBefore);req.buffer=chunk;req.callback=callback;function callback(availInAfter,availOutAfter){if(this){this.buffer=null;this.callback=null}if(self._hadError)return;var have=availOutBefore-availOutAfter;assert(have>=0,"have should not go down");if(have>0){var out=self._buffer.slice(self._offset,self._offset+have);self._offset+=have;if(async){self.push(out)}else{buffers.push(out);nread+=out.length}}if(availOutAfter===0||self._offset>=self._chunkSize){availOutBefore=self._chunkSize;self._offset=0;self._buffer=Buffer.allocUnsafe(self._chunkSize)}if(availOutAfter===0){inOff+=availInBefore-availInAfter;availInBefore=availInAfter;if(!async)return true;var newReq=self._handle.write(flushFlag,chunk,inOff,availInBefore,self._buffer,self._offset,self._chunkSize);newReq.callback=callback;newReq.buffer=chunk;return}if(!async)return false;cb()}};util.inherits(Deflate,Zlib);util.inherits(Inflate,Zlib);util.inherits(Gzip,Zlib);util.inherits(Gunzip,Zlib);util.inherits(DeflateRaw,Zlib);util.inherits(InflateRaw,Zlib);util.inherits(Unzip,Zlib)}).call(this)}).call(this,require("_process"))},{"./binding":86,_process:88,assert:35,buffer:88,stream:398,util:443}],88:[function(require,module,exports){arguments[4][43][0].apply(exports,arguments)},{dup:43}],89:[function(require,module,exports){(function(global){(function(){(function(root){var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=typeof module=="object"&&module&&!module.nodeType&&module;var freeGlobal=typeof global=="object"&&global;if(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal){root=freeGlobal}var punycode,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode,key;function error(type){throw new RangeError(errors[type])}function map(array,fn){var length=array.length;var result=[];while(length--){result[length]=fn(array[length])}return result}function mapDomain(string,fn){var parts=string.split("@");var result="";if(parts.length>1){result=parts[0]+"@";string=parts[1]}string=string.replace(regexSeparators,".");var labels=string.split(".");var encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){var output=[],counter=0,length=string.length,value,extra;while(counter<length){value=string.charCodeAt(counter++);if(value>=55296&&value<=56319&&counter<length){extra=string.charCodeAt(counter++);if((extra&64512)==56320){output.push(((value&1023)<<10)+(extra&1023)+65536)}else{output.push(value);counter--}}else{output.push(value)}}return output}function ucs2encode(array){return map(array,(function(value){var output="";if(value>65535){value-=65536;output+=stringFromCharCode(value>>>10&1023|55296);value=56320|value&1023}output+=stringFromCharCode(value);return output})).join("")}function basicToDigit(codePoint){if(codePoint-48<10){return codePoint-22}if(codePoint-65<26){return codePoint-65}if(codePoint-97<26){return codePoint-97}return base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((flag!=0)<<5)}function adapt(delta,numPoints,firstTime){var k=0;delta=firstTime?floor(delta/damp):delta>>1;delta+=floor(delta/numPoints);for(;delta>baseMinusTMin*tMax>>1;k+=base){delta=floor(delta/baseMinusTMin)}return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var output=[],inputLength=input.length,out,i=0,n=initialN,bias=initialBias,basic,j,index,oldi,w,k,digit,t,baseMinusT;basic=input.lastIndexOf(delimiter);if(basic<0){basic=0}for(j=0;j<basic;++j){if(input.charCodeAt(j)>=128){error("not-basic")}output.push(input.charCodeAt(j))}for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;;k+=base){if(index>=inputLength){error("invalid-input")}digit=basicToDigit(input.charCodeAt(index++));if(digit>=base||digit>floor((maxInt-i)/w)){error("overflow")}i+=digit*w;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(digit<t){break}baseMinusT=base-t;if(w>floor(maxInt/baseMinusT)){error("overflow")}w*=baseMinusT}out=output.length+1;bias=adapt(i-oldi,out,oldi==0);if(floor(i/out)>maxInt-n){error("overflow")}n+=floor(i/out);i%=out;output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,output=[],inputLength,handledCPCountPlusOne,baseMinusT,qMinusT;input=ucs2decode(input);inputLength=input.length;n=initialN;delta=0;bias=initialBias;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<128){output.push(stringFromCharCode(currentValue))}}handledCPCount=basicLength=output.length;if(basicLength){output.push(delimiter)}while(handledCPCount<inputLength){for(m=maxInt,j=0;j<inputLength;++j){currentValue=input[j];if(currentValue>=n&&currentValue<m){m=currentValue}}handledCPCountPlusOne=handledCPCount+1;if(m-n>floor((maxInt-delta)/handledCPCountPlusOne)){error("overflow")}delta+=(m-n)*handledCPCountPlusOne;n=m;for(j=0;j<inputLength;++j){currentValue=input[j];if(currentValue<n&&++delta>maxInt){error("overflow")}if(currentValue==n){for(q=delta,k=base;;k+=base){t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias;if(q<t){break}qMinusT=q-t;baseMinusT=base-t;output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0)));q=floor(qMinusT/baseMinusT)}output.push(stringFromCharCode(digitToBasic(q,0)));bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength);delta=0;++handledCPCount}}++delta;++n}return output.join("")}function toUnicode(input){return mapDomain(input,(function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string}))}function toASCII(input){return mapDomain(input,(function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string}))}punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define("punycode",(function(){return punycode}))}else if(freeExports&&freeModule){if(module.exports==freeExports){freeModule.exports=punycode}else{for(key in punycode){punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key])}}}else{root.punycode=punycode}})(this)}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],90:[function(require,module,exports){(function(Buffer){(function(){module.exports=function xor(a,b){var length=Math.min(a.length,b.length);var buffer=new Buffer(length);for(var i=0;i<length;++i){buffer[i]=a[i]^b[i]}return buffer}}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88}],91:[function(require,module,exports){module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],92:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBind=require("./");var $indexOf=callBind(GetIntrinsic("String.prototype.indexOf"));module.exports=function callBoundIntrinsic(name,allowMissing){var intrinsic=GetIntrinsic(name,!!allowMissing);if(typeof intrinsic==="function"&&$indexOf(name,".prototype.")>-1){return callBind(intrinsic)}return intrinsic}},{"./":93,"get-intrinsic":192}],93:[function(require,module,exports){"use strict";var bind=require("function-bind");var GetIntrinsic=require("get-intrinsic");var setFunctionLength=require("set-function-length");var $TypeError=GetIntrinsic("%TypeError%");var $apply=GetIntrinsic("%Function.prototype.apply%");var $call=GetIntrinsic("%Function.prototype.call%");var $reflectApply=GetIntrinsic("%Reflect.apply%",true)||bind.call($call,$apply);var $defineProperty=GetIntrinsic("%Object.defineProperty%",true);var $max=GetIntrinsic("%Math.max%");if($defineProperty){try{$defineProperty({},"a",{value:1})}catch(e){$defineProperty=null}}module.exports=function callBind(originalFunction){if(typeof originalFunction!=="function"){throw new $TypeError("a function is required")}var func=$reflectApply(bind,$call,arguments);return setFunctionLength(func,1+$max(0,originalFunction.length-(arguments.length-1)),true)};var applyBind=function applyBind(){return $reflectApply(bind,$apply,arguments)};if($defineProperty){$defineProperty(module.exports,"apply",{value:applyBind})}else{module.exports.apply=applyBind}},{"function-bind":191,"get-intrinsic":192,"set-function-length":387}],94:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.groupSelectors=exports.getDocumentRoot=void 0;var positionals_js_1=require("./positionals.js");function getDocumentRoot(node){while(node.parent)node=node.parent;return node}exports.getDocumentRoot=getDocumentRoot;function groupSelectors(selectors){var filteredSelectors=[];var plainSelectors=[];for(var _i=0,selectors_1=selectors;_i<selectors_1.length;_i++){var selector=selectors_1[_i];if(selector.some(positionals_js_1.isFilter)){filteredSelectors.push(selector)}else{plainSelectors.push(selector)}}return[plainSelectors,filteredSelectors]}exports.groupSelectors=groupSelectors},{"./positionals.js":96}],95:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.select=exports.filter=exports.some=exports.is=exports.aliases=exports.pseudos=exports.filters=void 0;var css_what_1=require("css-what");var css_select_1=require("css-select");var DomUtils=__importStar(require("domutils"));var boolbase=__importStar(require("boolbase"));var helpers_js_1=require("./helpers.js");var positionals_js_1=require("./positionals.js");var css_select_2=require("css-select");Object.defineProperty(exports,"filters",{enumerable:true,get:function(){return css_select_2.filters}});Object.defineProperty(exports,"pseudos",{enumerable:true,get:function(){return css_select_2.pseudos}});Object.defineProperty(exports,"aliases",{enumerable:true,get:function(){return css_select_2.aliases}});var UNIVERSAL_SELECTOR={type:css_what_1.SelectorType.Universal,namespace:null};var SCOPE_PSEUDO={type:css_what_1.SelectorType.Pseudo,name:"scope",data:null};function is(element,selector,options){if(options===void 0){options={}}return some([element],selector,options)}exports.is=is;function some(elements,selector,options){if(options===void 0){options={}}if(typeof selector==="function")return elements.some(selector);var _a=(0,helpers_js_1.groupSelectors)((0,css_what_1.parse)(selector)),plain=_a[0],filtered=_a[1];return plain.length>0&&elements.some((0,css_select_1._compileToken)(plain,options))||filtered.some((function(sel){return filterBySelector(sel,elements,options).length>0}))}exports.some=some;function filterByPosition(filter,elems,data,options){var num=typeof data==="string"?parseInt(data,10):NaN;switch(filter){case"first":case"lt":return elems;case"last":return elems.length>0?[elems[elems.length-1]]:elems;case"nth":case"eq":return isFinite(num)&&Math.abs(num)<elems.length?[num<0?elems[elems.length+num]:elems[num]]:[];case"gt":return isFinite(num)?elems.slice(num+1):[];case"even":return elems.filter((function(_,i){return i%2===0}));case"odd":return elems.filter((function(_,i){return i%2===1}));case"not":{var filtered_1=new Set(filterParsed(data,elems,options));return elems.filter((function(e){return!filtered_1.has(e)}))}}}function filter(selector,elements,options){if(options===void 0){options={}}return filterParsed((0,css_what_1.parse)(selector),elements,options)}exports.filter=filter;function filterParsed(selector,elements,options){if(elements.length===0)return[];var _a=(0,helpers_js_1.groupSelectors)(selector),plainSelectors=_a[0],filteredSelectors=_a[1];var found;if(plainSelectors.length){var filtered=filterElements(elements,plainSelectors,options);if(filteredSelectors.length===0){return filtered}if(filtered.length){found=new Set(filtered)}}for(var i=0;i<filteredSelectors.length&&(found===null||found===void 0?void 0:found.size)!==elements.length;i++){var filteredSelector=filteredSelectors[i];var missing=found?elements.filter((function(e){return DomUtils.isTag(e)&&!found.has(e)})):elements;if(missing.length===0)break;var filtered=filterBySelector(filteredSelector,elements,options);if(filtered.length){if(!found){if(i===filteredSelectors.length-1){return filtered}found=new Set(filtered)}else{filtered.forEach((function(el){return found.add(el)}))}}}return typeof found!=="undefined"?found.size===elements.length?elements:elements.filter((function(el){return found.has(el)})):[]}function filterBySelector(selector,elements,options){var _a;if(selector.some(css_what_1.isTraversal)){var root=(_a=options.root)!==null&&_a!==void 0?_a:(0,helpers_js_1.getDocumentRoot)(elements[0]);var opts=__assign(__assign({},options),{context:elements,relativeSelector:false});selector.push(SCOPE_PSEUDO);return findFilterElements(root,selector,opts,true,elements.length)}return findFilterElements(elements,selector,options,false,elements.length)}function select(selector,root,options,limit){if(options===void 0){options={}}if(limit===void 0){limit=Infinity}if(typeof selector==="function"){return find(root,selector)}var _a=(0,helpers_js_1.groupSelectors)((0,css_what_1.parse)(selector)),plain=_a[0],filtered=_a[1];var results=filtered.map((function(sel){return findFilterElements(root,sel,options,true,limit)}));if(plain.length){results.push(findElements(root,plain,options,limit))}if(results.length===0){return[]}if(results.length===1){return results[0]}return DomUtils.uniqueSort(results.reduce((function(a,b){return __spreadArray(__spreadArray([],a,true),b,true)})))}exports.select=select;function findFilterElements(root,selector,options,queryForSelector,totalLimit){var filterIndex=selector.findIndex(positionals_js_1.isFilter);var sub=selector.slice(0,filterIndex);var filter=selector[filterIndex];var partLimit=selector.length-1===filterIndex?totalLimit:Infinity;var limit=(0,positionals_js_1.getLimit)(filter.name,filter.data,partLimit);if(limit===0)return[];var elemsNoLimit=sub.length===0&&!Array.isArray(root)?DomUtils.getChildren(root).filter(DomUtils.isTag):sub.length===0?(Array.isArray(root)?root:[root]).filter(DomUtils.isTag):queryForSelector||sub.some(css_what_1.isTraversal)?findElements(root,[sub],options,limit):filterElements(root,[sub],options);var elems=elemsNoLimit.slice(0,limit);var result=filterByPosition(filter.name,elems,filter.data,options);if(result.length===0||selector.length===filterIndex+1){return result}var remainingSelector=selector.slice(filterIndex+1);var remainingHasTraversal=remainingSelector.some(css_what_1.isTraversal);if(remainingHasTraversal){if((0,css_what_1.isTraversal)(remainingSelector[0])){var type=remainingSelector[0].type;if(type===css_what_1.SelectorType.Sibling||type===css_what_1.SelectorType.Adjacent){result=(0,css_select_1.prepareContext)(result,DomUtils,true)}remainingSelector.unshift(UNIVERSAL_SELECTOR)}options=__assign(__assign({},options),{relativeSelector:false,rootFunc:function(el){return result.includes(el)}})}else if(options.rootFunc&&options.rootFunc!==boolbase.trueFunc){options=__assign(__assign({},options),{rootFunc:boolbase.trueFunc})}return remainingSelector.some(positionals_js_1.isFilter)?findFilterElements(result,remainingSelector,options,false,totalLimit):remainingHasTraversal?findElements(result,[remainingSelector],options,totalLimit):filterElements(result,[remainingSelector],options)}function findElements(root,sel,options,limit){var query=(0,css_select_1._compileToken)(sel,options,root);return find(root,query,limit)}function find(root,query,limit){if(limit===void 0){limit=Infinity}var elems=(0,css_select_1.prepareContext)(root,DomUtils,query.shouldTestNextSiblings);return DomUtils.find((function(node){return DomUtils.isTag(node)&&query(node)}),elems,true,limit)}function filterElements(elements,sel,options){var els=(Array.isArray(elements)?elements:[elements]).filter(DomUtils.isTag);if(els.length===0)return els;var query=(0,css_select_1._compileToken)(sel,options);return query===boolbase.trueFunc?els:els.filter(query)}},{"./helpers.js":94,"./positionals.js":96,boolbase:41,"css-select":122,"css-what":129,domutils:156}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getLimit=exports.isFilter=exports.filterNames=void 0;exports.filterNames=new Set(["first","last","eq","gt","nth","lt","even","odd"]);function isFilter(s){if(s.type!=="pseudo")return false;if(exports.filterNames.has(s.name))return true;if(s.name==="not"&&Array.isArray(s.data)){return s.data.some((function(s){return s.some(isFilter)}))}return false}exports.isFilter=isFilter;function getLimit(filter,data,partLimit){var num=data!=null?parseInt(data,10):NaN;switch(filter){case"first":return 1;case"nth":case"eq":return isFinite(num)?num>=0?num+1:Infinity:0;case"lt":return isFinite(num)?num>=0?Math.min(num,partLimit):Infinity:0;case"gt":return isFinite(num)?Infinity:0;case"odd":return 2*partLimit;case"even":return 2*partLimit-1;case"last":case"not":return Infinity}}exports.getLimit=getLimit},{}],97:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toggleClass=exports.removeClass=exports.addClass=exports.hasClass=exports.removeAttr=exports.val=exports.data=exports.prop=exports.attr=void 0;var static_js_1=require("../static.js");var utils_js_1=require("../utils.js");var domutils_1=require("domutils");var hasOwn=Object.prototype.hasOwnProperty;var rspace=/\s+/;var dataAttrPrefix="data-";var primitives={null:null,true:true,false:false};var rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i;var rbrace=/^{[^]*}$|^\[[^]*]$/;function getAttr(elem,name,xmlMode){var _a;if(!elem||!(0,utils_js_1.isTag)(elem))return undefined;(_a=elem.attribs)!==null&&_a!==void 0?_a:elem.attribs={};if(!name){return elem.attribs}if(hasOwn.call(elem.attribs,name)){return!xmlMode&&rboolean.test(name)?name:elem.attribs[name]}if(elem.name==="option"&&name==="value"){return(0,static_js_1.text)(elem.children)}if(elem.name==="input"&&(elem.attribs["type"]==="radio"||elem.attribs["type"]==="checkbox")&&name==="value"){return"on"}return undefined}function setAttr(el,name,value){if(value===null){removeAttribute(el,name)}else{el.attribs[name]="".concat(value)}}function attr(name,value){if(typeof name==="object"||value!==undefined){if(typeof value==="function"){if(typeof name!=="string"){{throw new Error("Bad combination of arguments.")}}return(0,utils_js_1.domEach)(this,(function(el,i){if((0,utils_js_1.isTag)(el))setAttr(el,name,value.call(el,i,el.attribs[name]))}))}return(0,utils_js_1.domEach)(this,(function(el){if(!(0,utils_js_1.isTag)(el))return;if(typeof name==="object"){Object.keys(name).forEach((function(objName){var objValue=name[objName];setAttr(el,objName,objValue)}))}else{setAttr(el,name,value)}}))}return arguments.length>1?this:getAttr(this[0],name,this.options.xmlMode)}exports.attr=attr;function getProp(el,name,xmlMode){return name in el?el[name]:!xmlMode&&rboolean.test(name)?getAttr(el,name,false)!==undefined:getAttr(el,name,xmlMode)}function setProp(el,name,value,xmlMode){if(name in el){el[name]=value}else{setAttr(el,name,!xmlMode&&rboolean.test(name)?value?"":null:"".concat(value))}}function prop(name,value){var _this=this;var _a;if(typeof name==="string"&&value===undefined){var el=this[0];if(!el||!(0,utils_js_1.isTag)(el))return undefined;switch(name){case"style":{var property_1=this.css();var keys=Object.keys(property_1);keys.forEach((function(p,i){property_1[i]=p}));property_1.length=keys.length;return property_1}case"tagName":case"nodeName":{return el.name.toUpperCase()}case"href":case"src":{var prop_1=(_a=el.attribs)===null||_a===void 0?void 0:_a[name];if(typeof URL!=="undefined"&&(name==="href"&&(el.tagName==="a"||el.name==="link")||name==="src"&&(el.tagName==="img"||el.tagName==="iframe"||el.tagName==="audio"||el.tagName==="video"||el.tagName==="source"))&&prop_1!==undefined&&this.options.baseURI){return new URL(prop_1,this.options.baseURI).href}return prop_1}case"innerText":{return(0,domutils_1.innerText)(el)}case"textContent":{return(0,domutils_1.textContent)(el)}case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return getProp(el,name,this.options.xmlMode)}}if(typeof name==="object"||value!==undefined){if(typeof value==="function"){if(typeof name==="object"){throw new Error("Bad combination of arguments.")}return(0,utils_js_1.domEach)(this,(function(el,i){if((0,utils_js_1.isTag)(el)){setProp(el,name,value.call(el,i,getProp(el,name,_this.options.xmlMode)),_this.options.xmlMode)}}))}return(0,utils_js_1.domEach)(this,(function(el){if(!(0,utils_js_1.isTag)(el))return;if(typeof name==="object"){Object.keys(name).forEach((function(key){var val=name[key];setProp(el,key,val,_this.options.xmlMode)}))}else{setProp(el,name,value,_this.options.xmlMode)}}))}return undefined}exports.prop=prop;function setData(el,name,value){var _a;var elem=el;(_a=elem.data)!==null&&_a!==void 0?_a:elem.data={};if(typeof name==="object")Object.assign(elem.data,name);else if(typeof name==="string"&&value!==undefined){elem.data[name]=value}}function readData(el,name){var domNames;var jsNames;var value;if(name==null){domNames=Object.keys(el.attribs).filter((function(attrName){return attrName.startsWith(dataAttrPrefix)}));jsNames=domNames.map((function(domName){return(0,utils_js_1.camelCase)(domName.slice(dataAttrPrefix.length))}))}else{domNames=[dataAttrPrefix+(0,utils_js_1.cssCase)(name)];jsNames=[name]}for(var idx=0;idx<domNames.length;++idx){var domName=domNames[idx];var jsName=jsNames[idx];if(hasOwn.call(el.attribs,domName)&&!hasOwn.call(el.data,jsName)){value=el.attribs[domName];if(hasOwn.call(primitives,value)){value=primitives[value]}else if(value===String(Number(value))){value=Number(value)}else if(rbrace.test(value)){try{value=JSON.parse(value)}catch(e){}}el.data[jsName]=value}}return name==null?el.data:value}function data(name,value){var _a;var elem=this[0];if(!elem||!(0,utils_js_1.isTag)(elem))return;var dataEl=elem;(_a=dataEl.data)!==null&&_a!==void 0?_a:dataEl.data={};if(!name){return readData(dataEl)}if(typeof name==="object"||value!==undefined){(0,utils_js_1.domEach)(this,(function(el){if((0,utils_js_1.isTag)(el)){if(typeof name==="object")setData(el,name);else setData(el,name,value)}}));return this}if(hasOwn.call(dataEl.data,name)){return dataEl.data[name]}return readData(dataEl,name)}exports.data=data;function val(value){var querying=arguments.length===0;var element=this[0];if(!element||!(0,utils_js_1.isTag)(element))return querying?undefined:this;switch(element.name){case"textarea":return this.text(value);case"select":{var option=this.find("option:selected");if(!querying){if(this.attr("multiple")==null&&typeof value==="object"){return this}this.find("option").removeAttr("selected");var values=typeof value!=="object"?[value]:value;for(var i=0;i<values.length;i++){this.find('option[value="'.concat(values[i],'"]')).attr("selected","")}return this}return this.attr("multiple")?option.toArray().map((function(el){return(0,static_js_1.text)(el.children)})):option.attr("value")}case"input":case"option":return querying?this.attr("value"):this.attr("value",value)}return undefined}exports.val=val;function removeAttribute(elem,name){if(!elem.attribs||!hasOwn.call(elem.attribs,name))return;delete elem.attribs[name]}function splitNames(names){return names?names.trim().split(rspace):[]}function removeAttr(name){var attrNames=splitNames(name);var _loop_1=function(i){(0,utils_js_1.domEach)(this_1,(function(elem){if((0,utils_js_1.isTag)(elem))removeAttribute(elem,attrNames[i])}))};var this_1=this;for(var i=0;i<attrNames.length;i++){_loop_1(i)}return this}exports.removeAttr=removeAttr;function hasClass(className){return this.toArray().some((function(elem){var clazz=(0,utils_js_1.isTag)(elem)&&elem.attribs["class"];var idx=-1;if(clazz&&className.length){while((idx=clazz.indexOf(className,idx+1))>-1){var end=idx+className.length;if((idx===0||rspace.test(clazz[idx-1]))&&(end===clazz.length||rspace.test(clazz[end]))){return true}}}return false}))}exports.hasClass=hasClass;function addClass(value){if(typeof value==="function"){return(0,utils_js_1.domEach)(this,(function(el,i){if((0,utils_js_1.isTag)(el)){var className=el.attribs["class"]||"";addClass.call([el],value.call(el,i,className))}}))}if(!value||typeof value!=="string")return this;var classNames=value.split(rspace);var numElements=this.length;for(var i=0;i<numElements;i++){var el=this[i];if(!(0,utils_js_1.isTag)(el))continue;var className=getAttr(el,"class",false);if(!className){setAttr(el,"class",classNames.join(" ").trim())}else{var setClass=" ".concat(className," ");for(var j=0;j<classNames.length;j++){var appendClass="".concat(classNames[j]," ");if(!setClass.includes(" ".concat(appendClass)))setClass+=appendClass}setAttr(el,"class",setClass.trim())}}return this}exports.addClass=addClass;function removeClass(name){if(typeof name==="function"){return(0,utils_js_1.domEach)(this,(function(el,i){if((0,utils_js_1.isTag)(el)){removeClass.call([el],name.call(el,i,el.attribs["class"]||""))}}))}var classes=splitNames(name);var numClasses=classes.length;var removeAll=arguments.length===0;return(0,utils_js_1.domEach)(this,(function(el){if(!(0,utils_js_1.isTag)(el))return;if(removeAll){el.attribs["class"]=""}else{var elClasses=splitNames(el.attribs["class"]);var changed=false;for(var j=0;j<numClasses;j++){var index=elClasses.indexOf(classes[j]);if(index>=0){elClasses.splice(index,1);changed=true;j--}}if(changed){el.attribs["class"]=elClasses.join(" ")}}}))}exports.removeClass=removeClass;function toggleClass(value,stateVal){if(typeof value==="function"){return(0,utils_js_1.domEach)(this,(function(el,i){if((0,utils_js_1.isTag)(el)){toggleClass.call([el],value.call(el,i,el.attribs["class"]||"",stateVal),stateVal)}}))}if(!value||typeof value!=="string")return this;var classNames=value.split(rspace);var numClasses=classNames.length;var state=typeof stateVal==="boolean"?stateVal?1:-1:0;var numElements=this.length;for(var i=0;i<numElements;i++){var el=this[i];if(!(0,utils_js_1.isTag)(el))continue;var elementClasses=splitNames(el.attribs["class"]);for(var j=0;j<numClasses;j++){var index=elementClasses.indexOf(classNames[j]);if(state>=0&&index<0){elementClasses.push(classNames[j])}else if(state<=0&&index>=0){elementClasses.splice(index,1)}}el.attribs["class"]=elementClasses.join(" ")}return this}exports.toggleClass=toggleClass},{"../static.js":108,"../utils.js":110,domutils:156}],98:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.css=void 0;var utils_js_1=require("../utils.js");function css(prop,val){if(prop!=null&&val!=null||typeof prop==="object"&&!Array.isArray(prop)){return(0,utils_js_1.domEach)(this,(function(el,i){if((0,utils_js_1.isTag)(el)){setCss(el,prop,val,i)}}))}if(this.length===0){return undefined}return getCss(this[0],prop)}exports.css=css;function setCss(el,prop,value,idx){if(typeof prop==="string"){var styles=getCss(el);var val=typeof value==="function"?value.call(el,idx,styles[prop]):value;if(val===""){delete styles[prop]}else if(val!=null){styles[prop]=val}el.attribs["style"]=stringify(styles)}else if(typeof prop==="object"){Object.keys(prop).forEach((function(k,i){setCss(el,k,prop[k],i)}))}}function getCss(el,prop){if(!el||!(0,utils_js_1.isTag)(el))return;var styles=parse(el.attribs["style"]);if(typeof prop==="string"){return styles[prop]}if(Array.isArray(prop)){var newStyles_1={};prop.forEach((function(item){if(styles[item]!=null){newStyles_1[item]=styles[item]}}));return newStyles_1}return styles}function stringify(obj){return Object.keys(obj).reduce((function(str,prop){return"".concat(str).concat(str?" ":"").concat(prop,": ").concat(obj[prop],";")}),"")}function parse(styles){styles=(styles||"").trim();if(!styles)return{};var obj={};var key;for(var _i=0,_a=styles.split(";");_i<_a.length;_i++){var str=_a[_i];var n=str.indexOf(":");if(n<1||n===str.length-1){var trimmed=str.trimEnd();if(trimmed.length>0&&key!==undefined){obj[key]+=";".concat(trimmed)}}else{key=str.slice(0,n).trim();obj[key]=str.slice(n+1).trim()}}return obj}},{"../utils.js":110}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.serializeArray=exports.serialize=void 0;var utils_js_1=require("../utils.js");var submittableSelector="input,select,textarea,keygen";var r20=/%20/g;var rCRLF=/\r?\n/g;function serialize(){var arr=this.serializeArray();var retArr=arr.map((function(data){return"".concat(encodeURIComponent(data.name),"=").concat(encodeURIComponent(data.value))}));return retArr.join("&").replace(r20,"+")}exports.serialize=serialize;function serializeArray(){var _this=this;return this.map((function(_,elem){var $elem=_this._make(elem);if((0,utils_js_1.isTag)(elem)&&elem.name==="form"){return $elem.find(submittableSelector).toArray()}return $elem.filter(submittableSelector).toArray()})).filter('[name!=""]:enabled'+":not(:submit, :button, :image, :reset, :file)"+":matches([checked], :not(:checkbox, :radio))").map((function(_,elem){var _a;var $elem=_this._make(elem);var name=$elem.attr("name");var value=(_a=$elem.val())!==null&&_a!==void 0?_a:"";if(Array.isArray(value)){return value.map((function(val){return{name:name,value:val.replace(rCRLF,"\r\n")}}))}return{name:name,value:value.replace(rCRLF,"\r\n")}})).toArray()}exports.serializeArray=serializeArray},{"../utils.js":110}],100:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.clone=exports.text=exports.toString=exports.html=exports.empty=exports.replaceWith=exports.remove=exports.insertBefore=exports.before=exports.insertAfter=exports.after=exports.wrapAll=exports.unwrap=exports.wrapInner=exports.wrap=exports.prepend=exports.append=exports.prependTo=exports.appendTo=exports._makeDomArray=void 0;var domhandler_1=require("domhandler");var parse_js_1=require("../parse.js");var static_js_1=require("../static.js");var utils_js_1=require("../utils.js");var domutils_1=require("domutils");function _makeDomArray(elem,clone){var _this=this;if(elem==null){return[]}if((0,utils_js_1.isCheerio)(elem)){return clone?(0,utils_js_1.cloneDom)(elem.get()):elem.get()}if(Array.isArray(elem)){return elem.reduce((function(newElems,el){return newElems.concat(_this._makeDomArray(el,clone))}),[])}if(typeof elem==="string"){return this._parse(elem,this.options,false,null).children}return clone?(0,utils_js_1.cloneDom)([elem]):[elem]}exports._makeDomArray=_makeDomArray;function _insert(concatenator){return function(){var _this=this;var elems=[];for(var _i=0;_i<arguments.length;_i++){elems[_i]=arguments[_i]}var lastIdx=this.length-1;return(0,utils_js_1.domEach)(this,(function(el,i){if(!(0,domhandler_1.hasChildren)(el))return;var domSrc=typeof elems[0]==="function"?elems[0].call(el,i,_this._render(el.children)):elems;var dom=_this._makeDomArray(domSrc,i<lastIdx);concatenator(dom,el.children,el)}))}}function uniqueSplice(array,spliceIdx,spliceCount,newElems,parent){var _a,_b;var spliceArgs=__spreadArray([spliceIdx,spliceCount],newElems,true);var prev=spliceIdx===0?null:array[spliceIdx-1];var next=spliceIdx+spliceCount>=array.length?null:array[spliceIdx+spliceCount];for(var idx=0;idx<newElems.length;++idx){var node=newElems[idx];var oldParent=node.parent;if(oldParent){var oldSiblings=oldParent.children;var prevIdx=oldSiblings.indexOf(node);if(prevIdx>-1){oldParent.children.splice(prevIdx,1);if(parent===oldParent&&spliceIdx>prevIdx){spliceArgs[0]--}}}node.parent=parent;if(node.prev){node.prev.next=(_a=node.next)!==null&&_a!==void 0?_a:null}if(node.next){node.next.prev=(_b=node.prev)!==null&&_b!==void 0?_b:null}node.prev=idx===0?prev:newElems[idx-1];node.next=idx===newElems.length-1?next:newElems[idx+1]}if(prev){prev.next=newElems[0]}if(next){next.prev=newElems[newElems.length-1]}return array.splice.apply(array,spliceArgs)}function appendTo(target){var appendTarget=(0,utils_js_1.isCheerio)(target)?target:this._make(target);appendTarget.append(this);return this}exports.appendTo=appendTo;function prependTo(target){var prependTarget=(0,utils_js_1.isCheerio)(target)?target:this._make(target);prependTarget.prepend(this);return this}exports.prependTo=prependTo;exports.append=_insert((function(dom,children,parent){uniqueSplice(children,children.length,0,dom,parent)}));exports.prepend=_insert((function(dom,children,parent){uniqueSplice(children,0,0,dom,parent)}));function _wrap(insert){return function(wrapper){var lastIdx=this.length-1;var lastParent=this.parents().last();for(var i=0;i<this.length;i++){var el=this[i];var wrap_1=typeof wrapper==="function"?wrapper.call(el,i,el):typeof wrapper==="string"&&!(0,utils_js_1.isHtml)(wrapper)?lastParent.find(wrapper).clone():wrapper;var wrapperDom=this._makeDomArray(wrap_1,i<lastIdx)[0];if(!wrapperDom||!(0,domhandler_1.hasChildren)(wrapperDom))continue;var elInsertLocation=wrapperDom;var j=0;while(j<elInsertLocation.children.length){var child=elInsertLocation.children[j];if((0,utils_js_1.isTag)(child)){elInsertLocation=child;j=0}else{j++}}insert(el,elInsertLocation,[wrapperDom])}return this}}exports.wrap=_wrap((function(el,elInsertLocation,wrapperDom){var parent=el.parent;if(!parent)return;var siblings=parent.children;var index=siblings.indexOf(el);(0,parse_js_1.update)([el],elInsertLocation);uniqueSplice(siblings,index,0,wrapperDom,parent)}));exports.wrapInner=_wrap((function(el,elInsertLocation,wrapperDom){if(!(0,domhandler_1.hasChildren)(el))return;(0,parse_js_1.update)(el.children,elInsertLocation);(0,parse_js_1.update)(wrapperDom,el)}));function unwrap(selector){var _this=this;this.parent(selector).not("body").each((function(_,el){_this._make(el).replaceWith(el.children)}));return this}exports.unwrap=unwrap;function wrapAll(wrapper){var el=this[0];if(el){var wrap_2=this._make(typeof wrapper==="function"?wrapper.call(el,0,el):wrapper).insertBefore(el);var elInsertLocation=void 0;for(var i=0;i<wrap_2.length;i++){if(wrap_2[i].type==="tag")elInsertLocation=wrap_2[i]}var j=0;while(elInsertLocation&&j<elInsertLocation.children.length){var child=elInsertLocation.children[j];if(child.type==="tag"){elInsertLocation=child;j=0}else{j++}}if(elInsertLocation)this._make(elInsertLocation).append(this)}return this}exports.wrapAll=wrapAll;function after(){var _this=this;var elems=[];for(var _i=0;_i<arguments.length;_i++){elems[_i]=arguments[_i]}var lastIdx=this.length-1;return(0,utils_js_1.domEach)(this,(function(el,i){var parent=el.parent;if(!(0,domhandler_1.hasChildren)(el)||!parent){return}var siblings=parent.children;var index=siblings.indexOf(el);if(index<0)return;var domSrc=typeof elems[0]==="function"?elems[0].call(el,i,_this._render(el.children)):elems;var dom=_this._makeDomArray(domSrc,i<lastIdx);uniqueSplice(siblings,index+1,0,dom,parent)}))}exports.after=after;function insertAfter(target){var _this=this;if(typeof target==="string"){target=this._make(target)}this.remove();var clones=[];this._makeDomArray(target).forEach((function(el){var clonedSelf=_this.clone().toArray();var parent=el.parent;if(!parent){return}var siblings=parent.children;var index=siblings.indexOf(el);if(index<0)return;uniqueSplice(siblings,index+1,0,clonedSelf,parent);clones.push.apply(clones,clonedSelf)}));return this._make(clones)}exports.insertAfter=insertAfter;function before(){var _this=this;var elems=[];for(var _i=0;_i<arguments.length;_i++){elems[_i]=arguments[_i]}var lastIdx=this.length-1;return(0,utils_js_1.domEach)(this,(function(el,i){var parent=el.parent;if(!(0,domhandler_1.hasChildren)(el)||!parent){return}var siblings=parent.children;var index=siblings.indexOf(el);if(index<0)return;var domSrc=typeof elems[0]==="function"?elems[0].call(el,i,_this._render(el.children)):elems;var dom=_this._makeDomArray(domSrc,i<lastIdx);uniqueSplice(siblings,index,0,dom,parent)}))}exports.before=before;function insertBefore(target){var _this=this;var targetArr=this._make(target);this.remove();var clones=[];(0,utils_js_1.domEach)(targetArr,(function(el){var clonedSelf=_this.clone().toArray();var parent=el.parent;if(!parent){return}var siblings=parent.children;var index=siblings.indexOf(el);if(index<0)return;uniqueSplice(siblings,index,0,clonedSelf,parent);clones.push.apply(clones,clonedSelf)}));return this._make(clones)}exports.insertBefore=insertBefore;function remove(selector){var elems=selector?this.filter(selector):this;(0,utils_js_1.domEach)(elems,(function(el){(0,domutils_1.removeElement)(el);el.prev=el.next=el.parent=null}));return this}exports.remove=remove;function replaceWith(content){var _this=this;return(0,utils_js_1.domEach)(this,(function(el,i){var parent=el.parent;if(!parent){return}var siblings=parent.children;var cont=typeof content==="function"?content.call(el,i,el):content;var dom=_this._makeDomArray(cont);(0,parse_js_1.update)(dom,null);var index=siblings.indexOf(el);uniqueSplice(siblings,index,1,dom,parent);if(!dom.includes(el)){el.parent=el.prev=el.next=null}}))}exports.replaceWith=replaceWith;function empty(){return(0,utils_js_1.domEach)(this,(function(el){if(!(0,domhandler_1.hasChildren)(el))return;el.children.forEach((function(child){child.next=child.prev=child.parent=null}));el.children.length=0}))}exports.empty=empty;function html(str){var _this=this;if(str===undefined){var el=this[0];if(!el||!(0,domhandler_1.hasChildren)(el))return null;return this._render(el.children)}return(0,utils_js_1.domEach)(this,(function(el){if(!(0,domhandler_1.hasChildren)(el))return;el.children.forEach((function(child){child.next=child.prev=child.parent=null}));var content=(0,utils_js_1.isCheerio)(str)?str.toArray():_this._parse("".concat(str),_this.options,false,el).children;(0,parse_js_1.update)(content,el)}))}exports.html=html;function toString(){return this._render(this)}exports.toString=toString;function text(str){var _this=this;if(str===undefined){return(0,static_js_1.text)(this)}if(typeof str==="function"){return(0,utils_js_1.domEach)(this,(function(el,i){return _this._make(el).text(str.call(el,i,(0,static_js_1.text)([el])))}))}return(0,utils_js_1.domEach)(this,(function(el){if(!(0,domhandler_1.hasChildren)(el))return;el.children.forEach((function(child){child.next=child.prev=child.parent=null}));var textNode=new domhandler_1.Text("".concat(str));(0,parse_js_1.update)(textNode,el)}))}exports.text=text;function clone(){return this._make((0,utils_js_1.cloneDom)(this.get()))}exports.clone=clone},{"../parse.js":106,"../static.js":108,"../utils.js":110,domhandler:152,domutils:156}],101:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.addBack=exports.add=exports.end=exports.slice=exports.index=exports.toArray=exports.get=exports.eq=exports.last=exports.first=exports.has=exports.not=exports.is=exports.filterArray=exports.filter=exports.map=exports.each=exports.contents=exports.children=exports.siblings=exports.prevUntil=exports.prevAll=exports.prev=exports.nextUntil=exports.nextAll=exports.next=exports.closest=exports.parentsUntil=exports.parents=exports.parent=exports.find=void 0;var domhandler_1=require("domhandler");var select=__importStar(require("cheerio-select"));var utils_js_1=require("../utils.js");var static_js_1=require("../static.js");var domutils_1=require("domutils");var reSiblingSelector=/^\s*[~+]/;function find(selectorOrHaystack){var _a;if(!selectorOrHaystack){return this._make([])}var context=this.toArray();if(typeof selectorOrHaystack!=="string"){var haystack=(0,utils_js_1.isCheerio)(selectorOrHaystack)?selectorOrHaystack.toArray():[selectorOrHaystack];return this._make(haystack.filter((function(elem){return context.some((function(node){return(0,static_js_1.contains)(node,elem)}))})))}var elems=reSiblingSelector.test(selectorOrHaystack)?context:this.children().toArray();var options={context:context,root:(_a=this._root)===null||_a===void 0?void 0:_a[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(select.select(selectorOrHaystack,elems,options))}exports.find=find;function _getMatcher(matchMap){return function(fn){var postFns=[];for(var _i=1;_i<arguments.length;_i++){postFns[_i-1]=arguments[_i]}return function(selector){var _a;var matched=matchMap(fn,this);if(selector){matched=filterArray(matched,selector,this.options.xmlMode,(_a=this._root)===null||_a===void 0?void 0:_a[0])}return this._make(this.length>1&&matched.length>1?postFns.reduce((function(elems,fn){return fn(elems)}),matched):matched)}}}var _matcher=_getMatcher((function(fn,elems){var _a;var ret=[];for(var i=0;i<elems.length;i++){var value=fn(elems[i]);ret.push(value)}return(_a=new Array).concat.apply(_a,ret)}));var _singleMatcher=_getMatcher((function(fn,elems){var ret=[];for(var i=0;i<elems.length;i++){var value=fn(elems[i]);if(value!==null){ret.push(value)}}return ret}));function _matchUntil(nextElem){var postFns=[];for(var _i=1;_i<arguments.length;_i++){postFns[_i-1]=arguments[_i]}var matches=null;var innerMatcher=_getMatcher((function(nextElem,elems){var matched=[];(0,utils_js_1.domEach)(elems,(function(elem){for(var next_1;next_1=nextElem(elem);elem=next_1){if(matches===null||matches===void 0?void 0:matches(next_1,matched.length))break;matched.push(next_1)}}));return matched})).apply(void 0,__spreadArray([nextElem],postFns,false));return function(selector,filterSelector){var _this=this;matches=typeof selector==="string"?function(elem){return select.is(elem,selector,_this.options)}:selector?getFilterFn(selector):null;var ret=innerMatcher.call(this,filterSelector);matches=null;return ret}}function _removeDuplicates(elems){return Array.from(new Set(elems))}exports.parent=_singleMatcher((function(_a){var parent=_a.parent;return parent&&!(0,domhandler_1.isDocument)(parent)?parent:null}),_removeDuplicates);exports.parents=_matcher((function(elem){var matched=[];while(elem.parent&&!(0,domhandler_1.isDocument)(elem.parent)){matched.push(elem.parent);elem=elem.parent}return matched}),domutils_1.uniqueSort,(function(elems){return elems.reverse()}));exports.parentsUntil=_matchUntil((function(_a){var parent=_a.parent;return parent&&!(0,domhandler_1.isDocument)(parent)?parent:null}),domutils_1.uniqueSort,(function(elems){return elems.reverse()}));function closest(selector){var _a;var set=[];if(!selector){return this._make(set)}var selectOpts={xmlMode:this.options.xmlMode,root:(_a=this._root)===null||_a===void 0?void 0:_a[0]};var selectFn=typeof selector==="string"?function(elem){return select.is(elem,selector,selectOpts)}:getFilterFn(selector);(0,utils_js_1.domEach)(this,(function(elem){while(elem&&(0,utils_js_1.isTag)(elem)){if(selectFn(elem,0)){if(!set.includes(elem)){set.push(elem)}break}elem=elem.parent}}));return this._make(set)}exports.closest=closest;exports.next=_singleMatcher((function(elem){return(0,domutils_1.nextElementSibling)(elem)}));exports.nextAll=_matcher((function(elem){var matched=[];while(elem.next){elem=elem.next;if((0,utils_js_1.isTag)(elem))matched.push(elem)}return matched}),_removeDuplicates);exports.nextUntil=_matchUntil((function(el){return(0,domutils_1.nextElementSibling)(el)}),_removeDuplicates);exports.prev=_singleMatcher((function(elem){return(0,domutils_1.prevElementSibling)(elem)}));exports.prevAll=_matcher((function(elem){var matched=[];while(elem.prev){elem=elem.prev;if((0,utils_js_1.isTag)(elem))matched.push(elem)}return matched}),_removeDuplicates);exports.prevUntil=_matchUntil((function(el){return(0,domutils_1.prevElementSibling)(el)}),_removeDuplicates);exports.siblings=_matcher((function(elem){return(0,domutils_1.getSiblings)(elem).filter((function(el){return(0,utils_js_1.isTag)(el)&&el!==elem}))}),domutils_1.uniqueSort);exports.children=_matcher((function(elem){return(0,domutils_1.getChildren)(elem).filter(utils_js_1.isTag)}),_removeDuplicates);function contents(){var elems=this.toArray().reduce((function(newElems,elem){return(0,domhandler_1.hasChildren)(elem)?newElems.concat(elem.children):newElems}),[]);return this._make(elems)}exports.contents=contents;function each(fn){var i=0;var len=this.length;while(i<len&&fn.call(this[i],i,this[i])!==false)++i;return this}exports.each=each;function map(fn){var elems=[];for(var i=0;i<this.length;i++){var el=this[i];var val=fn.call(el,i,el);if(val!=null){elems=elems.concat(val)}}return this._make(elems)}exports.map=map;function getFilterFn(match){if(typeof match==="function"){return function(el,i){return match.call(el,i,el)}}if((0,utils_js_1.isCheerio)(match)){return function(el){return Array.prototype.includes.call(match,el)}}return function(el){return match===el}}function filter(match){var _a;return this._make(filterArray(this.toArray(),match,this.options.xmlMode,(_a=this._root)===null||_a===void 0?void 0:_a[0]))}exports.filter=filter;function filterArray(nodes,match,xmlMode,root){return typeof match==="string"?select.filter(match,nodes,{xmlMode:xmlMode,root:root}):nodes.filter(getFilterFn(match))}exports.filterArray=filterArray;function is(selector){var nodes=this.toArray();return typeof selector==="string"?select.some(nodes.filter(utils_js_1.isTag),selector,this.options):selector?nodes.some(getFilterFn(selector)):false}exports.is=is;function not(match){var nodes=this.toArray();if(typeof match==="string"){var matches_1=new Set(select.filter(match,nodes,this.options));nodes=nodes.filter((function(el){return!matches_1.has(el)}))}else{var filterFn_1=getFilterFn(match);nodes=nodes.filter((function(el,i){return!filterFn_1(el,i)}))}return this._make(nodes)}exports.not=not;function has(selectorOrHaystack){var _this=this;return this.filter(typeof selectorOrHaystack==="string"?":has(".concat(selectorOrHaystack,")"):function(_,el){return _this._make(el).find(selectorOrHaystack).length>0})}exports.has=has;function first(){return this.length>1?this._make(this[0]):this}exports.first=first;function last(){return this.length>0?this._make(this[this.length-1]):this}exports.last=last;function eq(i){var _a;i=+i;if(i===0&&this.length<=1)return this;if(i<0)i=this.length+i;return this._make((_a=this[i])!==null&&_a!==void 0?_a:[])}exports.eq=eq;function get(i){if(i==null){return this.toArray()}return this[i<0?this.length+i:i]}exports.get=get;function toArray(){return Array.prototype.slice.call(this)}exports.toArray=toArray;function index(selectorOrNeedle){var $haystack;var needle;if(selectorOrNeedle==null){$haystack=this.parent().children();needle=this[0]}else if(typeof selectorOrNeedle==="string"){$haystack=this._make(selectorOrNeedle);needle=this[0]}else{$haystack=this;needle=(0,utils_js_1.isCheerio)(selectorOrNeedle)?selectorOrNeedle[0]:selectorOrNeedle}return Array.prototype.indexOf.call($haystack,needle)}exports.index=index;function slice(start,end){return this._make(Array.prototype.slice.call(this,start,end))}exports.slice=slice;function end(){var _a;return(_a=this.prevObject)!==null&&_a!==void 0?_a:this._make([])}exports.end=end;function add(other,context){var selection=this._make(other,context);var contents=(0,domutils_1.uniqueSort)(__spreadArray(__spreadArray([],this.get(),true),selection.get(),true));return this._make(contents)}exports.add=add;function addBack(selector){return this.prevObject?this.add(selector?this.prevObject.filter(selector):this.prevObject):this}exports.addBack=addBack},{"../static.js":108,"../utils.js":110,"cheerio-select":95,domhandler:152,domutils:156}],102:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};Object.defineProperty(exports,"__esModule",{value:true});exports.Cheerio=void 0;var Attributes=__importStar(require("./api/attributes.js"));var Traversing=__importStar(require("./api/traversing.js"));var Manipulation=__importStar(require("./api/manipulation.js"));var Css=__importStar(require("./api/css.js"));var Forms=__importStar(require("./api/forms.js"));var Cheerio=function(){function Cheerio(elements,root,options){this.length=0;this.options=options;this._root=root;if(elements){for(var idx=0;idx<elements.length;idx++){this[idx]=elements[idx]}this.length=elements.length}}return Cheerio}();exports.Cheerio=Cheerio;Cheerio.prototype.cheerio="[cheerio object]";Cheerio.prototype.splice=Array.prototype.splice;Cheerio.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];Object.assign(Cheerio.prototype,Attributes,Traversing,Manipulation,Css,Forms)},{"./api/attributes.js":97,"./api/css.js":98,"./api/forms.js":99,"./api/manipulation.js":100,"./api/traversing.js":101}],103:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.root=exports.parseHTML=exports.merge=exports.contains=exports.text=exports.xml=exports.html=exports.load=void 0;__exportStar(require("./types.js"),exports);var load_js_1=require("./load.js");var parse_js_1=require("./parse.js");var parse5_adapter_js_1=require("./parsers/parse5-adapter.js");var dom_serializer_1=__importDefault(require("dom-serializer"));var htmlparser2_1=require("htmlparser2");var parse=(0,parse_js_1.getParse)((function(content,options,isDocument,context){return options.xmlMode||options._useHtmlParser2?(0,htmlparser2_1.parseDocument)(content,options):(0,parse5_adapter_js_1.parseWithParse5)(content,options,isDocument,context)}));exports.load=(0,load_js_1.getLoad)(parse,(function(dom,options){return options.xmlMode||options._useHtmlParser2?(0,dom_serializer_1.default)(dom,options):(0,parse5_adapter_js_1.renderWithParse5)(dom)}));exports.default=(0,exports.load)([]);var static_js_1=require("./static.js");Object.defineProperty(exports,"html",{enumerable:true,get:function(){return static_js_1.html}});Object.defineProperty(exports,"xml",{enumerable:true,get:function(){return static_js_1.xml}});Object.defineProperty(exports,"text",{enumerable:true,get:function(){return static_js_1.text}});var staticMethods=__importStar(require("./static.js"));exports.contains=staticMethods.contains;exports.merge=staticMethods.merge;exports.parseHTML=staticMethods.parseHTML;exports.root=staticMethods.root},{"./load.js":104,"./parse.js":106,"./parsers/parse5-adapter.js":107,"./static.js":108,"./types.js":109,"dom-serializer":150,htmlparser2:231}],104:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};Object.defineProperty(exports,"__esModule",{value:true});exports.getLoad=void 0;var options_js_1=__importStar(require("./options.js"));var staticMethods=__importStar(require("./static.js"));var cheerio_js_1=require("./cheerio.js");var utils_js_1=require("./utils.js");function getLoad(parse,render){return function load(content,options,isDocument){if(isDocument===void 0){isDocument=true}if(content==null){throw new Error("cheerio.load() expects a string")}var internalOpts=__assign(__assign({},options_js_1.default),(0,options_js_1.flatten)(options));var initialRoot=parse(content,internalOpts,isDocument,null);var LoadedCheerio=function(_super){__extends(LoadedCheerio,_super);function LoadedCheerio(){return _super!==null&&_super.apply(this,arguments)||this}LoadedCheerio.prototype._make=function(selector,context){var cheerio=initialize(selector,context);cheerio.prevObject=this;return cheerio};LoadedCheerio.prototype._parse=function(content,options,isDocument,context){return parse(content,options,isDocument,context)};LoadedCheerio.prototype._render=function(dom){return render(dom,this.options)};return LoadedCheerio}(cheerio_js_1.Cheerio);function initialize(selector,context,root,opts){if(root===void 0){root=initialRoot}if(selector&&(0,utils_js_1.isCheerio)(selector))return selector;var options=__assign(__assign({},internalOpts),(0,options_js_1.flatten)(opts));var r=typeof root==="string"?[parse(root,options,false,null)]:"length"in root?root:[root];var rootInstance=(0,utils_js_1.isCheerio)(r)?r:new LoadedCheerio(r,null,options);rootInstance._root=rootInstance;if(!selector){return new LoadedCheerio(undefined,rootInstance,options)}var elements=typeof selector==="string"&&(0,utils_js_1.isHtml)(selector)?parse(selector,options,false,null).children:isNode(selector)?[selector]:Array.isArray(selector)?selector:undefined;var instance=new LoadedCheerio(elements,rootInstance,options);if(elements){return instance}if(typeof selector!=="string"){throw new Error("Unexpected type of selector")}var search=selector;var searchContext=!context?rootInstance:typeof context==="string"?(0,utils_js_1.isHtml)(context)?new LoadedCheerio([parse(context,options,false,null)],rootInstance,options):(search="".concat(context," ").concat(search),rootInstance):(0,utils_js_1.isCheerio)(context)?context:new LoadedCheerio(Array.isArray(context)?context:[context],rootInstance,options);if(!searchContext)return instance;return searchContext.find(search)}Object.assign(initialize,staticMethods,{load:load,_root:initialRoot,_options:internalOpts,fn:LoadedCheerio.prototype,prototype:LoadedCheerio.prototype});return initialize}}exports.getLoad=getLoad;function isNode(obj){return!!obj.name||obj.type==="root"||obj.type==="text"||obj.type==="comment"}},{"./cheerio.js":102,"./options.js":105,"./static.js":108,"./utils.js":110}],105:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:true});exports.flatten=void 0;var defaultOpts={xml:false,decodeEntities:true};exports.default=defaultOpts;var xmlModeDefault={_useHtmlParser2:true,xmlMode:true};function flatten(options){return(options===null||options===void 0?void 0:options.xml)?typeof options.xml==="boolean"?xmlModeDefault:__assign(__assign({},xmlModeDefault),options.xml):options!==null&&options!==void 0?options:undefined}exports.flatten=flatten},{}],106:[function(require,module,exports){(function(Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.update=exports.getParse=void 0;var domutils_1=require("domutils");var domhandler_1=require("domhandler");function getParse(parser){return function parse(content,options,isDocument,context){if(typeof Buffer!=="undefined"&&Buffer.isBuffer(content)){content=content.toString()}if(typeof content==="string"){return parser(content,options,isDocument,context)}var doc=content;if(!Array.isArray(doc)&&(0,domhandler_1.isDocument)(doc)){return doc}var root=new domhandler_1.Document([]);update(doc,root);return root}}exports.getParse=getParse;function update(newChilds,parent){var arr=Array.isArray(newChilds)?newChilds:[newChilds];if(parent){parent.children=arr}else{parent=null}for(var i=0;i<arr.length;i++){var node=arr[i];if(node.parent&&node.parent.children!==arr){(0,domutils_1.removeElement)(node)}if(parent){node.prev=arr[i-1]||null;node.next=arr[i+1]||null}else{node.prev=node.next=null}node.parent=parent}return parent}exports.update=update}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88,domhandler:152,domutils:156}],107:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.renderWithParse5=exports.parseWithParse5=void 0;var domhandler_1=require("domhandler");var parse5_1=require("parse5");var parse5_htmlparser2_tree_adapter_1=require("parse5-htmlparser2-tree-adapter");function parseWithParse5(content,options,isDocument,context){var opts={scriptingEnabled:typeof options.scriptingEnabled==="boolean"?options.scriptingEnabled:true,treeAdapter:parse5_htmlparser2_tree_adapter_1.adapter,sourceCodeLocationInfo:options.sourceCodeLocationInfo};return isDocument?(0,parse5_1.parse)(content,opts):(0,parse5_1.parseFragment)(context,content,opts)}exports.parseWithParse5=parseWithParse5;var renderOpts={treeAdapter:parse5_htmlparser2_tree_adapter_1.adapter};function renderWithParse5(dom){var _a;var nodes="length"in dom?dom:[dom];for(var index=0;index<nodes.length;index+=1){var node=nodes[index];if((0,domhandler_1.isDocument)(node)){(_a=Array.prototype.splice).call.apply(_a,__spreadArray([nodes,index,1],node.children,false))}}var result="";for(var index=0;index<nodes.length;index+=1){var node=nodes[index];result+=(0,parse5_1.serializeOuter)(node,renderOpts)}return result}exports.renderWithParse5=renderWithParse5},{domhandler:152,parse5:360,"parse5-htmlparser2-tree-adapter":353}],108:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};Object.defineProperty(exports,"__esModule",{value:true});exports.merge=exports.contains=exports.root=exports.parseHTML=exports.text=exports.xml=exports.html=void 0;var domutils_1=require("domutils");var options_js_1=__importStar(require("./options.js"));function render(that,dom,options){if(!that)return"";return that(dom!==null&&dom!==void 0?dom:that._root.children,null,undefined,options).toString()}function isOptions(dom,options){return!options&&typeof dom==="object"&&dom!=null&&!("length"in dom)&&!("type"in dom)}function html(dom,options){var toRender=isOptions(dom)?(options=dom,undefined):dom;var opts=__assign(__assign(__assign({},options_js_1.default),this===null||this===void 0?void 0:this._options),(0,options_js_1.flatten)(options!==null&&options!==void 0?options:{}));return render(this,toRender,opts)}exports.html=html;function xml(dom){var options=__assign(__assign({},this._options),{xmlMode:true});return render(this,dom,options)}exports.xml=xml;function text(elements){var elems=elements?elements:this?this.root():[];var ret="";for(var i=0;i<elems.length;i++){ret+=(0,domutils_1.textContent)(elems[i])}return ret}exports.text=text;function parseHTML(data,context,keepScripts){if(keepScripts===void 0){keepScripts=typeof context==="boolean"?context:false}if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){keepScripts=context}var parsed=this.load(data,options_js_1.default,false);if(!keepScripts){parsed("script").remove()}return parsed.root()[0].children.slice()}exports.parseHTML=parseHTML;function root(){return this(this._root)}exports.root=root;function contains(container,contained){if(contained===container){return false}var next=contained;while(next&&next!==next.parent){next=next.parent;if(next===container){return true}}return false}exports.contains=contains;function merge(arr1,arr2){if(!isArrayLike(arr1)||!isArrayLike(arr2)){return}var newLength=arr1.length;var len=+arr2.length;for(var i=0;i<len;i++){arr1[newLength++]=arr2[i]}arr1.length=newLength;return arr1}exports.merge=merge;function isArrayLike(item){if(Array.isArray(item)){return true}if(typeof item!=="object"||!Object.prototype.hasOwnProperty.call(item,"length")||typeof item.length!=="number"||item.length<0){return false}for(var i=0;i<item.length;i++){if(!(i in item)){return false}}return true}},{"./options.js":105,domutils:156}],109:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true})},{}],110:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isHtml=exports.cloneDom=exports.domEach=exports.cssCase=exports.camelCase=exports.isCheerio=exports.isTag=void 0;var domhandler_1=require("domhandler");var domhandler_2=require("domhandler");Object.defineProperty(exports,"isTag",{enumerable:true,get:function(){return domhandler_2.isTag}});function isCheerio(maybeCheerio){return maybeCheerio.cheerio!=null}exports.isCheerio=isCheerio;function camelCase(str){return str.replace(/[_.-](\w|$)/g,(function(_,x){return x.toUpperCase()}))}exports.camelCase=camelCase;function cssCase(str){return str.replace(/[A-Z]/g,"-$&").toLowerCase()}exports.cssCase=cssCase;function domEach(array,fn){var len=array.length;for(var i=0;i<len;i++)fn(array[i],i);return array}exports.domEach=domEach;function cloneDom(dom){var clone="length"in dom?Array.prototype.map.call(dom,(function(el){return(0,domhandler_1.cloneNode)(el,true)})):[(0,domhandler_1.cloneNode)(dom,true)];var root=new domhandler_1.Document(clone);clone.forEach((function(node){node.parent=root}));return clone}exports.cloneDom=cloneDom;var CharacterCodes;(function(CharacterCodes){CharacterCodes[CharacterCodes["LowerA"]=97]="LowerA";CharacterCodes[CharacterCodes["LowerZ"]=122]="LowerZ";CharacterCodes[CharacterCodes["UpperA"]=65]="UpperA";CharacterCodes[CharacterCodes["UpperZ"]=90]="UpperZ";CharacterCodes[CharacterCodes["Exclamation"]=33]="Exclamation"})(CharacterCodes||(CharacterCodes={}));function isHtml(str){var tagStart=str.indexOf("<");if(tagStart<0||tagStart>str.length-3)return false;var tagChar=str.charCodeAt(tagStart+1);return(tagChar>=CharacterCodes.LowerA&&tagChar<=CharacterCodes.LowerZ||tagChar>=CharacterCodes.UpperA&&tagChar<=CharacterCodes.UpperZ||tagChar===CharacterCodes.Exclamation)&&str.includes(">",tagStart+2)}exports.isHtml=isHtml},{domhandler:152}],111:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;var Transform=require("stream").Transform;var StringDecoder=require("string_decoder").StringDecoder;var inherits=require("inherits");function CipherBase(hashMode){Transform.call(this);this.hashMode=typeof hashMode==="string";if(this.hashMode){this[hashMode]=this._finalOrDigest}else{this.final=this._finalOrDigest}if(this._final){this.__final=this._final;this._final=null}this._decoder=null;this._encoding=null}inherits(CipherBase,Transform);CipherBase.prototype.update=function(data,inputEnc,outputEnc){if(typeof data==="string"){data=Buffer.from(data,inputEnc)}var outData=this._update(data);if(this.hashMode)return this;if(outputEnc){outData=this._toString(outData,outputEnc)}return outData};CipherBase.prototype.setAutoPadding=function(){};CipherBase.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")};CipherBase.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")};CipherBase.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")};CipherBase.prototype._transform=function(data,_,next){var err;try{if(this.hashMode){this._update(data)}else{this.push(this._update(data))}}catch(e){err=e}finally{next(err)}};CipherBase.prototype._flush=function(done){var err;try{this.push(this.__final())}catch(e){err=e}done(err)};CipherBase.prototype._finalOrDigest=function(outputEnc){var outData=this.__final()||Buffer.alloc(0);if(outputEnc){outData=this._toString(outData,outputEnc,true)}return outData};CipherBase.prototype._toString=function(value,enc,fin){if(!this._decoder){this._decoder=new StringDecoder(enc);this._encoding=enc}if(this._encoding!==enc)throw new Error("can't switch encodings");var out=this._decoder.write(value);if(fin){out+=this._decoder.end()}return out};module.exports=CipherBase},{inherits:233,"safe-buffer":385,stream:398,string_decoder:432}],112:[function(require,module,exports){(function(Buffer){(function(){var elliptic=require("elliptic");var BN=require("bn.js");module.exports=function createECDH(curve){return new ECDH(curve)};var aliases={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};aliases.p224=aliases.secp224r1;aliases.p256=aliases.secp256r1=aliases.prime256v1;aliases.p192=aliases.secp192r1=aliases.prime192v1;aliases.p384=aliases.secp384r1;aliases.p521=aliases.secp521r1;function ECDH(curve){this.curveType=aliases[curve];if(!this.curveType){this.curveType={name:curve}}this.curve=new elliptic.ec(this.curveType.name);this.keys=void 0}ECDH.prototype.generateKeys=function(enc,format){this.keys=this.curve.genKeyPair();return this.getPublicKey(enc,format)};ECDH.prototype.computeSecret=function(other,inenc,enc){inenc=inenc||"utf8";if(!Buffer.isBuffer(other)){other=new Buffer(other,inenc)}var otherPub=this.curve.keyFromPublic(other).getPublic();var out=otherPub.mul(this.keys.getPrivate()).getX();return formatReturnValue(out,enc,this.curveType.byteLength)};ECDH.prototype.getPublicKey=function(enc,format){var key=this.keys.getPublic(format==="compressed",true);if(format==="hybrid"){if(key[key.length-1]%2){key[0]=7}else{key[0]=6}}return formatReturnValue(key,enc)};ECDH.prototype.getPrivateKey=function(enc){return formatReturnValue(this.keys.getPrivate(),enc)};ECDH.prototype.setPublicKey=function(pub,enc){enc=enc||"utf8";if(!Buffer.isBuffer(pub)){pub=new Buffer(pub,enc)}this.keys._importPublic(pub);return this};ECDH.prototype.setPrivateKey=function(priv,enc){enc=enc||"utf8";if(!Buffer.isBuffer(priv)){priv=new Buffer(priv,enc)}var _priv=new BN(priv);_priv=_priv.toString(16);this.keys=this.curve.genKeyPair();this.keys._importPrivate(_priv);return this};function formatReturnValue(bn,enc,len){if(!Array.isArray(bn)){bn=bn.toArray()}var buf=new Buffer(bn);if(len&&buf.length<len){var zeros=new Buffer(len-buf.length);zeros.fill(0);buf=Buffer.concat([zeros,buf])}if(!enc){return buf}else{return buf.toString(enc)}}}).call(this)}).call(this,require("buffer").Buffer)},{"bn.js":113,buffer:88,elliptic:162}],113:[function(require,module,exports){arguments[4][34][0].apply(exports,arguments)},{buffer:88,dup:34}],114:[function(require,module,exports){"use strict";var inherits=require("inherits");var MD5=require("md5.js");var RIPEMD160=require("ripemd160");var sha=require("sha.js");var Base=require("cipher-base");function Hash(hash){Base.call(this,"digest");this._hash=hash}inherits(Hash,Base);Hash.prototype._update=function(data){this._hash.update(data)};Hash.prototype._final=function(){return this._hash.digest()};module.exports=function createHash(alg){alg=alg.toLowerCase();if(alg==="md5")return new MD5;if(alg==="rmd160"||alg==="ripemd160")return new RIPEMD160;return new Hash(sha(alg))}},{"cipher-base":111,inherits:233,"md5.js":283,ripemd160:384,"sha.js":389}],115:[function(require,module,exports){var MD5=require("md5.js");module.exports=function(buffer){return(new MD5).update(buffer).digest()}},{"md5.js":283}],116:[function(require,module,exports){"use strict";var inherits=require("inherits");var Legacy=require("./legacy");var Base=require("cipher-base");var Buffer=require("safe-buffer").Buffer;var md5=require("create-hash/md5");var RIPEMD160=require("ripemd160");var sha=require("sha.js");var ZEROS=Buffer.alloc(128);function Hmac(alg,key){Base.call(this,"digest");if(typeof key==="string"){key=Buffer.from(key)}var blocksize=alg==="sha512"||alg==="sha384"?128:64;this._alg=alg;this._key=key;if(key.length>blocksize){var hash=alg==="rmd160"?new RIPEMD160:sha(alg);key=hash.update(key).digest()}else if(key.length<blocksize){key=Buffer.concat([key,ZEROS],blocksize)}var ipad=this._ipad=Buffer.allocUnsafe(blocksize);var opad=this._opad=Buffer.allocUnsafe(blocksize);for(var i=0;i<blocksize;i++){ipad[i]=key[i]^54;opad[i]=key[i]^92}this._hash=alg==="rmd160"?new RIPEMD160:sha(alg);this._hash.update(ipad)}inherits(Hmac,Base);Hmac.prototype._update=function(data){this._hash.update(data)};Hmac.prototype._final=function(){var h=this._hash.digest();var hash=this._alg==="rmd160"?new RIPEMD160:sha(this._alg);return hash.update(this._opad).update(h).digest()};module.exports=function createHmac(alg,key){alg=alg.toLowerCase();if(alg==="rmd160"||alg==="ripemd160"){return new Hmac("rmd160",key)}if(alg==="md5"){return new Legacy(md5,key)}return new Hmac(alg,key)}},{"./legacy":117,"cipher-base":111,"create-hash/md5":115,inherits:233,ripemd160:384,"safe-buffer":385,"sha.js":389}],117:[function(require,module,exports){"use strict";var inherits=require("inherits");var Buffer=require("safe-buffer").Buffer;var Base=require("cipher-base");var ZEROS=Buffer.alloc(128);var blocksize=64;function Hmac(alg,key){Base.call(this,"digest");if(typeof key==="string"){key=Buffer.from(key)}this._alg=alg;this._key=key;if(key.length>blocksize){key=alg(key)}else if(key.length<blocksize){key=Buffer.concat([key,ZEROS],blocksize)}var ipad=this._ipad=Buffer.allocUnsafe(blocksize);var opad=this._opad=Buffer.allocUnsafe(blocksize);for(var i=0;i<blocksize;i++){ipad[i]=key[i]^54;opad[i]=key[i]^92}this._hash=[ipad]}inherits(Hmac,Base);Hmac.prototype._update=function(data){this._hash.push(data)};Hmac.prototype._final=function(){var h=this._alg(Buffer.concat(this._hash));return this._alg(Buffer.concat([this._opad,h]))};module.exports=Hmac},{"cipher-base":111,inherits:233,"safe-buffer":385}],118:[function(require,module,exports){"use strict";exports.randomBytes=exports.rng=exports.pseudoRandomBytes=exports.prng=require("randombytes");exports.createHash=exports.Hash=require("create-hash");exports.createHmac=exports.Hmac=require("create-hmac");var algos=require("browserify-sign/algos");var algoKeys=Object.keys(algos);var hashes=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(algoKeys);exports.getHashes=function(){return hashes};var p=require("pbkdf2");exports.pbkdf2=p.pbkdf2;exports.pbkdf2Sync=p.pbkdf2Sync;var aes=require("browserify-cipher");exports.Cipher=aes.Cipher;exports.createCipher=aes.createCipher;exports.Cipheriv=aes.Cipheriv;exports.createCipheriv=aes.createCipheriv;exports.Decipher=aes.Decipher;exports.createDecipher=aes.createDecipher;exports.Decipheriv=aes.Decipheriv;exports.createDecipheriv=aes.createDecipheriv;exports.getCiphers=aes.getCiphers;exports.listCiphers=aes.listCiphers;var dh=require("diffie-hellman");exports.DiffieHellmanGroup=dh.DiffieHellmanGroup;exports.createDiffieHellmanGroup=dh.createDiffieHellmanGroup;exports.getDiffieHellman=dh.getDiffieHellman;exports.createDiffieHellman=dh.createDiffieHellman;exports.DiffieHellman=dh.DiffieHellman;var sign=require("browserify-sign");exports.createSign=sign.createSign;exports.Sign=sign.Sign;exports.createVerify=sign.createVerify;exports.Verify=sign.Verify;exports.createECDH=require("create-ecdh");var publicEncrypt=require("public-encrypt");exports.publicEncrypt=publicEncrypt.publicEncrypt;exports.privateEncrypt=publicEncrypt.privateEncrypt;exports.publicDecrypt=publicEncrypt.publicDecrypt;exports.privateDecrypt=publicEncrypt.privateDecrypt;var rf=require("randomfill");exports.randomFill=rf.randomFill;exports.randomFillSync=rf.randomFillSync;exports.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))};exports.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":61,"browserify-sign":68,"browserify-sign/algos":65,"create-ecdh":112,"create-hash":114,"create-hmac":116,"diffie-hellman":144,pbkdf2:369,"public-encrypt":375,randombytes:382,randomfill:383}],119:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.attributeRules=void 0;var boolbase_1=__importDefault(require("boolbase"));var reChars=/[-[\]{}()*+?.,\\^$|#\s]/g;function escapeRegex(value){return value.replace(reChars,"\\$&")}var caseInsensitiveAttributes=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function shouldIgnoreCase(selector,options){return typeof selector.ignoreCase==="boolean"?selector.ignoreCase:selector.ignoreCase==="quirks"?!!options.quirksMode:!options.xmlMode&&caseInsensitiveAttributes.has(selector.name)}exports.attributeRules={equals:function(next,data,options){var adapter=options.adapter;var name=data.name;var value=data.value;if(shouldIgnoreCase(data,options)){value=value.toLowerCase();return function(elem){var attr=adapter.getAttributeValue(elem,name);return attr!=null&&attr.length===value.length&&attr.toLowerCase()===value&&next(elem)}}return function(elem){return adapter.getAttributeValue(elem,name)===value&&next(elem)}},hyphen:function(next,data,options){var adapter=options.adapter;var name=data.name;var value=data.value;var len=value.length;if(shouldIgnoreCase(data,options)){value=value.toLowerCase();return function hyphenIC(elem){var attr=adapter.getAttributeValue(elem,name);return attr!=null&&(attr.length===len||attr.charAt(len)==="-")&&attr.substr(0,len).toLowerCase()===value&&next(elem)}}return function hyphen(elem){var attr=adapter.getAttributeValue(elem,name);return attr!=null&&(attr.length===len||attr.charAt(len)==="-")&&attr.substr(0,len)===value&&next(elem)}},element:function(next,data,options){var adapter=options.adapter;var name=data.name,value=data.value;if(/\s/.test(value)){return boolbase_1.default.falseFunc}var regex=new RegExp("(?:^|\\s)".concat(escapeRegex(value),"(?:$|\\s)"),shouldIgnoreCase(data,options)?"i":"");return function element(elem){var attr=adapter.getAttributeValue(elem,name);return attr!=null&&attr.length>=value.length&&regex.test(attr)&&next(elem)}},exists:function(next,_a,_b){var name=_a.name;var adapter=_b.adapter;return function(elem){return adapter.hasAttrib(elem,name)&&next(elem)}},start:function(next,data,options){var adapter=options.adapter;var name=data.name;var value=data.value;var len=value.length;if(len===0){return boolbase_1.default.falseFunc}if(shouldIgnoreCase(data,options)){value=value.toLowerCase();return function(elem){var attr=adapter.getAttributeValue(elem,name);return attr!=null&&attr.length>=len&&attr.substr(0,len).toLowerCase()===value&&next(elem)}}return function(elem){var _a;return!!((_a=adapter.getAttributeValue(elem,name))===null||_a===void 0?void 0:_a.startsWith(value))&&next(elem)}},end:function(next,data,options){var adapter=options.adapter;var name=data.name;var value=data.value;var len=-value.length;if(len===0){return boolbase_1.default.falseFunc}if(shouldIgnoreCase(data,options)){value=value.toLowerCase();return function(elem){var _a;return((_a=adapter.getAttributeValue(elem,name))===null||_a===void 0?void 0:_a.substr(len).toLowerCase())===value&&next(elem)}}return function(elem){var _a;return!!((_a=adapter.getAttributeValue(elem,name))===null||_a===void 0?void 0:_a.endsWith(value))&&next(elem)}},any:function(next,data,options){var adapter=options.adapter;var name=data.name,value=data.value;if(value===""){return boolbase_1.default.falseFunc}if(shouldIgnoreCase(data,options)){var regex_1=new RegExp(escapeRegex(value),"i");return function anyIC(elem){var attr=adapter.getAttributeValue(elem,name);return attr!=null&&attr.length>=value.length&&regex_1.test(attr)&&next(elem)}}return function(elem){var _a;return!!((_a=adapter.getAttributeValue(elem,name))===null||_a===void 0?void 0:_a.includes(value))&&next(elem)}},not:function(next,data,options){var adapter=options.adapter;var name=data.name;var value=data.value;if(value===""){return function(elem){return!!adapter.getAttributeValue(elem,name)&&next(elem)}}else if(shouldIgnoreCase(data,options)){value=value.toLowerCase();return function(elem){var attr=adapter.getAttributeValue(elem,name);return(attr==null||attr.length!==value.length||attr.toLowerCase()!==value)&&next(elem)}}return function(elem){return adapter.getAttributeValue(elem,name)!==value&&next(elem)}}}},{boolbase:41}],120:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.compileToken=exports.compileUnsafe=exports.compile=void 0;var css_what_1=require("css-what");var boolbase_1=__importDefault(require("boolbase"));var sort_js_1=__importStar(require("./sort.js"));var general_js_1=require("./general.js");var subselects_js_1=require("./pseudo-selectors/subselects.js");function compile(selector,options,context){var next=compileUnsafe(selector,options,context);return(0,subselects_js_1.ensureIsTag)(next,options.adapter)}exports.compile=compile;function compileUnsafe(selector,options,context){var token=typeof selector==="string"?(0,css_what_1.parse)(selector):selector;return compileToken(token,options,context)}exports.compileUnsafe=compileUnsafe;function includesScopePseudo(t){return t.type===css_what_1.SelectorType.Pseudo&&(t.name==="scope"||Array.isArray(t.data)&&t.data.some((function(data){return data.some(includesScopePseudo)})))}var DESCENDANT_TOKEN={type:css_what_1.SelectorType.Descendant};var FLEXIBLE_DESCENDANT_TOKEN={type:"_flexibleDescendant"};var SCOPE_TOKEN={type:css_what_1.SelectorType.Pseudo,name:"scope",data:null};function absolutize(token,_a,context){var adapter=_a.adapter;var hasContext=!!(context===null||context===void 0?void 0:context.every((function(e){var parent=adapter.isTag(e)&&adapter.getParent(e);return e===subselects_js_1.PLACEHOLDER_ELEMENT||parent&&adapter.isTag(parent)})));for(var _i=0,token_1=token;_i<token_1.length;_i++){var t=token_1[_i];if(t.length>0&&(0,sort_js_1.isTraversal)(t[0])&&t[0].type!==css_what_1.SelectorType.Descendant){}else if(hasContext&&!t.some(includesScopePseudo)){t.unshift(DESCENDANT_TOKEN)}else{continue}t.unshift(SCOPE_TOKEN)}}function compileToken(token,options,context){var _a;token.forEach(sort_js_1.default);context=(_a=options.context)!==null&&_a!==void 0?_a:context;var isArrayContext=Array.isArray(context);var finalContext=context&&(Array.isArray(context)?context:[context]);if(options.relativeSelector!==false){absolutize(token,options,finalContext)}else if(token.some((function(t){return t.length>0&&(0,sort_js_1.isTraversal)(t[0])}))){throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled")}var shouldTestNextSiblings=false;var query=token.map((function(rules){if(rules.length>=2){var first=rules[0],second=rules[1];if(first.type!==css_what_1.SelectorType.Pseudo||first.name!=="scope"){}else if(isArrayContext&&second.type===css_what_1.SelectorType.Descendant){rules[1]=FLEXIBLE_DESCENDANT_TOKEN}else if(second.type===css_what_1.SelectorType.Adjacent||second.type===css_what_1.SelectorType.Sibling){shouldTestNextSiblings=true}}return compileRules(rules,options,finalContext)})).reduce(reduceRules,boolbase_1.default.falseFunc);query.shouldTestNextSiblings=shouldTestNextSiblings;return query}exports.compileToken=compileToken;function compileRules(rules,options,context){var _a;return rules.reduce((function(previous,rule){return previous===boolbase_1.default.falseFunc?boolbase_1.default.falseFunc:(0,general_js_1.compileGeneralSelector)(previous,rule,options,context,compileToken)}),(_a=options.rootFunc)!==null&&_a!==void 0?_a:boolbase_1.default.trueFunc)}function reduceRules(a,b){if(b===boolbase_1.default.falseFunc||a===boolbase_1.default.trueFunc){return a}if(a===boolbase_1.default.falseFunc||b===boolbase_1.default.trueFunc){return b}return function combine(elem){return a(elem)||b(elem)}}},{"./general.js":121,"./pseudo-selectors/subselects.js":127,"./sort.js":128,boolbase:41,"css-what":129}],121:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.compileGeneralSelector=void 0;var attributes_js_1=require("./attributes.js");var index_js_1=require("./pseudo-selectors/index.js");var css_what_1=require("css-what");function getElementParent(node,adapter){var parent=adapter.getParent(node);if(parent&&adapter.isTag(parent)){return parent}return null}function compileGeneralSelector(next,selector,options,context,compileToken){var adapter=options.adapter,equals=options.equals;switch(selector.type){case css_what_1.SelectorType.PseudoElement:{throw new Error("Pseudo-elements are not supported by css-select")}case css_what_1.SelectorType.ColumnCombinator:{throw new Error("Column combinators are not yet supported by css-select")}case css_what_1.SelectorType.Attribute:{if(selector.namespace!=null){throw new Error("Namespaced attributes are not yet supported by css-select")}if(!options.xmlMode||options.lowerCaseAttributeNames){selector.name=selector.name.toLowerCase()}return attributes_js_1.attributeRules[selector.action](next,selector,options)}case css_what_1.SelectorType.Pseudo:{return(0,index_js_1.compilePseudoSelector)(next,selector,options,context,compileToken)}case css_what_1.SelectorType.Tag:{if(selector.namespace!=null){throw new Error("Namespaced tag names are not yet supported by css-select")}var name_1=selector.name;if(!options.xmlMode||options.lowerCaseTags){name_1=name_1.toLowerCase()}return function tag(elem){return adapter.getName(elem)===name_1&&next(elem)}}case css_what_1.SelectorType.Descendant:{if(options.cacheResults===false||typeof WeakSet==="undefined"){return function descendant(elem){var current=elem;while(current=getElementParent(current,adapter)){if(next(current)){return true}}return false}}var isFalseCache_1=new WeakSet;return function cachedDescendant(elem){var current=elem;while(current=getElementParent(current,adapter)){if(!isFalseCache_1.has(current)){if(adapter.isTag(current)&&next(current)){return true}isFalseCache_1.add(current)}}return false}}case"_flexibleDescendant":{return function flexibleDescendant(elem){var current=elem;do{if(next(current))return true}while(current=getElementParent(current,adapter));return false}}case css_what_1.SelectorType.Parent:{return function parent(elem){return adapter.getChildren(elem).some((function(elem){return adapter.isTag(elem)&&next(elem)}))}}case css_what_1.SelectorType.Child:{return function child(elem){var parent=adapter.getParent(elem);return parent!=null&&adapter.isTag(parent)&&next(parent)}}case css_what_1.SelectorType.Sibling:{return function sibling(elem){var siblings=adapter.getSiblings(elem);for(var i=0;i<siblings.length;i++){var currentSibling=siblings[i];if(equals(elem,currentSibling))break;if(adapter.isTag(currentSibling)&&next(currentSibling)){return true}}return false}}case css_what_1.SelectorType.Adjacent:{if(adapter.prevElementSibling){return function adjacent(elem){var previous=adapter.prevElementSibling(elem);return previous!=null&&next(previous)}}return function adjacent(elem){var siblings=adapter.getSiblings(elem);var lastElement;for(var i=0;i<siblings.length;i++){var currentSibling=siblings[i];if(equals(elem,currentSibling))break;if(adapter.isTag(currentSibling)){lastElement=currentSibling}}return!!lastElement&&next(lastElement)}}case css_what_1.SelectorType.Universal:{if(selector.namespace!=null&&selector.namespace!=="*"){throw new Error("Namespaced universal selectors are not yet supported by css-select")}return next}}}exports.compileGeneralSelector=compileGeneralSelector},{"./attributes.js":119,"./pseudo-selectors/index.js":125,"css-what":129}],122:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.aliases=exports.pseudos=exports.filters=exports.is=exports.selectOne=exports.selectAll=exports.prepareContext=exports._compileToken=exports._compileUnsafe=exports.compile=void 0;var DomUtils=__importStar(require("domutils"));var boolbase_1=__importDefault(require("boolbase"));var compile_js_1=require("./compile.js");var subselects_js_1=require("./pseudo-selectors/subselects.js");var defaultEquals=function(a,b){return a===b};var defaultOptions={adapter:DomUtils,equals:defaultEquals};function convertOptionFormats(options){var _a,_b,_c,_d;var opts=options!==null&&options!==void 0?options:defaultOptions;(_a=opts.adapter)!==null&&_a!==void 0?_a:opts.adapter=DomUtils;(_b=opts.equals)!==null&&_b!==void 0?_b:opts.equals=(_d=(_c=opts.adapter)===null||_c===void 0?void 0:_c.equals)!==null&&_d!==void 0?_d:defaultEquals;return opts}function wrapCompile(func){return function addAdapter(selector,options,context){var opts=convertOptionFormats(options);return func(selector,opts,context)}}exports.compile=wrapCompile(compile_js_1.compile);exports._compileUnsafe=wrapCompile(compile_js_1.compileUnsafe);exports._compileToken=wrapCompile(compile_js_1.compileToken);function getSelectorFunc(searchFunc){return function select(query,elements,options){var opts=convertOptionFormats(options);if(typeof query!=="function"){query=(0,compile_js_1.compileUnsafe)(query,opts,elements)}var filteredElements=prepareContext(elements,opts.adapter,query.shouldTestNextSiblings);return searchFunc(query,filteredElements,opts)}}function prepareContext(elems,adapter,shouldTestNextSiblings){if(shouldTestNextSiblings===void 0){shouldTestNextSiblings=false}if(shouldTestNextSiblings){elems=appendNextSiblings(elems,adapter)}return Array.isArray(elems)?adapter.removeSubsets(elems):adapter.getChildren(elems)}exports.prepareContext=prepareContext;function appendNextSiblings(elem,adapter){var elems=Array.isArray(elem)?elem.slice(0):[elem];var elemsLength=elems.length;for(var i=0;i<elemsLength;i++){var nextSiblings=(0,subselects_js_1.getNextSiblings)(elems[i],adapter);elems.push.apply(elems,nextSiblings)}return elems}exports.selectAll=getSelectorFunc((function(query,elems,options){return query===boolbase_1.default.falseFunc||!elems||elems.length===0?[]:options.adapter.findAll(query,elems)}));exports.selectOne=getSelectorFunc((function(query,elems,options){return query===boolbase_1.default.falseFunc||!elems||elems.length===0?null:options.adapter.findOne(query,elems)}));function is(elem,query,options){var opts=convertOptionFormats(options);return(typeof query==="function"?query:(0,compile_js_1.compile)(query,opts))(elem)}exports.is=is;exports.default=exports.selectAll;var index_js_1=require("./pseudo-selectors/index.js");Object.defineProperty(exports,"filters",{enumerable:true,get:function(){return index_js_1.filters}});Object.defineProperty(exports,"pseudos",{enumerable:true,get:function(){return index_js_1.pseudos}});Object.defineProperty(exports,"aliases",{enumerable:true,get:function(){return index_js_1.aliases}})},{"./compile.js":120,"./pseudo-selectors/index.js":125,"./pseudo-selectors/subselects.js":127,boolbase:41,domutils:156}],123:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.aliases=void 0;exports.aliases={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:":is(\n        :is(button, input, select, textarea, optgroup, option)[disabled],\n        optgroup[disabled] > option,\n        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)\n    )",enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"}},{}],124:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.filters=void 0;var nth_check_1=__importDefault(require("nth-check"));var boolbase_1=__importDefault(require("boolbase"));function getChildFunc(next,adapter){return function(elem){var parent=adapter.getParent(elem);return parent!=null&&adapter.isTag(parent)&&next(elem)}}exports.filters={contains:function(next,text,_a){var adapter=_a.adapter;return function contains(elem){return next(elem)&&adapter.getText(elem).includes(text)}},icontains:function(next,text,_a){var adapter=_a.adapter;var itext=text.toLowerCase();return function icontains(elem){return next(elem)&&adapter.getText(elem).toLowerCase().includes(itext)}},"nth-child":function(next,rule,_a){var adapter=_a.adapter,equals=_a.equals;var func=(0,nth_check_1.default)(rule);if(func===boolbase_1.default.falseFunc)return boolbase_1.default.falseFunc;if(func===boolbase_1.default.trueFunc)return getChildFunc(next,adapter);return function nthChild(elem){var siblings=adapter.getSiblings(elem);var pos=0;for(var i=0;i<siblings.length;i++){if(equals(elem,siblings[i]))break;if(adapter.isTag(siblings[i])){pos++}}return func(pos)&&next(elem)}},"nth-last-child":function(next,rule,_a){var adapter=_a.adapter,equals=_a.equals;var func=(0,nth_check_1.default)(rule);if(func===boolbase_1.default.falseFunc)return boolbase_1.default.falseFunc;if(func===boolbase_1.default.trueFunc)return getChildFunc(next,adapter);return function nthLastChild(elem){var siblings=adapter.getSiblings(elem);var pos=0;for(var i=siblings.length-1;i>=0;i--){if(equals(elem,siblings[i]))break;if(adapter.isTag(siblings[i])){pos++}}return func(pos)&&next(elem)}},"nth-of-type":function(next,rule,_a){var adapter=_a.adapter,equals=_a.equals;var func=(0,nth_check_1.default)(rule);if(func===boolbase_1.default.falseFunc)return boolbase_1.default.falseFunc;if(func===boolbase_1.default.trueFunc)return getChildFunc(next,adapter);return function nthOfType(elem){var siblings=adapter.getSiblings(elem);var pos=0;for(var i=0;i<siblings.length;i++){var currentSibling=siblings[i];if(equals(elem,currentSibling))break;if(adapter.isTag(currentSibling)&&adapter.getName(currentSibling)===adapter.getName(elem)){pos++}}return func(pos)&&next(elem)}},"nth-last-of-type":function(next,rule,_a){var adapter=_a.adapter,equals=_a.equals;var func=(0,nth_check_1.default)(rule);if(func===boolbase_1.default.falseFunc)return boolbase_1.default.falseFunc;if(func===boolbase_1.default.trueFunc)return getChildFunc(next,adapter);return function nthLastOfType(elem){var siblings=adapter.getSiblings(elem);var pos=0;for(var i=siblings.length-1;i>=0;i--){var currentSibling=siblings[i];if(equals(elem,currentSibling))break;if(adapter.isTag(currentSibling)&&adapter.getName(currentSibling)===adapter.getName(elem)){pos++}}return func(pos)&&next(elem)}},root:function(next,_rule,_a){var adapter=_a.adapter;return function(elem){var parent=adapter.getParent(elem);return(parent==null||!adapter.isTag(parent))&&next(elem)}},scope:function(next,rule,options,context){var equals=options.equals;if(!context||context.length===0){return exports.filters["root"](next,rule,options)}if(context.length===1){return function(elem){return equals(context[0],elem)&&next(elem)}}return function(elem){return context.includes(elem)&&next(elem)}},hover:dynamicStatePseudo("isHovered"),visited:dynamicStatePseudo("isVisited"),active:dynamicStatePseudo("isActive")};function dynamicStatePseudo(name){return function dynamicPseudo(next,_rule,_a){var adapter=_a.adapter;var func=adapter[name];if(typeof func!=="function"){return boolbase_1.default.falseFunc}return function active(elem){return func(elem)&&next(elem)}}}},{boolbase:41,"nth-check":328}],125:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.compilePseudoSelector=exports.aliases=exports.pseudos=exports.filters=void 0;var css_what_1=require("css-what");var filters_js_1=require("./filters.js");Object.defineProperty(exports,"filters",{enumerable:true,get:function(){return filters_js_1.filters}});var pseudos_js_1=require("./pseudos.js");Object.defineProperty(exports,"pseudos",{enumerable:true,get:function(){return pseudos_js_1.pseudos}});var aliases_js_1=require("./aliases.js");Object.defineProperty(exports,"aliases",{enumerable:true,get:function(){return aliases_js_1.aliases}});var subselects_js_1=require("./subselects.js");function compilePseudoSelector(next,selector,options,context,compileToken){var _a;var name=selector.name,data=selector.data;if(Array.isArray(data)){if(!(name in subselects_js_1.subselects)){throw new Error("Unknown pseudo-class :".concat(name,"(").concat(data,")"))}return subselects_js_1.subselects[name](next,data,options,context,compileToken)}var userPseudo=(_a=options.pseudos)===null||_a===void 0?void 0:_a[name];var stringPseudo=typeof userPseudo==="string"?userPseudo:aliases_js_1.aliases[name];if(typeof stringPseudo==="string"){if(data!=null){throw new Error("Pseudo ".concat(name," doesn't have any arguments"))}var alias=(0,css_what_1.parse)(stringPseudo);return subselects_js_1.subselects["is"](next,alias,options,context,compileToken)}if(typeof userPseudo==="function"){(0,pseudos_js_1.verifyPseudoArgs)(userPseudo,name,data,1);return function(elem){return userPseudo(elem,data)&&next(elem)}}if(name in filters_js_1.filters){return filters_js_1.filters[name](next,data,options,context)}if(name in pseudos_js_1.pseudos){var pseudo_1=pseudos_js_1.pseudos[name];(0,pseudos_js_1.verifyPseudoArgs)(pseudo_1,name,data,2);return function(elem){return pseudo_1(elem,options,data)&&next(elem)}}throw new Error("Unknown pseudo-class :".concat(name))}exports.compilePseudoSelector=compilePseudoSelector},{"./aliases.js":123,"./filters.js":124,"./pseudos.js":126,"./subselects.js":127,"css-what":129}],126:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.verifyPseudoArgs=exports.pseudos=void 0;exports.pseudos={empty:function(elem,_a){var adapter=_a.adapter;return!adapter.getChildren(elem).some((function(elem){return adapter.isTag(elem)||adapter.getText(elem)!==""}))},"first-child":function(elem,_a){var adapter=_a.adapter,equals=_a.equals;if(adapter.prevElementSibling){return adapter.prevElementSibling(elem)==null}var firstChild=adapter.getSiblings(elem).find((function(elem){return adapter.isTag(elem)}));return firstChild!=null&&equals(elem,firstChild)},"last-child":function(elem,_a){var adapter=_a.adapter,equals=_a.equals;var siblings=adapter.getSiblings(elem);for(var i=siblings.length-1;i>=0;i--){if(equals(elem,siblings[i]))return true;if(adapter.isTag(siblings[i]))break}return false},"first-of-type":function(elem,_a){var adapter=_a.adapter,equals=_a.equals;var siblings=adapter.getSiblings(elem);var elemName=adapter.getName(elem);for(var i=0;i<siblings.length;i++){var currentSibling=siblings[i];if(equals(elem,currentSibling))return true;if(adapter.isTag(currentSibling)&&adapter.getName(currentSibling)===elemName){break}}return false},"last-of-type":function(elem,_a){var adapter=_a.adapter,equals=_a.equals;var siblings=adapter.getSiblings(elem);var elemName=adapter.getName(elem);for(var i=siblings.length-1;i>=0;i--){var currentSibling=siblings[i];if(equals(elem,currentSibling))return true;if(adapter.isTag(currentSibling)&&adapter.getName(currentSibling)===elemName){break}}return false},"only-of-type":function(elem,_a){var adapter=_a.adapter,equals=_a.equals;var elemName=adapter.getName(elem);return adapter.getSiblings(elem).every((function(sibling){return equals(elem,sibling)||!adapter.isTag(sibling)||adapter.getName(sibling)!==elemName}))},"only-child":function(elem,_a){var adapter=_a.adapter,equals=_a.equals;return adapter.getSiblings(elem).every((function(sibling){return equals(elem,sibling)||!adapter.isTag(sibling)}))}};function verifyPseudoArgs(func,name,subselect,argIndex){if(subselect===null){if(func.length>argIndex){throw new Error("Pseudo-class :".concat(name," requires an argument"))}}else if(func.length===argIndex){throw new Error("Pseudo-class :".concat(name," doesn't have any arguments"))}}exports.verifyPseudoArgs=verifyPseudoArgs},{}],127:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.subselects=exports.getNextSiblings=exports.ensureIsTag=exports.PLACEHOLDER_ELEMENT=void 0;var boolbase_1=__importDefault(require("boolbase"));var sort_js_1=require("../sort.js");exports.PLACEHOLDER_ELEMENT={};function ensureIsTag(next,adapter){if(next===boolbase_1.default.falseFunc)return boolbase_1.default.falseFunc;return function(elem){return adapter.isTag(elem)&&next(elem)}}exports.ensureIsTag=ensureIsTag;function getNextSiblings(elem,adapter){var siblings=adapter.getSiblings(elem);if(siblings.length<=1)return[];var elemIndex=siblings.indexOf(elem);if(elemIndex<0||elemIndex===siblings.length-1)return[];return siblings.slice(elemIndex+1).filter(adapter.isTag)}exports.getNextSiblings=getNextSiblings;function copyOptions(options){return{xmlMode:!!options.xmlMode,lowerCaseAttributeNames:!!options.lowerCaseAttributeNames,lowerCaseTags:!!options.lowerCaseTags,quirksMode:!!options.quirksMode,cacheResults:!!options.cacheResults,pseudos:options.pseudos,adapter:options.adapter,equals:options.equals}}var is=function(next,token,options,context,compileToken){var func=compileToken(token,copyOptions(options),context);return func===boolbase_1.default.trueFunc?next:func===boolbase_1.default.falseFunc?boolbase_1.default.falseFunc:function(elem){return func(elem)&&next(elem)}};exports.subselects={is:is,matches:is,where:is,not:function(next,token,options,context,compileToken){var func=compileToken(token,copyOptions(options),context);return func===boolbase_1.default.falseFunc?next:func===boolbase_1.default.trueFunc?boolbase_1.default.falseFunc:function(elem){return!func(elem)&&next(elem)}},has:function(next,subselect,options,_context,compileToken){var adapter=options.adapter;var opts=copyOptions(options);opts.relativeSelector=true;var context=subselect.some((function(s){return s.some(sort_js_1.isTraversal)}))?[exports.PLACEHOLDER_ELEMENT]:undefined;var compiled=compileToken(subselect,opts,context);if(compiled===boolbase_1.default.falseFunc)return boolbase_1.default.falseFunc;var hasElement=ensureIsTag(compiled,adapter);if(context&&compiled!==boolbase_1.default.trueFunc){var _a=compiled.shouldTestNextSiblings,shouldTestNextSiblings_1=_a===void 0?false:_a;return function(elem){if(!next(elem))return false;context[0]=elem;var childs=adapter.getChildren(elem);var nextElements=shouldTestNextSiblings_1?__spreadArray(__spreadArray([],childs,true),getNextSiblings(elem,adapter),true):childs;return adapter.existsOne(hasElement,nextElements)}}return function(elem){return next(elem)&&adapter.existsOne(hasElement,adapter.getChildren(elem))}}}},{"../sort.js":128,boolbase:41}],128:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isTraversal=void 0;var css_what_1=require("css-what");var procedure=new Map([[css_what_1.SelectorType.Universal,50],[css_what_1.SelectorType.Tag,30],[css_what_1.SelectorType.Attribute,1],[css_what_1.SelectorType.Pseudo,0]]);function isTraversal(token){return!procedure.has(token.type)}exports.isTraversal=isTraversal;var attributes=new Map([[css_what_1.AttributeAction.Exists,10],[css_what_1.AttributeAction.Equals,8],[css_what_1.AttributeAction.Not,7],[css_what_1.AttributeAction.Start,6],[css_what_1.AttributeAction.End,6],[css_what_1.AttributeAction.Any,5]]);function sortByProcedure(arr){var procs=arr.map(getProcedure);for(var i=1;i<arr.length;i++){var procNew=procs[i];if(procNew<0)continue;for(var j=i-1;j>=0&&procNew<procs[j];j--){var token=arr[j+1];arr[j+1]=arr[j];arr[j]=token;procs[j+1]=procs[j];procs[j]=procNew}}}exports.default=sortByProcedure;function getProcedure(token){var _a,_b;var proc=(_a=procedure.get(token.type))!==null&&_a!==void 0?_a:-1;if(token.type===css_what_1.SelectorType.Attribute){proc=(_b=attributes.get(token.action))!==null&&_b!==void 0?_b:4;if(token.action===css_what_1.AttributeAction.Equals&&token.name==="id"){proc=9}if(token.ignoreCase){proc>>=1}}else if(token.type===css_what_1.SelectorType.Pseudo){if(!token.data){proc=3}else if(token.name==="has"||token.name==="contains"){proc=0}else if(Array.isArray(token.data)){proc=Math.min.apply(Math,token.data.map((function(d){return Math.min.apply(Math,d.map(getProcedure))})));if(proc<0){proc=0}}else{proc=2}}return proc}},{"css-what":129}],129:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});exports.stringify=exports.parse=exports.isTraversal=void 0;__exportStar(require("./types"),exports);var parse_1=require("./parse");Object.defineProperty(exports,"isTraversal",{enumerable:true,get:function(){return parse_1.isTraversal}});Object.defineProperty(exports,"parse",{enumerable:true,get:function(){return parse_1.parse}});var stringify_1=require("./stringify");Object.defineProperty(exports,"stringify",{enumerable:true,get:function(){return stringify_1.stringify}})},{"./parse":130,"./stringify":131,"./types":132}],130:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.parse=exports.isTraversal=void 0;var types_1=require("./types");var reName=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/;var reEscape=/\\([\da-f]{1,6}\s?|(\s)|.)/gi;var actionTypes=new Map([[126,types_1.AttributeAction.Element],[94,types_1.AttributeAction.Start],[36,types_1.AttributeAction.End],[42,types_1.AttributeAction.Any],[33,types_1.AttributeAction.Not],[124,types_1.AttributeAction.Hyphen]]);var unpackPseudos=new Set(["has","not","matches","is","where","host","host-context"]);function isTraversal(selector){switch(selector.type){case types_1.SelectorType.Adjacent:case types_1.SelectorType.Child:case types_1.SelectorType.Descendant:case types_1.SelectorType.Parent:case types_1.SelectorType.Sibling:case types_1.SelectorType.ColumnCombinator:return true;default:return false}}exports.isTraversal=isTraversal;var stripQuotesFromPseudos=new Set(["contains","icontains"]);function funescape(_,escaped,escapedWhitespace){var high=parseInt(escaped,16)-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)}function unescapeCSS(str){return str.replace(reEscape,funescape)}function isQuote(c){return c===39||c===34}function isWhitespace(c){return c===32||c===9||c===10||c===12||c===13}function parse(selector){var subselects=[];var endIndex=parseSelector(subselects,"".concat(selector),0);if(endIndex<selector.length){throw new Error("Unmatched selector: ".concat(selector.slice(endIndex)))}return subselects}exports.parse=parse;function parseSelector(subselects,selector,selectorIndex){var tokens=[];function getName(offset){var match=selector.slice(selectorIndex+offset).match(reName);if(!match){throw new Error("Expected name, found ".concat(selector.slice(selectorIndex)))}var name=match[0];selectorIndex+=offset+name.length;return unescapeCSS(name)}function stripWhitespace(offset){selectorIndex+=offset;while(selectorIndex<selector.length&&isWhitespace(selector.charCodeAt(selectorIndex))){selectorIndex++}}function readValueWithParenthesis(){selectorIndex+=1;var start=selectorIndex;var counter=1;for(;counter>0&&selectorIndex<selector.length;selectorIndex++){if(selector.charCodeAt(selectorIndex)===40&&!isEscaped(selectorIndex)){counter++}else if(selector.charCodeAt(selectorIndex)===41&&!isEscaped(selectorIndex)){counter--}}if(counter){throw new Error("Parenthesis not matched")}return unescapeCSS(selector.slice(start,selectorIndex-1))}function isEscaped(pos){var slashCount=0;while(selector.charCodeAt(--pos)===92)slashCount++;return(slashCount&1)===1}function ensureNotTraversal(){if(tokens.length>0&&isTraversal(tokens[tokens.length-1])){throw new Error("Did not expect successive traversals.")}}function addTraversal(type){if(tokens.length>0&&tokens[tokens.length-1].type===types_1.SelectorType.Descendant){tokens[tokens.length-1].type=type;return}ensureNotTraversal();tokens.push({type:type})}function addSpecialAttribute(name,action){tokens.push({type:types_1.SelectorType.Attribute,name:name,action:action,value:getName(1),namespace:null,ignoreCase:"quirks"})}function finalizeSubselector(){if(tokens.length&&tokens[tokens.length-1].type===types_1.SelectorType.Descendant){tokens.pop()}if(tokens.length===0){throw new Error("Empty sub-selector")}subselects.push(tokens)}stripWhitespace(0);if(selector.length===selectorIndex){return selectorIndex}loop:while(selectorIndex<selector.length){var firstChar=selector.charCodeAt(selectorIndex);switch(firstChar){case 32:case 9:case 10:case 12:case 13:{if(tokens.length===0||tokens[0].type!==types_1.SelectorType.Descendant){ensureNotTraversal();tokens.push({type:types_1.SelectorType.Descendant})}stripWhitespace(1);break}case 62:{addTraversal(types_1.SelectorType.Child);stripWhitespace(1);break}case 60:{addTraversal(types_1.SelectorType.Parent);stripWhitespace(1);break}case 126:{addTraversal(types_1.SelectorType.Sibling);stripWhitespace(1);break}case 43:{addTraversal(types_1.SelectorType.Adjacent);stripWhitespace(1);break}case 46:{addSpecialAttribute("class",types_1.AttributeAction.Element);break}case 35:{addSpecialAttribute("id",types_1.AttributeAction.Equals);break}case 91:{stripWhitespace(1);var name_1=void 0;var namespace=null;if(selector.charCodeAt(selectorIndex)===124){name_1=getName(1)}else if(selector.startsWith("*|",selectorIndex)){namespace="*";name_1=getName(2)}else{name_1=getName(0);if(selector.charCodeAt(selectorIndex)===124&&selector.charCodeAt(selectorIndex+1)!==61){namespace=name_1;name_1=getName(1)}}stripWhitespace(0);var action=types_1.AttributeAction.Exists;var possibleAction=actionTypes.get(selector.charCodeAt(selectorIndex));if(possibleAction){action=possibleAction;if(selector.charCodeAt(selectorIndex+1)!==61){throw new Error("Expected `=`")}stripWhitespace(2)}else if(selector.charCodeAt(selectorIndex)===61){action=types_1.AttributeAction.Equals;stripWhitespace(1)}var value="";var ignoreCase=null;if(action!=="exists"){if(isQuote(selector.charCodeAt(selectorIndex))){var quote=selector.charCodeAt(selectorIndex);var sectionEnd=selectorIndex+1;while(sectionEnd<selector.length&&(selector.charCodeAt(sectionEnd)!==quote||isEscaped(sectionEnd))){sectionEnd+=1}if(selector.charCodeAt(sectionEnd)!==quote){throw new Error("Attribute value didn't end")}value=unescapeCSS(selector.slice(selectorIndex+1,sectionEnd));selectorIndex=sectionEnd+1}else{var valueStart=selectorIndex;while(selectorIndex<selector.length&&(!isWhitespace(selector.charCodeAt(selectorIndex))&&selector.charCodeAt(selectorIndex)!==93||isEscaped(selectorIndex))){selectorIndex+=1}value=unescapeCSS(selector.slice(valueStart,selectorIndex))}stripWhitespace(0);var forceIgnore=selector.charCodeAt(selectorIndex)|32;if(forceIgnore===115){ignoreCase=false;stripWhitespace(1)}else if(forceIgnore===105){ignoreCase=true;stripWhitespace(1)}}if(selector.charCodeAt(selectorIndex)!==93){throw new Error("Attribute selector didn't terminate")}selectorIndex+=1;var attributeSelector={type:types_1.SelectorType.Attribute,name:name_1,action:action,value:value,namespace:namespace,ignoreCase:ignoreCase};tokens.push(attributeSelector);break}case 58:{if(selector.charCodeAt(selectorIndex+1)===58){tokens.push({type:types_1.SelectorType.PseudoElement,name:getName(2).toLowerCase(),data:selector.charCodeAt(selectorIndex)===40?readValueWithParenthesis():null});continue}var name_2=getName(1).toLowerCase();var data=null;if(selector.charCodeAt(selectorIndex)===40){if(unpackPseudos.has(name_2)){if(isQuote(selector.charCodeAt(selectorIndex+1))){throw new Error("Pseudo-selector ".concat(name_2," cannot be quoted"))}data=[];selectorIndex=parseSelector(data,selector,selectorIndex+1);if(selector.charCodeAt(selectorIndex)!==41){throw new Error("Missing closing parenthesis in :".concat(name_2," (").concat(selector,")"))}selectorIndex+=1}else{data=readValueWithParenthesis();if(stripQuotesFromPseudos.has(name_2)){var quot=data.charCodeAt(0);if(quot===data.charCodeAt(data.length-1)&&isQuote(quot)){data=data.slice(1,-1)}}data=unescapeCSS(data)}}tokens.push({type:types_1.SelectorType.Pseudo,name:name_2,data:data});break}case 44:{finalizeSubselector();tokens=[];stripWhitespace(1);break}default:{if(selector.startsWith("/*",selectorIndex)){var endIndex=selector.indexOf("*/",selectorIndex+2);if(endIndex<0){throw new Error("Comment was not terminated")}selectorIndex=endIndex+2;if(tokens.length===0){stripWhitespace(0)}break}var namespace=null;var name_3=void 0;if(firstChar===42){selectorIndex+=1;name_3="*"}else if(firstChar===124){name_3="";if(selector.charCodeAt(selectorIndex+1)===124){addTraversal(types_1.SelectorType.ColumnCombinator);stripWhitespace(2);break}}else if(reName.test(selector.slice(selectorIndex))){name_3=getName(0)}else{break loop}if(selector.charCodeAt(selectorIndex)===124&&selector.charCodeAt(selectorIndex+1)!==124){namespace=name_3;if(selector.charCodeAt(selectorIndex+1)===42){name_3="*";selectorIndex+=2}else{name_3=getName(1)}}tokens.push(name_3==="*"?{type:types_1.SelectorType.Universal,namespace:namespace}:{type:types_1.SelectorType.Tag,name:name_3,namespace:namespace})}}}finalizeSubselector();return selectorIndex}},{"./types":132}],131:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.stringify=void 0;var types_1=require("./types");var attribValChars=["\\",'"'];var pseudoValChars=__spreadArray(__spreadArray([],attribValChars,true),["(",")"],false);var charsToEscapeInAttributeValue=new Set(attribValChars.map((function(c){return c.charCodeAt(0)})));var charsToEscapeInPseudoValue=new Set(pseudoValChars.map((function(c){return c.charCodeAt(0)})));var charsToEscapeInName=new Set(__spreadArray(__spreadArray([],pseudoValChars,true),["~","^","$","*","+","!","|",":","[","]"," ","."],false).map((function(c){return c.charCodeAt(0)})));function stringify(selector){return selector.map((function(token){return token.map(stringifyToken).join("")})).join(", ")}exports.stringify=stringify;function stringifyToken(token,index,arr){switch(token.type){case types_1.SelectorType.Child:return index===0?"> ":" > ";case types_1.SelectorType.Parent:return index===0?"< ":" < ";case types_1.SelectorType.Sibling:return index===0?"~ ":" ~ ";case types_1.SelectorType.Adjacent:return index===0?"+ ":" + ";case types_1.SelectorType.Descendant:return" ";case types_1.SelectorType.ColumnCombinator:return index===0?"|| ":" || ";case types_1.SelectorType.Universal:return token.namespace==="*"&&index+1<arr.length&&"name"in arr[index+1]?"":"".concat(getNamespace(token.namespace),"*");case types_1.SelectorType.Tag:return getNamespacedName(token);case types_1.SelectorType.PseudoElement:return"::".concat(escapeName(token.name,charsToEscapeInName)).concat(token.data===null?"":"(".concat(escapeName(token.data,charsToEscapeInPseudoValue),")"));case types_1.SelectorType.Pseudo:return":".concat(escapeName(token.name,charsToEscapeInName)).concat(token.data===null?"":"(".concat(typeof token.data==="string"?escapeName(token.data,charsToEscapeInPseudoValue):stringify(token.data),")"));case types_1.SelectorType.Attribute:{if(token.name==="id"&&token.action===types_1.AttributeAction.Equals&&token.ignoreCase==="quirks"&&!token.namespace){return"#".concat(escapeName(token.value,charsToEscapeInName))}if(token.name==="class"&&token.action===types_1.AttributeAction.Element&&token.ignoreCase==="quirks"&&!token.namespace){return".".concat(escapeName(token.value,charsToEscapeInName))}var name_1=getNamespacedName(token);if(token.action===types_1.AttributeAction.Exists){return"[".concat(name_1,"]")}return"[".concat(name_1).concat(getActionValue(token.action),'="').concat(escapeName(token.value,charsToEscapeInAttributeValue),'"').concat(token.ignoreCase===null?"":token.ignoreCase?" i":" s","]")}}}function getActionValue(action){switch(action){case types_1.AttributeAction.Equals:return"";case types_1.AttributeAction.Element:return"~";case types_1.AttributeAction.Start:return"^";case types_1.AttributeAction.End:return"$";case types_1.AttributeAction.Any:return"*";case types_1.AttributeAction.Not:return"!";case types_1.AttributeAction.Hyphen:return"|";case types_1.AttributeAction.Exists:throw new Error("Shouldn't be here")}}function getNamespacedName(token){return"".concat(getNamespace(token.namespace)).concat(escapeName(token.name,charsToEscapeInName))}function getNamespace(namespace){return namespace!==null?"".concat(namespace==="*"?"*":escapeName(namespace,charsToEscapeInName),"|"):""}function escapeName(str,charsToEscape){var lastIdx=0;var ret="";for(var i=0;i<str.length;i++){if(charsToEscape.has(str.charCodeAt(i))){ret+="".concat(str.slice(lastIdx,i),"\\").concat(str.charAt(i));lastIdx=i+1}}return ret.length>0?ret+str.slice(lastIdx):str}},{"./types":132}],132:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AttributeAction=exports.IgnoreCaseMode=exports.SelectorType=void 0;var SelectorType;(function(SelectorType){SelectorType["Attribute"]="attribute";SelectorType["Pseudo"]="pseudo";SelectorType["PseudoElement"]="pseudo-element";SelectorType["Tag"]="tag";SelectorType["Universal"]="universal";SelectorType["Adjacent"]="adjacent";SelectorType["Child"]="child";SelectorType["Descendant"]="descendant";SelectorType["Parent"]="parent";SelectorType["Sibling"]="sibling";SelectorType["ColumnCombinator"]="column-combinator"})(SelectorType=exports.SelectorType||(exports.SelectorType={}));exports.IgnoreCaseMode={Unknown:null,QuirksMode:"quirks",IgnoreCase:true,CaseSensitive:false};var AttributeAction;(function(AttributeAction){AttributeAction["Any"]="any";AttributeAction["Element"]="element";AttributeAction["End"]="end";AttributeAction["Equals"]="equals";AttributeAction["Exists"]="exists";AttributeAction["Hyphen"]="hyphen";AttributeAction["Not"]="not";AttributeAction["Start"]="start"})(AttributeAction=exports.AttributeAction||(exports.AttributeAction={}))},{}],133:[function(require,module,exports){var fingerprint=require("./lib/fingerprint.js");var pad=require("./lib/pad.js");var getRandomValue=require("./lib/getRandomValue.js");var c=0,blockSize=4,base=36,discreteValues=Math.pow(base,blockSize);function randomBlock(){return pad((getRandomValue()*discreteValues<<0).toString(base),blockSize)}function safeCounter(){c=c<discreteValues?c:0;c++;return c-1}function cuid(){var letter="c",timestamp=(new Date).getTime().toString(base),counter=pad(safeCounter().toString(base),blockSize),print=fingerprint(),random=randomBlock()+randomBlock();return letter+timestamp+counter+print+random}cuid.slug=function slug(){var date=(new Date).getTime().toString(36),counter=safeCounter().toString(36).slice(-4),print=fingerprint().slice(0,1)+fingerprint().slice(-1),random=randomBlock().slice(-2);return date.slice(-2)+counter+print+random};cuid.isCuid=function isCuid(stringToCheck){if(typeof stringToCheck!=="string")return false;if(stringToCheck.startsWith("c"))return true;return false};cuid.isSlug=function isSlug(stringToCheck){if(typeof stringToCheck!=="string")return false;var stringLength=stringToCheck.length;if(stringLength>=7&&stringLength<=10)return true;return false};cuid.fingerprint=fingerprint;module.exports=cuid},{"./lib/fingerprint.js":134,"./lib/getRandomValue.js":135,"./lib/pad.js":136}],134:[function(require,module,exports){var pad=require("./pad.js");var env=typeof window==="object"?window:self;var globalCount=Object.keys(env).length;var mimeTypesLength=navigator.mimeTypes?navigator.mimeTypes.length:0;var clientId=pad((mimeTypesLength+navigator.userAgent.length).toString(36)+globalCount.toString(36),4);module.exports=function fingerprint(){return clientId}},{"./pad.js":136}],135:[function(require,module,exports){var getRandomValue;var crypto=typeof window!=="undefined"&&(window.crypto||window.msCrypto)||typeof self!=="undefined"&&self.crypto;if(crypto){var lim=Math.pow(2,32)-1;getRandomValue=function(){return Math.abs(crypto.getRandomValues(new Uint32Array(1))[0]/lim)}}else{getRandomValue=Math.random}module.exports=getRandomValue},{}],136:[function(require,module,exports){module.exports=function pad(num,size){var s="000000000"+num;return s.substr(s.length-size)}},{}],137:[function(require,module,exports){"use strict";var hasPropertyDescriptors=require("has-property-descriptors")();var GetIntrinsic=require("get-intrinsic");var $defineProperty=hasPropertyDescriptors&&GetIntrinsic("%Object.defineProperty%",true);if($defineProperty){try{$defineProperty({},"a",{value:1})}catch(e){$defineProperty=false}}var $SyntaxError=GetIntrinsic("%SyntaxError%");var $TypeError=GetIntrinsic("%TypeError%");var gopd=require("gopd");module.exports=function defineDataProperty(obj,property,value){if(!obj||typeof obj!=="object"&&typeof obj!=="function"){throw new $TypeError("`obj` must be an object or a function`")}if(typeof property!=="string"&&typeof property!=="symbol"){throw new $TypeError("`property` must be a string or a symbol`")}if(arguments.length>3&&typeof arguments[3]!=="boolean"&&arguments[3]!==null){throw new $TypeError("`nonEnumerable`, if provided, must be a boolean or null")}if(arguments.length>4&&typeof arguments[4]!=="boolean"&&arguments[4]!==null){throw new $TypeError("`nonWritable`, if provided, must be a boolean or null")}if(arguments.length>5&&typeof arguments[5]!=="boolean"&&arguments[5]!==null){throw new $TypeError("`nonConfigurable`, if provided, must be a boolean or null")}if(arguments.length>6&&typeof arguments[6]!=="boolean"){throw new $TypeError("`loose`, if provided, must be a boolean")}var nonEnumerable=arguments.length>3?arguments[3]:null;var nonWritable=arguments.length>4?arguments[4]:null;var nonConfigurable=arguments.length>5?arguments[5]:null;var loose=arguments.length>6?arguments[6]:false;var desc=!!gopd&&gopd(obj,property);if($defineProperty){$defineProperty(obj,property,{configurable:nonConfigurable===null&&desc?desc.configurable:!nonConfigurable,enumerable:nonEnumerable===null&&desc?desc.enumerable:!nonEnumerable,value:value,writable:nonWritable===null&&desc?desc.writable:!nonWritable})}else if(loose||!nonEnumerable&&!nonWritable&&!nonConfigurable){obj[property]=value}else{throw new $SyntaxError("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}}},{"get-intrinsic":192,gopd:193,"has-property-descriptors":194}],138:[function(require,module,exports){"use strict";exports.utils=require("./des/utils");exports.Cipher=require("./des/cipher");exports.DES=require("./des/des");exports.CBC=require("./des/cbc");exports.EDE=require("./des/ede")},{"./des/cbc":139,"./des/cipher":140,"./des/des":141,"./des/ede":142,"./des/utils":143}],139:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert");var inherits=require("inherits");var proto={};function CBCState(iv){assert.equal(iv.length,8,"Invalid IV length");this.iv=new Array(8);for(var i=0;i<this.iv.length;i++)this.iv[i]=iv[i]}function instantiate(Base){function CBC(options){Base.call(this,options);this._cbcInit()}inherits(CBC,Base);var keys=Object.keys(proto);for(var i=0;i<keys.length;i++){var key=keys[i];CBC.prototype[key]=proto[key]}CBC.create=function create(options){return new CBC(options)};return CBC}exports.instantiate=instantiate;proto._cbcInit=function _cbcInit(){var state=new CBCState(this.options.iv);this._cbcState=state};proto._update=function _update(inp,inOff,out,outOff){var state=this._cbcState;var superProto=this.constructor.super_.prototype;var iv=state.iv;if(this.type==="encrypt"){for(var i=0;i<this.blockSize;i++)iv[i]^=inp[inOff+i];superProto._update.call(this,iv,0,out,outOff);for(var i=0;i<this.blockSize;i++)iv[i]=out[outOff+i]}else{superProto._update.call(this,inp,inOff,out,outOff);for(var i=0;i<this.blockSize;i++)out[outOff+i]^=iv[i];for(var i=0;i<this.blockSize;i++)iv[i]=inp[inOff+i]}}},{inherits:233,"minimalistic-assert":291}],140:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert");function Cipher(options){this.options=options;this.type=this.options.type;this.blockSize=8;this._init();this.buffer=new Array(this.blockSize);this.bufferOff=0;this.padding=options.padding!==false}module.exports=Cipher;Cipher.prototype._init=function _init(){};Cipher.prototype.update=function update(data){if(data.length===0)return[];if(this.type==="decrypt")return this._updateDecrypt(data);else return this._updateEncrypt(data)};Cipher.prototype._buffer=function _buffer(data,off){var min=Math.min(this.buffer.length-this.bufferOff,data.length-off);for(var i=0;i<min;i++)this.buffer[this.bufferOff+i]=data[off+i];this.bufferOff+=min;return min};Cipher.prototype._flushBuffer=function _flushBuffer(out,off){this._update(this.buffer,0,out,off);this.bufferOff=0;return this.blockSize};Cipher.prototype._updateEncrypt=function _updateEncrypt(data){var inputOff=0;var outputOff=0;var count=(this.bufferOff+data.length)/this.blockSize|0;var out=new Array(count*this.blockSize);if(this.bufferOff!==0){inputOff+=this._buffer(data,inputOff);if(this.bufferOff===this.buffer.length)outputOff+=this._flushBuffer(out,outputOff)}var max=data.length-(data.length-inputOff)%this.blockSize;for(;inputOff<max;inputOff+=this.blockSize){this._update(data,inputOff,out,outputOff);outputOff+=this.blockSize}for(;inputOff<data.length;inputOff++,this.bufferOff++)this.buffer[this.bufferOff]=data[inputOff];return out};Cipher.prototype._updateDecrypt=function _updateDecrypt(data){var inputOff=0;var outputOff=0;var count=Math.ceil((this.bufferOff+data.length)/this.blockSize)-1;var out=new Array(count*this.blockSize);for(;count>0;count--){inputOff+=this._buffer(data,inputOff);outputOff+=this._flushBuffer(out,outputOff)}inputOff+=this._buffer(data,inputOff);return out};Cipher.prototype.final=function final(buffer){var first;if(buffer)first=this.update(buffer);var last;if(this.type==="encrypt")last=this._finalEncrypt();else last=this._finalDecrypt();if(first)return first.concat(last);else return last};Cipher.prototype._pad=function _pad(buffer,off){if(off===0)return false;while(off<buffer.length)buffer[off++]=0;return true};Cipher.prototype._finalEncrypt=function _finalEncrypt(){if(!this._pad(this.buffer,this.bufferOff))return[];var out=new Array(this.blockSize);this._update(this.buffer,0,out,0);return out};Cipher.prototype._unpad=function _unpad(buffer){return buffer};Cipher.prototype._finalDecrypt=function _finalDecrypt(){assert.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var out=new Array(this.blockSize);this._flushBuffer(out,0);return this._unpad(out)}},{"minimalistic-assert":291}],141:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert");var inherits=require("inherits");var utils=require("./utils");var Cipher=require("./cipher");function DESState(){this.tmp=new Array(2);this.keys=null}function DES(options){Cipher.call(this,options);var state=new DESState;this._desState=state;this.deriveKeys(state,options.key)}inherits(DES,Cipher);module.exports=DES;DES.create=function create(options){return new DES(options)};var shiftTable=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];DES.prototype.deriveKeys=function deriveKeys(state,key){state.keys=new Array(16*2);assert.equal(key.length,this.blockSize,"Invalid key length");var kL=utils.readUInt32BE(key,0);var kR=utils.readUInt32BE(key,4);utils.pc1(kL,kR,state.tmp,0);kL=state.tmp[0];kR=state.tmp[1];for(var i=0;i<state.keys.length;i+=2){var shift=shiftTable[i>>>1];kL=utils.r28shl(kL,shift);kR=utils.r28shl(kR,shift);utils.pc2(kL,kR,state.keys,i)}};DES.prototype._update=function _update(inp,inOff,out,outOff){var state=this._desState;var l=utils.readUInt32BE(inp,inOff);var r=utils.readUInt32BE(inp,inOff+4);utils.ip(l,r,state.tmp,0);l=state.tmp[0];r=state.tmp[1];if(this.type==="encrypt")this._encrypt(state,l,r,state.tmp,0);else this._decrypt(state,l,r,state.tmp,0);l=state.tmp[0];r=state.tmp[1];utils.writeUInt32BE(out,l,outOff);utils.writeUInt32BE(out,r,outOff+4)};DES.prototype._pad=function _pad(buffer,off){if(this.padding===false){return false}var value=buffer.length-off;for(var i=off;i<buffer.length;i++)buffer[i]=value;return true};DES.prototype._unpad=function _unpad(buffer){if(this.padding===false){return buffer}var pad=buffer[buffer.length-1];for(var i=buffer.length-pad;i<buffer.length;i++)assert.equal(buffer[i],pad);return buffer.slice(0,buffer.length-pad)};DES.prototype._encrypt=function _encrypt(state,lStart,rStart,out,off){var l=lStart;var r=rStart;for(var i=0;i<state.keys.length;i+=2){var keyL=state.keys[i];var keyR=state.keys[i+1];utils.expand(r,state.tmp,0);keyL^=state.tmp[0];keyR^=state.tmp[1];var s=utils.substitute(keyL,keyR);var f=utils.permute(s);var t=r;r=(l^f)>>>0;l=t}utils.rip(r,l,out,off)};DES.prototype._decrypt=function _decrypt(state,lStart,rStart,out,off){var l=rStart;var r=lStart;for(var i=state.keys.length-2;i>=0;i-=2){var keyL=state.keys[i];var keyR=state.keys[i+1];utils.expand(l,state.tmp,0);keyL^=state.tmp[0];keyR^=state.tmp[1];var s=utils.substitute(keyL,keyR);var f=utils.permute(s);var t=l;l=(r^f)>>>0;r=t}utils.rip(l,r,out,off)}},{"./cipher":140,"./utils":143,inherits:233,"minimalistic-assert":291}],142:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert");var inherits=require("inherits");var Cipher=require("./cipher");var DES=require("./des");function EDEState(type,key){assert.equal(key.length,24,"Invalid key length");var k1=key.slice(0,8);var k2=key.slice(8,16);var k3=key.slice(16,24);if(type==="encrypt"){this.ciphers=[DES.create({type:"encrypt",key:k1}),DES.create({type:"decrypt",key:k2}),DES.create({type:"encrypt",key:k3})]}else{this.ciphers=[DES.create({type:"decrypt",key:k3}),DES.create({type:"encrypt",key:k2}),DES.create({type:"decrypt",key:k1})]}}function EDE(options){Cipher.call(this,options);var state=new EDEState(this.type,this.options.key);this._edeState=state}inherits(EDE,Cipher);module.exports=EDE;EDE.create=function create(options){return new EDE(options)};EDE.prototype._update=function _update(inp,inOff,out,outOff){var state=this._edeState;state.ciphers[0]._update(inp,inOff,out,outOff);state.ciphers[1]._update(out,outOff,out,outOff);state.ciphers[2]._update(out,outOff,out,outOff)};EDE.prototype._pad=DES.prototype._pad;EDE.prototype._unpad=DES.prototype._unpad},{"./cipher":140,"./des":141,inherits:233,"minimalistic-assert":291}],143:[function(require,module,exports){"use strict";exports.readUInt32BE=function readUInt32BE(bytes,off){var res=bytes[0+off]<<24|bytes[1+off]<<16|bytes[2+off]<<8|bytes[3+off];return res>>>0};exports.writeUInt32BE=function writeUInt32BE(bytes,value,off){bytes[0+off]=value>>>24;bytes[1+off]=value>>>16&255;bytes[2+off]=value>>>8&255;bytes[3+off]=value&255};exports.ip=function ip(inL,inR,out,off){var outL=0;var outR=0;for(var i=6;i>=0;i-=2){for(var j=0;j<=24;j+=8){outL<<=1;outL|=inR>>>j+i&1}for(var j=0;j<=24;j+=8){outL<<=1;outL|=inL>>>j+i&1}}for(var i=6;i>=0;i-=2){for(var j=1;j<=25;j+=8){outR<<=1;outR|=inR>>>j+i&1}for(var j=1;j<=25;j+=8){outR<<=1;outR|=inL>>>j+i&1}}out[off+0]=outL>>>0;out[off+1]=outR>>>0};exports.rip=function rip(inL,inR,out,off){var outL=0;var outR=0;for(var i=0;i<4;i++){for(var j=24;j>=0;j-=8){outL<<=1;outL|=inR>>>j+i&1;outL<<=1;outL|=inL>>>j+i&1}}for(var i=4;i<8;i++){for(var j=24;j>=0;j-=8){outR<<=1;outR|=inR>>>j+i&1;outR<<=1;outR|=inL>>>j+i&1}}out[off+0]=outL>>>0;out[off+1]=outR>>>0};exports.pc1=function pc1(inL,inR,out,off){var outL=0;var outR=0;for(var i=7;i>=5;i--){for(var j=0;j<=24;j+=8){outL<<=1;outL|=inR>>j+i&1}for(var j=0;j<=24;j+=8){outL<<=1;outL|=inL>>j+i&1}}for(var j=0;j<=24;j+=8){outL<<=1;outL|=inR>>j+i&1}for(var i=1;i<=3;i++){for(var j=0;j<=24;j+=8){outR<<=1;outR|=inR>>j+i&1}for(var j=0;j<=24;j+=8){outR<<=1;outR|=inL>>j+i&1}}for(var j=0;j<=24;j+=8){outR<<=1;outR|=inL>>j+i&1}out[off+0]=outL>>>0;out[off+1]=outR>>>0};exports.r28shl=function r28shl(num,shift){return num<<shift&268435455|num>>>28-shift};var pc2table=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];exports.pc2=function pc2(inL,inR,out,off){var outL=0;var outR=0;var len=pc2table.length>>>1;for(var i=0;i<len;i++){outL<<=1;outL|=inL>>>pc2table[i]&1}for(var i=len;i<pc2table.length;i++){outR<<=1;outR|=inR>>>pc2table[i]&1}out[off+0]=outL>>>0;out[off+1]=outR>>>0};exports.expand=function expand(r,out,off){var outL=0;var outR=0;outL=(r&1)<<5|r>>>27;for(var i=23;i>=15;i-=4){outL<<=6;outL|=r>>>i&63}for(var i=11;i>=3;i-=4){outR|=r>>>i&63;outR<<=6}outR|=(r&31)<<1|r>>>31;out[off+0]=outL>>>0;out[off+1]=outR>>>0};var sTable=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];exports.substitute=function substitute(inL,inR){var out=0;for(var i=0;i<4;i++){var b=inL>>>18-i*6&63;var sb=sTable[i*64+b];out<<=4;out|=sb}for(var i=0;i<4;i++){var b=inR>>>18-i*6&63;var sb=sTable[4*64+i*64+b];out<<=4;out|=sb}return out>>>0};var permuteTable=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];exports.permute=function permute(num){var out=0;for(var i=0;i<permuteTable.length;i++){out<<=1;out|=num>>>permuteTable[i]&1}return out>>>0};exports.padSplit=function padSplit(num,size,group){var str=num.toString(2);while(str.length<size)str="0"+str;var out=[];for(var i=0;i<size;i+=group)out.push(str.slice(i,i+group));return out.join(" ")}},{}],144:[function(require,module,exports){(function(Buffer){(function(){var generatePrime=require("./lib/generatePrime");var primes=require("./lib/primes.json");var DH=require("./lib/dh");function getDiffieHellman(mod){var prime=new Buffer(primes[mod].prime,"hex");var gen=new Buffer(primes[mod].gen,"hex");return new DH(prime,gen)}var ENCODINGS={binary:true,hex:true,base64:true};function createDiffieHellman(prime,enc,generator,genc){if(Buffer.isBuffer(enc)||ENCODINGS[enc]===undefined){return createDiffieHellman(prime,"binary",enc,generator)}enc=enc||"binary";genc=genc||"binary";generator=generator||new Buffer([2]);if(!Buffer.isBuffer(generator)){generator=new Buffer(generator,genc)}if(typeof prime==="number"){return new DH(generatePrime(prime,generator),generator,true)}if(!Buffer.isBuffer(prime)){prime=new Buffer(prime,enc)}return new DH(prime,generator,true)}exports.DiffieHellmanGroup=exports.createDiffieHellmanGroup=exports.getDiffieHellman=getDiffieHellman;exports.createDiffieHellman=exports.DiffieHellman=createDiffieHellman}).call(this)}).call(this,require("buffer").Buffer)},{"./lib/dh":145,"./lib/generatePrime":146,"./lib/primes.json":147,buffer:88}],145:[function(require,module,exports){(function(Buffer){(function(){var BN=require("bn.js");var MillerRabin=require("miller-rabin");var millerRabin=new MillerRabin;var TWENTYFOUR=new BN(24);var ELEVEN=new BN(11);var TEN=new BN(10);var THREE=new BN(3);var SEVEN=new BN(7);var primes=require("./generatePrime");var randomBytes=require("randombytes");module.exports=DH;function setPublicKey(pub,enc){enc=enc||"utf8";if(!Buffer.isBuffer(pub)){pub=new Buffer(pub,enc)}this._pub=new BN(pub);return this}function setPrivateKey(priv,enc){enc=enc||"utf8";if(!Buffer.isBuffer(priv)){priv=new Buffer(priv,enc)}this._priv=new BN(priv);return this}var primeCache={};function checkPrime(prime,generator){var gen=generator.toString("hex");var hex=[gen,prime.toString(16)].join("_");if(hex in primeCache){return primeCache[hex]}var error=0;if(prime.isEven()||!primes.simpleSieve||!primes.fermatTest(prime)||!millerRabin.test(prime)){error+=1;if(gen==="02"||gen==="05"){error+=8}else{error+=4}primeCache[hex]=error;return error}if(!millerRabin.test(prime.shrn(1))){error+=2}var rem;switch(gen){case"02":if(prime.mod(TWENTYFOUR).cmp(ELEVEN)){error+=8}break;case"05":rem=prime.mod(TEN);if(rem.cmp(THREE)&&rem.cmp(SEVEN)){error+=8}break;default:error+=4}primeCache[hex]=error;return error}function DH(prime,generator,malleable){this.setGenerator(generator);this.__prime=new BN(prime);this._prime=BN.mont(this.__prime);this._primeLen=prime.length;this._pub=undefined;this._priv=undefined;this._primeCode=undefined;if(malleable){this.setPublicKey=setPublicKey;this.setPrivateKey=setPrivateKey}else{this._primeCode=8}}Object.defineProperty(DH.prototype,"verifyError",{enumerable:true,get:function(){if(typeof this._primeCode!=="number"){this._primeCode=checkPrime(this.__prime,this.__gen)}return this._primeCode}});DH.prototype.generateKeys=function(){if(!this._priv){this._priv=new BN(randomBytes(this._primeLen))}this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed();return this.getPublicKey()};DH.prototype.computeSecret=function(other){other=new BN(other);other=other.toRed(this._prime);var secret=other.redPow(this._priv).fromRed();var out=new Buffer(secret.toArray());var prime=this.getPrime();if(out.length<prime.length){var front=new Buffer(prime.length-out.length);front.fill(0);out=Buffer.concat([front,out])}return out};DH.prototype.getPublicKey=function getPublicKey(enc){return formatReturnValue(this._pub,enc)};DH.prototype.getPrivateKey=function getPrivateKey(enc){return formatReturnValue(this._priv,enc)};DH.prototype.getPrime=function(enc){return formatReturnValue(this.__prime,enc)};DH.prototype.getGenerator=function(enc){return formatReturnValue(this._gen,enc)};DH.prototype.setGenerator=function(gen,enc){enc=enc||"utf8";if(!Buffer.isBuffer(gen)){gen=new Buffer(gen,enc)}this.__gen=gen;this._gen=new BN(gen);return this};function formatReturnValue(bn,enc){var buf=new Buffer(bn.toArray());if(!enc){return buf}else{return buf.toString(enc)}}}).call(this)}).call(this,require("buffer").Buffer)},{"./generatePrime":146,"bn.js":148,buffer:88,"miller-rabin":289,randombytes:382}],146:[function(require,module,exports){var randomBytes=require("randombytes");module.exports=findPrime;findPrime.simpleSieve=simpleSieve;findPrime.fermatTest=fermatTest;var BN=require("bn.js");var TWENTYFOUR=new BN(24);var MillerRabin=require("miller-rabin");var millerRabin=new MillerRabin;var ONE=new BN(1);var TWO=new BN(2);var FIVE=new BN(5);var SIXTEEN=new BN(16);var EIGHT=new BN(8);var TEN=new BN(10);var THREE=new BN(3);var SEVEN=new BN(7);var ELEVEN=new BN(11);var FOUR=new BN(4);var TWELVE=new BN(12);var primes=null;function _getPrimes(){if(primes!==null)return primes;var limit=1048576;var res=[];res[0]=2;for(var i=1,k=3;k<limit;k+=2){var sqrt=Math.ceil(Math.sqrt(k));for(var j=0;j<i&&res[j]<=sqrt;j++)if(k%res[j]===0)break;if(i!==j&&res[j]<=sqrt)continue;res[i++]=k}primes=res;return res}function simpleSieve(p){var primes=_getPrimes();for(var i=0;i<primes.length;i++)if(p.modn(primes[i])===0){if(p.cmpn(primes[i])===0){return true}else{return false}}return true}function fermatTest(p){var red=BN.mont(p);return TWO.toRed(red).redPow(p.subn(1)).fromRed().cmpn(1)===0}function findPrime(bits,gen){if(bits<16){if(gen===2||gen===5){return new BN([140,123])}else{return new BN([140,39])}}gen=new BN(gen);var num,n2;while(true){num=new BN(randomBytes(Math.ceil(bits/8)));while(num.bitLength()>bits){num.ishrn(1)}if(num.isEven()){num.iadd(ONE)}if(!num.testn(1)){num.iadd(TWO)}if(!gen.cmp(TWO)){while(num.mod(TWENTYFOUR).cmp(ELEVEN)){num.iadd(FOUR)}}else if(!gen.cmp(FIVE)){while(num.mod(TEN).cmp(THREE)){num.iadd(FOUR)}}n2=num.shrn(1);if(simpleSieve(n2)&&simpleSieve(num)&&fermatTest(n2)&&fermatTest(num)&&millerRabin.test(n2)&&millerRabin.test(num)){return num}}}},{"bn.js":148,"miller-rabin":289,randombytes:382}],147:[function(require,module,exports){module.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],148:[function(require,module,exports){arguments[4][34][0].apply(exports,arguments)},{buffer:88,dup:34}],149:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.attributeNames=exports.elementNames=void 0;exports.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map((function(val){return[val.toLowerCase(),val]})));exports.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map((function(val){return[val.toLowerCase(),val]})))},{}],150:[function(require,module,exports){"use strict";var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};Object.defineProperty(exports,"__esModule",{value:true});exports.render=void 0;var ElementType=__importStar(require("domelementtype"));var entities_1=require("entities");var foreignNames_js_1=require("./foreignNames.js");var unencodedElements=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function replaceQuotes(value){return value.replace(/"/g,"&quot;")}function formatAttributes(attributes,opts){var _a;if(!attributes)return;var encode=((_a=opts.encodeEntities)!==null&&_a!==void 0?_a:opts.decodeEntities)===false?replaceQuotes:opts.xmlMode||opts.encodeEntities!=="utf8"?entities_1.encodeXML:entities_1.escapeAttribute;return Object.keys(attributes).map((function(key){var _a,_b;var value=(_a=attributes[key])!==null&&_a!==void 0?_a:"";if(opts.xmlMode==="foreign"){key=(_b=foreignNames_js_1.attributeNames.get(key))!==null&&_b!==void 0?_b:key}if(!opts.emptyAttrs&&!opts.xmlMode&&value===""){return key}return"".concat(key,'="').concat(encode(value),'"')})).join(" ")}var singleTag=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function render(node,options){if(options===void 0){options={}}var nodes="length"in node?node:[node];var output="";for(var i=0;i<nodes.length;i++){output+=renderNode(nodes[i],options)}return output}exports.render=render;exports.default=render;function renderNode(node,options){switch(node.type){case ElementType.Root:return render(node.children,options);case ElementType.Doctype:case ElementType.Directive:return renderDirective(node);case ElementType.Comment:return renderComment(node);case ElementType.CDATA:return renderCdata(node);case ElementType.Script:case ElementType.Style:case ElementType.Tag:return renderTag(node,options);case ElementType.Text:return renderText(node,options)}}var foreignModeIntegrationPoints=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]);var foreignElements=new Set(["svg","math"]);function renderTag(elem,opts){var _a;if(opts.xmlMode==="foreign"){elem.name=(_a=foreignNames_js_1.elementNames.get(elem.name))!==null&&_a!==void 0?_a:elem.name;if(elem.parent&&foreignModeIntegrationPoints.has(elem.parent.name)){opts=__assign(__assign({},opts),{xmlMode:false})}}if(!opts.xmlMode&&foreignElements.has(elem.name)){opts=__assign(__assign({},opts),{xmlMode:"foreign"})}var tag="<".concat(elem.name);var attribs=formatAttributes(elem.attribs,opts);if(attribs){tag+=" ".concat(attribs)}if(elem.children.length===0&&(opts.xmlMode?opts.selfClosingTags!==false:opts.selfClosingTags&&singleTag.has(elem.name))){if(!opts.xmlMode)tag+=" ";tag+="/>"}else{tag+=">";if(elem.children.length>0){tag+=render(elem.children,opts)}if(opts.xmlMode||!singleTag.has(elem.name)){tag+="</".concat(elem.name,">")}}return tag}function renderDirective(elem){return"<".concat(elem.data,">")}function renderText(elem,opts){var _a;var data=elem.data||"";if(((_a=opts.encodeEntities)!==null&&_a!==void 0?_a:opts.decodeEntities)!==false&&!(!opts.xmlMode&&elem.parent&&unencodedElements.has(elem.parent.name))){data=opts.xmlMode||opts.encodeEntities!=="utf8"?(0,entities_1.encodeXML)(data):(0,entities_1.escapeText)(data)}return data}function renderCdata(elem){return"<![CDATA[".concat(elem.children[0].data,"]]>")}function renderComment(elem){return"\x3c!--".concat(elem.data,"--\x3e")}},{"./foreignNames.js":149,domelementtype:151,entities:186}],151:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Doctype=exports.CDATA=exports.Tag=exports.Style=exports.Script=exports.Comment=exports.Directive=exports.Text=exports.Root=exports.isTag=exports.ElementType=void 0;var ElementType;(function(ElementType){ElementType["Root"]="root";ElementType["Text"]="text";ElementType["Directive"]="directive";ElementType["Comment"]="comment";ElementType["Script"]="script";ElementType["Style"]="style";ElementType["Tag"]="tag";ElementType["CDATA"]="cdata";ElementType["Doctype"]="doctype"})(ElementType=exports.ElementType||(exports.ElementType={}));function isTag(elem){return elem.type===ElementType.Tag||elem.type===ElementType.Script||elem.type===ElementType.Style}exports.isTag=isTag;exports.Root=ElementType.Root;exports.Text=ElementType.Text;exports.Directive=ElementType.Directive;exports.Comment=ElementType.Comment;exports.Script=ElementType.Script;exports.Style=ElementType.Style;exports.Tag=ElementType.Tag;exports.CDATA=ElementType.CDATA;exports.Doctype=ElementType.Doctype},{}],152:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});exports.DomHandler=void 0;var domelementtype_1=require("domelementtype");var node_js_1=require("./node.js");__exportStar(require("./node.js"),exports);var defaultOpts={withStartIndices:false,withEndIndices:false,xmlMode:false};var DomHandler=function(){function DomHandler(callback,options,elementCB){this.dom=[];this.root=new node_js_1.Document(this.dom);this.done=false;this.tagStack=[this.root];this.lastNode=null;this.parser=null;if(typeof options==="function"){elementCB=options;options=defaultOpts}if(typeof callback==="object"){options=callback;callback=undefined}this.callback=callback!==null&&callback!==void 0?callback:null;this.options=options!==null&&options!==void 0?options:defaultOpts;this.elementCB=elementCB!==null&&elementCB!==void 0?elementCB:null}DomHandler.prototype.onparserinit=function(parser){this.parser=parser};DomHandler.prototype.onreset=function(){this.dom=[];this.root=new node_js_1.Document(this.dom);this.done=false;this.tagStack=[this.root];this.lastNode=null;this.parser=null};DomHandler.prototype.onend=function(){if(this.done)return;this.done=true;this.parser=null;this.handleCallback(null)};DomHandler.prototype.onerror=function(error){this.handleCallback(error)};DomHandler.prototype.onclosetag=function(){this.lastNode=null;var elem=this.tagStack.pop();if(this.options.withEndIndices){elem.endIndex=this.parser.endIndex}if(this.elementCB)this.elementCB(elem)};DomHandler.prototype.onopentag=function(name,attribs){var type=this.options.xmlMode?domelementtype_1.ElementType.Tag:undefined;var element=new node_js_1.Element(name,attribs,undefined,type);this.addNode(element);this.tagStack.push(element)};DomHandler.prototype.ontext=function(data){var lastNode=this.lastNode;if(lastNode&&lastNode.type===domelementtype_1.ElementType.Text){lastNode.data+=data;if(this.options.withEndIndices){lastNode.endIndex=this.parser.endIndex}}else{var node=new node_js_1.Text(data);this.addNode(node);this.lastNode=node}};DomHandler.prototype.oncomment=function(data){if(this.lastNode&&this.lastNode.type===domelementtype_1.ElementType.Comment){this.lastNode.data+=data;return}var node=new node_js_1.Comment(data);this.addNode(node);this.lastNode=node};DomHandler.prototype.oncommentend=function(){this.lastNode=null};DomHandler.prototype.oncdatastart=function(){var text=new node_js_1.Text("");var node=new node_js_1.CDATA([text]);this.addNode(node);text.parent=node;this.lastNode=text};DomHandler.prototype.oncdataend=function(){this.lastNode=null};DomHandler.prototype.onprocessinginstruction=function(name,data){var node=new node_js_1.ProcessingInstruction(name,data);this.addNode(node)};DomHandler.prototype.handleCallback=function(error){if(typeof this.callback==="function"){this.callback(error,this.dom)}else if(error){throw error}};DomHandler.prototype.addNode=function(node){var parent=this.tagStack[this.tagStack.length-1];var previousSibling=parent.children[parent.children.length-1];if(this.options.withStartIndices){node.startIndex=this.parser.startIndex}if(this.options.withEndIndices){node.endIndex=this.parser.endIndex}parent.children.push(node);if(previousSibling){node.prev=previousSibling;previousSibling.next=node}node.parent=parent;this.lastNode=null};return DomHandler}();exports.DomHandler=DomHandler;exports.default=DomHandler},{"./node.js":153,domelementtype:151}],153:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:true});exports.cloneNode=exports.hasChildren=exports.isDocument=exports.isDirective=exports.isComment=exports.isText=exports.isCDATA=exports.isTag=exports.Element=exports.Document=exports.CDATA=exports.NodeWithChildren=exports.ProcessingInstruction=exports.Comment=exports.Text=exports.DataNode=exports.Node=void 0;var domelementtype_1=require("domelementtype");var Node=function(){function Node(){this.parent=null;this.prev=null;this.next=null;this.startIndex=null;this.endIndex=null}Object.defineProperty(Node.prototype,"parentNode",{get:function(){return this.parent},set:function(parent){this.parent=parent},enumerable:false,configurable:true});Object.defineProperty(Node.prototype,"previousSibling",{get:function(){return this.prev},set:function(prev){this.prev=prev},enumerable:false,configurable:true});Object.defineProperty(Node.prototype,"nextSibling",{get:function(){return this.next},set:function(next){this.next=next},enumerable:false,configurable:true});Node.prototype.cloneNode=function(recursive){if(recursive===void 0){recursive=false}return cloneNode(this,recursive)};return Node}();exports.Node=Node;var DataNode=function(_super){__extends(DataNode,_super);function DataNode(data){var _this=_super.call(this)||this;_this.data=data;return _this}Object.defineProperty(DataNode.prototype,"nodeValue",{get:function(){return this.data},set:function(data){this.data=data},enumerable:false,configurable:true});return DataNode}(Node);exports.DataNode=DataNode;var Text=function(_super){__extends(Text,_super);function Text(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.type=domelementtype_1.ElementType.Text;return _this}Object.defineProperty(Text.prototype,"nodeType",{get:function(){return 3},enumerable:false,configurable:true});return Text}(DataNode);exports.Text=Text;var Comment=function(_super){__extends(Comment,_super);function Comment(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.type=domelementtype_1.ElementType.Comment;return _this}Object.defineProperty(Comment.prototype,"nodeType",{get:function(){return 8},enumerable:false,configurable:true});return Comment}(DataNode);exports.Comment=Comment;var ProcessingInstruction=function(_super){__extends(ProcessingInstruction,_super);function ProcessingInstruction(name,data){var _this=_super.call(this,data)||this;_this.name=name;_this.type=domelementtype_1.ElementType.Directive;return _this}Object.defineProperty(ProcessingInstruction.prototype,"nodeType",{get:function(){return 1},enumerable:false,configurable:true});return ProcessingInstruction}(DataNode);exports.ProcessingInstruction=ProcessingInstruction;var NodeWithChildren=function(_super){__extends(NodeWithChildren,_super);function NodeWithChildren(children){var _this=_super.call(this)||this;_this.children=children;return _this}Object.defineProperty(NodeWithChildren.prototype,"firstChild",{get:function(){var _a;return(_a=this.children[0])!==null&&_a!==void 0?_a:null},enumerable:false,configurable:true});Object.defineProperty(NodeWithChildren.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:false,configurable:true});Object.defineProperty(NodeWithChildren.prototype,"childNodes",{get:function(){return this.children},set:function(children){this.children=children},enumerable:false,configurable:true});return NodeWithChildren}(Node);exports.NodeWithChildren=NodeWithChildren;var CDATA=function(_super){__extends(CDATA,_super);function CDATA(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.type=domelementtype_1.ElementType.CDATA;return _this}Object.defineProperty(CDATA.prototype,"nodeType",{get:function(){return 4},enumerable:false,configurable:true});return CDATA}(NodeWithChildren);exports.CDATA=CDATA;var Document=function(_super){__extends(Document,_super);function Document(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.type=domelementtype_1.ElementType.Root;return _this}Object.defineProperty(Document.prototype,"nodeType",{get:function(){return 9},enumerable:false,configurable:true});return Document}(NodeWithChildren);exports.Document=Document;var Element=function(_super){__extends(Element,_super);function Element(name,attribs,children,type){if(children===void 0){children=[]}if(type===void 0){type=name==="script"?domelementtype_1.ElementType.Script:name==="style"?domelementtype_1.ElementType.Style:domelementtype_1.ElementType.Tag}var _this=_super.call(this,children)||this;_this.name=name;_this.attribs=attribs;_this.type=type;return _this}Object.defineProperty(Element.prototype,"nodeType",{get:function(){return 1},enumerable:false,configurable:true});Object.defineProperty(Element.prototype,"tagName",{get:function(){return this.name},set:function(name){this.name=name},enumerable:false,configurable:true});Object.defineProperty(Element.prototype,"attributes",{get:function(){var _this=this;return Object.keys(this.attribs).map((function(name){var _a,_b;return{name:name,value:_this.attribs[name],namespace:(_a=_this["x-attribsNamespace"])===null||_a===void 0?void 0:_a[name],prefix:(_b=_this["x-attribsPrefix"])===null||_b===void 0?void 0:_b[name]}}))},enumerable:false,configurable:true});return Element}(NodeWithChildren);exports.Element=Element;function isTag(node){return(0,domelementtype_1.isTag)(node)}exports.isTag=isTag;function isCDATA(node){return node.type===domelementtype_1.ElementType.CDATA}exports.isCDATA=isCDATA;function isText(node){return node.type===domelementtype_1.ElementType.Text}exports.isText=isText;function isComment(node){return node.type===domelementtype_1.ElementType.Comment}exports.isComment=isComment;function isDirective(node){return node.type===domelementtype_1.ElementType.Directive}exports.isDirective=isDirective;function isDocument(node){return node.type===domelementtype_1.ElementType.Root}exports.isDocument=isDocument;function hasChildren(node){return Object.prototype.hasOwnProperty.call(node,"children")}exports.hasChildren=hasChildren;function cloneNode(node,recursive){if(recursive===void 0){recursive=false}var result;if(isText(node)){result=new Text(node.data)}else if(isComment(node)){result=new Comment(node.data)}else if(isTag(node)){var children=recursive?cloneChildren(node.children):[];var clone_1=new Element(node.name,__assign({},node.attribs),children);children.forEach((function(child){return child.parent=clone_1}));if(node.namespace!=null){clone_1.namespace=node.namespace}if(node["x-attribsNamespace"]){clone_1["x-attribsNamespace"]=__assign({},node["x-attribsNamespace"])}if(node["x-attribsPrefix"]){clone_1["x-attribsPrefix"]=__assign({},node["x-attribsPrefix"])}result=clone_1}else if(isCDATA(node)){var children=recursive?cloneChildren(node.children):[];var clone_2=new CDATA(children);children.forEach((function(child){return child.parent=clone_2}));result=clone_2}else if(isDocument(node)){var children=recursive?cloneChildren(node.children):[];var clone_3=new Document(children);children.forEach((function(child){return child.parent=clone_3}));if(node["x-mode"]){clone_3["x-mode"]=node["x-mode"]}result=clone_3}else if(isDirective(node)){var instruction=new ProcessingInstruction(node.name,node.data);if(node["x-name"]!=null){instruction["x-name"]=node["x-name"];instruction["x-publicId"]=node["x-publicId"];instruction["x-systemId"]=node["x-systemId"]}result=instruction}else{throw new Error("Not implemented yet: ".concat(node.type))}result.startIndex=node.startIndex;result.endIndex=node.endIndex;if(node.sourceCodeLocation!=null){result.sourceCodeLocation=node.sourceCodeLocation}return result}exports.cloneNode=cloneNode;function cloneChildren(childs){var children=childs.map((function(child){return cloneNode(child,true)}));for(var i=1;i<children.length;i++){children[i].prev=children[i-1];children[i-1].next=children[i]}return children}},{domelementtype:151}],154:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFeed=void 0;var stringify_js_1=require("./stringify.js");var legacy_js_1=require("./legacy.js");function getFeed(doc){var feedRoot=getOneElement(isValidFeed,doc);return!feedRoot?null:feedRoot.name==="feed"?getAtomFeed(feedRoot):getRssFeed(feedRoot)}exports.getFeed=getFeed;function getAtomFeed(feedRoot){var _a;var childs=feedRoot.children;var feed={type:"atom",items:(0,legacy_js_1.getElementsByTagName)("entry",childs).map((function(item){var _a;var children=item.children;var entry={media:getMediaElements(children)};addConditionally(entry,"id","id",children);addConditionally(entry,"title","title",children);var href=(_a=getOneElement("link",children))===null||_a===void 0?void 0:_a.attribs["href"];if(href){entry.link=href}var description=fetch("summary",children)||fetch("content",children);if(description){entry.description=description}var pubDate=fetch("updated",children);if(pubDate){entry.pubDate=new Date(pubDate)}return entry}))};addConditionally(feed,"id","id",childs);addConditionally(feed,"title","title",childs);var href=(_a=getOneElement("link",childs))===null||_a===void 0?void 0:_a.attribs["href"];if(href){feed.link=href}addConditionally(feed,"description","subtitle",childs);var updated=fetch("updated",childs);if(updated){feed.updated=new Date(updated)}addConditionally(feed,"author","email",childs,true);return feed}function getRssFeed(feedRoot){var _a,_b;var childs=(_b=(_a=getOneElement("channel",feedRoot.children))===null||_a===void 0?void 0:_a.children)!==null&&_b!==void 0?_b:[];var feed={type:feedRoot.name.substr(0,3),id:"",items:(0,legacy_js_1.getElementsByTagName)("item",feedRoot.children).map((function(item){var children=item.children;var entry={media:getMediaElements(children)};addConditionally(entry,"id","guid",children);addConditionally(entry,"title","title",children);addConditionally(entry,"link","link",children);addConditionally(entry,"description","description",children);var pubDate=fetch("pubDate",children)||fetch("dc:date",children);if(pubDate)entry.pubDate=new Date(pubDate);return entry}))};addConditionally(feed,"title","title",childs);addConditionally(feed,"link","link",childs);addConditionally(feed,"description","description",childs);var updated=fetch("lastBuildDate",childs);if(updated){feed.updated=new Date(updated)}addConditionally(feed,"author","managingEditor",childs,true);return feed}var MEDIA_KEYS_STRING=["url","type","lang"];var MEDIA_KEYS_INT=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function getMediaElements(where){return(0,legacy_js_1.getElementsByTagName)("media:content",where).map((function(elem){var attribs=elem.attribs;var media={medium:attribs["medium"],isDefault:!!attribs["isDefault"]};for(var _i=0,MEDIA_KEYS_STRING_1=MEDIA_KEYS_STRING;_i<MEDIA_KEYS_STRING_1.length;_i++){var attrib=MEDIA_KEYS_STRING_1[_i];if(attribs[attrib]){media[attrib]=attribs[attrib]}}for(var _a=0,MEDIA_KEYS_INT_1=MEDIA_KEYS_INT;_a<MEDIA_KEYS_INT_1.length;_a++){var attrib=MEDIA_KEYS_INT_1[_a];if(attribs[attrib]){media[attrib]=parseInt(attribs[attrib],10)}}if(attribs["expression"]){media.expression=attribs["expression"]}return media}))}function getOneElement(tagName,node){return(0,legacy_js_1.getElementsByTagName)(tagName,node,true,1)[0]}function fetch(tagName,where,recurse){if(recurse===void 0){recurse=false}return(0,stringify_js_1.textContent)((0,legacy_js_1.getElementsByTagName)(tagName,where,recurse,1)).trim()}function addConditionally(obj,prop,tagName,where,recurse){if(recurse===void 0){recurse=false}var val=fetch(tagName,where,recurse);if(val)obj[prop]=val}function isValidFeed(value){return value==="rss"||value==="feed"||value==="rdf:RDF"}},{"./legacy.js":157,"./stringify.js":160}],155:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.uniqueSort=exports.compareDocumentPosition=exports.DocumentPosition=exports.removeSubsets=void 0;var domhandler_1=require("domhandler");function removeSubsets(nodes){var idx=nodes.length;while(--idx>=0){var node=nodes[idx];if(idx>0&&nodes.lastIndexOf(node,idx-1)>=0){nodes.splice(idx,1);continue}for(var ancestor=node.parent;ancestor;ancestor=ancestor.parent){if(nodes.includes(ancestor)){nodes.splice(idx,1);break}}}return nodes}exports.removeSubsets=removeSubsets;var DocumentPosition;(function(DocumentPosition){DocumentPosition[DocumentPosition["DISCONNECTED"]=1]="DISCONNECTED";DocumentPosition[DocumentPosition["PRECEDING"]=2]="PRECEDING";DocumentPosition[DocumentPosition["FOLLOWING"]=4]="FOLLOWING";DocumentPosition[DocumentPosition["CONTAINS"]=8]="CONTAINS";DocumentPosition[DocumentPosition["CONTAINED_BY"]=16]="CONTAINED_BY"})(DocumentPosition=exports.DocumentPosition||(exports.DocumentPosition={}));function compareDocumentPosition(nodeA,nodeB){var aParents=[];var bParents=[];if(nodeA===nodeB){return 0}var current=(0,domhandler_1.hasChildren)(nodeA)?nodeA:nodeA.parent;while(current){aParents.unshift(current);current=current.parent}current=(0,domhandler_1.hasChildren)(nodeB)?nodeB:nodeB.parent;while(current){bParents.unshift(current);current=current.parent}var maxIdx=Math.min(aParents.length,bParents.length);var idx=0;while(idx<maxIdx&&aParents[idx]===bParents[idx]){idx++}if(idx===0){return DocumentPosition.DISCONNECTED}var sharedParent=aParents[idx-1];var siblings=sharedParent.children;var aSibling=aParents[idx];var bSibling=bParents[idx];if(siblings.indexOf(aSibling)>siblings.indexOf(bSibling)){if(sharedParent===nodeB){return DocumentPosition.FOLLOWING|DocumentPosition.CONTAINED_BY}return DocumentPosition.FOLLOWING}if(sharedParent===nodeA){return DocumentPosition.PRECEDING|DocumentPosition.CONTAINS}return DocumentPosition.PRECEDING}exports.compareDocumentPosition=compareDocumentPosition;function uniqueSort(nodes){nodes=nodes.filter((function(node,i,arr){return!arr.includes(node,i+1)}));nodes.sort((function(a,b){var relative=compareDocumentPosition(a,b);if(relative&DocumentPosition.PRECEDING){return-1}else if(relative&DocumentPosition.FOLLOWING){return 1}return 0}));return nodes}exports.uniqueSort=uniqueSort},{domhandler:152}],156:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:true});exports.hasChildren=exports.isDocument=exports.isComment=exports.isText=exports.isCDATA=exports.isTag=void 0;__exportStar(require("./stringify.js"),exports);__exportStar(require("./traversal.js"),exports);__exportStar(require("./manipulation.js"),exports);__exportStar(require("./querying.js"),exports);__exportStar(require("./legacy.js"),exports);__exportStar(require("./helpers.js"),exports);__exportStar(require("./feeds.js"),exports);var domhandler_1=require("domhandler");Object.defineProperty(exports,"isTag",{enumerable:true,get:function(){return domhandler_1.isTag}});Object.defineProperty(exports,"isCDATA",{enumerable:true,get:function(){return domhandler_1.isCDATA}});Object.defineProperty(exports,"isText",{enumerable:true,get:function(){return domhandler_1.isText}});Object.defineProperty(exports,"isComment",{enumerable:true,get:function(){return domhandler_1.isComment}});Object.defineProperty(exports,"isDocument",{enumerable:true,get:function(){return domhandler_1.isDocument}});Object.defineProperty(exports,"hasChildren",{enumerable:true,get:function(){return domhandler_1.hasChildren}})},{"./feeds.js":154,"./helpers.js":155,"./legacy.js":157,"./manipulation.js":158,"./querying.js":159,"./stringify.js":160,"./traversal.js":161,domhandler:152}],157:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getElementsByTagType=exports.getElementsByTagName=exports.getElementById=exports.getElements=exports.testElement=void 0;var domhandler_1=require("domhandler");var querying_js_1=require("./querying.js");var Checks={tag_name:function(name){if(typeof name==="function"){return function(elem){return(0,domhandler_1.isTag)(elem)&&name(elem.name)}}else if(name==="*"){return domhandler_1.isTag}return function(elem){return(0,domhandler_1.isTag)(elem)&&elem.name===name}},tag_type:function(type){if(typeof type==="function"){return function(elem){return type(elem.type)}}return function(elem){return elem.type===type}},tag_contains:function(data){if(typeof data==="function"){return function(elem){return(0,domhandler_1.isText)(elem)&&data(elem.data)}}return function(elem){return(0,domhandler_1.isText)(elem)&&elem.data===data}}};function getAttribCheck(attrib,value){if(typeof value==="function"){return function(elem){return(0,domhandler_1.isTag)(elem)&&value(elem.attribs[attrib])}}return function(elem){return(0,domhandler_1.isTag)(elem)&&elem.attribs[attrib]===value}}function combineFuncs(a,b){return function(elem){return a(elem)||b(elem)}}function compileTest(options){var funcs=Object.keys(options).map((function(key){var value=options[key];return Object.prototype.hasOwnProperty.call(Checks,key)?Checks[key](value):getAttribCheck(key,value)}));return funcs.length===0?null:funcs.reduce(combineFuncs)}function testElement(options,node){var test=compileTest(options);return test?test(node):true}exports.testElement=testElement;function getElements(options,nodes,recurse,limit){if(limit===void 0){limit=Infinity}var test=compileTest(options);return test?(0,querying_js_1.filter)(test,nodes,recurse,limit):[]}exports.getElements=getElements;function getElementById(id,nodes,recurse){if(recurse===void 0){recurse=true}if(!Array.isArray(nodes))nodes=[nodes];return(0,querying_js_1.findOne)(getAttribCheck("id",id),nodes,recurse)}exports.getElementById=getElementById;function getElementsByTagName(tagName,nodes,recurse,limit){if(recurse===void 0){recurse=true}if(limit===void 0){limit=Infinity}return(0,querying_js_1.filter)(Checks["tag_name"](tagName),nodes,recurse,limit)}exports.getElementsByTagName=getElementsByTagName;function getElementsByTagType(type,nodes,recurse,limit){if(recurse===void 0){recurse=true}if(limit===void 0){limit=Infinity}return(0,querying_js_1.filter)(Checks["tag_type"](type),nodes,recurse,limit)}exports.getElementsByTagType=getElementsByTagType},{"./querying.js":159,domhandler:152}],158:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.prepend=exports.prependChild=exports.append=exports.appendChild=exports.replaceElement=exports.removeElement=void 0;function removeElement(elem){if(elem.prev)elem.prev.next=elem.next;if(elem.next)elem.next.prev=elem.prev;if(elem.parent){var childs=elem.parent.children;var childsIndex=childs.lastIndexOf(elem);if(childsIndex>=0){childs.splice(childsIndex,1)}}elem.next=null;elem.prev=null;elem.parent=null}exports.removeElement=removeElement;function replaceElement(elem,replacement){var prev=replacement.prev=elem.prev;if(prev){prev.next=replacement}var next=replacement.next=elem.next;if(next){next.prev=replacement}var parent=replacement.parent=elem.parent;if(parent){var childs=parent.children;childs[childs.lastIndexOf(elem)]=replacement;elem.parent=null}}exports.replaceElement=replaceElement;function appendChild(parent,child){removeElement(child);child.next=null;child.parent=parent;if(parent.children.push(child)>1){var sibling=parent.children[parent.children.length-2];sibling.next=child;child.prev=sibling}else{child.prev=null}}exports.appendChild=appendChild;function append(elem,next){removeElement(next);var parent=elem.parent;var currNext=elem.next;next.next=currNext;next.prev=elem;elem.next=next;next.parent=parent;if(currNext){currNext.prev=next;if(parent){var childs=parent.children;childs.splice(childs.lastIndexOf(currNext),0,next)}}else if(parent){parent.children.push(next)}}exports.append=append;function prependChild(parent,child){removeElement(child);child.parent=parent;child.prev=null;if(parent.children.unshift(child)!==1){var sibling=parent.children[1];sibling.prev=child;child.next=sibling}else{child.next=null}}exports.prependChild=prependChild;function prepend(elem,prev){removeElement(prev);var parent=elem.parent;if(parent){var childs=parent.children;childs.splice(childs.indexOf(elem),0,prev)}if(elem.prev){elem.prev.next=prev}prev.parent=parent;prev.prev=elem.prev;prev.next=elem;elem.prev=prev}exports.prepend=prepend},{}],159:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.findAll=exports.existsOne=exports.findOne=exports.findOneChild=exports.find=exports.filter=void 0;var domhandler_1=require("domhandler");function filter(test,node,recurse,limit){if(recurse===void 0){recurse=true}if(limit===void 0){limit=Infinity}return find(test,Array.isArray(node)?node:[node],recurse,limit)}exports.filter=filter;function find(test,nodes,recurse,limit){var result=[];var nodeStack=[nodes];var indexStack=[0];for(;;){if(indexStack[0]>=nodeStack[0].length){if(indexStack.length===1){return result}nodeStack.shift();indexStack.shift();continue}var elem=nodeStack[0][indexStack[0]++];if(test(elem)){result.push(elem);if(--limit<=0)return result}if(recurse&&(0,domhandler_1.hasChildren)(elem)&&elem.children.length>0){indexStack.unshift(0);nodeStack.unshift(elem.children)}}}exports.find=find;function findOneChild(test,nodes){return nodes.find(test)}exports.findOneChild=findOneChild;function findOne(test,nodes,recurse){if(recurse===void 0){recurse=true}var elem=null;for(var i=0;i<nodes.length&&!elem;i++){var node=nodes[i];if(!(0,domhandler_1.isTag)(node)){continue}else if(test(node)){elem=node}else if(recurse&&node.children.length>0){elem=findOne(test,node.children,true)}}return elem}exports.findOne=findOne;function existsOne(test,nodes){return nodes.some((function(checked){return(0,domhandler_1.isTag)(checked)&&(test(checked)||existsOne(test,checked.children))}))}exports.existsOne=existsOne;function findAll(test,nodes){var result=[];var nodeStack=[nodes];var indexStack=[0];for(;;){if(indexStack[0]>=nodeStack[0].length){if(nodeStack.length===1){return result}nodeStack.shift();indexStack.shift();continue}var elem=nodeStack[0][indexStack[0]++];if(!(0,domhandler_1.isTag)(elem))continue;if(test(elem))result.push(elem);if(elem.children.length>0){indexStack.unshift(0);nodeStack.unshift(elem.children)}}}exports.findAll=findAll},{domhandler:152}],160:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.innerText=exports.textContent=exports.getText=exports.getInnerHTML=exports.getOuterHTML=void 0;var domhandler_1=require("domhandler");var dom_serializer_1=__importDefault(require("dom-serializer"));var domelementtype_1=require("domelementtype");function getOuterHTML(node,options){return(0,dom_serializer_1.default)(node,options)}exports.getOuterHTML=getOuterHTML;function getInnerHTML(node,options){return(0,domhandler_1.hasChildren)(node)?node.children.map((function(node){return getOuterHTML(node,options)})).join(""):""}exports.getInnerHTML=getInnerHTML;function getText(node){if(Array.isArray(node))return node.map(getText).join("");if((0,domhandler_1.isTag)(node))return node.name==="br"?"\n":getText(node.children);if((0,domhandler_1.isCDATA)(node))return getText(node.children);if((0,domhandler_1.isText)(node))return node.data;return""}exports.getText=getText;function textContent(node){if(Array.isArray(node))return node.map(textContent).join("");if((0,domhandler_1.hasChildren)(node)&&!(0,domhandler_1.isComment)(node)){return textContent(node.children)}if((0,domhandler_1.isText)(node))return node.data;return""}exports.textContent=textContent;function innerText(node){if(Array.isArray(node))return node.map(innerText).join("");if((0,domhandler_1.hasChildren)(node)&&(node.type===domelementtype_1.ElementType.Tag||(0,domhandler_1.isCDATA)(node))){return innerText(node.children)}if((0,domhandler_1.isText)(node))return node.data;return""}exports.innerText=innerText},{"dom-serializer":150,domelementtype:151,domhandler:152}],161:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.prevElementSibling=exports.nextElementSibling=exports.getName=exports.hasAttrib=exports.getAttributeValue=exports.getSiblings=exports.getParent=exports.getChildren=void 0;var domhandler_1=require("domhandler");function getChildren(elem){return(0,domhandler_1.hasChildren)(elem)?elem.children:[]}exports.getChildren=getChildren;function getParent(elem){return elem.parent||null}exports.getParent=getParent;function getSiblings(elem){var _a,_b;var parent=getParent(elem);if(parent!=null)return getChildren(parent);var siblings=[elem];var prev=elem.prev,next=elem.next;while(prev!=null){siblings.unshift(prev);_a=prev,prev=_a.prev}while(next!=null){siblings.push(next);_b=next,next=_b.next}return siblings}exports.getSiblings=getSiblings;function getAttributeValue(elem,name){var _a;return(_a=elem.attribs)===null||_a===void 0?void 0:_a[name]}exports.getAttributeValue=getAttributeValue;function hasAttrib(elem,name){return elem.attribs!=null&&Object.prototype.hasOwnProperty.call(elem.attribs,name)&&elem.attribs[name]!=null}exports.hasAttrib=hasAttrib;function getName(elem){return elem.name}exports.getName=getName;function nextElementSibling(elem){var _a;var next=elem.next;while(next!==null&&!(0,domhandler_1.isTag)(next))_a=next,next=_a.next;return next}exports.nextElementSibling=nextElementSibling;function prevElementSibling(elem){var _a;var prev=elem.prev;while(prev!==null&&!(0,domhandler_1.isTag)(prev))_a=prev,prev=_a.prev;return prev}exports.prevElementSibling=prevElementSibling},{domhandler:152}],162:[function(require,module,exports){"use strict";var elliptic=exports;elliptic.version=require("../package.json").version;elliptic.utils=require("./elliptic/utils");elliptic.rand=require("brorand");elliptic.curve=require("./elliptic/curve");elliptic.curves=require("./elliptic/curves");elliptic.ec=require("./elliptic/ec");elliptic.eddsa=require("./elliptic/eddsa")},{"../package.json":178,"./elliptic/curve":165,"./elliptic/curves":168,"./elliptic/ec":169,"./elliptic/eddsa":172,"./elliptic/utils":176,brorand:42}],163:[function(require,module,exports){"use strict";var BN=require("bn.js");var utils=require("../utils");var getNAF=utils.getNAF;var getJSF=utils.getJSF;var assert=utils.assert;function BaseCurve(type,conf){this.type=type;this.p=new BN(conf.p,16);this.red=conf.prime?BN.red(conf.prime):BN.mont(this.p);this.zero=new BN(0).toRed(this.red);this.one=new BN(1).toRed(this.red);this.two=new BN(2).toRed(this.red);this.n=conf.n&&new BN(conf.n,16);this.g=conf.g&&this.pointFromJSON(conf.g,conf.gRed);this._wnafT1=new Array(4);this._wnafT2=new Array(4);this._wnafT3=new Array(4);this._wnafT4=new Array(4);this._bitLength=this.n?this.n.bitLength():0;var adjustCount=this.n&&this.p.div(this.n);if(!adjustCount||adjustCount.cmpn(100)>0){this.redN=null}else{this._maxwellTrick=true;this.redN=this.n.toRed(this.red)}}module.exports=BaseCurve;BaseCurve.prototype.point=function point(){throw new Error("Not implemented")};BaseCurve.prototype.validate=function validate(){throw new Error("Not implemented")};BaseCurve.prototype._fixedNafMul=function _fixedNafMul(p,k){assert(p.precomputed);var doubles=p._getDoubles();var naf=getNAF(k,1,this._bitLength);var I=(1<<doubles.step+1)-(doubles.step%2===0?2:1);I/=3;var repr=[];var j;var nafW;for(j=0;j<naf.length;j+=doubles.step){nafW=0;for(var l=j+doubles.step-1;l>=j;l--)nafW=(nafW<<1)+naf[l];repr.push(nafW)}var a=this.jpoint(null,null,null);var b=this.jpoint(null,null,null);for(var i=I;i>0;i--){for(j=0;j<repr.length;j++){nafW=repr[j];if(nafW===i)b=b.mixedAdd(doubles.points[j]);else if(nafW===-i)b=b.mixedAdd(doubles.points[j].neg())}a=a.add(b)}return a.toP()};BaseCurve.prototype._wnafMul=function _wnafMul(p,k){var w=4;var nafPoints=p._getNAFPoints(w);w=nafPoints.wnd;var wnd=nafPoints.points;var naf=getNAF(k,w,this._bitLength);var acc=this.jpoint(null,null,null);for(var i=naf.length-1;i>=0;i--){for(var l=0;i>=0&&naf[i]===0;i--)l++;if(i>=0)l++;acc=acc.dblp(l);if(i<0)break;var z=naf[i];assert(z!==0);if(p.type==="affine"){if(z>0)acc=acc.mixedAdd(wnd[z-1>>1]);else acc=acc.mixedAdd(wnd[-z-1>>1].neg())}else{if(z>0)acc=acc.add(wnd[z-1>>1]);else acc=acc.add(wnd[-z-1>>1].neg())}}return p.type==="affine"?acc.toP():acc};BaseCurve.prototype._wnafMulAdd=function _wnafMulAdd(defW,points,coeffs,len,jacobianResult){var wndWidth=this._wnafT1;var wnd=this._wnafT2;var naf=this._wnafT3;var max=0;var i;var j;var p;for(i=0;i<len;i++){p=points[i];var nafPoints=p._getNAFPoints(defW);wndWidth[i]=nafPoints.wnd;wnd[i]=nafPoints.points}for(i=len-1;i>=1;i-=2){var a=i-1;var b=i;if(wndWidth[a]!==1||wndWidth[b]!==1){naf[a]=getNAF(coeffs[a],wndWidth[a],this._bitLength);naf[b]=getNAF(coeffs[b],wndWidth[b],this._bitLength);max=Math.max(naf[a].length,max);max=Math.max(naf[b].length,max);continue}var comb=[points[a],null,null,points[b]];if(points[a].y.cmp(points[b].y)===0){comb[1]=points[a].add(points[b]);comb[2]=points[a].toJ().mixedAdd(points[b].neg())}else if(points[a].y.cmp(points[b].y.redNeg())===0){comb[1]=points[a].toJ().mixedAdd(points[b]);comb[2]=points[a].add(points[b].neg())}else{comb[1]=points[a].toJ().mixedAdd(points[b]);comb[2]=points[a].toJ().mixedAdd(points[b].neg())}var index=[-3,-1,-5,-7,0,7,5,1,3];var jsf=getJSF(coeffs[a],coeffs[b]);max=Math.max(jsf[0].length,max);naf[a]=new Array(max);naf[b]=new Array(max);for(j=0;j<max;j++){var ja=jsf[0][j]|0;var jb=jsf[1][j]|0;naf[a][j]=index[(ja+1)*3+(jb+1)];naf[b][j]=0;wnd[a]=comb}}var acc=this.jpoint(null,null,null);var tmp=this._wnafT4;for(i=max;i>=0;i--){var k=0;while(i>=0){var zero=true;for(j=0;j<len;j++){tmp[j]=naf[j][i]|0;if(tmp[j]!==0)zero=false}if(!zero)break;k++;i--}if(i>=0)k++;acc=acc.dblp(k);if(i<0)break;for(j=0;j<len;j++){var z=tmp[j];p;if(z===0)continue;else if(z>0)p=wnd[j][z-1>>1];else if(z<0)p=wnd[j][-z-1>>1].neg();if(p.type==="affine")acc=acc.mixedAdd(p);else acc=acc.add(p)}}for(i=0;i<len;i++)wnd[i]=null;if(jacobianResult)return acc;else return acc.toP()};function BasePoint(curve,type){this.curve=curve;this.type=type;this.precomputed=null}BaseCurve.BasePoint=BasePoint;BasePoint.prototype.eq=function eq(){throw new Error("Not implemented")};BasePoint.prototype.validate=function validate(){return this.curve.validate(this)};BaseCurve.prototype.decodePoint=function decodePoint(bytes,enc){bytes=utils.toArray(bytes,enc);var len=this.p.byteLength();if((bytes[0]===4||bytes[0]===6||bytes[0]===7)&&bytes.length-1===2*len){if(bytes[0]===6)assert(bytes[bytes.length-1]%2===0);else if(bytes[0]===7)assert(bytes[bytes.length-1]%2===1);var res=this.point(bytes.slice(1,1+len),bytes.slice(1+len,1+2*len));return res}else if((bytes[0]===2||bytes[0]===3)&&bytes.length-1===len){return this.pointFromX(bytes.slice(1,1+len),bytes[0]===3)}throw new Error("Unknown point format")};BasePoint.prototype.encodeCompressed=function encodeCompressed(enc){return this.encode(enc,true)};BasePoint.prototype._encode=function _encode(compact){var len=this.curve.p.byteLength();var x=this.getX().toArray("be",len);if(compact)return[this.getY().isEven()?2:3].concat(x);return[4].concat(x,this.getY().toArray("be",len))};BasePoint.prototype.encode=function encode(enc,compact){return utils.encode(this._encode(compact),enc)};BasePoint.prototype.precompute=function precompute(power){if(this.precomputed)return this;var precomputed={doubles:null,naf:null,beta:null};precomputed.naf=this._getNAFPoints(8);precomputed.doubles=this._getDoubles(4,power);precomputed.beta=this._getBeta();this.precomputed=precomputed;return this};BasePoint.prototype._hasDoubles=function _hasDoubles(k){if(!this.precomputed)return false;var doubles=this.precomputed.doubles;if(!doubles)return false;return doubles.points.length>=Math.ceil((k.bitLength()+1)/doubles.step)};BasePoint.prototype._getDoubles=function _getDoubles(step,power){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;var doubles=[this];var acc=this;for(var i=0;i<power;i+=step){for(var j=0;j<step;j++)acc=acc.dbl();doubles.push(acc)}return{step:step,points:doubles}};BasePoint.prototype._getNAFPoints=function _getNAFPoints(wnd){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;var res=[this];var max=(1<<wnd)-1;var dbl=max===1?null:this.dbl();for(var i=1;i<max;i++)res[i]=res[i-1].add(dbl);return{wnd:wnd,points:res}};BasePoint.prototype._getBeta=function _getBeta(){return null};BasePoint.prototype.dblp=function dblp(k){var r=this;for(var i=0;i<k;i++)r=r.dbl();return r}},{"../utils":176,"bn.js":177}],164:[function(require,module,exports){"use strict";var utils=require("../utils");var BN=require("bn.js");var inherits=require("inherits");var Base=require("./base");var assert=utils.assert;function EdwardsCurve(conf){this.twisted=(conf.a|0)!==1;this.mOneA=this.twisted&&(conf.a|0)===-1;this.extended=this.mOneA;Base.call(this,"edwards",conf);this.a=new BN(conf.a,16).umod(this.red.m);this.a=this.a.toRed(this.red);this.c=new BN(conf.c,16).toRed(this.red);this.c2=this.c.redSqr();this.d=new BN(conf.d,16).toRed(this.red);this.dd=this.d.redAdd(this.d);assert(!this.twisted||this.c.fromRed().cmpn(1)===0);this.oneC=(conf.c|0)===1}inherits(EdwardsCurve,Base);module.exports=EdwardsCurve;EdwardsCurve.prototype._mulA=function _mulA(num){if(this.mOneA)return num.redNeg();else return this.a.redMul(num)};EdwardsCurve.prototype._mulC=function _mulC(num){if(this.oneC)return num;else return this.c.redMul(num)};EdwardsCurve.prototype.jpoint=function jpoint(x,y,z,t){return this.point(x,y,z,t)};EdwardsCurve.prototype.pointFromX=function pointFromX(x,odd){x=new BN(x,16);if(!x.red)x=x.toRed(this.red);var x2=x.redSqr();var rhs=this.c2.redSub(this.a.redMul(x2));var lhs=this.one.redSub(this.c2.redMul(this.d).redMul(x2));var y2=rhs.redMul(lhs.redInvm());var y=y2.redSqrt();if(y.redSqr().redSub(y2).cmp(this.zero)!==0)throw new Error("invalid point");var isOdd=y.fromRed().isOdd();if(odd&&!isOdd||!odd&&isOdd)y=y.redNeg();return this.point(x,y)};EdwardsCurve.prototype.pointFromY=function pointFromY(y,odd){y=new BN(y,16);if(!y.red)y=y.toRed(this.red);var y2=y.redSqr();var lhs=y2.redSub(this.c2);var rhs=y2.redMul(this.d).redMul(this.c2).redSub(this.a);var x2=lhs.redMul(rhs.redInvm());if(x2.cmp(this.zero)===0){if(odd)throw new Error("invalid point");else return this.point(this.zero,y)}var x=x2.redSqrt();if(x.redSqr().redSub(x2).cmp(this.zero)!==0)throw new Error("invalid point");if(x.fromRed().isOdd()!==odd)x=x.redNeg();return this.point(x,y)};EdwardsCurve.prototype.validate=function validate(point){if(point.isInfinity())return true;point.normalize();var x2=point.x.redSqr();var y2=point.y.redSqr();var lhs=x2.redMul(this.a).redAdd(y2);var rhs=this.c2.redMul(this.one.redAdd(this.d.redMul(x2).redMul(y2)));return lhs.cmp(rhs)===0};function Point(curve,x,y,z,t){Base.BasePoint.call(this,curve,"projective");if(x===null&&y===null&&z===null){this.x=this.curve.zero;this.y=this.curve.one;this.z=this.curve.one;this.t=this.curve.zero;this.zOne=true}else{this.x=new BN(x,16);this.y=new BN(y,16);this.z=z?new BN(z,16):this.curve.one;this.t=t&&new BN(t,16);if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.y.red)this.y=this.y.toRed(this.curve.red);if(!this.z.red)this.z=this.z.toRed(this.curve.red);if(this.t&&!this.t.red)this.t=this.t.toRed(this.curve.red);this.zOne=this.z===this.curve.one;if(this.curve.extended&&!this.t){this.t=this.x.redMul(this.y);if(!this.zOne)this.t=this.t.redMul(this.z.redInvm())}}}inherits(Point,Base.BasePoint);EdwardsCurve.prototype.pointFromJSON=function pointFromJSON(obj){return Point.fromJSON(this,obj)};EdwardsCurve.prototype.point=function point(x,y,z,t){return new Point(this,x,y,z,t)};Point.fromJSON=function fromJSON(curve,obj){return new Point(curve,obj[0],obj[1],obj[2])};Point.prototype.inspect=function inspect(){if(this.isInfinity())return"<EC Point Infinity>";return"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Point.prototype.isInfinity=function isInfinity(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Point.prototype._extDbl=function _extDbl(){var a=this.x.redSqr();var b=this.y.redSqr();var c=this.z.redSqr();c=c.redIAdd(c);var d=this.curve._mulA(a);var e=this.x.redAdd(this.y).redSqr().redISub(a).redISub(b);var g=d.redAdd(b);var f=g.redSub(c);var h=d.redSub(b);var nx=e.redMul(f);var ny=g.redMul(h);var nt=e.redMul(h);var nz=f.redMul(g);return this.curve.point(nx,ny,nz,nt)};Point.prototype._projDbl=function _projDbl(){var b=this.x.redAdd(this.y).redSqr();var c=this.x.redSqr();var d=this.y.redSqr();var nx;var ny;var nz;var e;var h;var j;if(this.curve.twisted){e=this.curve._mulA(c);var f=e.redAdd(d);if(this.zOne){nx=b.redSub(c).redSub(d).redMul(f.redSub(this.curve.two));ny=f.redMul(e.redSub(d));nz=f.redSqr().redSub(f).redSub(f)}else{h=this.z.redSqr();j=f.redSub(h).redISub(h);nx=b.redSub(c).redISub(d).redMul(j);ny=f.redMul(e.redSub(d));nz=f.redMul(j)}}else{e=c.redAdd(d);h=this.curve._mulC(this.z).redSqr();j=e.redSub(h).redSub(h);nx=this.curve._mulC(b.redISub(e)).redMul(j);ny=this.curve._mulC(e).redMul(c.redISub(d));nz=e.redMul(j)}return this.curve.point(nx,ny,nz)};Point.prototype.dbl=function dbl(){if(this.isInfinity())return this;if(this.curve.extended)return this._extDbl();else return this._projDbl()};Point.prototype._extAdd=function _extAdd(p){var a=this.y.redSub(this.x).redMul(p.y.redSub(p.x));var b=this.y.redAdd(this.x).redMul(p.y.redAdd(p.x));var c=this.t.redMul(this.curve.dd).redMul(p.t);var d=this.z.redMul(p.z.redAdd(p.z));var e=b.redSub(a);var f=d.redSub(c);var g=d.redAdd(c);var h=b.redAdd(a);var nx=e.redMul(f);var ny=g.redMul(h);var nt=e.redMul(h);var nz=f.redMul(g);return this.curve.point(nx,ny,nz,nt)};Point.prototype._projAdd=function _projAdd(p){var a=this.z.redMul(p.z);var b=a.redSqr();var c=this.x.redMul(p.x);var d=this.y.redMul(p.y);var e=this.curve.d.redMul(c).redMul(d);var f=b.redSub(e);var g=b.redAdd(e);var tmp=this.x.redAdd(this.y).redMul(p.x.redAdd(p.y)).redISub(c).redISub(d);var nx=a.redMul(f).redMul(tmp);var ny;var nz;if(this.curve.twisted){ny=a.redMul(g).redMul(d.redSub(this.curve._mulA(c)));nz=f.redMul(g)}else{ny=a.redMul(g).redMul(d.redSub(c));nz=this.curve._mulC(f).redMul(g)}return this.curve.point(nx,ny,nz)};Point.prototype.add=function add(p){if(this.isInfinity())return p;if(p.isInfinity())return this;if(this.curve.extended)return this._extAdd(p);else return this._projAdd(p)};Point.prototype.mul=function mul(k){if(this._hasDoubles(k))return this.curve._fixedNafMul(this,k);else return this.curve._wnafMul(this,k)};Point.prototype.mulAdd=function mulAdd(k1,p,k2){return this.curve._wnafMulAdd(1,[this,p],[k1,k2],2,false)};Point.prototype.jmulAdd=function jmulAdd(k1,p,k2){return this.curve._wnafMulAdd(1,[this,p],[k1,k2],2,true)};Point.prototype.normalize=function normalize(){if(this.zOne)return this;var zi=this.z.redInvm();this.x=this.x.redMul(zi);this.y=this.y.redMul(zi);if(this.t)this.t=this.t.redMul(zi);this.z=this.curve.one;this.zOne=true;return this};Point.prototype.neg=function neg(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Point.prototype.getX=function getX(){this.normalize();return this.x.fromRed()};Point.prototype.getY=function getY(){this.normalize();return this.y.fromRed()};Point.prototype.eq=function eq(other){return this===other||this.getX().cmp(other.getX())===0&&this.getY().cmp(other.getY())===0};Point.prototype.eqXToP=function eqXToP(x){var rx=x.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(rx)===0)return true;var xc=x.clone();var t=this.curve.redN.redMul(this.z);for(;;){xc.iadd(this.curve.n);if(xc.cmp(this.curve.p)>=0)return false;rx.redIAdd(t);if(this.x.cmp(rx)===0)return true}};Point.prototype.toP=Point.prototype.normalize;Point.prototype.mixedAdd=Point.prototype.add},{"../utils":176,"./base":163,"bn.js":177,inherits:233}],165:[function(require,module,exports){"use strict";var curve=exports;curve.base=require("./base");curve.short=require("./short");curve.mont=require("./mont");curve.edwards=require("./edwards")},{"./base":163,"./edwards":164,"./mont":166,"./short":167}],166:[function(require,module,exports){"use strict";var BN=require("bn.js");var inherits=require("inherits");var Base=require("./base");var utils=require("../utils");function MontCurve(conf){Base.call(this,"mont",conf);this.a=new BN(conf.a,16).toRed(this.red);this.b=new BN(conf.b,16).toRed(this.red);this.i4=new BN(4).toRed(this.red).redInvm();this.two=new BN(2).toRed(this.red);this.a24=this.i4.redMul(this.a.redAdd(this.two))}inherits(MontCurve,Base);module.exports=MontCurve;MontCurve.prototype.validate=function validate(point){var x=point.normalize().x;var x2=x.redSqr();var rhs=x2.redMul(x).redAdd(x2.redMul(this.a)).redAdd(x);var y=rhs.redSqrt();return y.redSqr().cmp(rhs)===0};function Point(curve,x,z){Base.BasePoint.call(this,curve,"projective");if(x===null&&z===null){this.x=this.curve.one;this.z=this.curve.zero}else{this.x=new BN(x,16);this.z=new BN(z,16);if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.z.red)this.z=this.z.toRed(this.curve.red)}}inherits(Point,Base.BasePoint);MontCurve.prototype.decodePoint=function decodePoint(bytes,enc){return this.point(utils.toArray(bytes,enc),1)};MontCurve.prototype.point=function point(x,z){return new Point(this,x,z)};MontCurve.prototype.pointFromJSON=function pointFromJSON(obj){return Point.fromJSON(this,obj)};Point.prototype.precompute=function precompute(){};Point.prototype._encode=function _encode(){return this.getX().toArray("be",this.curve.p.byteLength())};Point.fromJSON=function fromJSON(curve,obj){return new Point(curve,obj[0],obj[1]||curve.one)};Point.prototype.inspect=function inspect(){if(this.isInfinity())return"<EC Point Infinity>";return"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Point.prototype.isInfinity=function isInfinity(){return this.z.cmpn(0)===0};Point.prototype.dbl=function dbl(){var a=this.x.redAdd(this.z);var aa=a.redSqr();var b=this.x.redSub(this.z);var bb=b.redSqr();var c=aa.redSub(bb);var nx=aa.redMul(bb);var nz=c.redMul(bb.redAdd(this.curve.a24.redMul(c)));return this.curve.point(nx,nz)};Point.prototype.add=function add(){throw new Error("Not supported on Montgomery curve")};Point.prototype.diffAdd=function diffAdd(p,diff){var a=this.x.redAdd(this.z);var b=this.x.redSub(this.z);var c=p.x.redAdd(p.z);var d=p.x.redSub(p.z);var da=d.redMul(a);var cb=c.redMul(b);var nx=diff.z.redMul(da.redAdd(cb).redSqr());var nz=diff.x.redMul(da.redISub(cb).redSqr());return this.curve.point(nx,nz)};Point.prototype.mul=function mul(k){var t=k.clone();var a=this;var b=this.curve.point(null,null);var c=this;for(var bits=[];t.cmpn(0)!==0;t.iushrn(1))bits.push(t.andln(1));for(var i=bits.length-1;i>=0;i--){if(bits[i]===0){a=a.diffAdd(b,c);b=b.dbl()}else{b=a.diffAdd(b,c);a=a.dbl()}}return b};Point.prototype.mulAdd=function mulAdd(){throw new Error("Not supported on Montgomery curve")};Point.prototype.jumlAdd=function jumlAdd(){throw new Error("Not supported on Montgomery curve")};Point.prototype.eq=function eq(other){return this.getX().cmp(other.getX())===0};Point.prototype.normalize=function normalize(){this.x=this.x.redMul(this.z.redInvm());this.z=this.curve.one;return this};Point.prototype.getX=function getX(){this.normalize();return this.x.fromRed()}},{"../utils":176,"./base":163,"bn.js":177,inherits:233}],167:[function(require,module,exports){"use strict";var utils=require("../utils");var BN=require("bn.js");var inherits=require("inherits");var Base=require("./base");var assert=utils.assert;function ShortCurve(conf){Base.call(this,"short",conf);this.a=new BN(conf.a,16).toRed(this.red);this.b=new BN(conf.b,16).toRed(this.red);this.tinv=this.two.redInvm();this.zeroA=this.a.fromRed().cmpn(0)===0;this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0;this.endo=this._getEndomorphism(conf);this._endoWnafT1=new Array(4);this._endoWnafT2=new Array(4)}inherits(ShortCurve,Base);module.exports=ShortCurve;ShortCurve.prototype._getEndomorphism=function _getEndomorphism(conf){if(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)return;var beta;var lambda;if(conf.beta){beta=new BN(conf.beta,16).toRed(this.red)}else{var betas=this._getEndoRoots(this.p);beta=betas[0].cmp(betas[1])<0?betas[0]:betas[1];beta=beta.toRed(this.red)}if(conf.lambda){lambda=new BN(conf.lambda,16)}else{var lambdas=this._getEndoRoots(this.n);if(this.g.mul(lambdas[0]).x.cmp(this.g.x.redMul(beta))===0){lambda=lambdas[0]}else{lambda=lambdas[1];assert(this.g.mul(lambda).x.cmp(this.g.x.redMul(beta))===0)}}var basis;if(conf.basis){basis=conf.basis.map((function(vec){return{a:new BN(vec.a,16),b:new BN(vec.b,16)}}))}else{basis=this._getEndoBasis(lambda)}return{beta:beta,lambda:lambda,basis:basis}};ShortCurve.prototype._getEndoRoots=function _getEndoRoots(num){var red=num===this.p?this.red:BN.mont(num);var tinv=new BN(2).toRed(red).redInvm();var ntinv=tinv.redNeg();var s=new BN(3).toRed(red).redNeg().redSqrt().redMul(tinv);var l1=ntinv.redAdd(s).fromRed();var l2=ntinv.redSub(s).fromRed();return[l1,l2]};ShortCurve.prototype._getEndoBasis=function _getEndoBasis(lambda){var aprxSqrt=this.n.ushrn(Math.floor(this.n.bitLength()/2));var u=lambda;var v=this.n.clone();var x1=new BN(1);var y1=new BN(0);var x2=new BN(0);var y2=new BN(1);var a0;var b0;var a1;var b1;var a2;var b2;var prevR;var i=0;var r;var x;while(u.cmpn(0)!==0){var q=v.div(u);r=v.sub(q.mul(u));x=x2.sub(q.mul(x1));var y=y2.sub(q.mul(y1));if(!a1&&r.cmp(aprxSqrt)<0){a0=prevR.neg();b0=x1;a1=r.neg();b1=x}else if(a1&&++i===2){break}prevR=r;v=u;u=r;x2=x1;x1=x;y2=y1;y1=y}a2=r.neg();b2=x;var len1=a1.sqr().add(b1.sqr());var len2=a2.sqr().add(b2.sqr());if(len2.cmp(len1)>=0){a2=a0;b2=b0}if(a1.negative){a1=a1.neg();b1=b1.neg()}if(a2.negative){a2=a2.neg();b2=b2.neg()}return[{a:a1,b:b1},{a:a2,b:b2}]};ShortCurve.prototype._endoSplit=function _endoSplit(k){var basis=this.endo.basis;var v1=basis[0];var v2=basis[1];var c1=v2.b.mul(k).divRound(this.n);var c2=v1.b.neg().mul(k).divRound(this.n);var p1=c1.mul(v1.a);var p2=c2.mul(v2.a);var q1=c1.mul(v1.b);var q2=c2.mul(v2.b);var k1=k.sub(p1).sub(p2);var k2=q1.add(q2).neg();return{k1:k1,k2:k2}};ShortCurve.prototype.pointFromX=function pointFromX(x,odd){x=new BN(x,16);if(!x.red)x=x.toRed(this.red);var y2=x.redSqr().redMul(x).redIAdd(x.redMul(this.a)).redIAdd(this.b);var y=y2.redSqrt();if(y.redSqr().redSub(y2).cmp(this.zero)!==0)throw new Error("invalid point");var isOdd=y.fromRed().isOdd();if(odd&&!isOdd||!odd&&isOdd)y=y.redNeg();return this.point(x,y)};ShortCurve.prototype.validate=function validate(point){if(point.inf)return true;var x=point.x;var y=point.y;var ax=this.a.redMul(x);var rhs=x.redSqr().redMul(x).redIAdd(ax).redIAdd(this.b);return y.redSqr().redISub(rhs).cmpn(0)===0};ShortCurve.prototype._endoWnafMulAdd=function _endoWnafMulAdd(points,coeffs,jacobianResult){var npoints=this._endoWnafT1;var ncoeffs=this._endoWnafT2;for(var i=0;i<points.length;i++){var split=this._endoSplit(coeffs[i]);var p=points[i];var beta=p._getBeta();if(split.k1.negative){split.k1.ineg();p=p.neg(true)}if(split.k2.negative){split.k2.ineg();beta=beta.neg(true)}npoints[i*2]=p;npoints[i*2+1]=beta;ncoeffs[i*2]=split.k1;ncoeffs[i*2+1]=split.k2}var res=this._wnafMulAdd(1,npoints,ncoeffs,i*2,jacobianResult);for(var j=0;j<i*2;j++){npoints[j]=null;ncoeffs[j]=null}return res};function Point(curve,x,y,isRed){Base.BasePoint.call(this,curve,"affine");if(x===null&&y===null){this.x=null;this.y=null;this.inf=true}else{this.x=new BN(x,16);this.y=new BN(y,16);if(isRed){this.x.forceRed(this.curve.red);this.y.forceRed(this.curve.red)}if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.y.red)this.y=this.y.toRed(this.curve.red);this.inf=false}}inherits(Point,Base.BasePoint);ShortCurve.prototype.point=function point(x,y,isRed){return new Point(this,x,y,isRed)};ShortCurve.prototype.pointFromJSON=function pointFromJSON(obj,red){return Point.fromJSON(this,obj,red)};Point.prototype._getBeta=function _getBeta(){if(!this.curve.endo)return;var pre=this.precomputed;if(pre&&pre.beta)return pre.beta;var beta=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(pre){var curve=this.curve;var endoMul=function(p){return curve.point(p.x.redMul(curve.endo.beta),p.y)};pre.beta=beta;beta.precomputed={beta:null,naf:pre.naf&&{wnd:pre.naf.wnd,points:pre.naf.points.map(endoMul)},doubles:pre.doubles&&{step:pre.doubles.step,points:pre.doubles.points.map(endoMul)}}}return beta};Point.prototype.toJSON=function toJSON(){if(!this.precomputed)return[this.x,this.y];return[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]};Point.fromJSON=function fromJSON(curve,obj,red){if(typeof obj==="string")obj=JSON.parse(obj);var res=curve.point(obj[0],obj[1],red);if(!obj[2])return res;function obj2point(obj){return curve.point(obj[0],obj[1],red)}var pre=obj[2];res.precomputed={beta:null,doubles:pre.doubles&&{step:pre.doubles.step,points:[res].concat(pre.doubles.points.map(obj2point))},naf:pre.naf&&{wnd:pre.naf.wnd,points:[res].concat(pre.naf.points.map(obj2point))}};return res};Point.prototype.inspect=function inspect(){if(this.isInfinity())return"<EC Point Infinity>";return"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Point.prototype.isInfinity=function isInfinity(){return this.inf};Point.prototype.add=function add(p){if(this.inf)return p;if(p.inf)return this;if(this.eq(p))return this.dbl();if(this.neg().eq(p))return this.curve.point(null,null);if(this.x.cmp(p.x)===0)return this.curve.point(null,null);var c=this.y.redSub(p.y);if(c.cmpn(0)!==0)c=c.redMul(this.x.redSub(p.x).redInvm());var nx=c.redSqr().redISub(this.x).redISub(p.x);var ny=c.redMul(this.x.redSub(nx)).redISub(this.y);return this.curve.point(nx,ny)};Point.prototype.dbl=function dbl(){if(this.inf)return this;var ys1=this.y.redAdd(this.y);if(ys1.cmpn(0)===0)return this.curve.point(null,null);var a=this.curve.a;var x2=this.x.redSqr();var dyinv=ys1.redInvm();var c=x2.redAdd(x2).redIAdd(x2).redIAdd(a).redMul(dyinv);var nx=c.redSqr().redISub(this.x.redAdd(this.x));var ny=c.redMul(this.x.redSub(nx)).redISub(this.y);return this.curve.point(nx,ny)};Point.prototype.getX=function getX(){return this.x.fromRed()};Point.prototype.getY=function getY(){return this.y.fromRed()};Point.prototype.mul=function mul(k){k=new BN(k,16);if(this.isInfinity())return this;else if(this._hasDoubles(k))return this.curve._fixedNafMul(this,k);else if(this.curve.endo)return this.curve._endoWnafMulAdd([this],[k]);else return this.curve._wnafMul(this,k)};Point.prototype.mulAdd=function mulAdd(k1,p2,k2){var points=[this,p2];var coeffs=[k1,k2];if(this.curve.endo)return this.curve._endoWnafMulAdd(points,coeffs);else return this.curve._wnafMulAdd(1,points,coeffs,2)};Point.prototype.jmulAdd=function jmulAdd(k1,p2,k2){var points=[this,p2];var coeffs=[k1,k2];if(this.curve.endo)return this.curve._endoWnafMulAdd(points,coeffs,true);else return this.curve._wnafMulAdd(1,points,coeffs,2,true)};Point.prototype.eq=function eq(p){return this===p||this.inf===p.inf&&(this.inf||this.x.cmp(p.x)===0&&this.y.cmp(p.y)===0)};Point.prototype.neg=function neg(_precompute){if(this.inf)return this;var res=this.curve.point(this.x,this.y.redNeg());if(_precompute&&this.precomputed){var pre=this.precomputed;var negate=function(p){return p.neg()};res.precomputed={naf:pre.naf&&{wnd:pre.naf.wnd,points:pre.naf.points.map(negate)},doubles:pre.doubles&&{step:pre.doubles.step,points:pre.doubles.points.map(negate)}}}return res};Point.prototype.toJ=function toJ(){if(this.inf)return this.curve.jpoint(null,null,null);var res=this.curve.jpoint(this.x,this.y,this.curve.one);return res};function JPoint(curve,x,y,z){Base.BasePoint.call(this,curve,"jacobian");if(x===null&&y===null&&z===null){this.x=this.curve.one;this.y=this.curve.one;this.z=new BN(0)}else{this.x=new BN(x,16);this.y=new BN(y,16);this.z=new BN(z,16)}if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.y.red)this.y=this.y.toRed(this.curve.red);if(!this.z.red)this.z=this.z.toRed(this.curve.red);this.zOne=this.z===this.curve.one}inherits(JPoint,Base.BasePoint);ShortCurve.prototype.jpoint=function jpoint(x,y,z){return new JPoint(this,x,y,z)};JPoint.prototype.toP=function toP(){if(this.isInfinity())return this.curve.point(null,null);var zinv=this.z.redInvm();var zinv2=zinv.redSqr();var ax=this.x.redMul(zinv2);var ay=this.y.redMul(zinv2).redMul(zinv);return this.curve.point(ax,ay)};JPoint.prototype.neg=function neg(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};JPoint.prototype.add=function add(p){if(this.isInfinity())return p;if(p.isInfinity())return this;var pz2=p.z.redSqr();var z2=this.z.redSqr();var u1=this.x.redMul(pz2);var u2=p.x.redMul(z2);var s1=this.y.redMul(pz2.redMul(p.z));var s2=p.y.redMul(z2.redMul(this.z));var h=u1.redSub(u2);var r=s1.redSub(s2);if(h.cmpn(0)===0){if(r.cmpn(0)!==0)return this.curve.jpoint(null,null,null);else return this.dbl()}var h2=h.redSqr();var h3=h2.redMul(h);var v=u1.redMul(h2);var nx=r.redSqr().redIAdd(h3).redISub(v).redISub(v);var ny=r.redMul(v.redISub(nx)).redISub(s1.redMul(h3));var nz=this.z.redMul(p.z).redMul(h);return this.curve.jpoint(nx,ny,nz)};JPoint.prototype.mixedAdd=function mixedAdd(p){if(this.isInfinity())return p.toJ();if(p.isInfinity())return this;var z2=this.z.redSqr();var u1=this.x;var u2=p.x.redMul(z2);var s1=this.y;var s2=p.y.redMul(z2).redMul(this.z);var h=u1.redSub(u2);var r=s1.redSub(s2);if(h.cmpn(0)===0){if(r.cmpn(0)!==0)return this.curve.jpoint(null,null,null);else return this.dbl()}var h2=h.redSqr();var h3=h2.redMul(h);var v=u1.redMul(h2);var nx=r.redSqr().redIAdd(h3).redISub(v).redISub(v);var ny=r.redMul(v.redISub(nx)).redISub(s1.redMul(h3));var nz=this.z.redMul(h);return this.curve.jpoint(nx,ny,nz)};JPoint.prototype.dblp=function dblp(pow){if(pow===0)return this;if(this.isInfinity())return this;if(!pow)return this.dbl();var i;if(this.curve.zeroA||this.curve.threeA){var r=this;for(i=0;i<pow;i++)r=r.dbl();return r}var a=this.curve.a;var tinv=this.curve.tinv;var jx=this.x;var jy=this.y;var jz=this.z;var jz4=jz.redSqr().redSqr();var jyd=jy.redAdd(jy);for(i=0;i<pow;i++){var jx2=jx.redSqr();var jyd2=jyd.redSqr();var jyd4=jyd2.redSqr();var c=jx2.redAdd(jx2).redIAdd(jx2).redIAdd(a.redMul(jz4));var t1=jx.redMul(jyd2);var nx=c.redSqr().redISub(t1.redAdd(t1));var t2=t1.redISub(nx);var dny=c.redMul(t2);dny=dny.redIAdd(dny).redISub(jyd4);var nz=jyd.redMul(jz);if(i+1<pow)jz4=jz4.redMul(jyd4);jx=nx;jz=nz;jyd=dny}return this.curve.jpoint(jx,jyd.redMul(tinv),jz)};JPoint.prototype.dbl=function dbl(){if(this.isInfinity())return this;if(this.curve.zeroA)return this._zeroDbl();else if(this.curve.threeA)return this._threeDbl();else return this._dbl()};JPoint.prototype._zeroDbl=function _zeroDbl(){var nx;var ny;var nz;if(this.zOne){var xx=this.x.redSqr();var yy=this.y.redSqr();var yyyy=yy.redSqr();var s=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy);s=s.redIAdd(s);var m=xx.redAdd(xx).redIAdd(xx);var t=m.redSqr().redISub(s).redISub(s);var yyyy8=yyyy.redIAdd(yyyy);yyyy8=yyyy8.redIAdd(yyyy8);yyyy8=yyyy8.redIAdd(yyyy8);nx=t;ny=m.redMul(s.redISub(t)).redISub(yyyy8);nz=this.y.redAdd(this.y)}else{var a=this.x.redSqr();var b=this.y.redSqr();var c=b.redSqr();var d=this.x.redAdd(b).redSqr().redISub(a).redISub(c);d=d.redIAdd(d);var e=a.redAdd(a).redIAdd(a);var f=e.redSqr();var c8=c.redIAdd(c);c8=c8.redIAdd(c8);c8=c8.redIAdd(c8);nx=f.redISub(d).redISub(d);ny=e.redMul(d.redISub(nx)).redISub(c8);nz=this.y.redMul(this.z);nz=nz.redIAdd(nz)}return this.curve.jpoint(nx,ny,nz)};JPoint.prototype._threeDbl=function _threeDbl(){var nx;var ny;var nz;if(this.zOne){var xx=this.x.redSqr();var yy=this.y.redSqr();var yyyy=yy.redSqr();var s=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy);s=s.redIAdd(s);var m=xx.redAdd(xx).redIAdd(xx).redIAdd(this.curve.a);var t=m.redSqr().redISub(s).redISub(s);nx=t;var yyyy8=yyyy.redIAdd(yyyy);yyyy8=yyyy8.redIAdd(yyyy8);yyyy8=yyyy8.redIAdd(yyyy8);ny=m.redMul(s.redISub(t)).redISub(yyyy8);nz=this.y.redAdd(this.y)}else{var delta=this.z.redSqr();var gamma=this.y.redSqr();var beta=this.x.redMul(gamma);var alpha=this.x.redSub(delta).redMul(this.x.redAdd(delta));alpha=alpha.redAdd(alpha).redIAdd(alpha);var beta4=beta.redIAdd(beta);beta4=beta4.redIAdd(beta4);var beta8=beta4.redAdd(beta4);nx=alpha.redSqr().redISub(beta8);nz=this.y.redAdd(this.z).redSqr().redISub(gamma).redISub(delta);var ggamma8=gamma.redSqr();ggamma8=ggamma8.redIAdd(ggamma8);ggamma8=ggamma8.redIAdd(ggamma8);ggamma8=ggamma8.redIAdd(ggamma8);ny=alpha.redMul(beta4.redISub(nx)).redISub(ggamma8)}return this.curve.jpoint(nx,ny,nz)};JPoint.prototype._dbl=function _dbl(){var a=this.curve.a;var jx=this.x;var jy=this.y;var jz=this.z;var jz4=jz.redSqr().redSqr();var jx2=jx.redSqr();var jy2=jy.redSqr();var c=jx2.redAdd(jx2).redIAdd(jx2).redIAdd(a.redMul(jz4));var jxd4=jx.redAdd(jx);jxd4=jxd4.redIAdd(jxd4);var t1=jxd4.redMul(jy2);var nx=c.redSqr().redISub(t1.redAdd(t1));var t2=t1.redISub(nx);var jyd8=jy2.redSqr();jyd8=jyd8.redIAdd(jyd8);jyd8=jyd8.redIAdd(jyd8);jyd8=jyd8.redIAdd(jyd8);var ny=c.redMul(t2).redISub(jyd8);var nz=jy.redAdd(jy).redMul(jz);return this.curve.jpoint(nx,ny,nz)};JPoint.prototype.trpl=function trpl(){if(!this.curve.zeroA)return this.dbl().add(this);var xx=this.x.redSqr();var yy=this.y.redSqr();var zz=this.z.redSqr();var yyyy=yy.redSqr();var m=xx.redAdd(xx).redIAdd(xx);var mm=m.redSqr();var e=this.x.redAdd(yy).redSqr().redISub(xx).redISub(yyyy);e=e.redIAdd(e);e=e.redAdd(e).redIAdd(e);e=e.redISub(mm);var ee=e.redSqr();var t=yyyy.redIAdd(yyyy);t=t.redIAdd(t);t=t.redIAdd(t);t=t.redIAdd(t);var u=m.redIAdd(e).redSqr().redISub(mm).redISub(ee).redISub(t);var yyu4=yy.redMul(u);yyu4=yyu4.redIAdd(yyu4);yyu4=yyu4.redIAdd(yyu4);var nx=this.x.redMul(ee).redISub(yyu4);nx=nx.redIAdd(nx);nx=nx.redIAdd(nx);var ny=this.y.redMul(u.redMul(t.redISub(u)).redISub(e.redMul(ee)));ny=ny.redIAdd(ny);ny=ny.redIAdd(ny);ny=ny.redIAdd(ny);var nz=this.z.redAdd(e).redSqr().redISub(zz).redISub(ee);return this.curve.jpoint(nx,ny,nz)};JPoint.prototype.mul=function mul(k,kbase){k=new BN(k,kbase);return this.curve._wnafMul(this,k)};JPoint.prototype.eq=function eq(p){if(p.type==="affine")return this.eq(p.toJ());if(this===p)return true;var z2=this.z.redSqr();var pz2=p.z.redSqr();if(this.x.redMul(pz2).redISub(p.x.redMul(z2)).cmpn(0)!==0)return false;var z3=z2.redMul(this.z);var pz3=pz2.redMul(p.z);return this.y.redMul(pz3).redISub(p.y.redMul(z3)).cmpn(0)===0};JPoint.prototype.eqXToP=function eqXToP(x){var zs=this.z.redSqr();var rx=x.toRed(this.curve.red).redMul(zs);if(this.x.cmp(rx)===0)return true;var xc=x.clone();var t=this.curve.redN.redMul(zs);for(;;){xc.iadd(this.curve.n);if(xc.cmp(this.curve.p)>=0)return false;rx.redIAdd(t);if(this.x.cmp(rx)===0)return true}};JPoint.prototype.inspect=function inspect(){if(this.isInfinity())return"<EC JPoint Infinity>";return"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};JPoint.prototype.isInfinity=function isInfinity(){return this.z.cmpn(0)===0}},{"../utils":176,"./base":163,"bn.js":177,inherits:233}],168:[function(require,module,exports){"use strict";var curves=exports;var hash=require("hash.js");var curve=require("./curve");var utils=require("./utils");var assert=utils.assert;function PresetCurve(options){if(options.type==="short")this.curve=new curve.short(options);else if(options.type==="edwards")this.curve=new curve.edwards(options);else this.curve=new curve.mont(options);this.g=this.curve.g;this.n=this.curve.n;this.hash=options.hash;assert(this.g.validate(),"Invalid curve");assert(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}curves.PresetCurve=PresetCurve;function defineCurve(name,options){Object.defineProperty(curves,name,{configurable:true,enumerable:true,get:function(){var curve=new PresetCurve(options);Object.defineProperty(curves,name,{configurable:true,enumerable:true,value:curve});return curve}})}defineCurve("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:hash.sha256,gRed:false,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});defineCurve("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:hash.sha256,gRed:false,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});defineCurve("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:hash.sha256,gRed:false,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});defineCurve("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff "+"fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff "+"fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f "+"5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 "+"f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:hash.sha384,gRed:false,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 "+"5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 "+"0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});defineCurve("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b "+"99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd "+"3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff "+"ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 "+"f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:hash.sha512,gRed:false,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 "+"053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 "+"a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 "+"579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 "+"3fad0761 353c7086 a272c240 88be9476 9fd16650"]});defineCurve("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash.sha256,gRed:false,g:["9"]});defineCurve("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:hash.sha256,gRed:false,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var pre;try{pre=require("./precomputed/secp256k1")}catch(e){pre=undefined}defineCurve("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:hash.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:false,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",pre]})},{"./curve":165,"./precomputed/secp256k1":175,"./utils":176,"hash.js":215}],169:[function(require,module,exports){"use strict";var BN=require("bn.js");var HmacDRBG=require("hmac-drbg");var utils=require("../utils");var curves=require("../curves");var rand=require("brorand");var assert=utils.assert;var KeyPair=require("./key");var Signature=require("./signature");function EC(options){if(!(this instanceof EC))return new EC(options);if(typeof options==="string"){assert(Object.prototype.hasOwnProperty.call(curves,options),"Unknown curve "+options);options=curves[options]}if(options instanceof curves.PresetCurve)options={curve:options};this.curve=options.curve.curve;this.n=this.curve.n;this.nh=this.n.ushrn(1);this.g=this.curve.g;this.g=options.curve.g;this.g.precompute(options.curve.n.bitLength()+1);this.hash=options.hash||options.curve.hash}module.exports=EC;EC.prototype.keyPair=function keyPair(options){return new KeyPair(this,options)};EC.prototype.keyFromPrivate=function keyFromPrivate(priv,enc){return KeyPair.fromPrivate(this,priv,enc)};EC.prototype.keyFromPublic=function keyFromPublic(pub,enc){return KeyPair.fromPublic(this,pub,enc)};EC.prototype.genKeyPair=function genKeyPair(options){if(!options)options={};var drbg=new HmacDRBG({hash:this.hash,pers:options.pers,persEnc:options.persEnc||"utf8",entropy:options.entropy||rand(this.hash.hmacStrength),entropyEnc:options.entropy&&options.entropyEnc||"utf8",nonce:this.n.toArray()});var bytes=this.n.byteLength();var ns2=this.n.sub(new BN(2));for(;;){var priv=new BN(drbg.generate(bytes));if(priv.cmp(ns2)>0)continue;priv.iaddn(1);return this.keyFromPrivate(priv)}};EC.prototype._truncateToN=function _truncateToN(msg,truncOnly){var delta=msg.byteLength()*8-this.n.bitLength();if(delta>0)msg=msg.ushrn(delta);if(!truncOnly&&msg.cmp(this.n)>=0)return msg.sub(this.n);else return msg};EC.prototype.sign=function sign(msg,key,enc,options){if(typeof enc==="object"){options=enc;enc=null}if(!options)options={};key=this.keyFromPrivate(key,enc);msg=this._truncateToN(new BN(msg,16));var bytes=this.n.byteLength();var bkey=key.getPrivate().toArray("be",bytes);var nonce=msg.toArray("be",bytes);var drbg=new HmacDRBG({hash:this.hash,entropy:bkey,nonce:nonce,pers:options.pers,persEnc:options.persEnc||"utf8"});var ns1=this.n.sub(new BN(1));for(var iter=0;;iter++){var k=options.k?options.k(iter):new BN(drbg.generate(this.n.byteLength()));k=this._truncateToN(k,true);if(k.cmpn(1)<=0||k.cmp(ns1)>=0)continue;var kp=this.g.mul(k);if(kp.isInfinity())continue;var kpX=kp.getX();var r=kpX.umod(this.n);if(r.cmpn(0)===0)continue;var s=k.invm(this.n).mul(r.mul(key.getPrivate()).iadd(msg));s=s.umod(this.n);if(s.cmpn(0)===0)continue;var recoveryParam=(kp.getY().isOdd()?1:0)|(kpX.cmp(r)!==0?2:0);if(options.canonical&&s.cmp(this.nh)>0){s=this.n.sub(s);recoveryParam^=1}return new Signature({r:r,s:s,recoveryParam:recoveryParam})}};EC.prototype.verify=function verify(msg,signature,key,enc){msg=this._truncateToN(new BN(msg,16));key=this.keyFromPublic(key,enc);signature=new Signature(signature,"hex");var r=signature.r;var s=signature.s;if(r.cmpn(1)<0||r.cmp(this.n)>=0)return false;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return false;var sinv=s.invm(this.n);var u1=sinv.mul(msg).umod(this.n);var u2=sinv.mul(r).umod(this.n);var p;if(!this.curve._maxwellTrick){p=this.g.mulAdd(u1,key.getPublic(),u2);if(p.isInfinity())return false;return p.getX().umod(this.n).cmp(r)===0}p=this.g.jmulAdd(u1,key.getPublic(),u2);if(p.isInfinity())return false;return p.eqXToP(r)};EC.prototype.recoverPubKey=function(msg,signature,j,enc){assert((3&j)===j,"The recovery param is more than two bits");signature=new Signature(signature,enc);var n=this.n;var e=new BN(msg);var r=signature.r;var s=signature.s;var isYOdd=j&1;var isSecondKey=j>>1;if(r.cmp(this.curve.p.umod(this.curve.n))>=0&&isSecondKey)throw new Error("Unable to find sencond key candinate");if(isSecondKey)r=this.curve.pointFromX(r.add(this.curve.n),isYOdd);else r=this.curve.pointFromX(r,isYOdd);var rInv=signature.r.invm(n);var s1=n.sub(e).mul(rInv).umod(n);var s2=s.mul(rInv).umod(n);return this.g.mulAdd(s1,r,s2)};EC.prototype.getKeyRecoveryParam=function(e,signature,Q,enc){signature=new Signature(signature,enc);if(signature.recoveryParam!==null)return signature.recoveryParam;for(var i=0;i<4;i++){var Qprime;try{Qprime=this.recoverPubKey(e,signature,i)}catch(e){continue}if(Qprime.eq(Q))return i}throw new Error("Unable to find valid recovery factor")}},{"../curves":168,"../utils":176,"./key":170,"./signature":171,"bn.js":177,brorand:42,"hmac-drbg":228}],170:[function(require,module,exports){"use strict";var BN=require("bn.js");var utils=require("../utils");var assert=utils.assert;function KeyPair(ec,options){this.ec=ec;this.priv=null;this.pub=null;if(options.priv)this._importPrivate(options.priv,options.privEnc);if(options.pub)this._importPublic(options.pub,options.pubEnc)}module.exports=KeyPair;KeyPair.fromPublic=function fromPublic(ec,pub,enc){if(pub instanceof KeyPair)return pub;return new KeyPair(ec,{pub:pub,pubEnc:enc})};KeyPair.fromPrivate=function fromPrivate(ec,priv,enc){if(priv instanceof KeyPair)return priv;return new KeyPair(ec,{priv:priv,privEnc:enc})};KeyPair.prototype.validate=function validate(){var pub=this.getPublic();if(pub.isInfinity())return{result:false,reason:"Invalid public key"};if(!pub.validate())return{result:false,reason:"Public key is not a point"};if(!pub.mul(this.ec.curve.n).isInfinity())return{result:false,reason:"Public key * N != O"};return{result:true,reason:null}};KeyPair.prototype.getPublic=function getPublic(compact,enc){if(typeof compact==="string"){enc=compact;compact=null}if(!this.pub)this.pub=this.ec.g.mul(this.priv);if(!enc)return this.pub;return this.pub.encode(enc,compact)};KeyPair.prototype.getPrivate=function getPrivate(enc){if(enc==="hex")return this.priv.toString(16,2);else return this.priv};KeyPair.prototype._importPrivate=function _importPrivate(key,enc){this.priv=new BN(key,enc||16);this.priv=this.priv.umod(this.ec.curve.n)};KeyPair.prototype._importPublic=function _importPublic(key,enc){if(key.x||key.y){if(this.ec.curve.type==="mont"){assert(key.x,"Need x coordinate")}else if(this.ec.curve.type==="short"||this.ec.curve.type==="edwards"){assert(key.x&&key.y,"Need both x and y coordinate")}this.pub=this.ec.curve.point(key.x,key.y);return}this.pub=this.ec.curve.decodePoint(key,enc)};KeyPair.prototype.derive=function derive(pub){if(!pub.validate()){assert(pub.validate(),"public point not validated")}return pub.mul(this.priv).getX()};KeyPair.prototype.sign=function sign(msg,enc,options){return this.ec.sign(msg,this,enc,options)};KeyPair.prototype.verify=function verify(msg,signature){return this.ec.verify(msg,signature,this)};KeyPair.prototype.inspect=function inspect(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":176,"bn.js":177}],171:[function(require,module,exports){"use strict";var BN=require("bn.js");var utils=require("../utils");var assert=utils.assert;function Signature(options,enc){if(options instanceof Signature)return options;if(this._importDER(options,enc))return;assert(options.r&&options.s,"Signature without r or s");this.r=new BN(options.r,16);this.s=new BN(options.s,16);if(options.recoveryParam===undefined)this.recoveryParam=null;else this.recoveryParam=options.recoveryParam}module.exports=Signature;function Position(){this.place=0}function getLength(buf,p){var initial=buf[p.place++];if(!(initial&128)){return initial}var octetLen=initial&15;if(octetLen===0||octetLen>4){return false}var val=0;for(var i=0,off=p.place;i<octetLen;i++,off++){val<<=8;val|=buf[off];val>>>=0}if(val<=127){return false}p.place=off;return val}function rmPadding(buf){var i=0;var len=buf.length-1;while(!buf[i]&&!(buf[i+1]&128)&&i<len){i++}if(i===0){return buf}return buf.slice(i)}Signature.prototype._importDER=function _importDER(data,enc){data=utils.toArray(data,enc);var p=new Position;if(data[p.place++]!==48){return false}var len=getLength(data,p);if(len===false){return false}if(len+p.place!==data.length){return false}if(data[p.place++]!==2){return false}var rlen=getLength(data,p);if(rlen===false){return false}var r=data.slice(p.place,rlen+p.place);p.place+=rlen;if(data[p.place++]!==2){return false}var slen=getLength(data,p);if(slen===false){return false}if(data.length!==slen+p.place){return false}var s=data.slice(p.place,slen+p.place);if(r[0]===0){if(r[1]&128){r=r.slice(1)}else{return false}}if(s[0]===0){if(s[1]&128){s=s.slice(1)}else{return false}}this.r=new BN(r);this.s=new BN(s);this.recoveryParam=null;return true};function constructLength(arr,len){if(len<128){arr.push(len);return}var octets=1+(Math.log(len)/Math.LN2>>>3);arr.push(octets|128);while(--octets){arr.push(len>>>(octets<<3)&255)}arr.push(len)}Signature.prototype.toDER=function toDER(enc){var r=this.r.toArray();var s=this.s.toArray();if(r[0]&128)r=[0].concat(r);if(s[0]&128)s=[0].concat(s);r=rmPadding(r);s=rmPadding(s);while(!s[0]&&!(s[1]&128)){s=s.slice(1)}var arr=[2];constructLength(arr,r.length);arr=arr.concat(r);arr.push(2);constructLength(arr,s.length);var backHalf=arr.concat(s);var res=[48];constructLength(res,backHalf.length);res=res.concat(backHalf);return utils.encode(res,enc)}},{"../utils":176,"bn.js":177}],172:[function(require,module,exports){"use strict";var hash=require("hash.js");var curves=require("../curves");var utils=require("../utils");var assert=utils.assert;var parseBytes=utils.parseBytes;var KeyPair=require("./key");var Signature=require("./signature");function EDDSA(curve){assert(curve==="ed25519","only tested with ed25519 so far");if(!(this instanceof EDDSA))return new EDDSA(curve);curve=curves[curve].curve;this.curve=curve;this.g=curve.g;this.g.precompute(curve.n.bitLength()+1);this.pointClass=curve.point().constructor;this.encodingLength=Math.ceil(curve.n.bitLength()/8);this.hash=hash.sha512}module.exports=EDDSA;EDDSA.prototype.sign=function sign(message,secret){message=parseBytes(message);var key=this.keyFromSecret(secret);var r=this.hashInt(key.messagePrefix(),message);var R=this.g.mul(r);var Rencoded=this.encodePoint(R);var s_=this.hashInt(Rencoded,key.pubBytes(),message).mul(key.priv());var S=r.add(s_).umod(this.curve.n);return this.makeSignature({R:R,S:S,Rencoded:Rencoded})};EDDSA.prototype.verify=function verify(message,sig,pub){message=parseBytes(message);sig=this.makeSignature(sig);var key=this.keyFromPublic(pub);var h=this.hashInt(sig.Rencoded(),key.pubBytes(),message);var SG=this.g.mul(sig.S());var RplusAh=sig.R().add(key.pub().mul(h));return RplusAh.eq(SG)};EDDSA.prototype.hashInt=function hashInt(){var hash=this.hash();for(var i=0;i<arguments.length;i++)hash.update(arguments[i]);return utils.intFromLE(hash.digest()).umod(this.curve.n)};EDDSA.prototype.keyFromPublic=function keyFromPublic(pub){return KeyPair.fromPublic(this,pub)};EDDSA.prototype.keyFromSecret=function keyFromSecret(secret){return KeyPair.fromSecret(this,secret)};EDDSA.prototype.makeSignature=function makeSignature(sig){if(sig instanceof Signature)return sig;return new Signature(this,sig)};EDDSA.prototype.encodePoint=function encodePoint(point){var enc=point.getY().toArray("le",this.encodingLength);enc[this.encodingLength-1]|=point.getX().isOdd()?128:0;return enc};EDDSA.prototype.decodePoint=function decodePoint(bytes){bytes=utils.parseBytes(bytes);var lastIx=bytes.length-1;var normed=bytes.slice(0,lastIx).concat(bytes[lastIx]&~128);var xIsOdd=(bytes[lastIx]&128)!==0;var y=utils.intFromLE(normed);return this.curve.pointFromY(y,xIsOdd)};EDDSA.prototype.encodeInt=function encodeInt(num){return num.toArray("le",this.encodingLength)};EDDSA.prototype.decodeInt=function decodeInt(bytes){return utils.intFromLE(bytes)};EDDSA.prototype.isPoint=function isPoint(val){return val instanceof this.pointClass}},{"../curves":168,"../utils":176,"./key":173,"./signature":174,"hash.js":215}],173:[function(require,module,exports){"use strict";var utils=require("../utils");var assert=utils.assert;var parseBytes=utils.parseBytes;var cachedProperty=utils.cachedProperty;function KeyPair(eddsa,params){this.eddsa=eddsa;this._secret=parseBytes(params.secret);if(eddsa.isPoint(params.pub))this._pub=params.pub;else this._pubBytes=parseBytes(params.pub)}KeyPair.fromPublic=function fromPublic(eddsa,pub){if(pub instanceof KeyPair)return pub;return new KeyPair(eddsa,{pub:pub})};KeyPair.fromSecret=function fromSecret(eddsa,secret){if(secret instanceof KeyPair)return secret;return new KeyPair(eddsa,{secret:secret})};KeyPair.prototype.secret=function secret(){return this._secret};cachedProperty(KeyPair,"pubBytes",(function pubBytes(){return this.eddsa.encodePoint(this.pub())}));cachedProperty(KeyPair,"pub",(function pub(){if(this._pubBytes)return this.eddsa.decodePoint(this._pubBytes);return this.eddsa.g.mul(this.priv())}));cachedProperty(KeyPair,"privBytes",(function privBytes(){var eddsa=this.eddsa;var hash=this.hash();var lastIx=eddsa.encodingLength-1;var a=hash.slice(0,eddsa.encodingLength);a[0]&=248;a[lastIx]&=127;a[lastIx]|=64;return a}));cachedProperty(KeyPair,"priv",(function priv(){return this.eddsa.decodeInt(this.privBytes())}));cachedProperty(KeyPair,"hash",(function hash(){return this.eddsa.hash().update(this.secret()).digest()}));cachedProperty(KeyPair,"messagePrefix",(function messagePrefix(){return this.hash().slice(this.eddsa.encodingLength)}));KeyPair.prototype.sign=function sign(message){assert(this._secret,"KeyPair can only verify");return this.eddsa.sign(message,this)};KeyPair.prototype.verify=function verify(message,sig){return this.eddsa.verify(message,sig,this)};KeyPair.prototype.getSecret=function getSecret(enc){assert(this._secret,"KeyPair is public only");return utils.encode(this.secret(),enc)};KeyPair.prototype.getPublic=function getPublic(enc){return utils.encode(this.pubBytes(),enc)};module.exports=KeyPair},{"../utils":176}],174:[function(require,module,exports){"use strict";var BN=require("bn.js");var utils=require("../utils");var assert=utils.assert;var cachedProperty=utils.cachedProperty;var parseBytes=utils.parseBytes;function Signature(eddsa,sig){this.eddsa=eddsa;if(typeof sig!=="object")sig=parseBytes(sig);if(Array.isArray(sig)){sig={R:sig.slice(0,eddsa.encodingLength),S:sig.slice(eddsa.encodingLength)}}assert(sig.R&&sig.S,"Signature without R or S");if(eddsa.isPoint(sig.R))this._R=sig.R;if(sig.S instanceof BN)this._S=sig.S;this._Rencoded=Array.isArray(sig.R)?sig.R:sig.Rencoded;this._Sencoded=Array.isArray(sig.S)?sig.S:sig.Sencoded}cachedProperty(Signature,"S",(function S(){return this.eddsa.decodeInt(this.Sencoded())}));cachedProperty(Signature,"R",(function R(){return this.eddsa.decodePoint(this.Rencoded())}));cachedProperty(Signature,"Rencoded",(function Rencoded(){return this.eddsa.encodePoint(this.R())}));cachedProperty(Signature,"Sencoded",(function Sencoded(){return this.eddsa.encodeInt(this.S())}));Signature.prototype.toBytes=function toBytes(){return this.Rencoded().concat(this.Sencoded())};Signature.prototype.toHex=function toHex(){return utils.encode(this.toBytes(),"hex").toUpperCase()};module.exports=Signature},{"../utils":176,"bn.js":177}],175:[function(require,module,exports){module.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],176:[function(require,module,exports){"use strict";var utils=exports;var BN=require("bn.js");var minAssert=require("minimalistic-assert");var minUtils=require("minimalistic-crypto-utils");utils.assert=minAssert;utils.toArray=minUtils.toArray;utils.zero2=minUtils.zero2;utils.toHex=minUtils.toHex;utils.encode=minUtils.encode;function getNAF(num,w,bits){var naf=new Array(Math.max(num.bitLength(),bits)+1);naf.fill(0);var ws=1<<w+1;var k=num.clone();for(var i=0;i<naf.length;i++){var z;var mod=k.andln(ws-1);if(k.isOdd()){if(mod>(ws>>1)-1)z=(ws>>1)-mod;else z=mod;k.isubn(z)}else{z=0}naf[i]=z;k.iushrn(1)}return naf}utils.getNAF=getNAF;function getJSF(k1,k2){var jsf=[[],[]];k1=k1.clone();k2=k2.clone();var d1=0;var d2=0;var m8;while(k1.cmpn(-d1)>0||k2.cmpn(-d2)>0){var m14=k1.andln(3)+d1&3;var m24=k2.andln(3)+d2&3;if(m14===3)m14=-1;if(m24===3)m24=-1;var u1;if((m14&1)===0){u1=0}else{m8=k1.andln(7)+d1&7;if((m8===3||m8===5)&&m24===2)u1=-m14;else u1=m14}jsf[0].push(u1);var u2;if((m24&1)===0){u2=0}else{m8=k2.andln(7)+d2&7;if((m8===3||m8===5)&&m14===2)u2=-m24;else u2=m24}jsf[1].push(u2);if(2*d1===u1+1)d1=1-d1;if(2*d2===u2+1)d2=1-d2;k1.iushrn(1);k2.iushrn(1)}return jsf}utils.getJSF=getJSF;function cachedProperty(obj,name,computer){var key="_"+name;obj.prototype[name]=function cachedProperty(){return this[key]!==undefined?this[key]:this[key]=computer.call(this)}}utils.cachedProperty=cachedProperty;function parseBytes(bytes){return typeof bytes==="string"?utils.toArray(bytes,"hex"):bytes}utils.parseBytes=parseBytes;function intFromLE(bytes){return new BN(bytes,"hex","le")}utils.intFromLE=intFromLE},{"bn.js":177,"minimalistic-assert":291,"minimalistic-crypto-utils":292}],177:[function(require,module,exports){arguments[4][34][0].apply(exports,arguments)},{buffer:88,dup:34}],178:[function(require,module,exports){module.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],179:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.decodeXML=exports.decodeHTMLStrict=exports.decodeHTMLAttribute=exports.decodeHTML=exports.determineBranch=exports.EntityDecoder=exports.DecodingMode=exports.BinTrieFlags=exports.fromCodePoint=exports.replaceCodePoint=exports.decodeCodePoint=exports.xmlDecodeTree=exports.htmlDecodeTree=void 0;var decode_data_html_js_1=__importDefault(require("./generated/decode-data-html.js"));exports.htmlDecodeTree=decode_data_html_js_1.default;var decode_data_xml_js_1=__importDefault(require("./generated/decode-data-xml.js"));exports.xmlDecodeTree=decode_data_xml_js_1.default;var decode_codepoint_js_1=__importStar(require("./decode_codepoint.js"));exports.decodeCodePoint=decode_codepoint_js_1.default;var decode_codepoint_js_2=require("./decode_codepoint.js");Object.defineProperty(exports,"replaceCodePoint",{enumerable:true,get:function(){return decode_codepoint_js_2.replaceCodePoint}});Object.defineProperty(exports,"fromCodePoint",{enumerable:true,get:function(){return decode_codepoint_js_2.fromCodePoint}});var CharCodes;(function(CharCodes){CharCodes[CharCodes["NUM"]=35]="NUM";CharCodes[CharCodes["SEMI"]=59]="SEMI";CharCodes[CharCodes["EQUALS"]=61]="EQUALS";CharCodes[CharCodes["ZERO"]=48]="ZERO";CharCodes[CharCodes["NINE"]=57]="NINE";CharCodes[CharCodes["LOWER_A"]=97]="LOWER_A";CharCodes[CharCodes["LOWER_F"]=102]="LOWER_F";CharCodes[CharCodes["LOWER_X"]=120]="LOWER_X";CharCodes[CharCodes["LOWER_Z"]=122]="LOWER_Z";CharCodes[CharCodes["UPPER_A"]=65]="UPPER_A";CharCodes[CharCodes["UPPER_F"]=70]="UPPER_F";CharCodes[CharCodes["UPPER_Z"]=90]="UPPER_Z"})(CharCodes||(CharCodes={}));var TO_LOWER_BIT=32;var BinTrieFlags;(function(BinTrieFlags){BinTrieFlags[BinTrieFlags["VALUE_LENGTH"]=49152]="VALUE_LENGTH";BinTrieFlags[BinTrieFlags["BRANCH_LENGTH"]=16256]="BRANCH_LENGTH";BinTrieFlags[BinTrieFlags["JUMP_TABLE"]=127]="JUMP_TABLE"})(BinTrieFlags=exports.BinTrieFlags||(exports.BinTrieFlags={}));function isNumber(code){return code>=CharCodes.ZERO&&code<=CharCodes.NINE}function isHexadecimalCharacter(code){return code>=CharCodes.UPPER_A&&code<=CharCodes.UPPER_F||code>=CharCodes.LOWER_A&&code<=CharCodes.LOWER_F}function isAsciiAlphaNumeric(code){return code>=CharCodes.UPPER_A&&code<=CharCodes.UPPER_Z||code>=CharCodes.LOWER_A&&code<=CharCodes.LOWER_Z||isNumber(code)}function isEntityInAttributeInvalidEnd(code){return code===CharCodes.EQUALS||isAsciiAlphaNumeric(code)}var EntityDecoderState;(function(EntityDecoderState){EntityDecoderState[EntityDecoderState["EntityStart"]=0]="EntityStart";EntityDecoderState[EntityDecoderState["NumericStart"]=1]="NumericStart";EntityDecoderState[EntityDecoderState["NumericDecimal"]=2]="NumericDecimal";EntityDecoderState[EntityDecoderState["NumericHex"]=3]="NumericHex";EntityDecoderState[EntityDecoderState["NamedEntity"]=4]="NamedEntity"})(EntityDecoderState||(EntityDecoderState={}));var DecodingMode;(function(DecodingMode){DecodingMode[DecodingMode["Legacy"]=0]="Legacy";DecodingMode[DecodingMode["Strict"]=1]="Strict";DecodingMode[DecodingMode["Attribute"]=2]="Attribute"})(DecodingMode=exports.DecodingMode||(exports.DecodingMode={}));var EntityDecoder=function(){function EntityDecoder(decodeTree,emitCodePoint,errors){this.decodeTree=decodeTree;this.emitCodePoint=emitCodePoint;this.errors=errors;this.state=EntityDecoderState.EntityStart;this.consumed=1;this.result=0;this.treeIndex=0;this.excess=1;this.decodeMode=DecodingMode.Strict}EntityDecoder.prototype.startEntity=function(decodeMode){this.decodeMode=decodeMode;this.state=EntityDecoderState.EntityStart;this.result=0;this.treeIndex=0;this.excess=1;this.consumed=1};EntityDecoder.prototype.write=function(str,offset){switch(this.state){case EntityDecoderState.EntityStart:{if(str.charCodeAt(offset)===CharCodes.NUM){this.state=EntityDecoderState.NumericStart;this.consumed+=1;return this.stateNumericStart(str,offset+1)}this.state=EntityDecoderState.NamedEntity;return this.stateNamedEntity(str,offset)}case EntityDecoderState.NumericStart:{return this.stateNumericStart(str,offset)}case EntityDecoderState.NumericDecimal:{return this.stateNumericDecimal(str,offset)}case EntityDecoderState.NumericHex:{return this.stateNumericHex(str,offset)}case EntityDecoderState.NamedEntity:{return this.stateNamedEntity(str,offset)}}};EntityDecoder.prototype.stateNumericStart=function(str,offset){if(offset>=str.length){return-1}if((str.charCodeAt(offset)|TO_LOWER_BIT)===CharCodes.LOWER_X){this.state=EntityDecoderState.NumericHex;this.consumed+=1;return this.stateNumericHex(str,offset+1)}this.state=EntityDecoderState.NumericDecimal;return this.stateNumericDecimal(str,offset)};EntityDecoder.prototype.addToNumericResult=function(str,start,end,base){if(start!==end){var digitCount=end-start;this.result=this.result*Math.pow(base,digitCount)+parseInt(str.substr(start,digitCount),base);this.consumed+=digitCount}};EntityDecoder.prototype.stateNumericHex=function(str,offset){var startIdx=offset;while(offset<str.length){var char=str.charCodeAt(offset);if(isNumber(char)||isHexadecimalCharacter(char)){offset+=1}else{this.addToNumericResult(str,startIdx,offset,16);return this.emitNumericEntity(char,3)}}this.addToNumericResult(str,startIdx,offset,16);return-1};EntityDecoder.prototype.stateNumericDecimal=function(str,offset){var startIdx=offset;while(offset<str.length){var char=str.charCodeAt(offset);if(isNumber(char)){offset+=1}else{this.addToNumericResult(str,startIdx,offset,10);return this.emitNumericEntity(char,2)}}this.addToNumericResult(str,startIdx,offset,10);return-1};EntityDecoder.prototype.emitNumericEntity=function(lastCp,expectedLength){var _a;if(this.consumed<=expectedLength){(_a=this.errors)===null||_a===void 0?void 0:_a.absenceOfDigitsInNumericCharacterReference(this.consumed);return 0}if(lastCp===CharCodes.SEMI){this.consumed+=1}else if(this.decodeMode===DecodingMode.Strict){return 0}this.emitCodePoint((0,decode_codepoint_js_1.replaceCodePoint)(this.result),this.consumed);if(this.errors){if(lastCp!==CharCodes.SEMI){this.errors.missingSemicolonAfterCharacterReference()}this.errors.validateNumericCharacterReference(this.result)}return this.consumed};EntityDecoder.prototype.stateNamedEntity=function(str,offset){var decodeTree=this.decodeTree;var current=decodeTree[this.treeIndex];var valueLength=(current&BinTrieFlags.VALUE_LENGTH)>>14;for(;offset<str.length;offset++,this.excess++){var char=str.charCodeAt(offset);this.treeIndex=determineBranch(decodeTree,current,this.treeIndex+Math.max(1,valueLength),char);if(this.treeIndex<0){return this.result===0||this.decodeMode===DecodingMode.Attribute&&(valueLength===0||isEntityInAttributeInvalidEnd(char))?0:this.emitNotTerminatedNamedEntity()}current=decodeTree[this.treeIndex];valueLength=(current&BinTrieFlags.VALUE_LENGTH)>>14;if(valueLength!==0){if(char===CharCodes.SEMI){return this.emitNamedEntityData(this.treeIndex,valueLength,this.consumed+this.excess)}if(this.decodeMode!==DecodingMode.Strict){this.result=this.treeIndex;this.consumed+=this.excess;this.excess=0}}}return-1};EntityDecoder.prototype.emitNotTerminatedNamedEntity=function(){var _a;var _b=this,result=_b.result,decodeTree=_b.decodeTree;var valueLength=(decodeTree[result]&BinTrieFlags.VALUE_LENGTH)>>14;this.emitNamedEntityData(result,valueLength,this.consumed);(_a=this.errors)===null||_a===void 0?void 0:_a.missingSemicolonAfterCharacterReference();return this.consumed};EntityDecoder.prototype.emitNamedEntityData=function(result,valueLength,consumed){var decodeTree=this.decodeTree;this.emitCodePoint(valueLength===1?decodeTree[result]&~BinTrieFlags.VALUE_LENGTH:decodeTree[result+1],consumed);if(valueLength===3){this.emitCodePoint(decodeTree[result+2],consumed)}return consumed};EntityDecoder.prototype.end=function(){var _a;switch(this.state){case EntityDecoderState.NamedEntity:{return this.result!==0&&(this.decodeMode!==DecodingMode.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0}case EntityDecoderState.NumericDecimal:{return this.emitNumericEntity(0,2)}case EntityDecoderState.NumericHex:{return this.emitNumericEntity(0,3)}case EntityDecoderState.NumericStart:{(_a=this.errors)===null||_a===void 0?void 0:_a.absenceOfDigitsInNumericCharacterReference(this.consumed);return 0}case EntityDecoderState.EntityStart:{return 0}}};return EntityDecoder}();exports.EntityDecoder=EntityDecoder;function getDecoder(decodeTree){var ret="";var decoder=new EntityDecoder(decodeTree,(function(str){return ret+=(0,decode_codepoint_js_1.fromCodePoint)(str)}));return function decodeWithTrie(str,decodeMode){var lastIndex=0;var offset=0;while((offset=str.indexOf("&",offset))>=0){ret+=str.slice(lastIndex,offset);decoder.startEntity(decodeMode);var len=decoder.write(str,offset+1);if(len<0){lastIndex=offset+decoder.end();break}lastIndex=offset+len;offset=len===0?lastIndex+1:lastIndex}var result=ret+str.slice(lastIndex);ret="";return result}}function determineBranch(decodeTree,current,nodeIdx,char){var branchCount=(current&BinTrieFlags.BRANCH_LENGTH)>>7;var jumpOffset=current&BinTrieFlags.JUMP_TABLE;if(branchCount===0){return jumpOffset!==0&&char===jumpOffset?nodeIdx:-1}if(jumpOffset){var value=char-jumpOffset;return value<0||value>=branchCount?-1:decodeTree[nodeIdx+value]-1}var lo=nodeIdx;var hi=lo+branchCount-1;while(lo<=hi){var mid=lo+hi>>>1;var midVal=decodeTree[mid];if(midVal<char){lo=mid+1}else if(midVal>char){hi=mid-1}else{return decodeTree[mid+branchCount]}}return-1}exports.determineBranch=determineBranch;var htmlDecoder=getDecoder(decode_data_html_js_1.default);var xmlDecoder=getDecoder(decode_data_xml_js_1.default);function decodeHTML(str,mode){if(mode===void 0){mode=DecodingMode.Legacy}return htmlDecoder(str,mode)}exports.decodeHTML=decodeHTML;function decodeHTMLAttribute(str){return htmlDecoder(str,DecodingMode.Attribute)}exports.decodeHTMLAttribute=decodeHTMLAttribute;function decodeHTMLStrict(str){return htmlDecoder(str,DecodingMode.Strict)}exports.decodeHTMLStrict=decodeHTMLStrict;function decodeXML(str){return xmlDecoder(str,DecodingMode.Strict)}exports.decodeXML=decodeXML},{"./decode_codepoint.js":180,"./generated/decode-data-html.js":183,"./generated/decode-data-xml.js":184}],180:[function(require,module,exports){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:true});exports.replaceCodePoint=exports.fromCodePoint=void 0;var decodeMap=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);exports.fromCodePoint=(_a=String.fromCodePoint)!==null&&_a!==void 0?_a:function(codePoint){var output="";if(codePoint>65535){codePoint-=65536;output+=String.fromCharCode(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}output+=String.fromCharCode(codePoint);return output};function replaceCodePoint(codePoint){var _a;if(codePoint>=55296&&codePoint<=57343||codePoint>1114111){return 65533}return(_a=decodeMap.get(codePoint))!==null&&_a!==void 0?_a:codePoint}exports.replaceCodePoint=replaceCodePoint;function decodeCodePoint(codePoint){return(0,exports.fromCodePoint)(replaceCodePoint(codePoint))}exports.default=decodeCodePoint},{}],181:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.encodeNonAsciiHTML=exports.encodeHTML=void 0;var encode_html_js_1=__importDefault(require("./generated/encode-html.js"));var escape_js_1=require("./escape.js");var htmlReplacer=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function encodeHTML(data){return encodeHTMLTrieRe(htmlReplacer,data)}exports.encodeHTML=encodeHTML;function encodeNonAsciiHTML(data){return encodeHTMLTrieRe(escape_js_1.xmlReplacer,data)}exports.encodeNonAsciiHTML=encodeNonAsciiHTML;function encodeHTMLTrieRe(regExp,str){var ret="";var lastIdx=0;var match;while((match=regExp.exec(str))!==null){var i=match.index;ret+=str.substring(lastIdx,i);var char=str.charCodeAt(i);var next=encode_html_js_1.default.get(char);if(typeof next==="object"){if(i+1<str.length){var nextChar=str.charCodeAt(i+1);var value=typeof next.n==="number"?next.n===nextChar?next.o:undefined:next.n.get(nextChar);if(value!==undefined){ret+=value;lastIdx=regExp.lastIndex+=1;continue}}next=next.v}if(next!==undefined){ret+=next;lastIdx=i+1}else{var cp=(0,escape_js_1.getCodePoint)(str,i);ret+="&#x".concat(cp.toString(16),";");lastIdx=regExp.lastIndex+=Number(cp!==char)}}return ret+str.substr(lastIdx)}},{"./escape.js":182,"./generated/encode-html.js":185}],182:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.escapeText=exports.escapeAttribute=exports.escapeUTF8=exports.escape=exports.encodeXML=exports.getCodePoint=exports.xmlReplacer=void 0;exports.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var xmlCodeMap=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);exports.getCodePoint=String.prototype.codePointAt!=null?function(str,index){return str.codePointAt(index)}:function(c,index){return(c.charCodeAt(index)&64512)===55296?(c.charCodeAt(index)-55296)*1024+c.charCodeAt(index+1)-56320+65536:c.charCodeAt(index)};function encodeXML(str){var ret="";var lastIdx=0;var match;while((match=exports.xmlReplacer.exec(str))!==null){var i=match.index;var char=str.charCodeAt(i);var next=xmlCodeMap.get(char);if(next!==undefined){ret+=str.substring(lastIdx,i)+next;lastIdx=i+1}else{ret+="".concat(str.substring(lastIdx,i),"&#x").concat((0,exports.getCodePoint)(str,i).toString(16),";");lastIdx=exports.xmlReplacer.lastIndex+=Number((char&64512)===55296)}}return ret+str.substr(lastIdx)}exports.encodeXML=encodeXML;exports.escape=encodeXML;function getEscaper(regex,map){return function escape(data){var match;var lastIdx=0;var result="";while(match=regex.exec(data)){if(lastIdx!==match.index){result+=data.substring(lastIdx,match.index)}result+=map.get(match[0].charCodeAt(0));lastIdx=match.index+1}return result+data.substring(lastIdx)}}exports.escapeUTF8=getEscaper(/[&<>'"]/g,xmlCodeMap);exports.escapeAttribute=getEscaper(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]]));exports.escapeText=getEscaper(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))},{}],183:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map((function(c){return c.charCodeAt(0)})))},{}],184:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=new Uint16Array("Ȁaglq\tɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map((function(c){return c.charCodeAt(0)})))},{}],185:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function restoreDiff(arr){for(var i=1;i<arr.length;i++){arr[i][0]+=arr[i-1][0]+1}return arr}exports.default=new Map(restoreDiff([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(restoreDiff([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(restoreDiff([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(restoreDiff([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]))},{}],186:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.decodeXMLStrict=exports.decodeHTML5Strict=exports.decodeHTML4Strict=exports.decodeHTML5=exports.decodeHTML4=exports.decodeHTMLAttribute=exports.decodeHTMLStrict=exports.decodeHTML=exports.decodeXML=exports.DecodingMode=exports.EntityDecoder=exports.encodeHTML5=exports.encodeHTML4=exports.encodeNonAsciiHTML=exports.encodeHTML=exports.escapeText=exports.escapeAttribute=exports.escapeUTF8=exports.escape=exports.encodeXML=exports.encode=exports.decodeStrict=exports.decode=exports.EncodingMode=exports.EntityLevel=void 0;var decode_js_1=require("./decode.js");var encode_js_1=require("./encode.js");var escape_js_1=require("./escape.js");var EntityLevel;(function(EntityLevel){EntityLevel[EntityLevel["XML"]=0]="XML";EntityLevel[EntityLevel["HTML"]=1]="HTML"})(EntityLevel=exports.EntityLevel||(exports.EntityLevel={}));var EncodingMode;(function(EncodingMode){EncodingMode[EncodingMode["UTF8"]=0]="UTF8";EncodingMode[EncodingMode["ASCII"]=1]="ASCII";EncodingMode[EncodingMode["Extensive"]=2]="Extensive";EncodingMode[EncodingMode["Attribute"]=3]="Attribute";EncodingMode[EncodingMode["Text"]=4]="Text"})(EncodingMode=exports.EncodingMode||(exports.EncodingMode={}));function decode(data,options){if(options===void 0){options=EntityLevel.XML}var level=typeof options==="number"?options:options.level;if(level===EntityLevel.HTML){var mode=typeof options==="object"?options.mode:undefined;return(0,decode_js_1.decodeHTML)(data,mode)}return(0,decode_js_1.decodeXML)(data)}exports.decode=decode;function decodeStrict(data,options){var _a;if(options===void 0){options=EntityLevel.XML}var opts=typeof options==="number"?{level:options}:options;(_a=opts.mode)!==null&&_a!==void 0?_a:opts.mode=decode_js_1.DecodingMode.Strict;return decode(data,opts)}exports.decodeStrict=decodeStrict;function encode(data,options){if(options===void 0){options=EntityLevel.XML}var opts=typeof options==="number"?{level:options}:options;if(opts.mode===EncodingMode.UTF8)return(0,escape_js_1.escapeUTF8)(data);if(opts.mode===EncodingMode.Attribute)return(0,escape_js_1.escapeAttribute)(data);if(opts.mode===EncodingMode.Text)return(0,escape_js_1.escapeText)(data);if(opts.level===EntityLevel.HTML){if(opts.mode===EncodingMode.ASCII){return(0,encode_js_1.encodeNonAsciiHTML)(data)}return(0,encode_js_1.encodeHTML)(data)}return(0,escape_js_1.encodeXML)(data)}exports.encode=encode;var escape_js_2=require("./escape.js");Object.defineProperty(exports,"encodeXML",{enumerable:true,get:function(){return escape_js_2.encodeXML}});Object.defineProperty(exports,"escape",{enumerable:true,get:function(){return escape_js_2.escape}});Object.defineProperty(exports,"escapeUTF8",{enumerable:true,get:function(){return escape_js_2.escapeUTF8}});Object.defineProperty(exports,"escapeAttribute",{enumerable:true,get:function(){return escape_js_2.escapeAttribute}});Object.defineProperty(exports,"escapeText",{enumerable:true,get:function(){return escape_js_2.escapeText}});var encode_js_2=require("./encode.js");Object.defineProperty(exports,"encodeHTML",{enumerable:true,get:function(){return encode_js_2.encodeHTML}});Object.defineProperty(exports,"encodeNonAsciiHTML",{enumerable:true,get:function(){return encode_js_2.encodeNonAsciiHTML}});Object.defineProperty(exports,"encodeHTML4",{enumerable:true,get:function(){return encode_js_2.encodeHTML}});Object.defineProperty(exports,"encodeHTML5",{enumerable:true,get:function(){return encode_js_2.encodeHTML}});var decode_js_2=require("./decode.js");Object.defineProperty(exports,"EntityDecoder",{enumerable:true,get:function(){return decode_js_2.EntityDecoder}});Object.defineProperty(exports,"DecodingMode",{enumerable:true,get:function(){return decode_js_2.DecodingMode}});Object.defineProperty(exports,"decodeXML",{enumerable:true,get:function(){return decode_js_2.decodeXML}});Object.defineProperty(exports,"decodeHTML",{enumerable:true,get:function(){return decode_js_2.decodeHTML}});Object.defineProperty(exports,"decodeHTMLStrict",{enumerable:true,get:function(){return decode_js_2.decodeHTMLStrict}});Object.defineProperty(exports,"decodeHTMLAttribute",{enumerable:true,get:function(){return decode_js_2.decodeHTMLAttribute}});Object.defineProperty(exports,"decodeHTML4",{enumerable:true,get:function(){return decode_js_2.decodeHTML}});Object.defineProperty(exports,"decodeHTML5",{enumerable:true,get:function(){return decode_js_2.decodeHTML}});Object.defineProperty(exports,"decodeHTML4Strict",{enumerable:true,get:function(){return decode_js_2.decodeHTMLStrict}});Object.defineProperty(exports,"decodeHTML5Strict",{enumerable:true,get:function(){return decode_js_2.decodeHTMLStrict}});Object.defineProperty(exports,"decodeXMLStrict",{enumerable:true,get:function(){return decode_js_2.decodeXML}})},{"./decode.js":179,"./encode.js":181,"./escape.js":182}],187:[function(require,module,exports){"use strict";var R=typeof Reflect==="object"?Reflect:null;var ReflectApply=R&&typeof R.apply==="function"?R.apply:function ReflectApply(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)};var ReflectOwnKeys;if(R&&typeof R.ownKeys==="function"){ReflectOwnKeys=R.ownKeys}else if(Object.getOwnPropertySymbols){ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}}else{ReflectOwnKeys=function ReflectOwnKeys(target){return Object.getOwnPropertyNames(target)}}function ProcessEmitWarning(warning){if(console&&console.warn)console.warn(warning)}var NumberIsNaN=Number.isNaN||function NumberIsNaN(value){return value!==value};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter;module.exports.once=once;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._eventsCount=0;EventEmitter.prototype._maxListeners=undefined;var defaultMaxListeners=10;function checkListener(listener){if(typeof listener!=="function"){throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:true,get:function(){return defaultMaxListeners},set:function(arg){if(typeof arg!=="number"||arg<0||NumberIsNaN(arg)){throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+".")}defaultMaxListeners=arg}});EventEmitter.init=function(){if(this._events===undefined||this._events===Object.getPrototypeOf(this)._events){this._events=Object.create(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined};EventEmitter.prototype.setMaxListeners=function setMaxListeners(n){if(typeof n!=="number"||n<0||NumberIsNaN(n)){throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".")}this._maxListeners=n;return this};function _getMaxListeners(that){if(that._maxListeners===undefined)return EventEmitter.defaultMaxListeners;return that._maxListeners}EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return _getMaxListeners(this)};EventEmitter.prototype.emit=function emit(type){var args=[];for(var i=1;i<arguments.length;i++)args.push(arguments[i]);var doError=type==="error";var events=this._events;if(events!==undefined)doError=doError&&events.error===undefined;else if(!doError)return false;if(doError){var er;if(args.length>0)er=args[0];if(er instanceof Error){throw er}var err=new Error("Unhandled error."+(er?" ("+er.message+")":""));err.context=er;throw err}var handler=events[type];if(handler===undefined)return false;if(typeof handler==="function"){ReflectApply(handler,this,args)}else{var len=handler.length;var listeners=arrayClone(handler,len);for(var i=0;i<len;++i)ReflectApply(listeners[i],this,args)}return true};function _addListener(target,type,listener,prepend){var m;var events;var existing;checkListener(listener);events=target._events;if(events===undefined){events=target._events=Object.create(null);target._eventsCount=0}else{if(events.newListener!==undefined){target.emit("newListener",type,listener.listener?listener.listener:listener);events=target._events}existing=events[type]}if(existing===undefined){existing=events[type]=listener;++target._eventsCount}else{if(typeof existing==="function"){existing=events[type]=prepend?[listener,existing]:[existing,listener]}else if(prepend){existing.unshift(listener)}else{existing.push(listener)}m=_getMaxListeners(target);if(m>0&&existing.length>m&&!existing.warned){existing.warned=true;var w=new Error("Possible EventEmitter memory leak detected. "+existing.length+" "+String(type)+" listeners "+"added. Use emitter.setMaxListeners() to "+"increase limit");w.name="MaxListenersExceededWarning";w.emitter=target;w.type=type;w.count=existing.length;ProcessEmitWarning(w)}}return target}EventEmitter.prototype.addListener=function addListener(type,listener){return _addListener(this,type,listener,false)};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.prependListener=function prependListener(type,listener){return _addListener(this,type,listener,true)};function onceWrapper(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;if(arguments.length===0)return this.listener.call(this.target);return this.listener.apply(this.target,arguments)}}function _onceWrap(target,type,listener){var state={fired:false,wrapFn:undefined,target:target,type:type,listener:listener};var wrapped=onceWrapper.bind(state);wrapped.listener=listener;state.wrapFn=wrapped;return wrapped}EventEmitter.prototype.once=function once(type,listener){checkListener(listener);this.on(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.prependOnceListener=function prependOnceListener(type,listener){checkListener(listener);this.prependListener(type,_onceWrap(this,type,listener));return this};EventEmitter.prototype.removeListener=function removeListener(type,listener){var list,events,position,i,originalListener;checkListener(listener);events=this._events;if(events===undefined)return this;list=events[type];if(list===undefined)return this;if(list===listener||list.listener===listener){if(--this._eventsCount===0)this._events=Object.create(null);else{delete events[type];if(events.removeListener)this.emit("removeListener",type,list.listener||listener)}}else if(typeof list!=="function"){position=-1;for(i=list.length-1;i>=0;i--){if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener;position=i;break}}if(position<0)return this;if(position===0)list.shift();else{spliceOne(list,position)}if(list.length===1)events[type]=list[0];if(events.removeListener!==undefined)this.emit("removeListener",type,originalListener||listener)}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.removeAllListeners=function removeAllListeners(type){var listeners,events,i;events=this._events;if(events===undefined)return this;if(events.removeListener===undefined){if(arguments.length===0){this._events=Object.create(null);this._eventsCount=0}else if(events[type]!==undefined){if(--this._eventsCount===0)this._events=Object.create(null);else delete events[type]}return this}if(arguments.length===0){var keys=Object.keys(events);var key;for(i=0;i<keys.length;++i){key=keys[i];if(key==="removeListener")continue;this.removeAllListeners(key)}this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}listeners=events[type];if(typeof listeners==="function"){this.removeListener(type,listeners)}else if(listeners!==undefined){for(i=listeners.length-1;i>=0;i--){this.removeListener(type,listeners[i])}}return this};function _listeners(target,type,unwrap){var events=target._events;if(events===undefined)return[];var evlistener=events[type];if(evlistener===undefined)return[];if(typeof evlistener==="function")return unwrap?[evlistener.listener||evlistener]:[evlistener];return unwrap?unwrapListeners(evlistener):arrayClone(evlistener,evlistener.length)}EventEmitter.prototype.listeners=function listeners(type){return _listeners(this,type,true)};EventEmitter.prototype.rawListeners=function rawListeners(type){return _listeners(this,type,false)};EventEmitter.listenerCount=function(emitter,type){if(typeof emitter.listenerCount==="function"){return emitter.listenerCount(type)}else{return listenerCount.call(emitter,type)}};EventEmitter.prototype.listenerCount=listenerCount;function listenerCount(type){var events=this._events;if(events!==undefined){var evlistener=events[type];if(typeof evlistener==="function"){return 1}else if(evlistener!==undefined){return evlistener.length}}return 0}EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(arr,n){var copy=new Array(n);for(var i=0;i<n;++i)copy[i]=arr[i];return copy}function spliceOne(list,index){for(;index+1<list.length;index++)list[index]=list[index+1];list.pop()}function unwrapListeners(arr){var ret=new Array(arr.length);for(var i=0;i<ret.length;++i){ret[i]=arr[i].listener||arr[i]}return ret}function once(emitter,name){return new Promise((function(resolve,reject){function errorListener(err){emitter.removeListener(name,resolver);reject(err)}function resolver(){if(typeof emitter.removeListener==="function"){emitter.removeListener("error",errorListener)}resolve([].slice.call(arguments))}eventTargetAgnosticAddListener(emitter,name,resolver,{once:true});if(name!=="error"){addErrorHandlerIfEventEmitter(emitter,errorListener,{once:true})}}))}function addErrorHandlerIfEventEmitter(emitter,handler,flags){if(typeof emitter.on==="function"){eventTargetAgnosticAddListener(emitter,"error",handler,flags)}}function eventTargetAgnosticAddListener(emitter,name,listener,flags){if(typeof emitter.on==="function"){if(flags.once){emitter.once(name,listener)}else{emitter.on(name,listener)}}else if(typeof emitter.addEventListener==="function"){emitter.addEventListener(name,(function wrapListener(arg){if(flags.once){emitter.removeEventListener(name,wrapListener)}listener(arg)}))}else{throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof emitter)}}},{}],188:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;var MD5=require("md5.js");function EVP_BytesToKey(password,salt,keyBits,ivLen){if(!Buffer.isBuffer(password))password=Buffer.from(password,"binary");if(salt){if(!Buffer.isBuffer(salt))salt=Buffer.from(salt,"binary");if(salt.length!==8)throw new RangeError("salt should be Buffer with 8 byte length")}var keyLen=keyBits/8;var key=Buffer.alloc(keyLen);var iv=Buffer.alloc(ivLen||0);var tmp=Buffer.alloc(0);while(keyLen>0||ivLen>0){var hash=new MD5;hash.update(tmp);hash.update(password);if(salt)hash.update(salt);tmp=hash.digest();var used=0;if(keyLen>0){var keyStart=key.length-keyLen;used=Math.min(keyLen,tmp.length);tmp.copy(key,keyStart,0,used);keyLen-=used}if(used<tmp.length&&ivLen>0){var ivStart=iv.length-ivLen;var length=Math.min(ivLen,tmp.length-used);tmp.copy(iv,ivStart,used,used+length);ivLen-=length}}tmp.fill(0);return{key:key,iv:iv}}module.exports=EVP_BytesToKey},{"md5.js":283,"safe-buffer":385}],189:[function(require,module,exports){"use strict";var isCallable=require("is-callable");var toStr=Object.prototype.toString;var hasOwnProperty=Object.prototype.hasOwnProperty;var forEachArray=function forEachArray(array,iterator,receiver){for(var i=0,len=array.length;i<len;i++){if(hasOwnProperty.call(array,i)){if(receiver==null){iterator(array[i],i,array)}else{iterator.call(receiver,array[i],i,array)}}}};var forEachString=function forEachString(string,iterator,receiver){for(var i=0,len=string.length;i<len;i++){if(receiver==null){iterator(string.charAt(i),i,string)}else{iterator.call(receiver,string.charAt(i),i,string)}}};var forEachObject=function forEachObject(object,iterator,receiver){for(var k in object){if(hasOwnProperty.call(object,k)){if(receiver==null){iterator(object[k],k,object)}else{iterator.call(receiver,object[k],k,object)}}}};var forEach=function forEach(list,iterator,thisArg){if(!isCallable(iterator)){throw new TypeError("iterator must be a function")}var receiver;if(arguments.length>=3){receiver=thisArg}if(toStr.call(list)==="[object Array]"){forEachArray(list,iterator,receiver)}else if(typeof list==="string"){forEachString(list,iterator,receiver)}else{forEachObject(list,iterator,receiver)}};module.exports=forEach},{"is-callable":236}],190:[function(require,module,exports){"use strict";var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var toStr=Object.prototype.toString;var max=Math.max;var funcType="[object Function]";var concatty=function concatty(a,b){var arr=[];for(var i=0;i<a.length;i+=1){arr[i]=a[i]}for(var j=0;j<b.length;j+=1){arr[j+a.length]=b[j]}return arr};var slicy=function slicy(arrLike,offset){var arr=[];for(var i=offset||0,j=0;i<arrLike.length;i+=1,j+=1){arr[j]=arrLike[i]}return arr};var joiny=function(arr,joiner){var str="";for(var i=0;i<arr.length;i+=1){str+=arr[i];if(i+1<arr.length){str+=joiner}}return str};module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.apply(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target)}var args=slicy(arguments,1);var bound;var binder=function(){if(this instanceof bound){var result=target.apply(this,concatty(args,arguments));if(Object(result)===result){return result}return this}return target.apply(that,concatty(args,arguments))};var boundLength=max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs[i]="$"+i}bound=Function("binder","return function ("+joiny(boundArgs,",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty;Empty.prototype=null}return bound}},{}],191:[function(require,module,exports){"use strict";var implementation=require("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":190}],192:[function(require,module,exports){"use strict";var undefined;var $SyntaxError=SyntaxError;var $Function=Function;var $TypeError=TypeError;var getEvalledConstructor=function(expressionSyntax){try{return $Function('"use strict"; return ('+expressionSyntax+").constructor;")()}catch(e){}};var $gOPD=Object.getOwnPropertyDescriptor;if($gOPD){try{$gOPD({},"")}catch(e){$gOPD=null}}var throwTypeError=function(){throw new $TypeError};var ThrowTypeError=$gOPD?function(){try{arguments.callee;return throwTypeError}catch(calleeThrows){try{return $gOPD(arguments,"callee").get}catch(gOPDthrows){return throwTypeError}}}():throwTypeError;var hasSymbols=require("has-symbols")();var hasProto=require("has-proto")();var getProto=Object.getPrototypeOf||(hasProto?function(x){return x.__proto__}:null);var needsEval={};var TypedArray=typeof Uint8Array==="undefined"||!getProto?undefined:getProto(Uint8Array);var INTRINSICS={"%AggregateError%":typeof AggregateError==="undefined"?undefined:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer==="undefined"?undefined:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols&&getProto?getProto([][Symbol.iterator]()):undefined,"%AsyncFromSyncIteratorPrototype%":undefined,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics==="undefined"?undefined:Atomics,"%BigInt%":typeof BigInt==="undefined"?undefined:BigInt,"%BigInt64Array%":typeof BigInt64Array==="undefined"?undefined:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array==="undefined"?undefined:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView==="undefined"?undefined:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array==="undefined"?undefined:Float32Array,"%Float64Array%":typeof Float64Array==="undefined"?undefined:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry==="undefined"?undefined:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array==="undefined"?undefined:Int8Array,"%Int16Array%":typeof Int16Array==="undefined"?undefined:Int16Array,"%Int32Array%":typeof Int32Array==="undefined"?undefined:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols&&getProto?getProto(getProto([][Symbol.iterator]())):undefined,"%JSON%":typeof JSON==="object"?JSON:undefined,"%Map%":typeof Map==="undefined"?undefined:Map,"%MapIteratorPrototype%":typeof Map==="undefined"||!hasSymbols||!getProto?undefined:getProto((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise==="undefined"?undefined:Promise,"%Proxy%":typeof Proxy==="undefined"?undefined:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect==="undefined"?undefined:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set==="undefined"?undefined:Set,"%SetIteratorPrototype%":typeof Set==="undefined"||!hasSymbols||!getProto?undefined:getProto((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer==="undefined"?undefined:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols&&getProto?getProto(""[Symbol.iterator]()):undefined,"%Symbol%":hasSymbols?Symbol:undefined,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":typeof Uint8Array==="undefined"?undefined:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray==="undefined"?undefined:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array==="undefined"?undefined:Uint16Array,"%Uint32Array%":typeof Uint32Array==="undefined"?undefined:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap==="undefined"?undefined:WeakMap,"%WeakRef%":typeof WeakRef==="undefined"?undefined:WeakRef,"%WeakSet%":typeof WeakSet==="undefined"?undefined:WeakSet};if(getProto){try{null.error}catch(e){var errorProto=getProto(getProto(e));INTRINSICS["%Error.prototype%"]=errorProto}}var doEval=function doEval(name){var value;if(name==="%AsyncFunction%"){value=getEvalledConstructor("async function () {}")}else if(name==="%GeneratorFunction%"){value=getEvalledConstructor("function* () {}")}else if(name==="%AsyncGeneratorFunction%"){value=getEvalledConstructor("async function* () {}")}else if(name==="%AsyncGenerator%"){var fn=doEval("%AsyncGeneratorFunction%");if(fn){value=fn.prototype}}else if(name==="%AsyncIteratorPrototype%"){var gen=doEval("%AsyncGenerator%");if(gen&&getProto){value=getProto(gen.prototype)}}INTRINSICS[name]=value;return value};var LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]};var bind=require("function-bind");var hasOwn=require("hasown");var $concat=bind.call(Function.call,Array.prototype.concat);var $spliceApply=bind.call(Function.apply,Array.prototype.splice);var $replace=bind.call(Function.call,String.prototype.replace);var $strSlice=bind.call(Function.call,String.prototype.slice);var $exec=bind.call(Function.call,RegExp.prototype.exec);var rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=function stringToPath(string){var first=$strSlice(string,0,1);var last=$strSlice(string,-1);if(first==="%"&&last!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`")}else if(last==="%"&&first!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`")}var result=[];$replace(string,rePropName,(function(match,number,quote,subString){result[result.length]=quote?$replace(subString,reEscapeChar,"$1"):number||match}));return result};var getBaseIntrinsic=function getBaseIntrinsic(name,allowMissing){var intrinsicName=name;var alias;if(hasOwn(LEGACY_ALIASES,intrinsicName)){alias=LEGACY_ALIASES[intrinsicName];intrinsicName="%"+alias[0]+"%"}if(hasOwn(INTRINSICS,intrinsicName)){var value=INTRINSICS[intrinsicName];if(value===needsEval){value=doEval(intrinsicName)}if(typeof value==="undefined"&&!allowMissing){throw new $TypeError("intrinsic "+name+" exists, but is not available. Please file an issue!")}return{alias:alias,name:intrinsicName,value:value}}throw new $SyntaxError("intrinsic "+name+" does not exist!")};module.exports=function GetIntrinsic(name,allowMissing){if(typeof name!=="string"||name.length===0){throw new $TypeError("intrinsic name must be a non-empty string")}if(arguments.length>1&&typeof allowMissing!=="boolean"){throw new $TypeError('"allowMissing" argument must be a boolean')}if($exec(/^%?[^%]*%?$/,name)===null){throw new $SyntaxError("`%` may not be present anywhere but at the beginning and end of the intrinsic name")}var parts=stringToPath(name);var intrinsicBaseName=parts.length>0?parts[0]:"";var intrinsic=getBaseIntrinsic("%"+intrinsicBaseName+"%",allowMissing);var intrinsicRealName=intrinsic.name;var value=intrinsic.value;var skipFurtherCaching=false;var alias=intrinsic.alias;if(alias){intrinsicBaseName=alias[0];$spliceApply(parts,$concat([0,1],alias))}for(var i=1,isOwn=true;i<parts.length;i+=1){var part=parts[i];var first=$strSlice(part,0,1);var last=$strSlice(part,-1);if((first==='"'||first==="'"||first==="`"||(last==='"'||last==="'"||last==="`"))&&first!==last){throw new $SyntaxError("property names with quotes must have matching quotes")}if(part==="constructor"||!isOwn){skipFurtherCaching=true}intrinsicBaseName+="."+part;intrinsicRealName="%"+intrinsicBaseName+"%";if(hasOwn(INTRINSICS,intrinsicRealName)){value=INTRINSICS[intrinsicRealName]}else if(value!=null){if(!(part in value)){if(!allowMissing){throw new $TypeError("base intrinsic for "+name+" exists, but the property is not available.")}return void undefined}if($gOPD&&i+1>=parts.length){var desc=$gOPD(value,part);isOwn=!!desc;if(isOwn&&"get"in desc&&!("originalValue"in desc.get)){value=desc.get}else{value=value[part]}}else{isOwn=hasOwn(value,part);value=value[part]}if(isOwn&&!skipFurtherCaching){INTRINSICS[intrinsicRealName]=value}}}return value}},{"function-bind":191,"has-proto":195,"has-symbols":196,hasown:227}],193:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var $gOPD=GetIntrinsic("%Object.getOwnPropertyDescriptor%",true);if($gOPD){try{$gOPD([],"length")}catch(e){$gOPD=null}}module.exports=$gOPD},{"get-intrinsic":192}],194:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var $defineProperty=GetIntrinsic("%Object.defineProperty%",true);var hasPropertyDescriptors=function hasPropertyDescriptors(){if($defineProperty){try{$defineProperty({},"a",{value:1});return true}catch(e){return false}}return false};hasPropertyDescriptors.hasArrayLengthDefineBug=function hasArrayLengthDefineBug(){if(!hasPropertyDescriptors()){return null}try{return $defineProperty([],"length",{value:1}).length!==1}catch(e){return true}};module.exports=hasPropertyDescriptors},{"get-intrinsic":192}],195:[function(require,module,exports){"use strict";var test={foo:{}};var $Object=Object;module.exports=function hasProto(){return{__proto__:test}.foo===test.foo&&!({__proto__:null}instanceof $Object)}},{}],196:[function(require,module,exports){"use strict";var origSymbol=typeof Symbol!=="undefined"&&Symbol;var hasSymbolSham=require("./shams");module.exports=function hasNativeSymbols(){if(typeof origSymbol!=="function"){return false}if(typeof Symbol!=="function"){return false}if(typeof origSymbol("foo")!=="symbol"){return false}if(typeof Symbol("bar")!=="symbol"){return false}return hasSymbolSham()}},{"./shams":197}],197:[function(require,module,exports){"use strict";module.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(typeof Symbol.iterator==="symbol"){return true}var obj={};var sym=Symbol("test");var symObj=Object(sym);if(typeof sym==="string"){return false}if(Object.prototype.toString.call(sym)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(symObj)!=="[object Symbol]"){return false}var symVal=42;obj[sym]=symVal;for(sym in obj){return false}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false}}return true}},{}],198:[function(require,module,exports){"use strict";var hasSymbols=require("has-symbols/shams");module.exports=function hasToStringTagShams(){return hasSymbols()&&!!Symbol.toStringTag}},{"has-symbols/shams":197}],199:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer;var Transform=require("readable-stream").Transform;var inherits=require("inherits");function throwIfNotStringOrBuffer(val,prefix){if(!Buffer.isBuffer(val)&&typeof val!=="string"){throw new TypeError(prefix+" must be a string or a buffer")}}function HashBase(blockSize){Transform.call(this);this._block=Buffer.allocUnsafe(blockSize);this._blockSize=blockSize;this._blockOffset=0;this._length=[0,0,0,0];this._finalized=false}inherits(HashBase,Transform);HashBase.prototype._transform=function(chunk,encoding,callback){var error=null;try{this.update(chunk,encoding)}catch(err){error=err}callback(error)};HashBase.prototype._flush=function(callback){var error=null;try{this.push(this.digest())}catch(err){error=err}callback(error)};HashBase.prototype.update=function(data,encoding){throwIfNotStringOrBuffer(data,"Data");if(this._finalized)throw new Error("Digest already called");if(!Buffer.isBuffer(data))data=Buffer.from(data,encoding);var block=this._block;var offset=0;while(this._blockOffset+data.length-offset>=this._blockSize){for(var i=this._blockOffset;i<this._blockSize;)block[i++]=data[offset++];this._update();this._blockOffset=0}while(offset<data.length)block[this._blockOffset++]=data[offset++];for(var j=0,carry=data.length*8;carry>0;++j){this._length[j]+=carry;carry=this._length[j]/4294967296|0;if(carry>0)this._length[j]-=4294967296*carry}return this};HashBase.prototype._update=function(){throw new Error("_update is not implemented")};HashBase.prototype.digest=function(encoding){if(this._finalized)throw new Error("Digest already called");this._finalized=true;var digest=this._digest();if(encoding!==undefined)digest=digest.toString(encoding);this._block.fill(0);this._blockOffset=0;for(var i=0;i<4;++i)this._length[i]=0;return digest};HashBase.prototype._digest=function(){throw new Error("_digest is not implemented")};module.exports=HashBase},{inherits:233,"readable-stream":214,"safe-buffer":385}],200:[function(require,module,exports){arguments[4][71][0].apply(exports,arguments)},{dup:71}],201:[function(require,module,exports){arguments[4][72][0].apply(exports,arguments)},{"./_stream_readable":203,"./_stream_writable":205,_process:88,dup:72,inherits:233}],202:[function(require,module,exports){arguments[4][73][0].apply(exports,arguments)},{"./_stream_transform":204,dup:73,inherits:233}],203:[function(require,module,exports){arguments[4][74][0].apply(exports,arguments)},{"../errors":200,"./_stream_duplex":201,"./internal/streams/async_iterator":206,"./internal/streams/buffer_list":207,"./internal/streams/destroy":208,"./internal/streams/from":210,"./internal/streams/state":212,"./internal/streams/stream":213,_process:88,buffer:88,dup:74,events:187,inherits:233,"string_decoder/":432,util:43}],204:[function(require,module,exports){arguments[4][75][0].apply(exports,arguments)},{"../errors":200,"./_stream_duplex":201,dup:75,inherits:233}],205:[function(require,module,exports){arguments[4][76][0].apply(exports,arguments)},{"../errors":200,"./_stream_duplex":201,"./internal/streams/destroy":208,"./internal/streams/state":212,"./internal/streams/stream":213,_process:88,buffer:88,dup:76,inherits:233,"util-deprecate":440}],206:[function(require,module,exports){arguments[4][77][0].apply(exports,arguments)},{"./end-of-stream":209,_process:88,dup:77}],207:[function(require,module,exports){arguments[4][78][0].apply(exports,arguments)},{buffer:88,dup:78,util:43}],208:[function(require,module,exports){arguments[4][79][0].apply(exports,arguments)},{_process:88,dup:79}],209:[function(require,module,exports){arguments[4][80][0].apply(exports,arguments)},{"../../../errors":200,dup:80}],210:[function(require,module,exports){arguments[4][81][0].apply(exports,arguments)},{dup:81}],211:[function(require,module,exports){arguments[4][82][0].apply(exports,arguments)},{"../../../errors":200,"./end-of-stream":209,dup:82}],212:[function(require,module,exports){arguments[4][83][0].apply(exports,arguments)},{"../../../errors":200,dup:83}],213:[function(require,module,exports){arguments[4][84][0].apply(exports,arguments)},{dup:84,events:187}],214:[function(require,module,exports){arguments[4][85][0].apply(exports,arguments)},{"./lib/_stream_duplex.js":201,"./lib/_stream_passthrough.js":202,"./lib/_stream_readable.js":203,"./lib/_stream_transform.js":204,"./lib/_stream_writable.js":205,"./lib/internal/streams/end-of-stream.js":209,"./lib/internal/streams/pipeline.js":211,dup:85}],215:[function(require,module,exports){var hash=exports;hash.utils=require("./hash/utils");hash.common=require("./hash/common");hash.sha=require("./hash/sha");hash.ripemd=require("./hash/ripemd");hash.hmac=require("./hash/hmac");hash.sha1=hash.sha.sha1;hash.sha256=hash.sha.sha256;hash.sha224=hash.sha.sha224;hash.sha384=hash.sha.sha384;hash.sha512=hash.sha.sha512;hash.ripemd160=hash.ripemd.ripemd160},{"./hash/common":216,"./hash/hmac":217,"./hash/ripemd":218,"./hash/sha":219,"./hash/utils":226}],216:[function(require,module,exports){"use strict";var utils=require("./utils");var assert=require("minimalistic-assert");function BlockHash(){this.pending=null;this.pendingTotal=0;this.blockSize=this.constructor.blockSize;this.outSize=this.constructor.outSize;this.hmacStrength=this.constructor.hmacStrength;this.padLength=this.constructor.padLength/8;this.endian="big";this._delta8=this.blockSize/8;this._delta32=this.blockSize/32}exports.BlockHash=BlockHash;BlockHash.prototype.update=function update(msg,enc){msg=utils.toArray(msg,enc);if(!this.pending)this.pending=msg;else this.pending=this.pending.concat(msg);this.pendingTotal+=msg.length;if(this.pending.length>=this._delta8){msg=this.pending;var r=msg.length%this._delta8;this.pending=msg.slice(msg.length-r,msg.length);if(this.pending.length===0)this.pending=null;msg=utils.join32(msg,0,msg.length-r,this.endian);for(var i=0;i<msg.length;i+=this._delta32)this._update(msg,i,i+this._delta32)}return this};BlockHash.prototype.digest=function digest(enc){this.update(this._pad());assert(this.pending===null);return this._digest(enc)};BlockHash.prototype._pad=function pad(){var len=this.pendingTotal;var bytes=this._delta8;var k=bytes-(len+this.padLength)%bytes;var res=new Array(k+this.padLength);res[0]=128;for(var i=1;i<k;i++)res[i]=0;len<<=3;if(this.endian==="big"){for(var t=8;t<this.padLength;t++)res[i++]=0;res[i++]=0;res[i++]=0;res[i++]=0;res[i++]=0;res[i++]=len>>>24&255;res[i++]=len>>>16&255;res[i++]=len>>>8&255;res[i++]=len&255}else{res[i++]=len&255;res[i++]=len>>>8&255;res[i++]=len>>>16&255;res[i++]=len>>>24&255;res[i++]=0;res[i++]=0;res[i++]=0;res[i++]=0;for(t=8;t<this.padLength;t++)res[i++]=0}return res}},{"./utils":226,"minimalistic-assert":291}],217:[function(require,module,exports){"use strict";var utils=require("./utils");var assert=require("minimalistic-assert");function Hmac(hash,key,enc){if(!(this instanceof Hmac))return new Hmac(hash,key,enc);this.Hash=hash;this.blockSize=hash.blockSize/8;this.outSize=hash.outSize/8;this.inner=null;this.outer=null;this._init(utils.toArray(key,enc))}module.exports=Hmac;Hmac.prototype._init=function init(key){if(key.length>this.blockSize)key=(new this.Hash).update(key).digest();assert(key.length<=this.blockSize);for(var i=key.length;i<this.blockSize;i++)key.push(0);for(i=0;i<key.length;i++)key[i]^=54;this.inner=(new this.Hash).update(key);for(i=0;i<key.length;i++)key[i]^=106;this.outer=(new this.Hash).update(key)};Hmac.prototype.update=function update(msg,enc){this.inner.update(msg,enc);return this};Hmac.prototype.digest=function digest(enc){this.outer.update(this.inner.digest());return this.outer.digest(enc)}},{"./utils":226,"minimalistic-assert":291}],218:[function(require,module,exports){"use strict";var utils=require("./utils");var common=require("./common");var rotl32=utils.rotl32;var sum32=utils.sum32;var sum32_3=utils.sum32_3;var sum32_4=utils.sum32_4;var BlockHash=common.BlockHash;function RIPEMD160(){if(!(this instanceof RIPEMD160))return new RIPEMD160;BlockHash.call(this);this.h=[1732584193,4023233417,2562383102,271733878,3285377520];this.endian="little"}utils.inherits(RIPEMD160,BlockHash);exports.ripemd160=RIPEMD160;RIPEMD160.blockSize=512;RIPEMD160.outSize=160;RIPEMD160.hmacStrength=192;RIPEMD160.padLength=64;RIPEMD160.prototype._update=function update(msg,start){var A=this.h[0];var B=this.h[1];var C=this.h[2];var D=this.h[3];var E=this.h[4];var Ah=A;var Bh=B;var Ch=C;var Dh=D;var Eh=E;for(var j=0;j<80;j++){var T=sum32(rotl32(sum32_4(A,f(j,B,C,D),msg[r[j]+start],K(j)),s[j]),E);A=E;E=D;D=rotl32(C,10);C=B;B=T;T=sum32(rotl32(sum32_4(Ah,f(79-j,Bh,Ch,Dh),msg[rh[j]+start],Kh(j)),sh[j]),Eh);Ah=Eh;Eh=Dh;Dh=rotl32(Ch,10);Ch=Bh;Bh=T}T=sum32_3(this.h[1],C,Dh);this.h[1]=sum32_3(this.h[2],D,Eh);this.h[2]=sum32_3(this.h[3],E,Ah);this.h[3]=sum32_3(this.h[4],A,Bh);this.h[4]=sum32_3(this.h[0],B,Ch);this.h[0]=T};RIPEMD160.prototype._digest=function digest(enc){if(enc==="hex")return utils.toHex32(this.h,"little");else return utils.split32(this.h,"little")};function f(j,x,y,z){if(j<=15)return x^y^z;else if(j<=31)return x&y|~x&z;else if(j<=47)return(x|~y)^z;else if(j<=63)return x&z|y&~z;else return x^(y|~z)}function K(j){if(j<=15)return 0;else if(j<=31)return 1518500249;else if(j<=47)return 1859775393;else if(j<=63)return 2400959708;else return 2840853838}function Kh(j){if(j<=15)return 1352829926;else if(j<=31)return 1548603684;else if(j<=47)return 1836072691;else if(j<=63)return 2053994217;else return 0}var r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var rh=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var s=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var sh=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":216,"./utils":226}],219:[function(require,module,exports){"use strict";exports.sha1=require("./sha/1");exports.sha224=require("./sha/224");exports.sha256=require("./sha/256");exports.sha384=require("./sha/384");exports.sha512=require("./sha/512")},{"./sha/1":220,"./sha/224":221,"./sha/256":222,"./sha/384":223,"./sha/512":224}],220:[function(require,module,exports){"use strict";var utils=require("../utils");var common=require("../common");var shaCommon=require("./common");var rotl32=utils.rotl32;var sum32=utils.sum32;var sum32_5=utils.sum32_5;var ft_1=shaCommon.ft_1;var BlockHash=common.BlockHash;var sha1_K=[1518500249,1859775393,2400959708,3395469782];function SHA1(){if(!(this instanceof SHA1))return new SHA1;BlockHash.call(this);this.h=[1732584193,4023233417,2562383102,271733878,3285377520];this.W=new Array(80)}utils.inherits(SHA1,BlockHash);module.exports=SHA1;SHA1.blockSize=512;SHA1.outSize=160;SHA1.hmacStrength=80;SHA1.padLength=64;SHA1.prototype._update=function _update(msg,start){var W=this.W;for(var i=0;i<16;i++)W[i]=msg[start+i];for(;i<W.length;i++)W[i]=rotl32(W[i-3]^W[i-8]^W[i-14]^W[i-16],1);var a=this.h[0];var b=this.h[1];var c=this.h[2];var d=this.h[3];var e=this.h[4];for(i=0;i<W.length;i++){var s=~~(i/20);var t=sum32_5(rotl32(a,5),ft_1(s,b,c,d),e,W[i],sha1_K[s]);e=d;d=c;c=rotl32(b,30);b=a;a=t}this.h[0]=sum32(this.h[0],a);this.h[1]=sum32(this.h[1],b);this.h[2]=sum32(this.h[2],c);this.h[3]=sum32(this.h[3],d);this.h[4]=sum32(this.h[4],e)};SHA1.prototype._digest=function digest(enc){if(enc==="hex")return utils.toHex32(this.h,"big");else return utils.split32(this.h,"big")}},{"../common":216,"../utils":226,"./common":225}],221:[function(require,module,exports){"use strict";var utils=require("../utils");var SHA256=require("./256");function SHA224(){if(!(this instanceof SHA224))return new SHA224;SHA256.call(this);this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}utils.inherits(SHA224,SHA256);module.exports=SHA224;SHA224.blockSize=512;SHA224.outSize=224;SHA224.hmacStrength=192;SHA224.padLength=64;SHA224.prototype._digest=function digest(enc){if(enc==="hex")return utils.toHex32(this.h.slice(0,7),"big");else return utils.split32(this.h.slice(0,7),"big")}},{"../utils":226,"./256":222}],222:[function(require,module,exports){"use strict";var utils=require("../utils");var common=require("../common");var shaCommon=require("./common");var assert=require("minimalistic-assert");var sum32=utils.sum32;var sum32_4=utils.sum32_4;var sum32_5=utils.sum32_5;var ch32=shaCommon.ch32;var maj32=shaCommon.maj32;var s0_256=shaCommon.s0_256;var s1_256=shaCommon.s1_256;var g0_256=shaCommon.g0_256;var g1_256=shaCommon.g1_256;var BlockHash=common.BlockHash;var sha256_K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function SHA256(){if(!(this instanceof SHA256))return new SHA256;BlockHash.call(this);this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];this.k=sha256_K;this.W=new Array(64)}utils.inherits(SHA256,BlockHash);module.exports=SHA256;SHA256.blockSize=512;SHA256.outSize=256;SHA256.hmacStrength=192;SHA256.padLength=64;SHA256.prototype._update=function _update(msg,start){var W=this.W;for(var i=0;i<16;i++)W[i]=msg[start+i];for(;i<W.length;i++)W[i]=sum32_4(g1_256(W[i-2]),W[i-7],g0_256(W[i-15]),W[i-16]);var a=this.h[0];var b=this.h[1];var c=this.h[2];var d=this.h[3];var e=this.h[4];var f=this.h[5];var g=this.h[6];var h=this.h[7];assert(this.k.length===W.length);for(i=0;i<W.length;i++){var T1=sum32_5(h,s1_256(e),ch32(e,f,g),this.k[i],W[i]);var T2=sum32(s0_256(a),maj32(a,b,c));h=g;g=f;f=e;e=sum32(d,T1);d=c;c=b;b=a;a=sum32(T1,T2)}this.h[0]=sum32(this.h[0],a);this.h[1]=sum32(this.h[1],b);this.h[2]=sum32(this.h[2],c);this.h[3]=sum32(this.h[3],d);this.h[4]=sum32(this.h[4],e);this.h[5]=sum32(this.h[5],f);this.h[6]=sum32(this.h[6],g);this.h[7]=sum32(this.h[7],h)};SHA256.prototype._digest=function digest(enc){if(enc==="hex")return utils.toHex32(this.h,"big");else return utils.split32(this.h,"big")}},{"../common":216,"../utils":226,"./common":225,"minimalistic-assert":291}],223:[function(require,module,exports){"use strict";var utils=require("../utils");var SHA512=require("./512");function SHA384(){if(!(this instanceof SHA384))return new SHA384;SHA512.call(this);this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}utils.inherits(SHA384,SHA512);module.exports=SHA384;SHA384.blockSize=1024;SHA384.outSize=384;SHA384.hmacStrength=192;SHA384.padLength=128;SHA384.prototype._digest=function digest(enc){if(enc==="hex")return utils.toHex32(this.h.slice(0,12),"big");else return utils.split32(this.h.slice(0,12),"big")}},{"../utils":226,"./512":224}],224:[function(require,module,exports){"use strict";var utils=require("../utils");var common=require("../common");var assert=require("minimalistic-assert");var rotr64_hi=utils.rotr64_hi;var rotr64_lo=utils.rotr64_lo;var shr64_hi=utils.shr64_hi;var shr64_lo=utils.shr64_lo;var sum64=utils.sum64;var sum64_hi=utils.sum64_hi;var sum64_lo=utils.sum64_lo;var sum64_4_hi=utils.sum64_4_hi;var sum64_4_lo=utils.sum64_4_lo;var sum64_5_hi=utils.sum64_5_hi;var sum64_5_lo=utils.sum64_5_lo;var BlockHash=common.BlockHash;var sha512_K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function SHA512(){if(!(this instanceof SHA512))return new SHA512;BlockHash.call(this);this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209];this.k=sha512_K;this.W=new Array(160)}utils.inherits(SHA512,BlockHash);module.exports=SHA512;SHA512.blockSize=1024;SHA512.outSize=512;SHA512.hmacStrength=192;SHA512.padLength=128;SHA512.prototype._prepareBlock=function _prepareBlock(msg,start){var W=this.W;for(var i=0;i<32;i++)W[i]=msg[start+i];for(;i<W.length;i+=2){var c0_hi=g1_512_hi(W[i-4],W[i-3]);var c0_lo=g1_512_lo(W[i-4],W[i-3]);var c1_hi=W[i-14];var c1_lo=W[i-13];var c2_hi=g0_512_hi(W[i-30],W[i-29]);var c2_lo=g0_512_lo(W[i-30],W[i-29]);var c3_hi=W[i-32];var c3_lo=W[i-31];W[i]=sum64_4_hi(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo);W[i+1]=sum64_4_lo(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo)}};SHA512.prototype._update=function _update(msg,start){this._prepareBlock(msg,start);var W=this.W;var ah=this.h[0];var al=this.h[1];var bh=this.h[2];var bl=this.h[3];var ch=this.h[4];var cl=this.h[5];var dh=this.h[6];var dl=this.h[7];var eh=this.h[8];var el=this.h[9];var fh=this.h[10];var fl=this.h[11];var gh=this.h[12];var gl=this.h[13];var hh=this.h[14];var hl=this.h[15];assert(this.k.length===W.length);for(var i=0;i<W.length;i+=2){var c0_hi=hh;var c0_lo=hl;var c1_hi=s1_512_hi(eh,el);var c1_lo=s1_512_lo(eh,el);var c2_hi=ch64_hi(eh,el,fh,fl,gh,gl);var c2_lo=ch64_lo(eh,el,fh,fl,gh,gl);var c3_hi=this.k[i];var c3_lo=this.k[i+1];var c4_hi=W[i];var c4_lo=W[i+1];var T1_hi=sum64_5_hi(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo,c4_hi,c4_lo);var T1_lo=sum64_5_lo(c0_hi,c0_lo,c1_hi,c1_lo,c2_hi,c2_lo,c3_hi,c3_lo,c4_hi,c4_lo);c0_hi=s0_512_hi(ah,al);c0_lo=s0_512_lo(ah,al);c1_hi=maj64_hi(ah,al,bh,bl,ch,cl);c1_lo=maj64_lo(ah,al,bh,bl,ch,cl);var T2_hi=sum64_hi(c0_hi,c0_lo,c1_hi,c1_lo);var T2_lo=sum64_lo(c0_hi,c0_lo,c1_hi,c1_lo);hh=gh;hl=gl;gh=fh;gl=fl;fh=eh;fl=el;eh=sum64_hi(dh,dl,T1_hi,T1_lo);el=sum64_lo(dl,dl,T1_hi,T1_lo);dh=ch;dl=cl;ch=bh;cl=bl;bh=ah;bl=al;ah=sum64_hi(T1_hi,T1_lo,T2_hi,T2_lo);al=sum64_lo(T1_hi,T1_lo,T2_hi,T2_lo)}sum64(this.h,0,ah,al);sum64(this.h,2,bh,bl);sum64(this.h,4,ch,cl);sum64(this.h,6,dh,dl);sum64(this.h,8,eh,el);sum64(this.h,10,fh,fl);sum64(this.h,12,gh,gl);sum64(this.h,14,hh,hl)};SHA512.prototype._digest=function digest(enc){if(enc==="hex")return utils.toHex32(this.h,"big");else return utils.split32(this.h,"big")};function ch64_hi(xh,xl,yh,yl,zh){var r=xh&yh^~xh&zh;if(r<0)r+=4294967296;return r}function ch64_lo(xh,xl,yh,yl,zh,zl){var r=xl&yl^~xl&zl;if(r<0)r+=4294967296;return r}function maj64_hi(xh,xl,yh,yl,zh){var r=xh&yh^xh&zh^yh&zh;if(r<0)r+=4294967296;return r}function maj64_lo(xh,xl,yh,yl,zh,zl){var r=xl&yl^xl&zl^yl&zl;if(r<0)r+=4294967296;return r}function s0_512_hi(xh,xl){var c0_hi=rotr64_hi(xh,xl,28);var c1_hi=rotr64_hi(xl,xh,2);var c2_hi=rotr64_hi(xl,xh,7);var r=c0_hi^c1_hi^c2_hi;if(r<0)r+=4294967296;return r}function s0_512_lo(xh,xl){var c0_lo=rotr64_lo(xh,xl,28);var c1_lo=rotr64_lo(xl,xh,2);var c2_lo=rotr64_lo(xl,xh,7);var r=c0_lo^c1_lo^c2_lo;if(r<0)r+=4294967296;return r}function s1_512_hi(xh,xl){var c0_hi=rotr64_hi(xh,xl,14);var c1_hi=rotr64_hi(xh,xl,18);var c2_hi=rotr64_hi(xl,xh,9);var r=c0_hi^c1_hi^c2_hi;if(r<0)r+=4294967296;return r}function s1_512_lo(xh,xl){var c0_lo=rotr64_lo(xh,xl,14);var c1_lo=rotr64_lo(xh,xl,18);var c2_lo=rotr64_lo(xl,xh,9);var r=c0_lo^c1_lo^c2_lo;if(r<0)r+=4294967296;return r}function g0_512_hi(xh,xl){var c0_hi=rotr64_hi(xh,xl,1);var c1_hi=rotr64_hi(xh,xl,8);var c2_hi=shr64_hi(xh,xl,7);var r=c0_hi^c1_hi^c2_hi;if(r<0)r+=4294967296;return r}function g0_512_lo(xh,xl){var c0_lo=rotr64_lo(xh,xl,1);var c1_lo=rotr64_lo(xh,xl,8);var c2_lo=shr64_lo(xh,xl,7);var r=c0_lo^c1_lo^c2_lo;if(r<0)r+=4294967296;return r}function g1_512_hi(xh,xl){var c0_hi=rotr64_hi(xh,xl,19);var c1_hi=rotr64_hi(xl,xh,29);var c2_hi=shr64_hi(xh,xl,6);var r=c0_hi^c1_hi^c2_hi;if(r<0)r+=4294967296;return r}function g1_512_lo(xh,xl){var c0_lo=rotr64_lo(xh,xl,19);var c1_lo=rotr64_lo(xl,xh,29);var c2_lo=shr64_lo(xh,xl,6);var r=c0_lo^c1_lo^c2_lo;if(r<0)r+=4294967296;return r}},{"../common":216,"../utils":226,"minimalistic-assert":291}],225:[function(require,module,exports){"use strict";var utils=require("../utils");var rotr32=utils.rotr32;function ft_1(s,x,y,z){if(s===0)return ch32(x,y,z);if(s===1||s===3)return p32(x,y,z);if(s===2)return maj32(x,y,z)}exports.ft_1=ft_1;function ch32(x,y,z){return x&y^~x&z}exports.ch32=ch32;function maj32(x,y,z){return x&y^x&z^y&z}exports.maj32=maj32;function p32(x,y,z){return x^y^z}exports.p32=p32;function s0_256(x){return rotr32(x,2)^rotr32(x,13)^rotr32(x,22)}exports.s0_256=s0_256;function s1_256(x){return rotr32(x,6)^rotr32(x,11)^rotr32(x,25)}exports.s1_256=s1_256;function g0_256(x){return rotr32(x,7)^rotr32(x,18)^x>>>3}exports.g0_256=g0_256;function g1_256(x){return rotr32(x,17)^rotr32(x,19)^x>>>10}exports.g1_256=g1_256},{"../utils":226}],226:[function(require,module,exports){"use strict";var assert=require("minimalistic-assert");var inherits=require("inherits");exports.inherits=inherits;function isSurrogatePair(msg,i){if((msg.charCodeAt(i)&64512)!==55296){return false}if(i<0||i+1>=msg.length){return false}return(msg.charCodeAt(i+1)&64512)===56320}function toArray(msg,enc){if(Array.isArray(msg))return msg.slice();if(!msg)return[];var res=[];if(typeof msg==="string"){if(!enc){var p=0;for(var i=0;i<msg.length;i++){var c=msg.charCodeAt(i);if(c<128){res[p++]=c}else if(c<2048){res[p++]=c>>6|192;res[p++]=c&63|128}else if(isSurrogatePair(msg,i)){c=65536+((c&1023)<<10)+(msg.charCodeAt(++i)&1023);res[p++]=c>>18|240;res[p++]=c>>12&63|128;res[p++]=c>>6&63|128;res[p++]=c&63|128}else{res[p++]=c>>12|224;res[p++]=c>>6&63|128;res[p++]=c&63|128}}}else if(enc==="hex"){msg=msg.replace(/[^a-z0-9]+/gi,"");if(msg.length%2!==0)msg="0"+msg;for(i=0;i<msg.length;i+=2)res.push(parseInt(msg[i]+msg[i+1],16))}}else{for(i=0;i<msg.length;i++)res[i]=msg[i]|0}return res}exports.toArray=toArray;function toHex(msg){var res="";for(var i=0;i<msg.length;i++)res+=zero2(msg[i].toString(16));return res}exports.toHex=toHex;function htonl(w){var res=w>>>24|w>>>8&65280|w<<8&16711680|(w&255)<<24;return res>>>0}exports.htonl=htonl;function toHex32(msg,endian){var res="";for(var i=0;i<msg.length;i++){var w=msg[i];if(endian==="little")w=htonl(w);res+=zero8(w.toString(16))}return res}exports.toHex32=toHex32;function zero2(word){if(word.length===1)return"0"+word;else return word}exports.zero2=zero2;function zero8(word){if(word.length===7)return"0"+word;else if(word.length===6)return"00"+word;else if(word.length===5)return"000"+word;else if(word.length===4)return"0000"+word;else if(word.length===3)return"00000"+word;else if(word.length===2)return"000000"+word;else if(word.length===1)return"0000000"+word;else return word}exports.zero8=zero8;function join32(msg,start,end,endian){var len=end-start;assert(len%4===0);var res=new Array(len/4);for(var i=0,k=start;i<res.length;i++,k+=4){var w;if(endian==="big")w=msg[k]<<24|msg[k+1]<<16|msg[k+2]<<8|msg[k+3];else w=msg[k+3]<<24|msg[k+2]<<16|msg[k+1]<<8|msg[k];res[i]=w>>>0}return res}exports.join32=join32;function split32(msg,endian){var res=new Array(msg.length*4);for(var i=0,k=0;i<msg.length;i++,k+=4){var m=msg[i];if(endian==="big"){res[k]=m>>>24;res[k+1]=m>>>16&255;res[k+2]=m>>>8&255;res[k+3]=m&255}else{res[k+3]=m>>>24;res[k+2]=m>>>16&255;res[k+1]=m>>>8&255;res[k]=m&255}}return res}exports.split32=split32;function rotr32(w,b){return w>>>b|w<<32-b}exports.rotr32=rotr32;function rotl32(w,b){return w<<b|w>>>32-b}exports.rotl32=rotl32;function sum32(a,b){return a+b>>>0}exports.sum32=sum32;function sum32_3(a,b,c){return a+b+c>>>0}exports.sum32_3=sum32_3;function sum32_4(a,b,c,d){return a+b+c+d>>>0}exports.sum32_4=sum32_4;function sum32_5(a,b,c,d,e){return a+b+c+d+e>>>0}exports.sum32_5=sum32_5;function sum64(buf,pos,ah,al){var bh=buf[pos];var bl=buf[pos+1];var lo=al+bl>>>0;var hi=(lo<al?1:0)+ah+bh;buf[pos]=hi>>>0;buf[pos+1]=lo}exports.sum64=sum64;function sum64_hi(ah,al,bh,bl){var lo=al+bl>>>0;var hi=(lo<al?1:0)+ah+bh;return hi>>>0}exports.sum64_hi=sum64_hi;function sum64_lo(ah,al,bh,bl){var lo=al+bl;return lo>>>0}exports.sum64_lo=sum64_lo;function sum64_4_hi(ah,al,bh,bl,ch,cl,dh,dl){var carry=0;var lo=al;lo=lo+bl>>>0;carry+=lo<al?1:0;lo=lo+cl>>>0;carry+=lo<cl?1:0;lo=lo+dl>>>0;carry+=lo<dl?1:0;var hi=ah+bh+ch+dh+carry;return hi>>>0}exports.sum64_4_hi=sum64_4_hi;function sum64_4_lo(ah,al,bh,bl,ch,cl,dh,dl){var lo=al+bl+cl+dl;return lo>>>0}exports.sum64_4_lo=sum64_4_lo;function sum64_5_hi(ah,al,bh,bl,ch,cl,dh,dl,eh,el){var carry=0;var lo=al;lo=lo+bl>>>0;carry+=lo<al?1:0;lo=lo+cl>>>0;carry+=lo<cl?1:0;lo=lo+dl>>>0;carry+=lo<dl?1:0;lo=lo+el>>>0;carry+=lo<el?1:0;var hi=ah+bh+ch+dh+eh+carry;return hi>>>0}exports.sum64_5_hi=sum64_5_hi;function sum64_5_lo(ah,al,bh,bl,ch,cl,dh,dl,eh,el){var lo=al+bl+cl+dl+el;return lo>>>0}exports.sum64_5_lo=sum64_5_lo;function rotr64_hi(ah,al,num){var r=al<<32-num|ah>>>num;return r>>>0}exports.rotr64_hi=rotr64_hi;function rotr64_lo(ah,al,num){var r=ah<<32-num|al>>>num;return r>>>0}exports.rotr64_lo=rotr64_lo;function shr64_hi(ah,al,num){return ah>>>num}exports.shr64_hi=shr64_hi;function shr64_lo(ah,al,num){var r=ah<<32-num|al>>>num;return r>>>0}exports.shr64_lo=shr64_lo},{inherits:233,"minimalistic-assert":291}],227:[function(require,module,exports){"use strict";var call=Function.prototype.call;var $hasOwn=Object.prototype.hasOwnProperty;var bind=require("function-bind");module.exports=bind.call(call,$hasOwn)},{"function-bind":191}],228:[function(require,module,exports){"use strict";var hash=require("hash.js");var utils=require("minimalistic-crypto-utils");var assert=require("minimalistic-assert");function HmacDRBG(options){if(!(this instanceof HmacDRBG))return new HmacDRBG(options);this.hash=options.hash;this.predResist=!!options.predResist;this.outLen=this.hash.outSize;this.minEntropy=options.minEntropy||this.hash.hmacStrength;this._reseed=null;this.reseedInterval=null;this.K=null;this.V=null;var entropy=utils.toArray(options.entropy,options.entropyEnc||"hex");var nonce=utils.toArray(options.nonce,options.nonceEnc||"hex");var pers=utils.toArray(options.pers,options.persEnc||"hex");assert(entropy.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits");this._init(entropy,nonce,pers)}module.exports=HmacDRBG;HmacDRBG.prototype._init=function init(entropy,nonce,pers){var seed=entropy.concat(nonce).concat(pers);this.K=new Array(this.outLen/8);this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++){this.K[i]=0;this.V[i]=1}this._update(seed);this._reseed=1;this.reseedInterval=281474976710656};HmacDRBG.prototype._hmac=function hmac(){return new hash.hmac(this.hash,this.K)};HmacDRBG.prototype._update=function update(seed){var kmac=this._hmac().update(this.V).update([0]);if(seed)kmac=kmac.update(seed);this.K=kmac.digest();this.V=this._hmac().update(this.V).digest();if(!seed)return;this.K=this._hmac().update(this.V).update([1]).update(seed).digest();this.V=this._hmac().update(this.V).digest()};HmacDRBG.prototype.reseed=function reseed(entropy,entropyEnc,add,addEnc){if(typeof entropyEnc!=="string"){addEnc=add;add=entropyEnc;entropyEnc=null}entropy=utils.toArray(entropy,entropyEnc);add=utils.toArray(add,addEnc);assert(entropy.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits");this._update(entropy.concat(add||[]));this._reseed=1};HmacDRBG.prototype.generate=function generate(len,enc,add,addEnc){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");if(typeof enc!=="string"){addEnc=add;add=enc;enc=null}if(add){add=utils.toArray(add,addEnc||"hex");this._update(add)}var temp=[];while(temp.length<len){this.V=this._hmac().update(this.V).digest();temp=temp.concat(this.V)}var res=temp.slice(0,len);this._update(add);this._reseed++;return utils.encode(res,enc)}},{"hash.js":215,"minimalistic-assert":291,"minimalistic-crypto-utils":292}],229:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};Object.defineProperty(exports,"__esModule",{value:true});exports.Parser=void 0;var Tokenizer_js_1=__importStar(require("./Tokenizer.js"));var decode_js_1=require("entities/lib/decode.js");var formTags=new Set(["input","option","optgroup","select","button","datalist","textarea"]);var pTag=new Set(["p"]);var tableSectionTags=new Set(["thead","tbody"]);var ddtTags=new Set(["dd","dt"]);var rtpTags=new Set(["rt","rp"]);var openImpliesClose=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",pTag],["h1",pTag],["h2",pTag],["h3",pTag],["h4",pTag],["h5",pTag],["h6",pTag],["select",formTags],["input",formTags],["output",formTags],["button",formTags],["datalist",formTags],["textarea",formTags],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",ddtTags],["dt",ddtTags],["address",pTag],["article",pTag],["aside",pTag],["blockquote",pTag],["details",pTag],["div",pTag],["dl",pTag],["fieldset",pTag],["figcaption",pTag],["figure",pTag],["footer",pTag],["form",pTag],["header",pTag],["hr",pTag],["main",pTag],["nav",pTag],["ol",pTag],["pre",pTag],["section",pTag],["table",pTag],["ul",pTag],["rt",rtpTags],["rp",rtpTags],["tbody",tableSectionTags],["tfoot",tableSectionTags]]);var voidElements=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);var foreignContextElements=new Set(["math","svg"]);var htmlIntegrationElements=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]);var reNameEnd=/\s|\//;var Parser=function(){function Parser(cbs,options){if(options===void 0){options={}}var _a,_b,_c,_d,_e;this.options=options;this.startIndex=0;this.endIndex=0;this.openTagStart=0;this.tagname="";this.attribname="";this.attribvalue="";this.attribs=null;this.stack=[];this.foreignContext=[];this.buffers=[];this.bufferOffset=0;this.writeIndex=0;this.ended=false;this.cbs=cbs!==null&&cbs!==void 0?cbs:{};this.lowerCaseTagNames=(_a=options.lowerCaseTags)!==null&&_a!==void 0?_a:!options.xmlMode;this.lowerCaseAttributeNames=(_b=options.lowerCaseAttributeNames)!==null&&_b!==void 0?_b:!options.xmlMode;this.tokenizer=new((_c=options.Tokenizer)!==null&&_c!==void 0?_c:Tokenizer_js_1.default)(this.options,this);(_e=(_d=this.cbs).onparserinit)===null||_e===void 0?void 0:_e.call(_d,this)}Parser.prototype.ontext=function(start,endIndex){var _a,_b;var data=this.getSlice(start,endIndex);this.endIndex=endIndex-1;(_b=(_a=this.cbs).ontext)===null||_b===void 0?void 0:_b.call(_a,data);this.startIndex=endIndex};Parser.prototype.ontextentity=function(cp){var _a,_b;var index=this.tokenizer.getSectionStart();this.endIndex=index-1;(_b=(_a=this.cbs).ontext)===null||_b===void 0?void 0:_b.call(_a,(0,decode_js_1.fromCodePoint)(cp));this.startIndex=index};Parser.prototype.isVoidElement=function(name){return!this.options.xmlMode&&voidElements.has(name)};Parser.prototype.onopentagname=function(start,endIndex){this.endIndex=endIndex;var name=this.getSlice(start,endIndex);if(this.lowerCaseTagNames){name=name.toLowerCase()}this.emitOpenTag(name)};Parser.prototype.emitOpenTag=function(name){var _a,_b,_c,_d;this.openTagStart=this.startIndex;this.tagname=name;var impliesClose=!this.options.xmlMode&&openImpliesClose.get(name);if(impliesClose){while(this.stack.length>0&&impliesClose.has(this.stack[this.stack.length-1])){var element=this.stack.pop();(_b=(_a=this.cbs).onclosetag)===null||_b===void 0?void 0:_b.call(_a,element,true)}}if(!this.isVoidElement(name)){this.stack.push(name);if(foreignContextElements.has(name)){this.foreignContext.push(true)}else if(htmlIntegrationElements.has(name)){this.foreignContext.push(false)}}(_d=(_c=this.cbs).onopentagname)===null||_d===void 0?void 0:_d.call(_c,name);if(this.cbs.onopentag)this.attribs={}};Parser.prototype.endOpenTag=function(isImplied){var _a,_b;this.startIndex=this.openTagStart;if(this.attribs){(_b=(_a=this.cbs).onopentag)===null||_b===void 0?void 0:_b.call(_a,this.tagname,this.attribs,isImplied);this.attribs=null}if(this.cbs.onclosetag&&this.isVoidElement(this.tagname)){this.cbs.onclosetag(this.tagname,true)}this.tagname=""};Parser.prototype.onopentagend=function(endIndex){this.endIndex=endIndex;this.endOpenTag(false);this.startIndex=endIndex+1};Parser.prototype.onclosetag=function(start,endIndex){var _a,_b,_c,_d,_e,_f;this.endIndex=endIndex;var name=this.getSlice(start,endIndex);if(this.lowerCaseTagNames){name=name.toLowerCase()}if(foreignContextElements.has(name)||htmlIntegrationElements.has(name)){this.foreignContext.pop()}if(!this.isVoidElement(name)){var pos=this.stack.lastIndexOf(name);if(pos!==-1){if(this.cbs.onclosetag){var count=this.stack.length-pos;while(count--){this.cbs.onclosetag(this.stack.pop(),count!==0)}}else this.stack.length=pos}else if(!this.options.xmlMode&&name==="p"){this.emitOpenTag("p");this.closeCurrentTag(true)}}else if(!this.options.xmlMode&&name==="br"){(_b=(_a=this.cbs).onopentagname)===null||_b===void 0?void 0:_b.call(_a,"br");(_d=(_c=this.cbs).onopentag)===null||_d===void 0?void 0:_d.call(_c,"br",{},true);(_f=(_e=this.cbs).onclosetag)===null||_f===void 0?void 0:_f.call(_e,"br",false)}this.startIndex=endIndex+1};Parser.prototype.onselfclosingtag=function(endIndex){this.endIndex=endIndex;if(this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]){this.closeCurrentTag(false);this.startIndex=endIndex+1}else{this.onopentagend(endIndex)}};Parser.prototype.closeCurrentTag=function(isOpenImplied){var _a,_b;var name=this.tagname;this.endOpenTag(isOpenImplied);if(this.stack[this.stack.length-1]===name){(_b=(_a=this.cbs).onclosetag)===null||_b===void 0?void 0:_b.call(_a,name,!isOpenImplied);this.stack.pop()}};Parser.prototype.onattribname=function(start,endIndex){this.startIndex=start;var name=this.getSlice(start,endIndex);this.attribname=this.lowerCaseAttributeNames?name.toLowerCase():name};Parser.prototype.onattribdata=function(start,endIndex){this.attribvalue+=this.getSlice(start,endIndex)};Parser.prototype.onattribentity=function(cp){this.attribvalue+=(0,decode_js_1.fromCodePoint)(cp)};Parser.prototype.onattribend=function(quote,endIndex){var _a,_b;this.endIndex=endIndex;(_b=(_a=this.cbs).onattribute)===null||_b===void 0?void 0:_b.call(_a,this.attribname,this.attribvalue,quote===Tokenizer_js_1.QuoteType.Double?'"':quote===Tokenizer_js_1.QuoteType.Single?"'":quote===Tokenizer_js_1.QuoteType.NoValue?undefined:null);if(this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)){this.attribs[this.attribname]=this.attribvalue}this.attribvalue=""};Parser.prototype.getInstructionName=function(value){var index=value.search(reNameEnd);var name=index<0?value:value.substr(0,index);if(this.lowerCaseTagNames){name=name.toLowerCase()}return name};Parser.prototype.ondeclaration=function(start,endIndex){this.endIndex=endIndex;var value=this.getSlice(start,endIndex);if(this.cbs.onprocessinginstruction){var name=this.getInstructionName(value);this.cbs.onprocessinginstruction("!".concat(name),"!".concat(value))}this.startIndex=endIndex+1};Parser.prototype.onprocessinginstruction=function(start,endIndex){this.endIndex=endIndex;var value=this.getSlice(start,endIndex);if(this.cbs.onprocessinginstruction){var name=this.getInstructionName(value);this.cbs.onprocessinginstruction("?".concat(name),"?".concat(value))}this.startIndex=endIndex+1};Parser.prototype.oncomment=function(start,endIndex,offset){var _a,_b,_c,_d;this.endIndex=endIndex;(_b=(_a=this.cbs).oncomment)===null||_b===void 0?void 0:_b.call(_a,this.getSlice(start,endIndex-offset));(_d=(_c=this.cbs).oncommentend)===null||_d===void 0?void 0:_d.call(_c);this.startIndex=endIndex+1};Parser.prototype.oncdata=function(start,endIndex,offset){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k;this.endIndex=endIndex;var value=this.getSlice(start,endIndex-offset);if(this.options.xmlMode||this.options.recognizeCDATA){(_b=(_a=this.cbs).oncdatastart)===null||_b===void 0?void 0:_b.call(_a);(_d=(_c=this.cbs).ontext)===null||_d===void 0?void 0:_d.call(_c,value);(_f=(_e=this.cbs).oncdataend)===null||_f===void 0?void 0:_f.call(_e)}else{(_h=(_g=this.cbs).oncomment)===null||_h===void 0?void 0:_h.call(_g,"[CDATA[".concat(value,"]]"));(_k=(_j=this.cbs).oncommentend)===null||_k===void 0?void 0:_k.call(_j)}this.startIndex=endIndex+1};Parser.prototype.onend=function(){var _a,_b;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var index=this.stack.length;index>0;this.cbs.onclosetag(this.stack[--index],true));}(_b=(_a=this.cbs).onend)===null||_b===void 0?void 0:_b.call(_a)};Parser.prototype.reset=function(){var _a,_b,_c,_d;(_b=(_a=this.cbs).onreset)===null||_b===void 0?void 0:_b.call(_a);this.tokenizer.reset();this.tagname="";this.attribname="";this.attribs=null;this.stack.length=0;this.startIndex=0;this.endIndex=0;(_d=(_c=this.cbs).onparserinit)===null||_d===void 0?void 0:_d.call(_c,this);this.buffers.length=0;this.bufferOffset=0;this.writeIndex=0;this.ended=false};Parser.prototype.parseComplete=function(data){this.reset();this.end(data)};Parser.prototype.getSlice=function(start,end){while(start-this.bufferOffset>=this.buffers[0].length){this.shiftBuffer()}var slice=this.buffers[0].slice(start-this.bufferOffset,end-this.bufferOffset);while(end-this.bufferOffset>this.buffers[0].length){this.shiftBuffer();slice+=this.buffers[0].slice(0,end-this.bufferOffset)}return slice};Parser.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length;this.writeIndex--;this.buffers.shift()};Parser.prototype.write=function(chunk){var _a,_b;if(this.ended){(_b=(_a=this.cbs).onerror)===null||_b===void 0?void 0:_b.call(_a,new Error(".write() after done!"));return}this.buffers.push(chunk);if(this.tokenizer.running){this.tokenizer.write(chunk);this.writeIndex++}};Parser.prototype.end=function(chunk){var _a,_b;if(this.ended){(_b=(_a=this.cbs).onerror)===null||_b===void 0?void 0:_b.call(_a,new Error(".end() after done!"));return}if(chunk)this.write(chunk);this.ended=true;this.tokenizer.end()};Parser.prototype.pause=function(){this.tokenizer.pause()};Parser.prototype.resume=function(){this.tokenizer.resume();while(this.tokenizer.running&&this.writeIndex<this.buffers.length){this.tokenizer.write(this.buffers[this.writeIndex++])}if(this.ended)this.tokenizer.end()};Parser.prototype.parseChunk=function(chunk){this.write(chunk)};Parser.prototype.done=function(chunk){this.end(chunk)};return Parser}();exports.Parser=Parser},{"./Tokenizer.js":230,"entities/lib/decode.js":179}],230:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.QuoteType=void 0;var decode_js_1=require("entities/lib/decode.js");var CharCodes;(function(CharCodes){CharCodes[CharCodes["Tab"]=9]="Tab";CharCodes[CharCodes["NewLine"]=10]="NewLine";CharCodes[CharCodes["FormFeed"]=12]="FormFeed";CharCodes[CharCodes["CarriageReturn"]=13]="CarriageReturn";CharCodes[CharCodes["Space"]=32]="Space";CharCodes[CharCodes["ExclamationMark"]=33]="ExclamationMark";CharCodes[CharCodes["Number"]=35]="Number";CharCodes[CharCodes["Amp"]=38]="Amp";CharCodes[CharCodes["SingleQuote"]=39]="SingleQuote";CharCodes[CharCodes["DoubleQuote"]=34]="DoubleQuote";CharCodes[CharCodes["Dash"]=45]="Dash";CharCodes[CharCodes["Slash"]=47]="Slash";CharCodes[CharCodes["Zero"]=48]="Zero";CharCodes[CharCodes["Nine"]=57]="Nine";CharCodes[CharCodes["Semi"]=59]="Semi";CharCodes[CharCodes["Lt"]=60]="Lt";CharCodes[CharCodes["Eq"]=61]="Eq";CharCodes[CharCodes["Gt"]=62]="Gt";CharCodes[CharCodes["Questionmark"]=63]="Questionmark";CharCodes[CharCodes["UpperA"]=65]="UpperA";CharCodes[CharCodes["LowerA"]=97]="LowerA";CharCodes[CharCodes["UpperF"]=70]="UpperF";CharCodes[CharCodes["LowerF"]=102]="LowerF";CharCodes[CharCodes["UpperZ"]=90]="UpperZ";CharCodes[CharCodes["LowerZ"]=122]="LowerZ";CharCodes[CharCodes["LowerX"]=120]="LowerX";CharCodes[CharCodes["OpeningSquareBracket"]=91]="OpeningSquareBracket"})(CharCodes||(CharCodes={}));var State;(function(State){State[State["Text"]=1]="Text";State[State["BeforeTagName"]=2]="BeforeTagName";State[State["InTagName"]=3]="InTagName";State[State["InSelfClosingTag"]=4]="InSelfClosingTag";State[State["BeforeClosingTagName"]=5]="BeforeClosingTagName";State[State["InClosingTagName"]=6]="InClosingTagName";State[State["AfterClosingTagName"]=7]="AfterClosingTagName";State[State["BeforeAttributeName"]=8]="BeforeAttributeName";State[State["InAttributeName"]=9]="InAttributeName";State[State["AfterAttributeName"]=10]="AfterAttributeName";State[State["BeforeAttributeValue"]=11]="BeforeAttributeValue";State[State["InAttributeValueDq"]=12]="InAttributeValueDq";State[State["InAttributeValueSq"]=13]="InAttributeValueSq";State[State["InAttributeValueNq"]=14]="InAttributeValueNq";State[State["BeforeDeclaration"]=15]="BeforeDeclaration";State[State["InDeclaration"]=16]="InDeclaration";State[State["InProcessingInstruction"]=17]="InProcessingInstruction";State[State["BeforeComment"]=18]="BeforeComment";State[State["CDATASequence"]=19]="CDATASequence";State[State["InSpecialComment"]=20]="InSpecialComment";State[State["InCommentLike"]=21]="InCommentLike";State[State["BeforeSpecialS"]=22]="BeforeSpecialS";State[State["SpecialStartSequence"]=23]="SpecialStartSequence";State[State["InSpecialTag"]=24]="InSpecialTag";State[State["BeforeEntity"]=25]="BeforeEntity";State[State["BeforeNumericEntity"]=26]="BeforeNumericEntity";State[State["InNamedEntity"]=27]="InNamedEntity";State[State["InNumericEntity"]=28]="InNumericEntity";State[State["InHexEntity"]=29]="InHexEntity"})(State||(State={}));function isWhitespace(c){return c===CharCodes.Space||c===CharCodes.NewLine||c===CharCodes.Tab||c===CharCodes.FormFeed||c===CharCodes.CarriageReturn}function isEndOfTagSection(c){return c===CharCodes.Slash||c===CharCodes.Gt||isWhitespace(c)}function isNumber(c){return c>=CharCodes.Zero&&c<=CharCodes.Nine}function isASCIIAlpha(c){return c>=CharCodes.LowerA&&c<=CharCodes.LowerZ||c>=CharCodes.UpperA&&c<=CharCodes.UpperZ}function isHexDigit(c){return c>=CharCodes.UpperA&&c<=CharCodes.UpperF||c>=CharCodes.LowerA&&c<=CharCodes.LowerF}var QuoteType;(function(QuoteType){QuoteType[QuoteType["NoValue"]=0]="NoValue";QuoteType[QuoteType["Unquoted"]=1]="Unquoted";QuoteType[QuoteType["Single"]=2]="Single";QuoteType[QuoteType["Double"]=3]="Double"})(QuoteType=exports.QuoteType||(exports.QuoteType={}));var Sequences={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])};var Tokenizer=function(){function Tokenizer(_a,cbs){var _b=_a.xmlMode,xmlMode=_b===void 0?false:_b,_c=_a.decodeEntities,decodeEntities=_c===void 0?true:_c;this.cbs=cbs;this.state=State.Text;this.buffer="";this.sectionStart=0;this.index=0;this.baseState=State.Text;this.isSpecial=false;this.running=true;this.offset=0;this.currentSequence=undefined;this.sequenceIndex=0;this.trieIndex=0;this.trieCurrent=0;this.entityResult=0;this.entityExcess=0;this.xmlMode=xmlMode;this.decodeEntities=decodeEntities;this.entityTrie=xmlMode?decode_js_1.xmlDecodeTree:decode_js_1.htmlDecodeTree}Tokenizer.prototype.reset=function(){this.state=State.Text;this.buffer="";this.sectionStart=0;this.index=0;this.baseState=State.Text;this.currentSequence=undefined;this.running=true;this.offset=0};Tokenizer.prototype.write=function(chunk){this.offset+=this.buffer.length;this.buffer=chunk;this.parse()};Tokenizer.prototype.end=function(){if(this.running)this.finish()};Tokenizer.prototype.pause=function(){this.running=false};Tokenizer.prototype.resume=function(){this.running=true;if(this.index<this.buffer.length+this.offset){this.parse()}};Tokenizer.prototype.getIndex=function(){return this.index};Tokenizer.prototype.getSectionStart=function(){return this.sectionStart};Tokenizer.prototype.stateText=function(c){if(c===CharCodes.Lt||!this.decodeEntities&&this.fastForwardTo(CharCodes.Lt)){if(this.index>this.sectionStart){this.cbs.ontext(this.sectionStart,this.index)}this.state=State.BeforeTagName;this.sectionStart=this.index}else if(this.decodeEntities&&c===CharCodes.Amp){this.state=State.BeforeEntity}};Tokenizer.prototype.stateSpecialStartSequence=function(c){var isEnd=this.sequenceIndex===this.currentSequence.length;var isMatch=isEnd?isEndOfTagSection(c):(c|32)===this.currentSequence[this.sequenceIndex];if(!isMatch){this.isSpecial=false}else if(!isEnd){this.sequenceIndex++;return}this.sequenceIndex=0;this.state=State.InTagName;this.stateInTagName(c)};Tokenizer.prototype.stateInSpecialTag=function(c){if(this.sequenceIndex===this.currentSequence.length){if(c===CharCodes.Gt||isWhitespace(c)){var endOfText=this.index-this.currentSequence.length;if(this.sectionStart<endOfText){var actualIndex=this.index;this.index=endOfText;this.cbs.ontext(this.sectionStart,endOfText);this.index=actualIndex}this.isSpecial=false;this.sectionStart=endOfText+2;this.stateInClosingTagName(c);return}this.sequenceIndex=0}if((c|32)===this.currentSequence[this.sequenceIndex]){this.sequenceIndex+=1}else if(this.sequenceIndex===0){if(this.currentSequence===Sequences.TitleEnd){if(this.decodeEntities&&c===CharCodes.Amp){this.state=State.BeforeEntity}}else if(this.fastForwardTo(CharCodes.Lt)){this.sequenceIndex=1}}else{this.sequenceIndex=Number(c===CharCodes.Lt)}};Tokenizer.prototype.stateCDATASequence=function(c){if(c===Sequences.Cdata[this.sequenceIndex]){if(++this.sequenceIndex===Sequences.Cdata.length){this.state=State.InCommentLike;this.currentSequence=Sequences.CdataEnd;this.sequenceIndex=0;this.sectionStart=this.index+1}}else{this.sequenceIndex=0;this.state=State.InDeclaration;this.stateInDeclaration(c)}};Tokenizer.prototype.fastForwardTo=function(c){while(++this.index<this.buffer.length+this.offset){if(this.buffer.charCodeAt(this.index-this.offset)===c){return true}}this.index=this.buffer.length+this.offset-1;return false};Tokenizer.prototype.stateInCommentLike=function(c){if(c===this.currentSequence[this.sequenceIndex]){if(++this.sequenceIndex===this.currentSequence.length){if(this.currentSequence===Sequences.CdataEnd){this.cbs.oncdata(this.sectionStart,this.index,2)}else{this.cbs.oncomment(this.sectionStart,this.index,2)}this.sequenceIndex=0;this.sectionStart=this.index+1;this.state=State.Text}}else if(this.sequenceIndex===0){if(this.fastForwardTo(this.currentSequence[0])){this.sequenceIndex=1}}else if(c!==this.currentSequence[this.sequenceIndex-1]){this.sequenceIndex=0}};Tokenizer.prototype.isTagStartChar=function(c){return this.xmlMode?!isEndOfTagSection(c):isASCIIAlpha(c)};Tokenizer.prototype.startSpecial=function(sequence,offset){this.isSpecial=true;this.currentSequence=sequence;this.sequenceIndex=offset;this.state=State.SpecialStartSequence};Tokenizer.prototype.stateBeforeTagName=function(c){if(c===CharCodes.ExclamationMark){this.state=State.BeforeDeclaration;this.sectionStart=this.index+1}else if(c===CharCodes.Questionmark){this.state=State.InProcessingInstruction;this.sectionStart=this.index+1}else if(this.isTagStartChar(c)){var lower=c|32;this.sectionStart=this.index;if(!this.xmlMode&&lower===Sequences.TitleEnd[2]){this.startSpecial(Sequences.TitleEnd,3)}else{this.state=!this.xmlMode&&lower===Sequences.ScriptEnd[2]?State.BeforeSpecialS:State.InTagName}}else if(c===CharCodes.Slash){this.state=State.BeforeClosingTagName}else{this.state=State.Text;this.stateText(c)}};Tokenizer.prototype.stateInTagName=function(c){if(isEndOfTagSection(c)){this.cbs.onopentagname(this.sectionStart,this.index);this.sectionStart=-1;this.state=State.BeforeAttributeName;this.stateBeforeAttributeName(c)}};Tokenizer.prototype.stateBeforeClosingTagName=function(c){if(isWhitespace(c)){}else if(c===CharCodes.Gt){this.state=State.Text}else{this.state=this.isTagStartChar(c)?State.InClosingTagName:State.InSpecialComment;this.sectionStart=this.index}};Tokenizer.prototype.stateInClosingTagName=function(c){if(c===CharCodes.Gt||isWhitespace(c)){this.cbs.onclosetag(this.sectionStart,this.index);this.sectionStart=-1;this.state=State.AfterClosingTagName;this.stateAfterClosingTagName(c)}};Tokenizer.prototype.stateAfterClosingTagName=function(c){if(c===CharCodes.Gt||this.fastForwardTo(CharCodes.Gt)){this.state=State.Text;this.baseState=State.Text;this.sectionStart=this.index+1}};Tokenizer.prototype.stateBeforeAttributeName=function(c){if(c===CharCodes.Gt){this.cbs.onopentagend(this.index);if(this.isSpecial){this.state=State.InSpecialTag;this.sequenceIndex=0}else{this.state=State.Text}this.baseState=this.state;this.sectionStart=this.index+1}else if(c===CharCodes.Slash){this.state=State.InSelfClosingTag}else if(!isWhitespace(c)){this.state=State.InAttributeName;this.sectionStart=this.index}};Tokenizer.prototype.stateInSelfClosingTag=function(c){if(c===CharCodes.Gt){this.cbs.onselfclosingtag(this.index);this.state=State.Text;this.baseState=State.Text;this.sectionStart=this.index+1;this.isSpecial=false}else if(!isWhitespace(c)){this.state=State.BeforeAttributeName;this.stateBeforeAttributeName(c)}};Tokenizer.prototype.stateInAttributeName=function(c){if(c===CharCodes.Eq||isEndOfTagSection(c)){this.cbs.onattribname(this.sectionStart,this.index);this.sectionStart=-1;this.state=State.AfterAttributeName;this.stateAfterAttributeName(c)}};Tokenizer.prototype.stateAfterAttributeName=function(c){if(c===CharCodes.Eq){this.state=State.BeforeAttributeValue}else if(c===CharCodes.Slash||c===CharCodes.Gt){this.cbs.onattribend(QuoteType.NoValue,this.index);this.state=State.BeforeAttributeName;this.stateBeforeAttributeName(c)}else if(!isWhitespace(c)){this.cbs.onattribend(QuoteType.NoValue,this.index);this.state=State.InAttributeName;this.sectionStart=this.index}};Tokenizer.prototype.stateBeforeAttributeValue=function(c){if(c===CharCodes.DoubleQuote){this.state=State.InAttributeValueDq;this.sectionStart=this.index+1}else if(c===CharCodes.SingleQuote){this.state=State.InAttributeValueSq;this.sectionStart=this.index+1}else if(!isWhitespace(c)){this.sectionStart=this.index;this.state=State.InAttributeValueNq;this.stateInAttributeValueNoQuotes(c)}};Tokenizer.prototype.handleInAttributeValue=function(c,quote){if(c===quote||!this.decodeEntities&&this.fastForwardTo(quote)){this.cbs.onattribdata(this.sectionStart,this.index);this.sectionStart=-1;this.cbs.onattribend(quote===CharCodes.DoubleQuote?QuoteType.Double:QuoteType.Single,this.index);this.state=State.BeforeAttributeName}else if(this.decodeEntities&&c===CharCodes.Amp){this.baseState=this.state;this.state=State.BeforeEntity}};Tokenizer.prototype.stateInAttributeValueDoubleQuotes=function(c){this.handleInAttributeValue(c,CharCodes.DoubleQuote)};Tokenizer.prototype.stateInAttributeValueSingleQuotes=function(c){this.handleInAttributeValue(c,CharCodes.SingleQuote)};Tokenizer.prototype.stateInAttributeValueNoQuotes=function(c){if(isWhitespace(c)||c===CharCodes.Gt){this.cbs.onattribdata(this.sectionStart,this.index);this.sectionStart=-1;this.cbs.onattribend(QuoteType.Unquoted,this.index);this.state=State.BeforeAttributeName;this.stateBeforeAttributeName(c)}else if(this.decodeEntities&&c===CharCodes.Amp){this.baseState=this.state;this.state=State.BeforeEntity}};Tokenizer.prototype.stateBeforeDeclaration=function(c){if(c===CharCodes.OpeningSquareBracket){this.state=State.CDATASequence;this.sequenceIndex=0}else{this.state=c===CharCodes.Dash?State.BeforeComment:State.InDeclaration}};Tokenizer.prototype.stateInDeclaration=function(c){if(c===CharCodes.Gt||this.fastForwardTo(CharCodes.Gt)){this.cbs.ondeclaration(this.sectionStart,this.index);this.state=State.Text;this.sectionStart=this.index+1}};Tokenizer.prototype.stateInProcessingInstruction=function(c){if(c===CharCodes.Gt||this.fastForwardTo(CharCodes.Gt)){this.cbs.onprocessinginstruction(this.sectionStart,this.index);this.state=State.Text;this.sectionStart=this.index+1}};Tokenizer.prototype.stateBeforeComment=function(c){if(c===CharCodes.Dash){this.state=State.InCommentLike;this.currentSequence=Sequences.CommentEnd;this.sequenceIndex=2;this.sectionStart=this.index+1}else{this.state=State.InDeclaration}};Tokenizer.prototype.stateInSpecialComment=function(c){if(c===CharCodes.Gt||this.fastForwardTo(CharCodes.Gt)){this.cbs.oncomment(this.sectionStart,this.index,0);this.state=State.Text;this.sectionStart=this.index+1}};Tokenizer.prototype.stateBeforeSpecialS=function(c){var lower=c|32;if(lower===Sequences.ScriptEnd[3]){this.startSpecial(Sequences.ScriptEnd,4)}else if(lower===Sequences.StyleEnd[3]){this.startSpecial(Sequences.StyleEnd,4)}else{this.state=State.InTagName;this.stateInTagName(c)}};Tokenizer.prototype.stateBeforeEntity=function(c){this.entityExcess=1;this.entityResult=0;if(c===CharCodes.Number){this.state=State.BeforeNumericEntity}else if(c===CharCodes.Amp){}else{this.trieIndex=0;this.trieCurrent=this.entityTrie[0];this.state=State.InNamedEntity;this.stateInNamedEntity(c)}};Tokenizer.prototype.stateInNamedEntity=function(c){this.entityExcess+=1;this.trieIndex=(0,decode_js_1.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,c);if(this.trieIndex<0){this.emitNamedEntity();this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var masked=this.trieCurrent&decode_js_1.BinTrieFlags.VALUE_LENGTH;if(masked){var valueLength=(masked>>14)-1;if(!this.allowLegacyEntity()&&c!==CharCodes.Semi){this.trieIndex+=valueLength}else{var entityStart=this.index-this.entityExcess+1;if(entityStart>this.sectionStart){this.emitPartial(this.sectionStart,entityStart)}this.entityResult=this.trieIndex;this.trieIndex+=valueLength;this.entityExcess=0;this.sectionStart=this.index+1;if(valueLength===0){this.emitNamedEntity()}}}};Tokenizer.prototype.emitNamedEntity=function(){this.state=this.baseState;if(this.entityResult===0){return}var valueLength=(this.entityTrie[this.entityResult]&decode_js_1.BinTrieFlags.VALUE_LENGTH)>>14;switch(valueLength){case 1:{this.emitCodePoint(this.entityTrie[this.entityResult]&~decode_js_1.BinTrieFlags.VALUE_LENGTH);break}case 2:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);break}case 3:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);this.emitCodePoint(this.entityTrie[this.entityResult+2])}}};Tokenizer.prototype.stateBeforeNumericEntity=function(c){if((c|32)===CharCodes.LowerX){this.entityExcess++;this.state=State.InHexEntity}else{this.state=State.InNumericEntity;this.stateInNumericEntity(c)}};Tokenizer.prototype.emitNumericEntity=function(strict){var entityStart=this.index-this.entityExcess-1;var numberStart=entityStart+2+Number(this.state===State.InHexEntity);if(numberStart!==this.index){if(entityStart>this.sectionStart){this.emitPartial(this.sectionStart,entityStart)}this.sectionStart=this.index+Number(strict);this.emitCodePoint((0,decode_js_1.replaceCodePoint)(this.entityResult))}this.state=this.baseState};Tokenizer.prototype.stateInNumericEntity=function(c){if(c===CharCodes.Semi){this.emitNumericEntity(true)}else if(isNumber(c)){this.entityResult=this.entityResult*10+(c-CharCodes.Zero);this.entityExcess++}else{if(this.allowLegacyEntity()){this.emitNumericEntity(false)}else{this.state=this.baseState}this.index--}};Tokenizer.prototype.stateInHexEntity=function(c){if(c===CharCodes.Semi){this.emitNumericEntity(true)}else if(isNumber(c)){this.entityResult=this.entityResult*16+(c-CharCodes.Zero);this.entityExcess++}else if(isHexDigit(c)){this.entityResult=this.entityResult*16+((c|32)-CharCodes.LowerA+10);this.entityExcess++}else{if(this.allowLegacyEntity()){this.emitNumericEntity(false)}else{this.state=this.baseState}this.index--}};Tokenizer.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===State.Text||this.baseState===State.InSpecialTag)};Tokenizer.prototype.cleanup=function(){if(this.running&&this.sectionStart!==this.index){if(this.state===State.Text||this.state===State.InSpecialTag&&this.sequenceIndex===0){this.cbs.ontext(this.sectionStart,this.index);this.sectionStart=this.index}else if(this.state===State.InAttributeValueDq||this.state===State.InAttributeValueSq||this.state===State.InAttributeValueNq){this.cbs.onattribdata(this.sectionStart,this.index);this.sectionStart=this.index}}};Tokenizer.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running};Tokenizer.prototype.parse=function(){while(this.shouldContinue()){var c=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case State.Text:{this.stateText(c);break}case State.SpecialStartSequence:{this.stateSpecialStartSequence(c);break}case State.InSpecialTag:{this.stateInSpecialTag(c);break}case State.CDATASequence:{this.stateCDATASequence(c);break}case State.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(c);break}case State.InAttributeName:{this.stateInAttributeName(c);break}case State.InCommentLike:{this.stateInCommentLike(c);break}case State.InSpecialComment:{this.stateInSpecialComment(c);break}case State.BeforeAttributeName:{this.stateBeforeAttributeName(c);break}case State.InTagName:{this.stateInTagName(c);break}case State.InClosingTagName:{this.stateInClosingTagName(c);break}case State.BeforeTagName:{this.stateBeforeTagName(c);break}case State.AfterAttributeName:{this.stateAfterAttributeName(c);break}case State.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(c);break}case State.BeforeAttributeValue:{this.stateBeforeAttributeValue(c);break}case State.BeforeClosingTagName:{this.stateBeforeClosingTagName(c);break}case State.AfterClosingTagName:{this.stateAfterClosingTagName(c);break}case State.BeforeSpecialS:{this.stateBeforeSpecialS(c);break}case State.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(c);break}case State.InSelfClosingTag:{this.stateInSelfClosingTag(c);break}case State.InDeclaration:{this.stateInDeclaration(c);break}case State.BeforeDeclaration:{this.stateBeforeDeclaration(c);break}case State.BeforeComment:{this.stateBeforeComment(c);break}case State.InProcessingInstruction:{this.stateInProcessingInstruction(c);break}case State.InNamedEntity:{this.stateInNamedEntity(c);break}case State.BeforeEntity:{this.stateBeforeEntity(c);break}case State.InHexEntity:{this.stateInHexEntity(c);break}case State.InNumericEntity:{this.stateInNumericEntity(c);break}default:{this.stateBeforeNumericEntity(c)}}this.index++}this.cleanup()};Tokenizer.prototype.finish=function(){if(this.state===State.InNamedEntity){this.emitNamedEntity()}if(this.sectionStart<this.index){this.handleTrailingData()}this.cbs.onend()};Tokenizer.prototype.handleTrailingData=function(){var endIndex=this.buffer.length+this.offset;if(this.state===State.InCommentLike){if(this.currentSequence===Sequences.CdataEnd){this.cbs.oncdata(this.sectionStart,endIndex,0)}else{this.cbs.oncomment(this.sectionStart,endIndex,0)}}else if(this.state===State.InNumericEntity&&this.allowLegacyEntity()){this.emitNumericEntity(false)}else if(this.state===State.InHexEntity&&this.allowLegacyEntity()){this.emitNumericEntity(false)}else if(this.state===State.InTagName||this.state===State.BeforeAttributeName||this.state===State.BeforeAttributeValue||this.state===State.AfterAttributeName||this.state===State.InAttributeName||this.state===State.InAttributeValueSq||this.state===State.InAttributeValueDq||this.state===State.InAttributeValueNq||this.state===State.InClosingTagName){}else{this.cbs.ontext(this.sectionStart,endIndex)}};Tokenizer.prototype.emitPartial=function(start,endIndex){if(this.baseState!==State.Text&&this.baseState!==State.InSpecialTag){this.cbs.onattribdata(start,endIndex)}else{this.cbs.ontext(start,endIndex)}};Tokenizer.prototype.emitCodePoint=function(cp){if(this.baseState!==State.Text&&this.baseState!==State.InSpecialTag){this.cbs.onattribentity(cp)}else{this.cbs.ontextentity(cp)}};return Tokenizer}();exports.default=Tokenizer},{"entities/lib/decode.js":179}],231:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.DomUtils=exports.parseFeed=exports.getFeed=exports.ElementType=exports.Tokenizer=exports.createDomStream=exports.parseDOM=exports.parseDocument=exports.DefaultHandler=exports.DomHandler=exports.Parser=void 0;var Parser_js_1=require("./Parser.js");var Parser_js_2=require("./Parser.js");Object.defineProperty(exports,"Parser",{enumerable:true,get:function(){return Parser_js_2.Parser}});var domhandler_1=require("domhandler");var domhandler_2=require("domhandler");Object.defineProperty(exports,"DomHandler",{enumerable:true,get:function(){return domhandler_2.DomHandler}});Object.defineProperty(exports,"DefaultHandler",{enumerable:true,get:function(){return domhandler_2.DomHandler}});function parseDocument(data,options){var handler=new domhandler_1.DomHandler(undefined,options);new Parser_js_1.Parser(handler,options).end(data);return handler.root}exports.parseDocument=parseDocument;function parseDOM(data,options){return parseDocument(data,options).children}exports.parseDOM=parseDOM;function createDomStream(callback,options,elementCallback){var handler=new domhandler_1.DomHandler(callback,options,elementCallback);return new Parser_js_1.Parser(handler,options)}exports.createDomStream=createDomStream;var Tokenizer_js_1=require("./Tokenizer.js");Object.defineProperty(exports,"Tokenizer",{enumerable:true,get:function(){return __importDefault(Tokenizer_js_1).default}});exports.ElementType=__importStar(require("domelementtype"));var domutils_1=require("domutils");var domutils_2=require("domutils");Object.defineProperty(exports,"getFeed",{enumerable:true,get:function(){return domutils_2.getFeed}});var parseFeedDefaultOptions={xmlMode:true};function parseFeed(feed,options){if(options===void 0){options=parseFeedDefaultOptions}return(0,domutils_1.getFeed)(parseDOM(feed,options))}exports.parseFeed=parseFeed;exports.DomUtils=__importStar(require("domutils"))},{"./Parser.js":229,"./Tokenizer.js":230,domelementtype:151,domhandler:152,domutils:156}],232:[function(require,module,exports){var http=require("http");var url=require("url");var https=module.exports;for(var key in http){if(http.hasOwnProperty(key))https[key]=http[key]}https.request=function(params,cb){params=validateParams(params);return http.request.call(this,params,cb)};https.get=function(params,cb){params=validateParams(params);return http.get.call(this,params,cb)};function validateParams(params){if(typeof params==="string"){params=url.parse(params)}if(!params.protocol){params.protocol="https:"}if(params.protocol!=="https:"){throw new Error('Protocol "'+params.protocol+'" not supported. Expected "https:"')}return params}},{http:413,url:439}],233:[function(require,module,exports){if(typeof Object.create==="function"){module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:false,writable:true,configurable:true}})}}}else{module.exports=function inherits(ctor,superCtor){if(superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype;ctor.prototype=new TempCtor;ctor.prototype.constructor=ctor}}}},{}],234:[function(require,module,exports){"use strict";var hasToStringTag=require("has-tostringtag/shams")();var callBound=require("call-bind/callBound");var $toString=callBound("Object.prototype.toString");var isStandardArguments=function isArguments(value){if(hasToStringTag&&value&&typeof value==="object"&&Symbol.toStringTag in value){return false}return $toString(value)==="[object Arguments]"};var isLegacyArguments=function isArguments(value){if(isStandardArguments(value)){return true}return value!==null&&typeof value==="object"&&typeof value.length==="number"&&value.length>=0&&$toString(value)!=="[object Array]"&&$toString(value.callee)==="[object Function]"};var supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments;module.exports=supportsStandardArguments?isStandardArguments:isLegacyArguments},{"call-bind/callBound":92,"has-tostringtag/shams":198}],235:[function(require,module,exports){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
module.exports=function(obj){return obj!=null&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)};function isBuffer(obj){return!!obj.constructor&&typeof obj.constructor.isBuffer==="function"&&obj.constructor.isBuffer(obj)}function isSlowBuffer(obj){return typeof obj.readFloatLE==="function"&&typeof obj.slice==="function"&&isBuffer(obj.slice(0,0))}},{}],236:[function(require,module,exports){"use strict";var fnToStr=Function.prototype.toString;var reflectApply=typeof Reflect==="object"&&Reflect!==null&&Reflect.apply;var badArrayLike;var isCallableMarker;if(typeof reflectApply==="function"&&typeof Object.defineProperty==="function"){try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}});isCallableMarker={};reflectApply((function(){throw 42}),null,badArrayLike)}catch(_){if(_!==isCallableMarker){reflectApply=null}}}else{reflectApply=null}var constructorRegex=/^\s*class\b/;var isES6ClassFn=function isES6ClassFunction(value){try{var fnStr=fnToStr.call(value);return constructorRegex.test(fnStr)}catch(e){return false}};var tryFunctionObject=function tryFunctionToStr(value){try{if(isES6ClassFn(value)){return false}fnToStr.call(value);return true}catch(e){return false}};var toStr=Object.prototype.toString;var objectClass="[object Object]";var fnClass="[object Function]";var genClass="[object GeneratorFunction]";var ddaClass="[object HTMLAllCollection]";var ddaClass2="[object HTML document.all class]";var ddaClass3="[object HTMLCollection]";var hasToStringTag=typeof Symbol==="function"&&!!Symbol.toStringTag;var isIE68=!(0 in[,]);var isDDA=function isDocumentDotAll(){return false};if(typeof document==="object"){var all=document.all;if(toStr.call(all)===toStr.call(document.all)){isDDA=function isDocumentDotAll(value){if((isIE68||!value)&&(typeof value==="undefined"||typeof value==="object")){try{var str=toStr.call(value);return(str===ddaClass||str===ddaClass2||str===ddaClass3||str===objectClass)&&value("")==null}catch(e){}}return false}}}module.exports=reflectApply?function isCallable(value){if(isDDA(value)){return true}if(!value){return false}if(typeof value!=="function"&&typeof value!=="object"){return false}try{reflectApply(value,null,badArrayLike)}catch(e){if(e!==isCallableMarker){return false}}return!isES6ClassFn(value)&&tryFunctionObject(value)}:function isCallable(value){if(isDDA(value)){return true}if(!value){return false}if(typeof value!=="function"&&typeof value!=="object"){return false}if(hasToStringTag){return tryFunctionObject(value)}if(isES6ClassFn(value)){return false}var strClass=toStr.call(value);if(strClass!==fnClass&&strClass!==genClass&&!/^\[object HTML/.test(strClass)){return false}return tryFunctionObject(value)}},{}],237:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;var fnToStr=Function.prototype.toString;var isFnRegex=/^\s*(?:function)?\*/;var hasToStringTag=require("has-tostringtag/shams")();var getProto=Object.getPrototypeOf;var getGeneratorFunc=function(){if(!hasToStringTag){return false}try{return Function("return function*() {}")()}catch(e){}};var GeneratorFunction;module.exports=function isGeneratorFunction(fn){if(typeof fn!=="function"){return false}if(isFnRegex.test(fnToStr.call(fn))){return true}if(!hasToStringTag){var str=toStr.call(fn);return str==="[object GeneratorFunction]"}if(!getProto){return false}if(typeof GeneratorFunction==="undefined"){var generatorFunc=getGeneratorFunc();GeneratorFunction=generatorFunc?getProto(generatorFunc):false}return getProto(fn)===GeneratorFunction}},{"has-tostringtag/shams":198}],238:[function(require,module,exports){"use strict";var whichTypedArray=require("which-typed-array");module.exports=function isTypedArray(value){return!!whichTypedArray(value)}},{"which-typed-array":444}],239:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function c(input,length,result){const b=[0,0,0,0,0];for(let i=0;i<length;i+=4){let n=((input[i]*256+input[i+1])*256+input[i+2])*256+input[i+3];if(!n){result.push("z")}else{for(let j=0;j<5;b[j++]=n%85+33,n=Math.floor(n/85)){}result.push(String.fromCharCode(b[4],b[3],b[2],b[1],b[0]))}}}function encode(arr){var _a;const input=arr,result=[],remainder=input.length%4,length=input.length-remainder;c(input,length,result);if(remainder){const t=new Uint8Array(4);t.set(input.slice(length),0);c(t,4,result);let x=(_a=result.pop())!==null&&_a!==void 0?_a:"";if(x=="z"){x="!!!!!"}result.push(x.substr(0,remainder+1))}let ret=result.join("");ret="<~"+ret+"~>";return ret}const ascii85={encode:function(arr){if(arr instanceof ArrayBuffer){arr=new Uint8Array(arr,0,arr.byteLength)}return encode(arr)},decode:function(input){if(!input.startsWith("<~")||!input.endsWith("~>")){throw new Error("Invalid input string")}input=input.substr(2,input.length-4);const n=input.length,r=[],b=[0,0,0,0,0];let t,x,y,d;for(let i=0;i<n;++i){if(input.charAt(i)=="z"){r.push(0,0,0,0);continue}for(let j=0;j<5;++j){b[j]=input.charCodeAt(i+j)-33}d=n-i;if(d<5){for(let j=d;j<4;b[++j]=0){}b[d]=85}t=(((b[0]*85+b[1])*85+b[2])*85+b[3])*85+b[4];x=t&255;t>>>=8;y=t&255;t>>>=8;r.push(t>>>8,t&255,y,x);for(let j=d;j<5;++j,r.pop()){}i+=4}const data=new Uint8Array(r);return data.buffer.slice(data.byteOffset,data.byteOffset+data.byteLength)}};exports.default=ascii85},{}],240:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});class Base64{constructor(value){this.value=value;this.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}static utf8_encode(value){let e=value.replace(/rn/g,"n");let t="";for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t}static utf8_decode(value){let t="";let n=0;let r=0,c1=0,c2=0,c3=0;while(n<value.length){r=value.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=value.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=value.charCodeAt(n+1);c3=value.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}encode(){let t="";let n,r,i,s,o,u,a;let f=0;let e=Base64.utf8_encode(this.value);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this.keyStr.charAt(s)+this.keyStr.charAt(o)+this.keyStr.charAt(u)+this.keyStr.charAt(a)}return t}static encode(value){return new Base64(value).encode()}decode(){let t="";let n,r,i;let s,o,u,a;let f=0;let e=this.value.replace(/[^A-Za-z0-9+/=]/g,"");while(f<e.length){s=this.keyStr.indexOf(e.charAt(f++));o=this.keyStr.indexOf(e.charAt(f++));u=this.keyStr.indexOf(e.charAt(f++));a=this.keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Base64.utf8_decode(t);return t}static decode(value){return new Base64(value).decode()}}exports.default=Base64},{}],241:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const A=(a,b)=>1-3*b+3*a;const B=(a,b)=>3*b-6*a;const C=a=>3*a;const calcBezier=(a,b,c)=>((A(b,c)*a+B(b,c))*a+C(b))*a;const getSlope=(a,b,c)=>3*A(b,c)*a*a+2*B(b,c)*a+C(b);const binarySubdivide=(a,b,c,d,e)=>{let f,g,i=0;do{g=b+(c-b)/2;f=calcBezier(g,d,e)-a;if(f>0){c=g}else{b=g}}while(Math.abs(f)>1e-7&&++i<10);return g};const newtonRaphsonIterate=(a,b,c,d)=>{for(let i=0;i<4;++i){let currentSlope=getSlope(b,c,d);if(currentSlope===0){return b}let currentX=calcBezier(b,c,d)-a;b-=currentX/currentSlope}return b};const getTForX=(a,props)=>{let b=0,c=1,d=props.kSplineTableSize-1;for(;c!==d&&props.sampleValues[c]<=a;++c){b+=props.kSampleStepSize}--c;let e=(a-props.sampleValues[c])/(props.sampleValues[c+1]-props.sampleValues[c]),f=b+e*props.kSampleStepSize,g=getSlope(f,props.x1,props.x2);if(g>=.001){return newtonRaphsonIterate(a,f,props.x1,props.x2)}else if(g===0){return f}else{return binarySubdivide(a,b,b+props.kSampleStepSize,props.x1,props.x2)}};const elastic=x=>x*(33*x*x*x*x-106*x*x*x+126*x*x-67*x+15);const easeInElastic=x=>{const c4=2*Math.PI/3;return x===0?0:x===1?1:-Math.pow(2,10*x-10)*Math.sin((x*10-10.75)*c4)};const easeInOutElastic=x=>{const c5=2*Math.PI/4.5;return x===0?0:x===1?1:x<.5?-(Math.pow(2,20*x-10)*Math.sin((20*x-11.125)*c5))/2:Math.pow(2,-20*x+10)*Math.sin((20*x-11.125)*c5)/2+1};const easeOutElastic=x=>{const c4=2*Math.PI/3;return x===0?0:x===1?1:Math.pow(2,-10*x)*Math.sin((x*10-.75)*c4)+1};const easeOutBounce=x=>{const n1=7.5625;const d1=2.75;return x<1/d1?n1*x*x:x<2/d1?n1*(x-=1.5/d1)*x+.75:x<2.5/d1?n1*(x-=2.25/d1)*x+.9375:n1*(x-=2.625/d1)*x+.984375};const easeInBounce=x=>1-easeOutBounce(1-x);const easeInOutBounce=x=>x<.5?(1-easeOutBounce(1-2*x))/2:(1+easeOutBounce(2*x-1))/2;const easingList={linear:"linear",elastic:"elastic",ease:"ease","ease-in":"easeIn","ease-in-elastic":"easeInElastic","ease-in-bounce":"easeInBounce","ease-in-expo":"easeInExpo","ease-in-sine":"easeInSine","ease-in-quad":"easeInQuad","ease-in-cubic":"easeInCubic","ease-in-back":"easeInBack","ease-in-quart":"easeInQuart","ease-in-quint":"easeInQuint","ease-in-circ":"easeInCirc","ease-in-out":"easeInOut","ease-in-out-elastic":"easeInOutElastic","ease-in-out-bounce":"easeInOutBounce","ease-in-out-sine":"easeInOutSine","ease-in-out-quad":"easeInOutQuad","ease-in-out-cubic":"easeInOutCubic","ease-in-out-back":"easeInOutBack","ease-in-out-quart":"easeInOutQuart","ease-in-out-quint":"easeInOutQuint","ease-in-out-expo":"easeInOutExpo","ease-in-out-circ":"easeInOutCirc","ease-out":"easeOut","ease-out-elastic":"easeOutElastic","ease-out-bounce":"easeOutBounce","ease-out-sine":"easeOutSine","ease-out-quad":"easeOutQuad","ease-out-cubic":"easeOutCubic","ease-out-back":"easeOutBack","ease-out-quart":"easeOutQuart","ease-out-quint":"easeOutQuint","ease-out-expo":"easeOutExpo","ease-out-circ":"easeOutCirc","fast-out-slow-in":"fastOutSlowIn","fast-out-linear-in":"fastOutLinearIn","linear-out-slow-in":"linearOutSlowIn"};class BezierEasing{constructor(x1,y1,x2,y2){this.x1=x1;this.y1=y1;this.x2=x2;this.y2=y2;this.kSplineTableSize=11;this.kSampleStepSize=1/(this.kSplineTableSize-1);this.sampleValues=typeof Float32Array==="function"?new Float32Array(this.kSplineTableSize):new Array(this.kSplineTableSize);if(!(0<=x1&&x1<=1&&0<=x2&&x2<=1)){throw new Error("bezier x values must be in [0, 1] range")}for(let i=0;i<this.kSplineTableSize;++i){this.sampleValues[i]=calcBezier(i*this.kSampleStepSize,x1,x2)}}to(t){if(this.x1===this.y1&&this.x2===this.y2){return t}const props={x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,kSplineTableSize:this.kSplineTableSize,kSampleStepSize:this.kSampleStepSize,sampleValues:this.sampleValues};return t===0?0:t===1?1:calcBezier(getTForX(t,props),this.y1,this.y2)}static linear(t){return t}static elastic(t){return elastic(t)}static ease(t){return new BezierEasing(.25,.1,.25,1).to(t)}static easeIn(t){return new BezierEasing(.42,0,1,1).to(t)}static easeInElastic(t){return easeInElastic(t)}static easeInBounce(t){return easeInBounce(t)}static easeInExpo(t){return new BezierEasing(.95,.05,.795,.035).to(t)}static easeInSine(t){return new BezierEasing(.47,0,.75,.72).to(t)}static easeInQuad(t){return new BezierEasing(.55,.09,.68,.53).to(t)}static easeInCubic(t){return new BezierEasing(.55,.06,.68,.19).to(t)}static easeInBack(t){return new BezierEasing(.6,-.28,.74,.05).to(t)}static easeInQuart(t){return new BezierEasing(.895,.03,.685,.22).to(t)}static easeInQuint(t){return new BezierEasing(.755,.05,.855,.06).to(t)}static easeInCirc(t){return new BezierEasing(.6,.04,.98,.335).to(t)}static easeInOut(t){return new BezierEasing(.42,0,.58,1).to(t)}static easeInOutElastic(t){return easeInOutElastic(t)}static easeInOutBounce(t){return easeInOutBounce(t)}static easeInOutSine(t){return new BezierEasing(.45,.05,.55,.95).to(t)}static easeInOutQuad(t){return new BezierEasing(.46,.03,.52,.96).to(t)}static easeInOutCubic(t){return new BezierEasing(.65,.05,.36,1).to(t)}static easeInOutBack(t){return new BezierEasing(.68,-.55,.27,1.55).to(t)}static easeInOutQuart(t){return new BezierEasing(.77,0,.175,1).to(t)}static easeInOutQuint(t){return new BezierEasing(.86,0,.07,1).to(t)}static easeInOutExpo(t){return new BezierEasing(1,0,0,1).to(t)}static easeInOutCirc(t){return new BezierEasing(.785,.135,.15,.86).to(t)}static easeOut(t){return new BezierEasing(0,0,.58,1).to(t)}static easeOutElastic(t){return easeOutElastic(t)}static easeOutBounce(t){return easeOutBounce(t)}static easeOutSine(t){return new BezierEasing(.39,.58,.57,1).to(t)}static easeOutQuad(t){return new BezierEasing(.25,.46,.45,.94).to(t)}static easeOutCubic(t){return new BezierEasing(.22,.61,.36,1).to(t)}static easeOutBack(t){return new BezierEasing(.18,.89,.32,1.28).to(t)}static easeOutQuart(t){return new BezierEasing(.165,.84,.44,1).to(t)}static easeOutQuint(t){return new BezierEasing(.23,1,.32,1).to(t)}static easeOutExpo(t){return new BezierEasing(.19,1,.22,1).to(t)}static easeOutCirc(t){return new BezierEasing(.075,.82,.165,1).to(t)}static fastOutSlowIn(t){return new BezierEasing(.4,0,.2,1).to(t)}static fastOutLinearIn(t){return new BezierEasing(.4,0,1,1).to(t)}static linearOutSlowIn(t){return new BezierEasing(0,0,.2,1).to(t)}static setInterval(func,delay=1,duration=1e3,easing="linear"){let elapsed=0;let timerDelay,start=Date.now();const loop=async()=>{var _a;if(elapsed>duration){clearTimeout(timerDelay);return}const t=Math.min(1,elapsed/duration);if(easing instanceof BezierEasing){await func(easing.to(t))}else if(typeof easing==="function"){await func((_a=easing(t))!==null&&_a!==void 0?_a:1)}else if(easing in easingList){await func(BezierEasing[easingList[easing]](t))}else{await func(t)}elapsed=Date.now()-start;timerDelay=setTimeout(loop,delay-elapsed%delay)};loop();return timerDelay}}exports.default=BezierEasing},{}],242:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.infoColor=exports.hslDistance=exports.negative=exports.growing=exports.watershed=exports.colorScale=exports.grayScale=exports.lighten=exports.darken=exports.blend=exports.hwbToRgb=exports.cmykToRgb=exports.hsvToRgb=exports.hslToRgb=exports.rgbToHwb=exports.rgbToCmyk=exports.rgbToHsv=exports.rgbToHsl=exports.rgbToHex=exports.hexToRgb=exports.colorNames=void 0;exports.colorNames={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};const prependZeroIfNecessaryHelper=a=>1==a.length?"0"+a:a;const hexToRgb=a=>{let b=parseInt(a.substring(1,3),16),c=parseInt(a.substring(3,5),16),d=parseInt(a.substring(5,7),16);return[b,c,d]};exports.hexToRgb=hexToRgb;const rgbToHex=(a,b,c)=>{if(isNaN(a)||0>a||255<a||isNaN(b)||0>b||255<b||isNaN(c)||0>c||255<c){return"#000000"}return"#"+[prependZeroIfNecessaryHelper(a.toString(16)),prependZeroIfNecessaryHelper(b.toString(16)),prependZeroIfNecessaryHelper(c.toString(16))].join("")};exports.rgbToHex=rgbToHex;const rgbToHsl=(a,b,c)=>{a/=255;b/=255;c/=255;let d=Math.max(a,b,c),e=Math.min(a,b,c),f=0,g=0,h=.5*(d+e);if(d!=e){if(d==a){f=60*(b-c)/(d-e)}else if(d==b){f=60*(c-a)/(d-e)+120}else if(d==c){f=60*(a-b)/(d-e)+240}}g=0<h&&.5>=h?(d-e)/(2*h):(d-e)/(2-2*h);return[Math.round(f+360)%360,Math.round(g*100),Math.round(h*100)]};exports.rgbToHsl=rgbToHsl;const rgbToHsv=(a,b,c)=>{let d=Math.max(Math.max(a,b),c),e=Math.min(Math.min(a,b),c),f;if(e==d){e=a=0}else{f=d-e;e=f/d;a=60*(a==d?(b-c)/f:b==d?2+(c-a)/f:4+(a-b)/f);if(0>a){a+=360}else if(360<a){a-=360}}return[Math.round(a),Math.round(e*100),Math.round(d*100/255)]};exports.rgbToHsv=rgbToHsv;const rgbToCmyk=(a,b,c)=>{let d,e,f,g,h,i,j;if(a==0&&b==0&&c==0){d=e=f=0;g=1}else{h=1-a/255;i=1-b/255;j=1-c/255;g=Math.min(h,Math.min(i,j));d=(h-g)/(1-g);e=(i-g)/(1-g);f=(j-g)/(1-g)}return[Math.round(d*100),Math.round(e*100),Math.round(f*100),Math.round(g*100)]};exports.rgbToCmyk=rgbToCmyk;const rgbToHwb=(a,b,c)=>{let d,e,f,g,h,i,j;h=(0,exports.rgbToHsv)(a,b,c)[0];a/=255;b/=255;c/=255;f=Math.min(a,b,c);g=Math.max(a,b,c);c=1-g;if(g===f){i=Math.round(f*100);j=Math.round(c*100)}else{d=a===f?b-c:b===f?c-a:a-b;e=a===f?3:b===f?5:1;h=Math.round((e-d/(g-f))/6*100*360/100);if(0>h){h+=360}else if(360<h){h-=360}i=Math.round(f*100);j=Math.round(c*100)}return[Math.round(h),Math.round(i),Math.round(j)]};exports.rgbToHwb=rgbToHwb;const hueToRgb_=(a,b,c)=>{0>c?c+=1:1<c&&(c-=1);return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a};const hslToRgb=(a,b,c)=>{let d=0,e=0,f=0,g;a/=360;if(0==b){d=e=f=255*c}else{g=f=0;g=.5>c?c*(1+b):c+b-b*c;f=2*c-g;d=255*hueToRgb_(f,g,a+1/3);e=255*hueToRgb_(f,g,a);f=255*hueToRgb_(f,g,a-1/3)}return[Math.round(d),Math.round(e),Math.round(f)]};exports.hslToRgb=hslToRgb;const hsvToRgb=(a,b_,c)=>{let r,g,b,d,e,f,h,i,k,l,m;if(b_==0){r=g=b=Math.round(c*255)}else{h=a*6==6?0:a*6;i=Math.floor(h);k=c*(1-b_);l=c*(1-b_*(h-i));m=c*(1-b_*(1-(h-i)));if(i==0){d=c;e=m;f=k}else if(i==1){d=l;e=c;f=k}else if(i==2){d=k;e=c;f=m}else if(i==3){d=k;e=l;f=c}else if(i==4){d=m;e=k;f=c}else{d=c;e=k;f=l}r=Math.round(d*255);g=Math.round(e*255);b=Math.round(f*255)}return[r,g,b]};exports.hsvToRgb=hsvToRgb;const cmykToRgb=(a,b,c,d)=>{let e=255*(1-a)*(1-d),f=255*(1-b)*(1-d),g=255*(1-c)*(1-d);return[Math.round(e),Math.round(f),Math.round(g)]};exports.cmykToRgb=cmykToRgb;const hwbToRgb=(a,b,c)=>{let d,e,f,g,h,i,j;a=a*6;g=1-c;j=a|0;i=a-j;if(j&1){i=1-i}h=b+i*(g-b);g=g*255|0;h=h*255|0;b=b*255|0;if(j==0){d=g;e=h;f=b}else if(j==1){d=h;e=g;f=b}else if(j==2){d=b;e=g;f=h}else if(j==3){d=b;e=h;f=g}else if(j==4){d=h;e=b;f=g}else if(j==5){d=g;e=b;f=h}else{d=e=f=g}return[Math.round(d),Math.round(e),Math.round(f)]};exports.hwbToRgb=hwbToRgb;const blend=(a,b,c)=>{c=Math.min(Math.max(c,0),1);return[Math.round(c*a[0]+(1-c)*b[0]),Math.round(c*a[1]+(1-c)*b[1]),Math.round(c*a[2]+(1-c)*b[2])]};exports.blend=blend;const darken=(a,b)=>(0,exports.blend)([0,0,0],a,b);exports.darken=darken;const lighten=(a,b)=>(0,exports.blend)([255,255,255],a,b);exports.lighten=lighten;const grayScale=a=>{let b=Math.round((a[0]+a[1]+a[2])/3);return[b,b,b]};exports.grayScale=grayScale;const colorScale=(a,b,c)=>{let s=(0,exports.grayScale)(a)[0];b=b==undefined?[255,255,255]:b;c=c==undefined?[0,0,0]:c;let d=s*100/255;return(0,exports.blend)(b,c,d)};exports.colorScale=colorScale;const watershed=a=>{let b=(0,exports.grayScale)(a),c=b[0],e=255/2;if(c>=e){return[255,255,255]}else{return[0,0,0]}};exports.watershed=watershed;const growing=a=>{let b=(0,exports.grayScale)(a),c=b[0];return(0,exports.hslToRgb)(Math.round(c*360/255),100/100,50/100)};exports.growing=growing;const negative=a=>[Math.round(255-a[0]),Math.round(255-a[1]),Math.round(255-a[2])];exports.negative=negative;const hslDistance=(a,b)=>{a=[a[0],a[1]/100,a[2]/100];b=[b[0],b[1]/100,b[2]/100];let c,d;c=.5>=a[2]?a[1]*a[2]:a[1]*(1-a[2]);d=.5>=b[2]?b[1]*b[2]:b[1]*(1-b[2]);return Math.round(((a[2]-b[2])*(a[2]-b[2])+c*c+d*d-2*c*d*Math.cos(2*(a[0]/360-b[0]/360)*Math.PI))*100)};exports.hslDistance=hslDistance;const infoColor=color=>{let result={type:undefined,string:undefined,array:undefined},b,c,d,e;if(b=/^((?:rgb|hs[lv]|cmyk|hwb)a?)\s*\(([^\)]*)\)/.exec(String(color))){c=b[1];d=c.replace(/a$/,"");e=d==="cmyk"?4:3;b[2]=b[2].replace(/^\s+|\s+$/g,"").split(/\s*,\s*/).map(((x,i)=>{if(/%$/.test(x)&&i===e){return parseFloat(x)/100}else if(/%$/.test(x)){return parseFloat(x)}return parseFloat(x)}));result.type=d;result.string=color;result.array=b[2]}else if(/^#[A-Fa-f0-9]+$/.test(color)){result.type="hex";result.string=color;result.array=(0,exports.hexToRgb)(color)}else if(Object.keys(exports.colorNames).includes(String(color).toLowerCase())){result.type="name";result.string=color;result.array=(0,exports.hexToRgb)(exports.colorNames[color])}return result};exports.infoColor=infoColor;class Color{constructor(color="#000000"){this.value="#000000";this.value=Array.isArray(color)?exports.rgbToHex.apply(null,color):color;this.info=(0,exports.infoColor)(this.value);this.type=this.info.type;const defaultProps={rgb:[0,0,0],string:"#000000",hex:"#000000",hsl:[0,0,0],hsv:[0,0,0],cmyk:[0,0,0,0],hwb:[0,0,0]};if(Array.isArray(this.info.array)){switch(this.type){case"name":this.props=Color.colorName(this.value);break;case"hex":this.props=Color.hex(this.value);break;case"rgb":this.props=Color.rgb.apply(null,this.info.array);break;case"hsl":this.props=Color.hsl.apply(null,this.info.array);break;case"cmyk":this.props=Color.cmyk.apply(null,this.info.array);break;case"hwb":this.props=Color.hwb.apply(null,this.info.array);break;case"hsv":this.props=Color.hsv.apply(null,this.info.array);break;default:this.props=defaultProps}}else{this.props=defaultProps}}get isValidColor(){return Color.isColor(this.value)}get hex(){return this.props.hex}get rgb(){return"rgb("+this.props.rgb.join(", ")+")"}get hsl(){return"hsl("+this.props.hsl.map(((v,i)=>v+(i>0?"%":""))).join(", ")+")"}get hsv(){return"hsv("+this.props.hsv.map(((v,i)=>v+(i>0?"%":""))).join(", ")+")"}get cmyk(){return"cmyk("+this.props.cmyk.join("%, ")+")"}get hwb(){return"hwb("+this.props.hsv.map(((v,i)=>v+(i>0?"%":""))).join(", ")+")"}get string(){return this.props.string}get vector(){return(0,exports.infoColor)(this.rgb).array}distance(a){return(0,exports.hslDistance)(this.props.hsl,new Color(a).props.hsl)}blend(a,b){const c=(0,exports.blend)(this.props.rgb,new Color(a).props.rgb,b);return new Color("rgb("+c.join(", ")+")")}static blend(a,b,c){return new Color(a).blend(b,c)}darken(a){let b=(0,exports.darken)(this.props.rgb,a);return new Color("rgb("+b.join(", ")+")")}lighten(a){let b=(0,exports.lighten)(this.props.rgb,a);return new Color("rgb("+b.join(", ")+")")}grayScale(){let b=(0,exports.grayScale)(this.props.rgb);return new Color("rgb("+b.join(", ")+")")}colorScale(a,b){const c=(0,exports.colorScale)(this.props.rgb,new Color(a==undefined?"#ffffff":a).props.rgb,new Color(b==undefined?"#000000":b).props.rgb);return new Color("rgb("+c.join(", ")+")")}watershed(){let b=(0,exports.watershed)(this.props.rgb);return new Color("rgb("+b.join(", ")+")")}growing(){let b=(0,exports.growing)(this.props.rgb);return new Color("rgb("+b.join(", ")+")")}negative(){let b=(0,exports.negative)(this.props.rgb);return new Color("rgb("+b.join(", ")+")")}static isColor(color){var _a;try{let b=(0,exports.infoColor)(color);if(["hex","name","rgb","hsl","hsv","cmyk","hwb","rgba","hsla","hsva","cmyka","hwba"].includes((_a=b.type)!==null&&_a!==void 0?_a:"")){return true}}catch(e){return false}return false}static colorName(color){const hex=exports.colorNames[color];let result=Color.hex(hex);result.string=String(color).toLowerCase();return result}static hex(hex){hex=String(hex);hex="#"==hex.charAt(0)?hex:"#"+hex;let hexTripletRe_=/#(.)(.)(.)/,validHexColorRe_=/^#(?:[0-9a-f]{3}){1,2}$/i,isValid=function(a){return validHexColorRe_.test(a)},normalizeHex=a=>{if(!isValid(a))a="#000000";4==a.length&&(a=a.replace(hexTripletRe_,"#$1$1$2$2$3$3"));return a.toLowerCase()};hex=normalizeHex(hex);let result=Color.rgb.apply(null,(0,exports.hexToRgb)(hex));result.string=hex;result.hex=hex;return result}static rgb(a,b,c){a=Math.round(Number(a));b=Math.round(Number(b));c=Math.round(Number(c));const rgb=[a,b,c];return{rgb:rgb,string:"rgb("+rgb.join(", ")+")",hex:(0,exports.rgbToHex)(a,b,c),hsl:(0,exports.rgbToHsl)(a,b,c),hsv:(0,exports.rgbToHsv)(a,b,c),cmyk:(0,exports.rgbToCmyk)(a,b,c),hwb:(0,exports.rgbToHwb)(a,b,c)}}static hsl(a,b,c){a=Math.round(Number(a));b=Number(b)/100;c=Number(c)/100;const rgb=(0,exports.hslToRgb)(a,b,c);let result=Color.rgb.apply(null,rgb);result.hsl=[Math.round(a),Math.round(b*100),Math.round(c*100)];result.string="hsl("+result.hsl.map(((v,i)=>v+(i>0?"%":""))).join(", ")+")";return result}static hsv(a,b,c){a=Math.round(Number(a));b=Number(b)/100;c=Number(c)/100;const rgb=(0,exports.hsvToRgb)(a,b,c);let result=Color.rgb.apply(null,rgb);result.hsv=[Math.round(a),Math.round(b*100),Math.round(c*100)];result.string="hsv("+result.hsv.map(((v,i)=>v+(i>0?"%":""))).join(", ")+")";return result}static cmyk(a,b,c,d){a=Number(a)/100;b=Number(b)/100;c=Number(c)/100;d=Number(d)/100;const rgb=(0,exports.cmykToRgb)(a,b,c,d);let result=Color.rgb.apply(null,rgb);result.cmyk=[Math.round(a*100),Math.round(b*100),Math.round(c*100),Math.round(d*100)];result.string="cmyk("+result.cmyk.join("%, ")+"%)";return result}static hwb(a,b,c){a=Number(a)/360;b=Number(b)/100;c=Number(c)/100;const rgb=(0,exports.hwbToRgb)(a,b,c);let result=Color.rgb.apply(null,rgb);result.hwb=[Math.round(a*360),Math.round(b*100),Math.round(c*100)];result.string="hwb("+result.hwb.map(((v,i)=>v+(i>0?"%":""))).join(", ")+")";return result}}exports.default=Color},{}],243:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const validation_1=require("./validation");const JSONStringify=obj=>{const restOfDataTypes=value=>(0,validation_1.isNumber)(value)||(0,validation_1.isString)(value)||(0,validation_1.isBoolean)(value);const ignoreDataTypes=value=>(0,validation_1.isUndefined)(value)||(0,validation_1.isFunction)(value)||(0,validation_1.isSymbol)(value);const nullDataTypes=value=>(0,validation_1.isNotNumber)(value)||(0,validation_1.isInfinity)(value)||(0,validation_1.isNull)(value);const arrayValuesNullTypes=value=>(0,validation_1.isNotNumber)(value)||(0,validation_1.isInfinity)(value)||(0,validation_1.isNull)(value)||ignoreDataTypes(value);const removeComma=str=>{const tempArr=str.split("");tempArr.pop();return tempArr.join("")};if(ignoreDataTypes(obj)){return"{}"}if((0,validation_1.isDate)(obj)){return`"${new Date(obj).toISOString()}"`}if(nullDataTypes(obj)){return`${null}`}if((0,validation_1.isSymbol)(obj)){return"{}"}if(restOfDataTypes(obj)){return JSON.stringify(obj)}if((0,validation_1.isArray)(obj)){let arrStr="";obj.forEach((eachValue=>{arrStr+=arrayValuesNullTypes(eachValue)?JSONStringify(null):JSONStringify(eachValue);arrStr+=","}));return`[`+removeComma(arrStr)+`]`}if((0,validation_1.isObject)(obj)){let objStr="";const objKeys=Object.keys(obj);objKeys.forEach((eachKey=>{const eachValue=obj[eachKey];objStr+=!ignoreDataTypes(eachValue)?`"${eachKey}":${JSONStringify(eachValue)},`:""}));return`{`+removeComma(objStr)+`}`}return"{}"};exports.default=JSONStringify},{"./validation":251}],244:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function runCallback(callback,data){try{callback(data)}catch(err){console.error("Error in subscription callback",err)}}const _subscriptions=Symbol("subscriptions");const _oneTimeEvents=Symbol("oneTimeEvents");class SimpleEventEmitter{constructor(){this[_subscriptions]=[];this[_oneTimeEvents]=new Map}on(event,callback){if(this[_oneTimeEvents].has(event)){runCallback(callback,this[_oneTimeEvents].get(event))}else{this[_subscriptions].push({event:event,callback:callback,once:false})}const self=this;return{stop(){self.off(event,callback)}}}off(event,callback){this[_subscriptions]=this[_subscriptions].filter((s=>s.event!==event||callback&&s.callback!==callback));return this}once(event,callback){return new Promise((resolve=>{const ourCallback=data=>{resolve(data);callback===null||callback===void 0?void 0:callback(data)};if(this[_oneTimeEvents].has(event)){runCallback(ourCallback,this[_oneTimeEvents].get(event))}else{this[_subscriptions].push({event:event,callback:ourCallback,once:true})}}))}emit(event,data){if(this[_oneTimeEvents].has(event)){throw new Error(`Event "${event}" was supposed to be emitted only once`)}for(let i=0;i<this[_subscriptions].length;i++){const s=this[_subscriptions][i];if(s.event!==event){continue}runCallback(s.callback,data);if(s.once){this[_subscriptions].splice(i,1);i--}}return this}emitOnce(event,data){if(this[_oneTimeEvents].has(event)){throw new Error(`Event "${event}" was supposed to be emitted only once`)}this.emit(event,data);this[_oneTimeEvents].set(event,data);this.off(event);return this}pipe(event,eventEmitter){return this.on(event,(data=>{eventEmitter.emit(event,data)}))}pipeOnce(event,eventEmitter){return this.once(event,(data=>{eventEmitter.emitOnce(event,data)}))}}exports.default=SimpleEventEmitter},{}],245:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};Object.defineProperty(exports,"__esModule",{value:true});exports.mat4=void 0;exports.mat4=__importStar(require("./mat4"))},{"./mat4":246}],246:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.transpose=exports.translate=exports.str=exports.scale=exports.rotateZ=exports.rotateY=exports.rotateX=exports.rotate=exports.perspectiveFromFieldOfView=exports.perspective=exports.ortho=exports.multiply=exports.lookAt=exports.invert=exports.identity=exports.frustum=exports.fromZRotation=exports.fromYRotation=exports.fromXRotation=exports.fromTranslation=exports.fromScaling=exports.fromRotationTranslation=exports.fromRotation=exports.fromQuat=exports.determinant=exports.create=exports.copy=exports.clone=exports.adjoint=void 0;const adjoint=(out,a)=>{let a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];out[0]=a11*(a22*a33-a23*a32)-a21*(a12*a33-a13*a32)+a31*(a12*a23-a13*a22);out[1]=-(a01*(a22*a33-a23*a32)-a21*(a02*a33-a03*a32)+a31*(a02*a23-a03*a22));out[2]=a01*(a12*a33-a13*a32)-a11*(a02*a33-a03*a32)+a31*(a02*a13-a03*a12);out[3]=-(a01*(a12*a23-a13*a22)-a11*(a02*a23-a03*a22)+a21*(a02*a13-a03*a12));out[4]=-(a10*(a22*a33-a23*a32)-a20*(a12*a33-a13*a32)+a30*(a12*a23-a13*a22));out[5]=a00*(a22*a33-a23*a32)-a20*(a02*a33-a03*a32)+a30*(a02*a23-a03*a22);out[6]=-(a00*(a12*a33-a13*a32)-a10*(a02*a33-a03*a32)+a30*(a02*a13-a03*a12));out[7]=a00*(a12*a23-a13*a22)-a10*(a02*a23-a03*a22)+a20*(a02*a13-a03*a12);out[8]=a10*(a21*a33-a23*a31)-a20*(a11*a33-a13*a31)+a30*(a11*a23-a13*a21);out[9]=-(a00*(a21*a33-a23*a31)-a20*(a01*a33-a03*a31)+a30*(a01*a23-a03*a21));out[10]=a00*(a11*a33-a13*a31)-a10*(a01*a33-a03*a31)+a30*(a01*a13-a03*a11);out[11]=-(a00*(a11*a23-a13*a21)-a10*(a01*a23-a03*a21)+a20*(a01*a13-a03*a11));out[12]=-(a10*(a21*a32-a22*a31)-a20*(a11*a32-a12*a31)+a30*(a11*a22-a12*a21));out[13]=a00*(a21*a32-a22*a31)-a20*(a01*a32-a02*a31)+a30*(a01*a22-a02*a21);out[14]=-(a00*(a11*a32-a12*a31)-a10*(a01*a32-a02*a31)+a30*(a01*a12-a02*a11));out[15]=a00*(a11*a22-a12*a21)-a10*(a01*a22-a02*a21)+a20*(a01*a12-a02*a11);return out};exports.adjoint=adjoint;const clone=a=>{let out=new Float32Array(16);out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out};exports.clone=clone;const copy=(out,a)=>{out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out};exports.copy=copy;const create=()=>{let out=new Float32Array(16);out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};exports.create=create;const determinant=a=>{const a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32;return b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06};exports.determinant=determinant;const fromQuat=(out,q)=>{const x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;out[0]=1-yy-zz;out[1]=yx+wz;out[2]=zx-wy;out[3]=0;out[4]=yx-wz;out[5]=1-xx-zz;out[6]=zy+wx;out[7]=0;out[8]=zx+wy;out[9]=zy-wx;out[10]=1-xx-yy;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};exports.fromQuat=fromQuat;const fromRotation=(out,rad,axis)=>{let s,c,t;let x=axis[0];let y=axis[1];let z=axis[2];let len=Math.sqrt(x*x+y*y+z*z);if(Math.abs(len)<1e-6){return null}len=1/len;x*=len;y*=len;z*=len;s=Math.sin(rad);c=Math.cos(rad);t=1-c;out[0]=x*x*t+c;out[1]=y*x*t+z*s;out[2]=z*x*t-y*s;out[3]=0;out[4]=x*y*t-z*s;out[5]=y*y*t+c;out[6]=z*y*t+x*s;out[7]=0;out[8]=x*z*t+y*s;out[9]=y*z*t-x*s;out[10]=z*z*t+c;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};exports.fromRotation=fromRotation;const fromRotationTranslation=(out,q,v)=>{let x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;out[0]=1-(yy+zz);out[1]=xy+wz;out[2]=xz-wy;out[3]=0;out[4]=xy-wz;out[5]=1-(xx+zz);out[6]=yz+wx;out[7]=0;out[8]=xz+wy;out[9]=yz-wx;out[10]=1-(xx+yy);out[11]=0;out[12]=v[0];out[13]=v[1];out[14]=v[2];out[15]=1;return out};exports.fromRotationTranslation=fromRotationTranslation;const fromScaling=(out,v)=>{out[0]=v[0];out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=v[1];out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=v[2];out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};exports.fromScaling=fromScaling;const fromTranslation=(out,v)=>{out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=v[0];out[13]=v[1];out[14]=v[2];out[15]=1;return out};exports.fromTranslation=fromTranslation;const fromXRotation=(out,rad)=>{const s=Math.sin(rad),c=Math.cos(rad);out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=c;out[6]=s;out[7]=0;out[8]=0;out[9]=-s;out[10]=c;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};exports.fromXRotation=fromXRotation;const fromYRotation=(out,rad)=>{const s=Math.sin(rad),c=Math.cos(rad);out[0]=c;out[1]=0;out[2]=-s;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=s;out[9]=0;out[10]=c;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};exports.fromYRotation=fromYRotation;const fromZRotation=(out,rad)=>{let s=Math.sin(rad),c=Math.cos(rad);out[0]=c;out[1]=s;out[2]=0;out[3]=0;out[4]=-s;out[5]=c;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};exports.fromZRotation=fromZRotation;const frustum=(out,left,right,bottom,top,near,far)=>{let rl=1/(right-left),tb=1/(top-bottom),nf=1/(near-far);out[0]=near*2*rl;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=near*2*tb;out[6]=0;out[7]=0;out[8]=(right+left)*rl;out[9]=(top+bottom)*tb;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=far*near*2*nf;out[15]=0;return out};exports.frustum=frustum;const identity=out=>{out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out};exports.identity=identity;const invert=(out,a)=>{let a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;out[0]=(a11*b11-a12*b10+a13*b09)*det;out[1]=(a02*b10-a01*b11-a03*b09)*det;out[2]=(a31*b05-a32*b04+a33*b03)*det;out[3]=(a22*b04-a21*b05-a23*b03)*det;out[4]=(a12*b08-a10*b11-a13*b07)*det;out[5]=(a00*b11-a02*b08+a03*b07)*det;out[6]=(a32*b02-a30*b05-a33*b01)*det;out[7]=(a20*b05-a22*b02+a23*b01)*det;out[8]=(a10*b10-a11*b08+a13*b06)*det;out[9]=(a01*b08-a00*b10-a03*b06)*det;out[10]=(a30*b04-a31*b02+a33*b00)*det;out[11]=(a21*b02-a20*b04-a23*b00)*det;out[12]=(a11*b07-a10*b09-a12*b06)*det;out[13]=(a00*b09-a01*b07+a02*b06)*det;out[14]=(a31*b01-a30*b03-a32*b00)*det;out[15]=(a20*b03-a21*b01+a22*b00)*det;return out};exports.invert=invert;const lookAt=(out,eye,center,up)=>{let x0,x1,x2,y0,y1,y2,z0,z1,z2,len,eyex=eye[0],eyey=eye[1],eyez=eye[2],upx=up[0],upy=up[1],upz=up[2],centerx=center[0],centery=center[1],centerz=center[2];if(Math.abs(eyex-centerx)<1e-6&&Math.abs(eyey-centery)<1e-6&&Math.abs(eyez-centerz)<1e-6){return(0,exports.identity)(out)}z0=eyex-centerx;z1=eyey-centery;z2=eyez-centerz;len=1/Math.sqrt(z0*z0+z1*z1+z2*z2);z0*=len;z1*=len;z2*=len;x0=upy*z2-upz*z1;x1=upz*z0-upx*z2;x2=upx*z1-upy*z0;len=Math.sqrt(x0*x0+x1*x1+x2*x2);if(!len){x0=0;x1=0;x2=0}else{len=1/len;x0*=len;x1*=len;x2*=len}y0=z1*x2-z2*x1;y1=z2*x0-z0*x2;y2=z0*x1-z1*x0;len=Math.sqrt(y0*y0+y1*y1+y2*y2);if(!len){y0=0;y1=0;y2=0}else{len=1/len;y0*=len;y1*=len;y2*=len}out[0]=x0;out[1]=y0;out[2]=z0;out[3]=0;out[4]=x1;out[5]=y1;out[6]=z1;out[7]=0;out[8]=x2;out[9]=y2;out[10]=z2;out[11]=0;out[12]=-(x0*eyex+x1*eyey+x2*eyez);out[13]=-(y0*eyex+y1*eyey+y2*eyez);out[14]=-(z0*eyex+z1*eyey+z2*eyez);out[15]=1;return out};exports.lookAt=lookAt;const multiply=(out,a,b)=>{let a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];let b0=b[0],b1=b[1],b2=b[2],b3=b[3];out[0]=b0*a00+b1*a10+b2*a20+b3*a30;out[1]=b0*a01+b1*a11+b2*a21+b3*a31;out[2]=b0*a02+b1*a12+b2*a22+b3*a32;out[3]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[4];b1=b[5];b2=b[6];b3=b[7];out[4]=b0*a00+b1*a10+b2*a20+b3*a30;out[5]=b0*a01+b1*a11+b2*a21+b3*a31;out[6]=b0*a02+b1*a12+b2*a22+b3*a32;out[7]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[8];b1=b[9];b2=b[10];b3=b[11];out[8]=b0*a00+b1*a10+b2*a20+b3*a30;out[9]=b0*a01+b1*a11+b2*a21+b3*a31;out[10]=b0*a02+b1*a12+b2*a22+b3*a32;out[11]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[12];b1=b[13];b2=b[14];b3=b[15];out[12]=b0*a00+b1*a10+b2*a20+b3*a30;out[13]=b0*a01+b1*a11+b2*a21+b3*a31;out[14]=b0*a02+b1*a12+b2*a22+b3*a32;out[15]=b0*a03+b1*a13+b2*a23+b3*a33;return out};exports.multiply=multiply;const ortho=(out,left,right,bottom,top,near,far)=>{let lr=1/(left-right),bt=1/(bottom-top),nf=1/(near-far);out[0]=-2*lr;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=-2*bt;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=2*nf;out[11]=0;out[12]=(left+right)*lr;out[13]=(top+bottom)*bt;out[14]=(far+near)*nf;out[15]=1;return out};exports.ortho=ortho;const perspective=(out,fovy,aspect,near,far)=>{let f=1/Math.tan(fovy/2),nf=1/(near-far);out[0]=f/aspect;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=f;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=2*far*near*nf;out[15]=0;return out};exports.perspective=perspective;const perspectiveFromFieldOfView=(out,fov,near,far)=>{let upTan=Math.tan(fov.upDegrees*Math.PI/180),downTan=Math.tan(fov.downDegrees*Math.PI/180),leftTan=Math.tan(fov.leftDegrees*Math.PI/180),rightTan=Math.tan(fov.rightDegrees*Math.PI/180),xScale=2/(leftTan+rightTan),yScale=2/(upTan+downTan);out[0]=xScale;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=yScale;out[6]=0;out[7]=0;out[8]=-((leftTan-rightTan)*xScale*.5);out[9]=(upTan-downTan)*yScale*.5;out[10]=far/(near-far);out[11]=-1;out[12]=0;out[13]=0;out[14]=far*near/(near-far);out[15]=0;return out};exports.perspectiveFromFieldOfView=perspectiveFromFieldOfView;const rotate=(out,a,rad,axis)=>{let x=axis[0],y=axis[1],z=axis[2],len=Math.sqrt(x*x+y*y+z*z),s,c,t,a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,b00,b01,b02,b10,b11,b12,b20,b21,b22;if(Math.abs(len)<1e-6){return null}len=1/len;x*=len;y*=len;z*=len;s=Math.sin(rad);c=Math.cos(rad);t=1-c;a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];b00=x*x*t+c;b01=y*x*t+z*s;b02=z*x*t-y*s;b10=x*y*t-z*s;b11=y*y*t+c;b12=z*y*t+x*s;b20=x*z*t+y*s;b21=y*z*t-x*s;b22=z*z*t+c;out[0]=a00*b00+a10*b01+a20*b02;out[1]=a01*b00+a11*b01+a21*b02;out[2]=a02*b00+a12*b01+a22*b02;out[3]=a03*b00+a13*b01+a23*b02;out[4]=a00*b10+a10*b11+a20*b12;out[5]=a01*b10+a11*b11+a21*b12;out[6]=a02*b10+a12*b11+a22*b12;out[7]=a03*b10+a13*b11+a23*b12;out[8]=a00*b20+a10*b21+a20*b22;out[9]=a01*b20+a11*b21+a21*b22;out[10]=a02*b20+a12*b21+a22*b22;out[11]=a03*b20+a13*b21+a23*b22;if(a!==out){out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}return out};exports.rotate=rotate;const rotateX=(out,a,rad)=>{let s=Math.sin(rad),c=Math.cos(rad),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];if(a!==out){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[4]=a10*c+a20*s;out[5]=a11*c+a21*s;out[6]=a12*c+a22*s;out[7]=a13*c+a23*s;out[8]=a20*c-a10*s;out[9]=a21*c-a11*s;out[10]=a22*c-a12*s;out[11]=a23*c-a13*s;return out};exports.rotateX=rotateX;const rotateY=(out,a,rad)=>{let s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];if(a!==out){out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[0]=a00*c-a20*s;out[1]=a01*c-a21*s;out[2]=a02*c-a22*s;out[3]=a03*c-a23*s;out[8]=a00*s+a20*c;out[9]=a01*s+a21*c;out[10]=a02*s+a22*c;out[11]=a03*s+a23*c;return out};exports.rotateY=rotateY;const rotateZ=(out,a,rad)=>{let s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];if(a!==out){out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15]}out[0]=a00*c+a10*s;out[1]=a01*c+a11*s;out[2]=a02*c+a12*s;out[3]=a03*c+a13*s;out[4]=a10*c-a00*s;out[5]=a11*c-a01*s;out[6]=a12*c-a02*s;out[7]=a13*c-a03*s;return out};exports.rotateZ=rotateZ;const scale=(out,a,v)=>{let x=v[0],y=v[1],z=v[2];out[0]=a[0]*x;out[1]=a[1]*x;out[2]=a[2]*x;out[3]=a[3]*x;out[4]=a[4]*y;out[5]=a[5]*y;out[6]=a[6]*y;out[7]=a[7]*y;out[8]=a[8]*z;out[9]=a[9]*z;out[10]=a[10]*z;out[11]=a[11]*z;out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out};exports.scale=scale;const str=a=>"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")";exports.str=str;const translate=(out,a,v)=>{let x=v[0],y=v[1],z=v[2],a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23;if(a===out){out[12]=a[0]*x+a[4]*y+a[8]*z+a[12];out[13]=a[1]*x+a[5]*y+a[9]*z+a[13];out[14]=a[2]*x+a[6]*y+a[10]*z+a[14];out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]}else{a00=a[0];a01=a[1];a02=a[2];a03=a[3];a10=a[4];a11=a[5];a12=a[6];a13=a[7];a20=a[8];a21=a[9];a22=a[10];a23=a[11];out[0]=a00;out[1]=a01;out[2]=a02;out[3]=a03;out[4]=a10;out[5]=a11;out[6]=a12;out[7]=a13;out[8]=a20;out[9]=a21;out[10]=a22;out[11]=a23;out[12]=a00*x+a10*y+a20*z+a[12];out[13]=a01*x+a11*y+a21*z+a[13];out[14]=a02*x+a12*y+a22*z+a[14];out[15]=a03*x+a13*y+a23*z+a[15]}return out};exports.translate=translate;const transpose=(out,a)=>{if(out===a){let a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a01;out[6]=a[9];out[7]=a[13];out[8]=a02;out[9]=a12;out[11]=a[14];out[12]=a03;out[13]=a13;out[14]=a23}else{out[0]=a[0];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a[1];out[5]=a[5];out[6]=a[9];out[7]=a[13];out[8]=a[2];out[9]=a[6];out[10]=a[10];out[11]=a[14];out[12]=a[3];out[13]=a[7];out[14]=a[11];out[15]=a[15]}return out};exports.transpose=transpose},{}],247:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(exports,p))__createBinding(exports,m,p)};var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.SimpleEventEmitter=exports.Ascii85=exports.ColorUtils=exports.Color=exports.BezierEasing=exports.Base64=exports.gl=exports.mergeClasses=exports.JSONStringify=void 0;var JSONStringify_1=require("./JSONStringify");Object.defineProperty(exports,"JSONStringify",{enumerable:true,get:function(){return __importDefault(JSONStringify_1).default}});var mergeClasses_1=require("./mergeClasses");Object.defineProperty(exports,"mergeClasses",{enumerable:true,get:function(){return __importDefault(mergeClasses_1).default}});__exportStar(require("./mimeTypeFromBuffer"),exports);__exportStar(require("./utils"),exports);__exportStar(require("./validation"),exports);exports.gl=__importStar(require("./gl"));var Base64_1=require("./Base64");Object.defineProperty(exports,"Base64",{enumerable:true,get:function(){return __importDefault(Base64_1).default}});var BezierEasing_1=require("./BezierEasing");Object.defineProperty(exports,"BezierEasing",{enumerable:true,get:function(){return __importDefault(BezierEasing_1).default}});var Color_1=require("./Color");Object.defineProperty(exports,"Color",{enumerable:true,get:function(){return __importDefault(Color_1).default}});exports.ColorUtils=__importStar(require("./Color"));var Ascii85_1=require("./Ascii85");Object.defineProperty(exports,"Ascii85",{enumerable:true,get:function(){return __importDefault(Ascii85_1).default}});var SimpleEventEmitter_1=require("./SimpleEventEmitter");Object.defineProperty(exports,"SimpleEventEmitter",{enumerable:true,get:function(){return __importDefault(SimpleEventEmitter_1).default}})},{"./Ascii85":239,"./Base64":240,"./BezierEasing":241,"./Color":242,"./JSONStringify":243,"./SimpleEventEmitter":244,"./gl":245,"./mergeClasses":248,"./mimeTypeFromBuffer":249,"./utils":250,"./validation":251}],248:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const findProtoNames=i=>{let names=[];let c=i.constructor;do{const n=Object.getOwnPropertyNames(c.prototype);names=names.concat(n.filter((s=>s!=="constructor")));c=Object.getPrototypeOf(c)}while(c.prototype);return names};const wrapProto=i=>{const names=findProtoNames(i);const o={};for(const name of names){if(typeof i[name]!=="function"){continue}o[name]=function(...args){return i[name].apply(i,args)}}return o};const assignProperties=(a,b)=>{for(const propName of Object.keys(b)){if(a.hasOwnProperty(propName)){continue}Object.defineProperty(a,propName,{get:function(){return b[propName]},set:function(value){b[propName]=value}})}return a};const mergeClasses=(a,b)=>{if(b.constructor.name==="Object"){return Object.assign(a,b)}else{const wrapper=wrapProto(b);a=assignProperties(a,b);return assignProperties(a,wrapper)}};exports.default=mergeClasses},{}],249:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.mimeTypeFromBuffer=void 0;const mimeTypes={ffd8ffe000104a464946:"image/jpeg","89504e470d0a1a0a0000":"image/png","47494638396126026f01":"image/gif","52494646574f455053":"image/webp","464c4946":"image/flif","424d":"image/bmp","49492a00":"image/tiff","4d4d002a":"image/tiff","49492a00100000004352":"image/tiff","4d4d002a000000005200":"image/tiff","654c696673":"image/x-xcf","4954534608000000600000":"image/x-canon-cr2","495453461a00000003000000":"image/x-canon-cr3","414f4c4949":"image/vnd.ms-photo",38425053:"image/vnd.adobe.photoshop","3c3f78646f636d656e74":"application/x-indesign","504b0304":"application/epub+zip","526172211a0700cf9073":"application/x-rar-compressed","504b0708":"application/x-rar-compressed","504b0304140006000800":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",d0cf11e0a1b11ae10000:"application/msword",25504446:"application/pdf","1f8b08":"application/gzip","1f9d90":"application/x-tar","425a68":"application/x-bzip2","377abcaf271c":"application/x-7z-compressed","425a68393141524320202020202000":"application/x-7z-compressed","4d534346":"application/x-apple-diskimage",61726301:"application/x-apache-arrow",66747970:"video/mp4","4d546864":"audio/midi","1a45dfa3":"video/x-matroska","1a45dfa3010000000000":"video/x-matroska","00000014667479706d703432":"video/webm",77415645:"video/quicktime",52494646:"video/mp4","524946464f4500013000":"video/mpeg",fffb:"audio/mpeg",fff3:"audio/mp3",666675:"audio/opus","4f676753":"video/ogg","664c6143":"audio/x-flac",41564520:"audio/ape","7776706b":"audio/wavpack","464f524d00":"audio/amr","7f454c46":"application/x-elf","436f6e74656e742d74797065":"application/x-shockwave-flash","7b5c727466":"application/rtf","0061736d":"application/wasm","774f4646":"audio/x-wav",d46d9d6c:"audio/x-musepack","0d0a0d0a":"text/calendar",42494638:"video/x-flv","252150532d41646f6265":"application/eps",fd377a585a00:"application/x-xz","53514c69746520666f726d6174203300":"application/x-sqlite3","4e45531a":"application/x-nintendo-nes-rom",21:"text/plain",314159265359:"text/plain","7801730d626260":"text/plain","7865726d":"text/plain",6375736800000002e4:"text/plain",49545346:"application/x-deb","504b030414":"application/x-compress","0000001a667479703367706832":"video/mp2t","424c5030":"application/x-blender",4250473031:"image/bpg","4a2d2d20":"image/j2c","0000000cjp2":"image/jp2","0d0a870a":"image/jpx","6a5020200d0a870a":"image/jpx","000000186a703268":"image/jpx","6d6a703268":"image/jpm","4d4a32":"image/mj2","464f524d20":"audio/aiff","3c3f786d6c":"application/xml",7573746172:"application/tar+gzip",465753:"application/x-mobipocket-ebook","667479706d6f6f6d":"application/vnd.tcpdump.pcap","444d5321":"audio/x-dsf","4c495445":"application/x.ms.shortcut","53746f7261676554696d6573":"application/x.apple.alias",46575320:"application/x-mobipocket-ebook","6f6c796d7075733f6772652d":"audio/opus","4f52494643":"image/x-olympus-orf",49534328:"image/x-sony-arw",49534344:"image/x-adobe-dng",49545046:"image/x-panasonic-rw2",465547464946:"image/x-fujifilm-raf",667479702:"video/3gpp2",fff30000:"audio/aac","466f726d6174203300":"audio/x-it",44534420:"application/x-esri-shape",494433:"audio/aac","5a4f4f20":"application/x-xz",fdfd580000:"application/x-sqlite3","50616e20636f6f6b696e":"image/x-icon",47494638:"image/gif",4649463837610111:"image/vnd.adobe.photoshop","0000010000":"application/x-elf","4d5a":"application/x-msdownload","437265617469766520436f6d6d656e74":"application/vnd.ms-htmlhelp",415647:"model/stl","6d737132":"model/3mf","000001c0":"image/jxl",b501:"application/zstd","4a4c53":"image/jls",e3828596:"audio/x-rmf","2345584548494c5":"application/vnd.ms-outlook","0c6d6b6e6f74656e73":"audio/x-mid","1a0b617272616e673135":"application/x-arj","6173642020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020":"application/x-squashfs","3026b2758e66cf11a6d900aa0062ce6c":"application/x-msdownload","536c595845":"application/vnd.iccprofile"};const mimeTypeFromBuffer=buffer=>{const header=buffer.toString("hex",0,16);for(const magicNumber in mimeTypes){if(header.startsWith(magicNumber)){return mimeTypes[magicNumber]}}return"application/octet-stream"};exports.mimeTypeFromBuffer=mimeTypeFromBuffer},{}],250:[function(require,module,exports){(function(process,global,Buffer){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.objectToUrlParams=exports.getAllUrlParams=exports.bytesToNumber=exports.numberToBytes=exports.decodeString=exports.encodeString=exports.defer=exports.getGlobalObject=exports.deepEqual=exports.safeGet=exports.contains=exports.uuidv4=exports.asyncForEach=void 0;const validation_1=require("./validation");const asyncForEach=(array,callback)=>new Promise((async(resolve,reject)=>{try{for(let i=0;i<array.length;i++){await callback(array[i],i,array)}resolve()}catch(e){reject(e)}}));exports.asyncForEach=asyncForEach;function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(c=>{const r=Math.random()*16|0,v=c==="x"?r:r&3|8;return v.toString(16)}))}exports.uuidv4=uuidv4;function contains(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}exports.contains=contains;function safeGet(obj,key){if(Object.prototype.hasOwnProperty.call(obj,key)){return obj[key]}else{return undefined}}exports.safeGet=safeGet;function deepEqual(a,b){if(a===b){return true}const aKeys=Object.keys(a);const bKeys=Object.keys(b);for(const k of aKeys){if(!bKeys.includes(k)){return false}const aProp=a[k];const bProp=b[k];if((0,validation_1.isObject)(aProp)&&(0,validation_1.isObject)(bProp)){if(!deepEqual(aProp,bProp)){return false}}else if(aProp!==bProp){return false}}for(const k of bKeys){if(!aKeys.includes(k)){return false}}return true}exports.deepEqual=deepEqual;function getGlobalObject(){if(typeof globalThis!=="undefined"){return globalThis}if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("Unable to locate global object.")}exports.getGlobalObject=getGlobalObject;function defer(fn){process.nextTick(fn)}exports.defer=defer;function encodeString(str){if(typeof TextEncoder!=="undefined"){const encoder=new TextEncoder;return encoder.encode(str)}else if(typeof Buffer==="function"){const buf=Buffer.from(str,"utf-8");return new Uint8Array(buf.buffer,buf.byteOffset,buf.byteLength)}else{const arr=[];for(let i=0;i<str.length;i++){let code=str.charCodeAt(i);if(code>128){if((code&55296)===55296){const nextCode=str.charCodeAt(i+1);if((nextCode&56320)!==56320){throw new Error("follow-up utf-16 character does not start with 0xDC00")}i++;const p1=code&1023;const p2=nextCode&1023;code=65536|p1<<10|p2}if(code<2048){const b1=192|code>>6&31;const b2=128|code&63;arr.push(b1,b2)}else if(code<65536){const b1=224|code>>12&15;const b2=128|code>>6&63;const b3=128|code&63;arr.push(b1,b2,b3)}else if(code<2097152){const b1=240|code>>18&7;const b2=128|code>>12&63;const b3=128|code>>6&63;const b4=128|code&63;arr.push(b1,b2,b3,b4)}else{throw new Error(`Cannot convert character ${str.charAt(i)} (code ${code}) to utf-8`)}}else{arr.push(code<128?code:63)}}return new Uint8Array(arr)}}exports.encodeString=encodeString;function decodeString(buffer){if(typeof TextDecoder!=="undefined"){const decoder=new TextDecoder;if(buffer instanceof Uint8Array){return decoder.decode(buffer)}const buf=Uint8Array.from(buffer);return decoder.decode(buf)}else if(typeof Buffer==="function"){if(buffer instanceof Array){buffer=Uint8Array.from(buffer)}if(!(buffer instanceof Buffer)&&"buffer"in buffer&&buffer.buffer instanceof ArrayBuffer){const typedArray=buffer;buffer=Buffer.from(typedArray.buffer,typedArray.byteOffset,typedArray.byteLength)}if(!(buffer instanceof Buffer)){throw new Error("Unsupported buffer argument")}return buffer.toString("utf-8")}else{if(!(buffer instanceof Uint8Array)&&"buffer"in buffer&&buffer["buffer"]instanceof ArrayBuffer){const typedArray=buffer;buffer=new Uint8Array(typedArray.buffer,typedArray.byteOffset,typedArray.byteLength)}if(buffer instanceof Buffer||buffer instanceof Array||buffer instanceof Uint8Array){let str="";for(let i=0;i<buffer.length;i++){let code=buffer[i];if(code>128){if((code&240)===240){const b1=code,b2=buffer[i+1],b3=buffer[i+2],b4=buffer[i+3];code=(b1&7)<<18|(b2&63)<<12|(b3&63)<<6|b4&63;i+=3}else if((code&224)===224){const b1=code,b2=buffer[i+1],b3=buffer[i+2];code=(b1&15)<<12|(b2&63)<<6|b3&63;i+=2}else if((code&192)===192){const b1=code,b2=buffer[i+1];code=(b1&31)<<6|b2&63;i++}else{throw new Error("invalid utf-8 data")}}if(code>=65536){code^=65536;const p1=55296|code>>10;const p2=56320|code&1023;str+=String.fromCharCode(p1);str+=String.fromCharCode(p2)}else{str+=String.fromCharCode(code)}}return str}else{throw new Error("Unsupported buffer argument")}}}exports.decodeString=decodeString;function numberToBytes(number){const bytes=new Uint8Array(8);const view=new DataView(bytes.buffer);view.setFloat64(0,number);return new Array(...bytes)}exports.numberToBytes=numberToBytes;function bytesToNumber(bytes){const length=Array.isArray(bytes)?bytes.length:bytes.byteLength;if(length!==8){throw new TypeError("must be 8 bytes")}const bin=new Uint8Array(bytes);const view=new DataView(bin.buffer);const nr=view.getFloat64(0);return nr}exports.bytesToNumber=bytesToNumber;function getAllUrlParams(url){let queryString=url?url.split("?")[1]:typeof window!=="undefined"&&window.location&&window.location.search?window.location.search.slice(1):"";let obj={};if(queryString){queryString=queryString.split("#")[0];let arr=queryString.split("&");for(let i=0;i<arr.length;i++){let a=arr[i].split("=");let paramName=a[0];let paramValue=typeof a[1]==="undefined"?true:a[1];paramName=paramName.toLowerCase();if(typeof paramValue==="string"){paramValue=decodeURIComponent(paramValue).toLowerCase()}if(/\[(\d+)?\]$/.test(paramName)){let key=paramName.replace(/\[(\d+)?\]/,"");if(!obj[key])obj[key]=[];if(/\[\d+\]$/.test(paramName)){let index=parseInt(/\[(\d+)\]/.exec(paramName)[1]);obj[key][index]=paramValue}else{obj[key].push(paramValue)}}else{if(!obj[paramName]){obj[paramName]=paramValue}else if(obj[paramName]&&typeof obj[paramName]==="string"){obj[paramName]=[obj[paramName]];obj[paramName].push(paramValue)}else{obj[paramName].push(paramValue)}}}}return obj}exports.getAllUrlParams=getAllUrlParams;function objectToUrlParams(obj){return Object.keys(obj).map((key=>{const value=obj[key];if(Array.isArray(value)){return value.map((val=>`${encodeURIComponent(key)}[]=${encodeURIComponent(val)}`)).join("&")}return`${encodeURIComponent(key)}=${encodeURIComponent(value)}`})).join("&")}exports.objectToUrlParams=objectToUrlParams}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"./validation":251,_process:88,buffer:88}],251:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isEmpty=exports.isUrlValid=exports.isPhoneValid=exports.isPasswordValid=exports.isEmailValid=exports.isBuffer=exports.isSymbol=exports.isFunction=exports.isUndefined=exports.isDate=exports.isInfinity=exports.isNotNumber=exports.isNull=exports.isFloat=exports.isInt=exports.isNumberValid=exports.isNumber=exports.isBoolean=exports.isString=exports.isJson=exports.isObject=exports.isTypedArray=exports.isArray=void 0;const isArray=value=>Array.isArray(value)&&typeof value==="object";exports.isArray=isArray;const isTypedArray=value=>typeof value==="object"&&["ArrayBuffer","Buffer","Uint8Array","Uint16Array","Uint32Array","Int8Array","Int16Array","Int32Array"].includes(value.constructor.name);exports.isTypedArray=isTypedArray;const isObject=value=>typeof value==="object"&&value!==null&&!Array.isArray(value);exports.isObject=isObject;const isJson=value=>{try{const result=JSON.parse(typeof value==="string"?value:JSON.stringify(value));return(0,exports.isObject)(result)}catch(_a){return false}};exports.isJson=isJson;const isString=value=>typeof value==="string";exports.isString=isString;const isBoolean=value=>typeof value==="boolean";exports.isBoolean=isBoolean;const isNumber=value=>typeof value==="number"&&Number(value)===value;exports.isNumber=isNumber;const isNumberValid=value=>{if(typeof value==="number")return true;if(typeof value!=="string")return false;const num=parseFloat(value);return!isNaN(num)&&isFinite(num)&&/^(\-)?\d+(\.\d+)?$/.test(value)};exports.isNumberValid=isNumberValid;const isInt=value=>(0,exports.isNumber)(value)&&value%1===0;exports.isInt=isInt;const isFloat=value=>(0,exports.isNumber)(value)&&value%1!==0;exports.isFloat=isFloat;const isNull=value=>value===null&&typeof value==="object";exports.isNull=isNull;const isNotNumber=value=>typeof value==="number"&&isNaN(value);exports.isNotNumber=isNotNumber;const isInfinity=value=>typeof value==="number"&&!isFinite(value);exports.isInfinity=isInfinity;const isDate=value=>value instanceof Date||typeof value==="object"&&value!==null&&typeof value.getMonth==="function"||typeof value==="string"&&/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z?$/.test(value)&&!isNaN(Date.parse(value));exports.isDate=isDate;const isUndefined=value=>value===undefined&&typeof value==="undefined";exports.isUndefined=isUndefined;const isFunction=value=>typeof value==="function";exports.isFunction=isFunction;const isSymbol=value=>typeof value==="symbol";exports.isSymbol=isSymbol;const isBuffer=obj=>obj!=null&&obj.constructor!=null&&typeof obj.constructor.isBuffer==="function"&&obj.constructor.isBuffer(obj);exports.isBuffer=isBuffer;const isEmailValid=email=>{if(typeof email!=="string"){return false}const regex=/^\b[\w\.-]+@[\w\.-]+\.\w{2,4}\b$/gi;return regex.test(email)};exports.isEmailValid=isEmailValid;const isPasswordValid=password=>{if(typeof password!=="string"){return false}var regex=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$/gm;return regex.test(password)};exports.isPasswordValid=isPasswordValid;const isPhoneValid=phone=>{if(typeof phone!=="string"){return false}var regex=new RegExp("^((1[1-9])|([2-9][0-9]))((3[0-9]{3}[0-9]{4})|(9?[0-9]{3}[0-9]{5}))$");return regex.test(String(phone).replace(/\D/gi,""))};exports.isPhoneValid=isPhoneValid;const isUrlValid=url=>{if(typeof url!=="string"){return false}var regex=/^[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)$/gi;regex=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;return regex.test(url)};exports.isUrlValid=isUrlValid;function isEmpty(obj){for(const key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){return false}}return true}exports.isEmpty=isEmpty},{}],252:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});const SimpleEventEmitter_1=__importDefault(require("../Lib/SimpleEventEmitter"));class NotImplementedError extends Error{constructor(name){super(`${name} is not implemented`)}}class Api extends SimpleEventEmitter_1.default{constructor(){super()}stats(options){throw new NotImplementedError("stats")}subscribe(path,event,callback,settings){throw new NotImplementedError("subscribe")}unsubscribe(path,event,callback){throw new NotImplementedError("unsubscribe")}update(path,updates,options){throw new NotImplementedError("update")}set(path,value,options){throw new NotImplementedError("set")}get(path,options){throw new NotImplementedError("get")}transaction(path,callback,options){throw new NotImplementedError("transaction")}exists(path){throw new NotImplementedError("exists")}query(path,query,options){throw new NotImplementedError("query")}reflect(path,type,args){throw new NotImplementedError("reflect")}export(path,write,options){throw new NotImplementedError("export")}import(path,read,options){throw new NotImplementedError("import")}setSchema(path,schema,warnOnly){throw new NotImplementedError("setSchema")}getSchema(path){throw new NotImplementedError("getSchema")}getSchemas(){throw new NotImplementedError("getSchemas")}validateSchema(path,value,isUpdate){throw new NotImplementedError("validateSchema")}getMutations(filter){throw new NotImplementedError("getMutations")}getChanges(filter){throw new NotImplementedError("getChanges")}}exports.default=Api},{"../Lib/SimpleEventEmitter":265}],253:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.DataBase=exports.DataBaseSettings=void 0;const SimpleEventEmitter_1=__importDefault(require("../Lib/SimpleEventEmitter"));const reference_1=require("./reference");const DebugLogger_1=__importDefault(require("../Lib/DebugLogger"));const TypeMappings_1=__importDefault(require("../Lib/TypeMappings"));class DataBaseSettings{constructor(options){this.logLevel="log";this.logColors=true;this.info="realtime database";if(typeof options!=="object"){options={}}if(typeof options.logLevel==="string"){this.logLevel=options.logLevel}if(typeof options.logColors==="boolean"){this.logColors=options.logColors}if(typeof options.info==="string"){this.info=options.info}}}exports.DataBaseSettings=DataBaseSettings;class DataBase extends SimpleEventEmitter_1.default{constructor(dbname,options={}){super();this._ready=false;options=new DataBaseSettings(options);this.name=dbname;this.debug=new DebugLogger_1.default(options.logLevel,`[${dbname}]`);this.types=new TypeMappings_1.default(this);this.once("ready",(()=>{this._ready=true}))}async ready(callback){if(!this._ready){await new Promise((resolve=>this.on("ready",resolve)))}callback===null||callback===void 0?void 0:callback()}get isReady(){return this._ready}ref(path){return new reference_1.DataReference(this,path)}get root(){return this.ref("")}query(path){const ref=new reference_1.DataReference(this,path);return new reference_1.DataReferenceQuery(ref)}get schema(){return{get:path=>this.storage.getSchema(path),set:(path,schema,warnOnly=false)=>this.storage.setSchema(path,schema,warnOnly),all:()=>this.storage.getSchemas(),check:(path,value,isUpdate)=>this.storage.validateSchema(path,value,isUpdate)}}}exports.DataBase=DataBase;exports.default=DataBase},{"../Lib/DebugLogger":258,"../Lib/SimpleEventEmitter":265,"../Lib/TypeMappings":269,"./reference":254}],254:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.DataReferenceQuery=exports.DataReferencesArray=exports.DataSnapshotsArray=exports.QueryDataRetrievalOptions=exports.DataReference=exports.DataRetrievalOptions=void 0;const Subscription_1=require("../Lib/Subscription");const snapshot_1=require("./snapshot");const PathInfo_1=__importDefault(require("../Lib/PathInfo"));const ID_1=__importDefault(require("../Lib/ID"));const OptionalObservable_1=require("../Lib/OptionalObservable");class DataRetrievalOptions{constructor(options){if(!options){options={}}if(typeof options.include!=="undefined"&&!(options.include instanceof Array)){throw new TypeError("options.include must be an array")}if(typeof options.exclude!=="undefined"&&!(options.exclude instanceof Array)){throw new TypeError("options.exclude must be an array")}if(typeof options.child_objects!=="undefined"&&typeof options.child_objects!=="boolean"){throw new TypeError("options.child_objects must be a boolean")}if(typeof options.cache_mode==="string"&&!["allow","bypass","force"].includes(options.cache_mode)){throw new TypeError("invalid value for options.cache_mode")}this.include=options.include||undefined;this.exclude=options.exclude||undefined;this.child_objects=typeof options.child_objects==="boolean"?options.child_objects:undefined;this.cache_mode=typeof options.cache_mode==="string"?options.cache_mode:typeof options.allow_cache==="boolean"?options.allow_cache?"allow":"bypass":"allow";this.cache_cursor=typeof options.cache_cursor==="string"?options.cache_cursor:undefined}}exports.DataRetrievalOptions=DataRetrievalOptions;const _private=Symbol("private");class DataReference{constructor(db,path,vars){this.db=db;if(!path){path=""}path=path.replace(/^\/|\/$/g,"");const pathInfo=PathInfo_1.default.get(path);const key=pathInfo.key;const callbacks=[];this[_private]={get path(){return path},get key(){return key},get callbacks(){return callbacks},vars:vars||{},context:{},pushed:false,cursor:null}}context(context,merge=false){const currentContext=this[_private].context;if(typeof context==="object"){const newContext=context?merge?currentContext||{}:context:{};if(context){Object.keys(context).forEach((key=>{newContext[key]=context[key]}))}this[_private].context=newContext;return this}else if(typeof context==="undefined"){console.warn("Use snap.context() instead of snap.ref.context() to get updating context in event callbacks");return currentContext}else{throw new Error("Invalid context argument")}}get cursor(){return this[_private].cursor}set cursor(value){var _a;this[_private].cursor=value;(_a=this.onCursor)===null||_a===void 0?void 0:_a.call(this,value)}get isWildcardPath(){return this.path.indexOf("*")>=0||this.path.indexOf("$")>=0}get path(){return this[_private].path}get key(){const key=this[_private].key;return typeof key==="number"?`[${key}]`:key}get index(){const key=this[_private].key;if(typeof key!=="number"){throw new Error(`"${key}" is not a number`)}return key}get parent(){const currentPath=PathInfo_1.default.fillVariables2(this.path,this.vars);const info=PathInfo_1.default.get(currentPath);if(info.parentPath===null){return null}return new DataReference(this.db,info.parentPath).context(this[_private].context)}get vars(){return this[_private].vars}child(childPath){childPath=typeof childPath==="number"?childPath:childPath.replace(/^\/|\/$/g,"");const currentPath=PathInfo_1.default.fillVariables2(this.path,this.vars);const targetPath=PathInfo_1.default.getChildPath(currentPath,childPath);return new DataReference(this.db,targetPath).context(this[_private].context)}async set(value,onComplete){try{if(this.isWildcardPath){throw new Error(`Cannot set the value of wildcard path "/${this.path}"`)}if(this.parent===null){throw new Error("Cannot set the root object. Use update, or set individual child properties")}if(typeof value==="undefined"){throw new TypeError(`Cannot store undefined value in "/${this.path}"`)}if(!this.db.isReady){await this.db.ready()}value=this.db.types.serialize(this.path,value);const{cursor:cursor}=await this.db.storage.set(this.path,value,{context:this[_private].context});this.cursor=cursor;if(typeof onComplete==="function"){try{onComplete(null,this)}catch(err){console.error("Error in onComplete callback:",err)}}}catch(err){if(typeof onComplete==="function"){try{onComplete(err,this)}catch(err){console.error("Error in onComplete callback:",err)}}else{throw err}}return this}async update(updates,onComplete){try{if(this.isWildcardPath){throw new Error(`Cannot update the value of wildcard path "/${this.path}"`)}if(!this.db.isReady){await this.db.ready()}if(typeof updates!=="object"||updates instanceof Array||updates instanceof ArrayBuffer||updates instanceof Date){await this.set(updates)}else if(Object.keys(updates).length===0){console.warn(`update called on path "/${this.path}", but there is nothing to update`)}else{updates=this.db.types.serialize(this.path,updates);const{cursor:cursor}=await this.db.storage.update(this.path,updates,{context:this[_private].context});this.cursor=cursor}if(typeof onComplete==="function"){try{onComplete(null,this)}catch(err){console.error("Error in onComplete callback:",err)}}}catch(err){if(typeof onComplete==="function"){try{onComplete(err,this)}catch(err){console.error("Error in onComplete callback:",err)}}else{throw err}}return this}async transaction(callback){if(this.isWildcardPath){throw new Error(`Cannot start a transaction on wildcard path "/${this.path}"`)}if(!this.db.isReady){await this.db.ready()}let throwError;const cb=currentValue=>{currentValue=this.db.types.deserialize(this.path,currentValue);const snap=new snapshot_1.DataSnapshot(this,currentValue);let newValue;try{newValue=callback(snap)}catch(err){throwError=err;return}if(newValue instanceof Promise){return newValue.then((val=>this.db.types.serialize(this.path,val))).catch((err=>{throwError=err;return}))}else{return this.db.types.serialize(this.path,newValue)}};const{cursor:cursor}=await this.db.storage.transaction(this.path,cb,{context:this[_private].context});this.cursor=cursor;if(throwError){throw throwError}return this}on(event,callback,cancelCallback){if(this.path===""&&["value","child_changed"].includes(event)){console.warn("WARNING: Listening for value and child_changed events on the root node is a bad practice. These events require loading of all data (value event), or potentially lots of data (child_changed event) each time they are fired")}let eventPublisher;const eventStream=new Subscription_1.EventStream((publisher=>{eventPublisher=publisher}));const cb={event:event,stream:eventStream,userCallback:typeof callback==="function"?callback:undefined,ourCallback:(err,path,newValue,oldValue,eventContext)=>{if(err){this.db.debug.error(`Error getting data for event ${event} on path "${path}"`,err);return}const ref=this.db.ref(path);ref[_private].vars=PathInfo_1.default.extractVariables(this.path,path);let callbackObject;if(event.startsWith("notify_")){callbackObject=ref.context(eventContext||{})}else{const values={previous:this.db.types.deserialize(path,oldValue),current:this.db.types.deserialize(path,newValue)};if(event==="child_removed"){callbackObject=new snapshot_1.DataSnapshot(ref,values.previous,true,values.previous,eventContext)}else if(event==="mutations"){callbackObject=new snapshot_1.MutationsDataSnapshot(ref,values.current,eventContext)}else{const isRemoved=event==="mutated"&&values.current===null;callbackObject=new snapshot_1.DataSnapshot(ref,values.current,isRemoved,values.previous,eventContext)}}eventPublisher.publish(callbackObject);if(eventContext===null||eventContext===void 0?void 0:eventContext.acebase_cursor){this.cursor=eventContext.acebase_cursor}}};this[_private].callbacks.push(cb);const subscribe=()=>{if(typeof callback==="function"){eventStream.subscribe(callback,((activated,cancelReason)=>{if(!activated){cancelCallback&&cancelCallback(cancelReason)}}))}const advancedOptions=typeof callback==="object"?callback:{newOnly:!callback};if(typeof advancedOptions.newOnly!=="boolean"){advancedOptions.newOnly=false}if(this.isWildcardPath){advancedOptions.newOnly=true}const cancelSubscription=err=>{const callbacks=this[_private].callbacks;callbacks.splice(callbacks.indexOf(cb),1);this.db.storage.unsubscribe(this.path,event,cb.ourCallback);this.db.debug.error(`Subscription "${event}" on path "/${this.path}" canceled because of an error: ${err.message}`);eventPublisher.cancel(err.message)};const authorized=this.db.storage.subscribe(this.path,event,cb.ourCallback,{newOnly:advancedOptions.newOnly,cancelCallback:cancelSubscription,syncFallback:advancedOptions.syncFallback});const allSubscriptionsStoppedCallback=()=>{const callbacks=this[_private].callbacks;callbacks.splice(callbacks.indexOf(cb),1);return this.db.storage.unsubscribe(this.path,event,cb.ourCallback)};if(authorized instanceof Promise){authorized.then((()=>{eventPublisher.start(allSubscriptionsStoppedCallback)})).catch(cancelSubscription)}else{eventPublisher.start(allSubscriptionsStoppedCallback)}if(!advancedOptions.newOnly){if(event==="value"){this.get((snap=>{eventPublisher.publish(snap)}))}else if(event==="child_added"){this.get((snap=>{const val=snap.val();if(val===null||typeof val!=="object"){return}Object.keys(val).forEach((key=>{const childSnap=new snapshot_1.DataSnapshot(this.child(key),val[key]);eventPublisher.publish(childSnap)}))}))}else if(event==="notify_child_added"){const step=100,limit=step;let skip=0;const more=async()=>{const children=await this.db.storage.reflect(this.path,"children",{limit:limit,skip:skip});if(children&&"more"in children){children.list.forEach((child=>{const childRef=this.child(child.key);eventPublisher.publish(childRef)}));if(children.more){skip+=step;more()}}};more()}}};if(this.db.isReady){subscribe()}else{this.db.ready(subscribe)}return eventStream}off(event,callback){const subscriptions=this[_private].callbacks;const stopSubs=subscriptions.filter((sub=>(!event||sub.event===event)&&(!callback||sub.userCallback===callback)));if(stopSubs.length===0){this.db.debug.warn(`Can't find event subscriptions to stop (path: "${this.path}", event: ${event||"(any)"}, callback: ${callback})`)}stopSubs.forEach((sub=>{sub.stream.stop()}));return this}get(optionsOrCallback,callback){if(!this.db.isReady){const promise=this.db.ready().then((()=>this.get(optionsOrCallback,callback)));return typeof optionsOrCallback!=="function"&&typeof callback!=="function"?promise:undefined}callback=typeof optionsOrCallback==="function"?optionsOrCallback:typeof callback==="function"?callback:undefined;if(this.isWildcardPath){const error=new Error(`Cannot get value of wildcard path "/${this.path}". Use .query() instead`);if(typeof callback==="function"){throw error}return Promise.reject(error)}const options=new DataRetrievalOptions(typeof optionsOrCallback==="object"?optionsOrCallback:{cache_mode:"allow"});const promise=this.db.storage.get(this.path,options).then((result=>{var _a;const isNewApiResult="context"in result&&"value"in result;if(!isNewApiResult){console.warn("IvipBase api.get method returned an old response value. Update your acebase or acebase-client package");result={value:result,context:{}}}const value=this.db.types.deserialize(this.path,result.value);const snapshot=new snapshot_1.DataSnapshot(this,value,undefined,undefined,result.context);if((_a=result.context)===null||_a===void 0?void 0:_a.acebase_cursor){this.cursor=result.context.acebase_cursor}return snapshot}));if(callback){promise.then(callback).catch((err=>{console.error("Uncaught error:",err)}));return}else{return promise}}once(event,options){if(event==="value"&&!this.isWildcardPath){return this.get(options)}return new Promise((resolve=>{const callback=snap=>{this.off(event,callback);resolve(snap)};this.on(event,callback)}))}push(value,onComplete){if(this.isWildcardPath){const error=new Error(`Cannot push to wildcard path "/${this.path}"`);if(typeof value==="undefined"||typeof onComplete==="function"){throw error}return Promise.reject(error)}const id=ID_1.default.generate();const ref=this.child(id);ref[_private].pushed=true;if(typeof value!=="undefined"){return ref.set(value,onComplete).then((()=>ref))}else{return ref}}async remove(){if(this.isWildcardPath){throw new Error(`Cannot remove wildcard path "/${this.path}". Use query().remove instead`)}if(this.parent===null){throw new Error("Cannot remove the root node")}return this.set(null)}async exists(){if(this.isWildcardPath){throw new Error(`Cannot check wildcard path "/${this.path}" existence`)}if(!this.db.isReady){await this.db.ready()}return this.db.storage.exists(this.path)}query(){return new DataReferenceQuery(this)}async count(){const info=await this.reflect("info",{child_count:true});return info.children.count}async reflect(type,args){if(this.isWildcardPath){throw new Error(`Cannot reflect on wildcard path "/${this.path}"`)}if(!this.db.isReady){await this.db.ready()}return this.db.storage.reflect(this.path,type,args)}async export(write,options={format:"json",type_safe:true}){if(this.isWildcardPath){throw new Error(`Cannot export wildcard path "/${this.path}"`)}if(!this.db.isReady){await this.db.ready()}const writeFn=typeof write==="function"?write:write.write.bind(write);return this.db.storage.export(this.path,writeFn,options)}async import(read,options={format:"json",suppress_events:false}){if(this.isWildcardPath){throw new Error(`Cannot import to wildcard path "/${this.path}"`)}if(!this.db.isReady){await this.db.ready()}return this.db.storage.import(this.path,read,options)}observe(options){if(options){throw new Error("observe does not support data retrieval options yet")}if(this.isWildcardPath){throw new Error(`Cannot observe wildcard path "/${this.path}"`)}const Observable=(0,OptionalObservable_1.getObservable)();return new Observable((observer=>{let cache,resolved=false;let promise=Promise.all([this.get(options)]).then((([snap])=>{resolved=true;cache=snap.val();observer.next(cache)}));const updateCache=snap=>{if(!resolved){promise=promise.then((()=>updateCache(snap)));return}const mutatedPath=snap.ref.path;if(mutatedPath===this.path){cache=snap.val();return observer.next(cache)}const trailKeys=PathInfo_1.default.getPathKeys(mutatedPath).slice(PathInfo_1.default.getPathKeys(this.path).length);let target=cache;while(trailKeys.length>1){const key=trailKeys.shift();if(typeof key==="string"||typeof key==="number"){if(!(key in target)){target[key]=typeof trailKeys[0]==="number"?[]:{}}target=target[key]}}const prop=trailKeys.shift();const newValue=snap.val();if(typeof prop==="string"||typeof prop==="number"){if(newValue===null){target instanceof Array&&typeof prop==="number"?target.splice(prop,1):delete target[prop]}else{target[prop]=newValue}}observer.next(cache)};this.on("mutated",updateCache);return()=>{this.off("mutated",updateCache)}}))}async forEach(callbackOrOptions,callback){let options;if(typeof callbackOrOptions==="function"){callback=callbackOrOptions}else{options=callbackOrOptions}if(typeof callback!=="function"){throw new TypeError("No callback function given")}const{children:children}=await this.reflect("children",{limit:0,skip:0});const summary={canceled:false,total:children&&"list"in children?children===null||children===void 0?void 0:children.list.length:0,processed:0};if(children&&"list"in children){for(let i=0;i<children.list.length;i++){const key=children.list[i].key;const snapshot=await this.child(key).get(options);summary.processed++;if(!snapshot||!snapshot.exists()){continue}const result=await callback(snapshot);if(result===false){summary.canceled=true;break}}}return summary}async getMutations(cursorOrDate){const cursor=typeof cursorOrDate==="string"?cursorOrDate:undefined;const timestamp=cursorOrDate===null||typeof cursorOrDate==="undefined"?0:cursorOrDate instanceof Date?cursorOrDate.getTime():Date.now();return this.db.storage.getMutations({path:this.path,cursor:cursor,timestamp:timestamp})}async getChanges(cursorOrDate){const cursor=typeof cursorOrDate==="string"?cursorOrDate:undefined;const timestamp=cursorOrDate===null||typeof cursorOrDate==="undefined"?0:cursorOrDate instanceof Date?cursorOrDate.getTime():Date.now();return this.db.storage.getChanges({path:this.path,cursor:cursor,timestamp:timestamp})}}exports.DataReference=DataReference;class QueryDataRetrievalOptions extends DataRetrievalOptions{constructor(options){super(options);if(!["undefined","boolean"].includes(typeof options.snapshots)){throw new TypeError("options.snapshots must be a boolean")}this.snapshots=typeof options.snapshots==="boolean"?options.snapshots:true}}exports.QueryDataRetrievalOptions=QueryDataRetrievalOptions;class DataSnapshotsArray extends Array{static from(snaps){const arr=new DataSnapshotsArray(snaps.length);snaps.forEach(((snap,i)=>arr[i]=snap));return arr}getValues(){return this.map((snap=>snap.val()))}}exports.DataSnapshotsArray=DataSnapshotsArray;class DataReferencesArray extends Array{static from(refs){const arr=new DataReferencesArray(refs.length);refs.forEach(((ref,i)=>arr[i]=ref));return arr}getPaths(){return this.map((ref=>ref.path))}}exports.DataReferencesArray=DataReferencesArray;class DataReferenceQuery{constructor(ref){this.ref=ref;this[_private]={filters:[],skip:0,take:0,order:[],events:{}}}filter(key,op,compare){if((op==="in"||op==="!in")&&(!(compare instanceof Array)||compare.length===0)){throw new Error(`${op} filter for ${key} must supply an Array compare argument containing at least 1 value`)}if((op==="between"||op==="!between")&&(!(compare instanceof Array)||compare.length!==2)){throw new Error(`${op} filter for ${key} must supply an Array compare argument containing 2 values`)}if((op==="matches"||op==="!matches")&&!(compare instanceof RegExp)){throw new Error(`${op} filter for ${key} must supply a RegExp compare argument`)}this[_private].filters.push({key:key,op:op,compare:compare});return this}where(key,op,compare){return this.filter(key,op,compare)}take(n){this[_private].take=n;return this}skip(n){this[_private].skip=n;return this}sort(key,ascending=true){if(!["string","number"].includes(typeof key)){throw"key must be a string or number"}this[_private].order.push({key:key,ascending:ascending});return this}order(key,ascending=true){return this.sort(key,ascending)}get(optionsOrCallback,callback){if(!this.ref.db.isReady){const promise=this.ref.db.ready().then((()=>this.get(optionsOrCallback,callback)));return typeof optionsOrCallback!=="function"&&typeof callback!=="function"?promise:undefined}callback=typeof optionsOrCallback==="function"?optionsOrCallback:typeof callback==="function"?callback:undefined;const options=new QueryDataRetrievalOptions(typeof optionsOrCallback==="object"?optionsOrCallback:{snapshots:true,cache_mode:"allow"});options.allow_cache=options.cache_mode!=="bypass";options.eventHandler=ev=>{if(!this[_private].events[ev.name]){return false}const listeners=this[_private].events[ev.name];if(typeof listeners!=="object"||listeners.length===0){return false}if(["add","change","remove"].includes(ev.name)){const eventData={name:ev.name,ref:new DataReference(this.ref.db,ev.path)};if(eventData.ref&&options.snapshots&&ev.name!=="remove"){const val=db.types.deserialize(ev.path,ev.value);eventData.snapshot=new snapshot_1.DataSnapshot(eventData.ref,val,false)}ev=eventData}listeners.forEach((callback=>{var _a,_b;try{callback(ev)}catch(err){this.ref.db.debug.error(`Error executing "${ev.name}" event handler of realtime query on path "${this.ref.path}": ${(_b=(_a=err===null||err===void 0?void 0:err.stack)!==null&&_a!==void 0?_a:err===null||err===void 0?void 0:err.message)!==null&&_b!==void 0?_b:err}`)}}))};options.monitor={add:false,change:false,remove:false};if(this[_private].events){if(this[_private].events["add"]&&this[_private].events["add"].length>0){options.monitor.add=true}if(this[_private].events["change"]&&this[_private].events["change"].length>0){options.monitor.change=true}if(this[_private].events["remove"]&&this[_private].events["remove"].length>0){options.monitor.remove=true}}this.stop();const db=this.ref.db;return db.storage.query(this.ref.path,this[_private],options).catch((err=>{throw new Error(err)})).then((res=>{const{stop:stop}=res;let{results:results,context:context}=res;this.stop=async()=>{await stop()};if(!("results"in res&&"context"in res)){console.warn("Query results missing context. Update your acebase and/or acebase-client packages");results=res,context={}}if(options.snapshots){const snaps=results.map((result=>{const val=db.types.deserialize(result.path,result.val);return new snapshot_1.DataSnapshot(db.ref(result.path),val,false,undefined,context)}));return DataSnapshotsArray.from(snaps)}else{const refs=results.map((path=>db.ref(path)));return DataReferencesArray.from(refs)}})).then((results=>{callback&&callback(results);return results}))}async stop(){}getRefs(callback){return this.get({snapshots:false},callback)}find(){return this.get({snapshots:false})}async count(){const refs=await this.find();return refs.length}async exists(){const originalTake=this[_private].take;const p=this.take(1).find();this.take(originalTake);const refs=await p;return refs.length!==0}async remove(callback){const refs=await this.find();const parentUpdates=refs.reduce(((parents,ref)=>{if(ref.parent){const parent=parents[ref.parent.path];if(!parent){parents[ref.parent.path]=[ref]}else{parent.push(ref)}}return parents}),{});const db=this.ref.db;const promises=Object.keys(parentUpdates).map((async parentPath=>{const updates=refs.reduce(((updates,ref)=>{updates[ref.key]=null;return updates}),{});const ref=db.ref(parentPath);try{await ref.update(updates);return{ref:ref,success:true}}catch(error){return{ref:ref,success:false,error:error}}}));const results=await Promise.all(promises);callback&&callback(results);return results}on(event,callback){if(!this[_private].events[event]){this[_private].events[event]=[]}this[_private].events[event].push(callback);return this}off(event,callback){if(typeof event==="undefined"){this[_private].events={};return this}if(!this[_private].events[event]){return this}if(typeof callback==="undefined"){delete this[_private].events[event];return this}const index=this[_private].events[event].indexOf(callback);if(!~index){return this}this[_private].events[event].splice(index,1);return this}async forEach(callbackOrOptions,callback){let options;if(typeof callbackOrOptions==="function"){callback=callbackOrOptions}else{options=callbackOrOptions}if(typeof callback!=="function"){throw new TypeError("No callback function given")}const refs=await this.find();const summary={canceled:false,total:refs.length,processed:0};for(let i=0;i<refs.length;i++){const ref=refs[i];const snapshot=await ref.get(options);summary.processed++;if(!snapshot||!snapshot.exists()){continue}const result=await callback(snapshot);if(result===false){summary.canceled=true;break}}return summary}}exports.DataReferenceQuery=DataReferenceQuery},{"../Lib/ID":259,"../Lib/OptionalObservable":261,"../Lib/PathInfo":263,"../Lib/Subscription":267,"./snapshot":255}],255:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.MutationsDataSnapshot=exports.DataSnapshot=void 0;const PathInfo_1=__importDefault(require("../Lib/PathInfo"));function getChild(snapshot,path,previous=false){if(!snapshot.exists()){return null}let child=previous?snapshot.previous():snapshot.val();if(typeof path==="number"){return child[path]}PathInfo_1.default.getPathKeys(path).every((key=>{child=child[key];return typeof child!=="undefined"}));return child||null}function getChildren(snapshot){if(!snapshot.exists()){return[]}const value=snapshot.val();if(value instanceof Array){return new Array(value.length).map(((v,i)=>i))}if(typeof value==="object"){return Object.keys(value)}return[]}class DataSnapshot{exists(){return false}constructor(ref,value,isRemoved=false,prevValue,context){this.ref=ref;this.val=()=>value;this.previous=()=>prevValue;this.exists=()=>{if(isRemoved){return false}return value!==null&&typeof value!=="undefined"};this.context=()=>context||{}}static for(ref,value){return new DataSnapshot(ref,value)}child(path){const val=getChild(this,path,false);const prev=getChild(this,path,true);return new DataSnapshot(this.ref.child(path),val,false,prev)}hasChild(path){return getChild(this,path)!==null}hasChildren(){return getChildren(this).length>0}numChildren(){return getChildren(this).length}forEach(callback){var _a,_b;const value=(_a=this.val())!==null&&_a!==void 0?_a:{};const prev=(_b=this.previous())!==null&&_b!==void 0?_b:{};return getChildren(this).every((key=>{const snap=new DataSnapshot(this.ref.child(key),value[key],false,prev[key]);return callback(snap)}))}get key(){return this.ref.key}}exports.DataSnapshot=DataSnapshot;class MutationsDataSnapshot extends DataSnapshot{constructor(ref,mutations,context){super(ref,mutations,false,undefined,context);this.previous=()=>{throw new Error("Iterate values to get previous values for each mutation")};this.val=(warn=true)=>{if(warn){console.warn("Unless you know what you are doing, it is best not to use the value of a mutations snapshot directly. Use child methods and forEach to iterate the mutations instead")}return mutations}}forEach(callback){const mutations=this.val(false);return mutations.every((mutation=>{const ref=mutation.target.reduce(((ref,key)=>ref.child(key)),this.ref);const snap=new DataSnapshot(ref,mutation.val,false,mutation.prev);return callback(snap)}))}child(index){if(typeof index!=="number"){throw new Error("child index must be a number")}const mutation=this.val(false)[index];const ref=mutation.target.reduce(((ref,key)=>ref.child(key)),this.ref);return new DataSnapshot(ref,mutation.val,false,mutation.prev)}}exports.MutationsDataSnapshot=MutationsDataSnapshot},{"../Lib/PathInfo":263}],256:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ascii85=void 0;function c(input,length,result){const b=[0,0,0,0,0];for(let i=0;i<length;i+=4){let n=((input[i]*256+input[i+1])*256+input[i+2])*256+input[i+3];if(!n){result.push("z")}else{for(let j=0;j<5;b[j++]=n%85+33,n=Math.floor(n/85)){}result.push(String.fromCharCode(b[4],b[3],b[2],b[1],b[0]))}}}function encode(arr){var _a;const input=arr,result=[],remainder=input.length%4,length=input.length-remainder;c(input,length,result);if(remainder){const t=new Uint8Array(4);t.set(input.slice(length),0);c(t,4,result);let x=(_a=result.pop())!==null&&_a!==void 0?_a:"";if(x=="z"){x="!!!!!"}result.push(x.substr(0,remainder+1))}let ret=result.join("");ret="<~"+ret+"~>";return ret}exports.ascii85={encode:function(arr){if(arr instanceof ArrayBuffer){arr=new Uint8Array(arr,0,arr.byteLength)}return encode(arr)},decode:function(input){if(!input.startsWith("<~")||!input.endsWith("~>")){throw new Error("Invalid input string")}input=input.substr(2,input.length-4);const n=input.length,r=[],b=[0,0,0,0,0];let t,x,y,d;for(let i=0;i<n;++i){if(input.charAt(i)=="z"){r.push(0,0,0,0);continue}for(let j=0;j<5;++j){b[j]=input.charCodeAt(i+j)-33}d=n-i;if(d<5){for(let j=d;j<4;b[++j]=0){}b[d]=85}t=(((b[0]*85+b[1])*85+b[2])*85+b[3])*85+b[4];x=t&255;t>>>=8;y=t&255;t>>>=8;r.push(t>>>8,t&255,y,x);for(let j=d;j<5;++j,r.pop()){}i+=4}const data=new Uint8Array(r);return data.buffer.slice(data.byteOffset,data.byteOffset+data.byteLength)}};exports.default=exports.ascii85},{}],257:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.assert=void 0;function assert(condition,error){if(!condition){throw new Error(`Assertion failed: ${error!==null&&error!==void 0?error:"check your code"}`)}}exports.assert=assert},{}],258:[function(require,module,exports){(function(process){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const noop=()=>{};class DebugLogger{constructor(level="log",prefix=""){this.level=level;this.prefix=prefix;this.setLevel(level)}setLevel(level){const prefix=this.prefix?this.prefix+" %s":"";this.verbose=["verbose"].includes(level)?prefix?console.log.bind(console,prefix):console.log.bind(console):noop;this.log=["verbose","log"].includes(level)?prefix?console.log.bind(console,prefix):console.log.bind(console):noop;this.warn=["verbose","log","warn"].includes(level)?prefix?console.warn.bind(console,prefix):console.warn.bind(console):noop;this.error=["verbose","log","warn","error"].includes(level)?prefix?console.error.bind(console,prefix):console.error.bind(console):noop;this.write=text=>{const isRunKit=typeof process!=="undefined"&&process.env&&typeof process.env.RUNKIT_ENDPOINT_PATH==="string";if(text&&isRunKit){text.split("\n").forEach((line=>console.log(line)))}else{console.log(text)}}}}exports.default=DebugLogger}).call(this)}).call(this,require("_process"))},{_process:88}],259:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});const cuid_1=__importDefault(require("cuid"));let timeBias=0;class ID{static set timeBias(bias){if(typeof bias!=="number"){return}timeBias=bias}static generate(){return(0,cuid_1.default)().slice(1)}}exports.default=ID},{cuid:133}],260:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.ObjectCollection=void 0;const ID_1=__importDefault(require("./ID"));class ObjectCollection{static from(array){const collection={};array.forEach((child=>{collection[ID_1.default.generate()]=child}));return collection}}exports.ObjectCollection=ObjectCollection},{"./ID":259}],261:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.setObservable=exports.getObservable=void 0;const SimpleObservable_1=__importDefault(require("./SimpleObservable"));const Utils_1=require("./Utils");let _shimRequested=false;let _observable;(async()=>{const global=(0,Utils_1.getGlobalObject)();if(typeof global.Observable!=="undefined"){_observable=global.Observable;return}try{const{Observable:Observable}=await Promise.resolve().then((()=>__importStar(require("rxjs"))));_observable=Observable}catch(_a){_observable=SimpleObservable_1.default}})();function getObservable(){if(_observable===SimpleObservable_1.default&&!_shimRequested){console.warn("Using IvipBase's simple Observable implementation because rxjs is not available. "+'Add it to your project with "npm install rxjs", add it to IvipBase using db.setObservable(Observable), '+'or call db.setObservable("shim") to suppress this warning')}if(_observable){return _observable}throw new Error("RxJS Observable could not be loaded. ")}exports.getObservable=getObservable;function setObservable(Observable){if(Observable==="shim"){_observable=SimpleObservable_1.default;_shimRequested=true}else{_observable=Observable}}exports.setObservable=setObservable},{"./SimpleObservable":266,"./Utils":270,rxjs:88}],262:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PartialArray=void 0;class PartialArray{constructor(sparseArray){if(sparseArray instanceof Array){for(let i=0;i<sparseArray.length;i++){if(typeof sparseArray[i]!=="undefined"){this[i]=sparseArray[i]}}}else if(sparseArray){Object.assign(this,sparseArray)}}}exports.PartialArray=PartialArray},{}],263:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PathInfo=exports.PathReference=void 0;class PathReference{constructor(path){this.path=path}}exports.PathReference=PathReference;function getPathKeys(path){path=path.replace(/\[/g,"/[").replace(/^\/+/,"").replace(/\/+$/,"");if(path.length===0){return[""]}const keys=["",...path.split("/")];return keys.map((key=>key.startsWith("[")?parseInt(key.slice(1,-1)):key))}class PathInfo{static get(path){return new PathInfo(path)}static getChildPath(path,childKey){return PathInfo.get(path).child(childKey).path}static getPathKeys(path){return getPathKeys(path)}constructor(path){if(typeof path==="string"){this.keys=getPathKeys(path)}else if(path instanceof Array){this.keys=path}else{this.keys=[""]}this.path=this.keys.reduce(((path,key,i)=>i===0?`${key}`:typeof key==="string"?`${path}/${key}`:`${path}[${key}]`),"").replace(/^\//gi,"")}get key(){return this.keys.length===0?null:this.keys.slice(-1)[0]}get parent(){if(this.keys.length==0){return null}const parentKeys=this.keys.slice(0,-1);return new PathInfo(parentKeys)}get parentPath(){var _a,_b;return this.keys.length===0?null:(_b=(_a=this.parent)===null||_a===void 0?void 0:_a.path)!==null&&_b!==void 0?_b:null}child(childKey){if(typeof childKey==="string"){if(childKey.length===0){throw new Error(`child key for path "${this.path}" cannot be empty`)}const keys=getPathKeys(childKey);keys.forEach(((key,index)=>{if(typeof key!=="string"){return}if(/[\x00-\x08\x0b\x0c\x0e-\x1f/[\]\\]/.test(key)){throw new Error(`Invalid child key "${key}" for path "${this.path}". Keys cannot contain control characters or any of the following characters: \\ / [ ]`)}if(key.length>128){throw new Error(`child key "${key}" for path "${this.path}" is too long. Max key length is 128`)}if(index!==0&&key.length===0){throw new Error(`child key for path "${this.path}" cannot be empty`)}}));childKey=keys}if(Array.isArray(childKey)&&childKey[0]==="")childKey.shift();return new PathInfo(this.keys.concat(childKey).filter(((key,i,l)=>key===""?i===0:true)))}childPath(childKey){return this.child(childKey).path}get pathKeys(){return this.keys}static extractVariables(varPath,fullPath){if(!varPath.includes("*")&&!varPath.includes("$")){return[]}const keys=getPathKeys(varPath);const pathKeys=getPathKeys(fullPath);let count=0;const variables={get length(){return count}};keys.forEach(((key,index)=>{const pathKey=pathKeys[index];if(key==="*"){variables[count++]=pathKey}else if(typeof key==="string"&&key[0]==="$"){variables[count++]=pathKey;variables[key]=pathKey;const varName=key.slice(1);if(typeof variables[varName]==="undefined"){variables[varName]=pathKey}}}));return variables}static fillVariables(varPath,fullPath){if(varPath.indexOf("*")<0&&varPath.indexOf("$")<0){return varPath}const keys=getPathKeys(varPath);const pathKeys=getPathKeys(fullPath);const merged=keys.map(((key,index)=>{if(key===pathKeys[index]||index>=pathKeys.length){return key}else if(typeof key==="string"&&(key==="*"||key[0]==="$")){return pathKeys[index]}else{throw new Error(`Path "${fullPath}" cannot be used to fill variables of path "${varPath}" because they do not match`)}}));let mergedPath="";merged.forEach((key=>{if(typeof key==="number"){mergedPath+=`[${key}]`}else{if(mergedPath.length>0){mergedPath+="/"}mergedPath+=key}}));return mergedPath}static fillVariables2(varPath,vars){if(typeof vars!=="object"||Object.keys(vars).length===0){return varPath}const pathKeys=getPathKeys(varPath);let n=0;const targetPath=pathKeys.reduce(((path,key)=>{if(typeof key==="string"&&(key==="*"||key.startsWith("$"))){return PathInfo.getChildPath(path,vars[n++])}else{return PathInfo.getChildPath(path,key)}}),"");return targetPath}equals(otherPath){const other=otherPath instanceof PathInfo?otherPath:new PathInfo(otherPath);if(this.path===other.path){return true}if(this.keys.length!==other.keys.length){return false}return this.keys.every(((key,index)=>{const otherKey=other.keys[index];return otherKey===key||typeof otherKey==="string"&&(otherKey==="*"||otherKey[0]==="$")||typeof key==="string"&&(key==="*"||key[0]==="$")}))}isAncestorOf(descendantPath){const descendant=descendantPath instanceof PathInfo?descendantPath:new PathInfo(descendantPath);if(descendant.path===""||this.path===descendant.path){return false}if(this.path===""){return true}if(this.keys.length>=descendant.keys.length){return false}return this.keys.every(((key,index)=>{const otherKey=descendant.keys[index];return otherKey===key||typeof otherKey==="string"&&(otherKey==="*"||otherKey[0]==="$")||typeof key==="string"&&(key==="*"||key[0]==="$")}))}isDescendantOf(ancestorPath){const ancestor=ancestorPath instanceof PathInfo?ancestorPath:new PathInfo(ancestorPath);if(this.path===""||this.path===ancestor.path){return false}if(ancestorPath===""){return true}if(ancestor.keys.length>=this.keys.length){return false}return ancestor.keys.every(((key,index)=>{const otherKey=this.keys[index];return otherKey===key||typeof otherKey==="string"&&(otherKey==="*"||otherKey[0]==="$")||typeof key==="string"&&(key==="*"||key[0]==="$")}))}isOnTrailOf(otherPath){const other=otherPath instanceof PathInfo?otherPath:new PathInfo(otherPath);if(this.path.length===0||other.path.length===0){return true}if(this.path===other.path){return true}return this.pathKeys.every(((key,index)=>{if(index>=other.keys.length){return true}const otherKey=other.keys[index];return otherKey===key||typeof otherKey==="string"&&(otherKey==="*"||otherKey[0]==="$")||typeof key==="string"&&(key==="*"||key[0]==="$")}))}isChildOf(otherPath){var _a,_b;const other=otherPath instanceof PathInfo?otherPath:new PathInfo(otherPath);if(this.path===""){return false}return(_b=(_a=this.parent)===null||_a===void 0?void 0:_a.equals(other))!==null&&_b!==void 0?_b:false}isParentOf(otherPath){const other=otherPath instanceof PathInfo?otherPath:new PathInfo(otherPath);if(other.path===""||!other.parent){return false}return this.equals(other.parent)}}exports.PathInfo=PathInfo;exports.default=PathInfo},{}],264:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SchemaDefinition=void 0;function parse(definition){let pos=0;function consumeSpaces(){let c;while(c=definition[pos],[" ","\r","\n","\t"].includes(c)){pos++}}function consumeCharacter(c){if(definition[pos]!==c){throw new Error(`Unexpected character at position ${pos}. Expected: '${c}', found '${definition[pos]}'`)}pos++}function readProperty(){consumeSpaces();const prop={name:"",optional:false,wildcard:false};let c;while(c=definition[pos],c==="_"||c==="$"||c>="a"&&c<="z"||c>="A"&&c<="Z"||prop.name.length>0&&c>="0"&&c<="9"||prop.name.length===0&&c==="*"){prop.name+=c;pos++}if(prop.name.length===0){throw new Error(`Property name expected at position ${pos}, found: ${definition.slice(pos,pos+10)}..`)}if(definition[pos]==="?"){prop.optional=true;pos++}if(prop.name==="*"||prop.name[0]==="$"){prop.optional=true;prop.wildcard=true}consumeSpaces();consumeCharacter(":");return prop}function readType(){consumeSpaces();let type={typeOf:"any"},c;let name="";while(c=definition[pos],c>="a"&&c<="z"||c>="A"&&c<="Z"){name+=c;pos++}if(name.length===0){if(definition[pos]==="*"){consumeCharacter("*");type.typeOf="any"}else if(["'",'"',"`"].includes(definition[pos])){type.typeOf="string";type.value="";const quote=definition[pos];consumeCharacter(quote);while(c=definition[pos],c&&c!==quote){type.value+=c;pos++}consumeCharacter(quote)}else if(definition[pos]>="0"&&definition[pos]<="9"){type.typeOf="number";let nr="";while(c=definition[pos],c==="."||c==="n"||c>="0"&&c<="9"){nr+=c;pos++}if(nr.endsWith("n")){type.value=BigInt(nr)}else if(nr.includes(".")){type.value=parseFloat(nr)}else{type.value=parseInt(nr)}}else if(definition[pos]==="{"){consumeCharacter("{");type.typeOf="object";type.instanceOf=Object;type.children=[];while(true){const prop=readProperty();const types=readTypes();type.children.push({name:prop.name,optional:prop.optional,wildcard:prop.wildcard,types:types});consumeSpaces();if(definition[pos]===";"||definition[pos]===","){consumeCharacter(definition[pos]);consumeSpaces()}if(definition[pos]==="}"){break}}consumeCharacter("}")}else if(definition[pos]==="/"){consumeCharacter("/");let pattern="",flags="";while(c=definition[pos],c!=="/"||pattern.endsWith("\\")){pattern+=c;pos++}consumeCharacter("/");while(c=definition[pos],["g","i","m","s","u","y","d"].includes(c)){flags+=c;pos++}type.typeOf="string";type.matches=new RegExp(pattern,flags)}else{throw new Error(`Expected a type definition at position ${pos}, found character '${definition[pos]}'`)}}else if(["string","number","boolean","bigint","undefined","String","Number","Boolean","BigInt"].includes(name)){type.typeOf=name.toLowerCase()}else if(name==="Object"||name==="object"){type.typeOf="object";type.instanceOf=Object}else if(name==="Date"){type.typeOf="object";type.instanceOf=Date}else if(name==="Binary"||name==="binary"){type.typeOf="object";type.instanceOf=ArrayBuffer}else if(name==="any"){type.typeOf="any"}else if(name==="null"){type.typeOf="object";type.value=null}else if(name==="Array"){consumeCharacter("<");type.typeOf="object";type.instanceOf=Array;type.genericTypes=readTypes();consumeCharacter(">")}else if(["true","false"].includes(name)){type.typeOf="boolean";type.value=name==="true"}else{throw new Error(`Unknown type at position ${pos}: "${type}"`)}consumeSpaces();while(definition[pos]==="["){consumeCharacter("[");consumeCharacter("]");type={typeOf:"object",instanceOf:Array,genericTypes:[type]}}return type}function readTypes(){consumeSpaces();const types=[readType()];while(definition[pos]==="|"){consumeCharacter("|");types.push(readType());consumeSpaces()}return types}return readType()}function checkObject(path,properties,obj,partial){const invalidProperties=properties.find((prop=>prop.name==="*"||prop.name[0]==="$"))?[]:Object.keys(obj).filter((key=>![null,undefined].includes(obj[key])&&!properties.find((prop=>prop.name===key))));if(invalidProperties.length>0){return{ok:false,reason:`Object at path "${path}" cannot have propert${invalidProperties.length===1?"y":"ies"} ${invalidProperties.map((p=>`"${p}"`)).join(", ")}`}}function checkProperty(property){const hasValue=![null,undefined].includes(obj[property.name]);if(!property.optional&&(partial?obj[property.name]===null:!hasValue)){return{ok:false,reason:`Property at path "${path}/${property.name}" is not optional`}}if(hasValue&&property.types.length===1){return checkType(`${path}/${property.name}`,property.types[0],obj[property.name],false)}if(hasValue&&!property.types.some((type=>checkType(`${path}/${property.name}`,type,obj[property.name],false).ok))){return{ok:false,reason:`Property at path "${path}/${property.name}" does not match any of ${property.types.length} allowed types`}}return{ok:true}}const namedProperties=properties.filter((prop=>!prop.wildcard));const failedProperty=namedProperties.find((prop=>!checkProperty(prop).ok));if(failedProperty){const reason=checkProperty(failedProperty).reason;return{ok:false,reason:reason}}const wildcardProperty=properties.find((prop=>prop.wildcard));if(!wildcardProperty){return{ok:true}}const wildcardChildKeys=Object.keys(obj).filter((key=>!namedProperties.find((prop=>prop.name===key))));let result={ok:true};for(let i=0;i<wildcardChildKeys.length&&result.ok;i++){const childKey=wildcardChildKeys[i];result=checkProperty({name:childKey,types:wildcardProperty.types,optional:true,wildcard:true})}return result}function checkType(path,type,value,partial,trailKeys){const ok={ok:true};if(type.typeOf==="any"){return ok}if(trailKeys instanceof Array&&trailKeys.length>0){if(type.typeOf!=="object"){return{ok:false,reason:`path "${path}" must be typeof ${type.typeOf}`}}if(!type.children){return ok}const childKey=trailKeys[0];let property=type.children.find((prop=>prop.name===childKey));if(!property){property=type.children.find((prop=>prop.name==="*"||prop.name[0]==="$"))}if(!property){return{ok:false,reason:`Object at path "${path}" cannot have property "${childKey}"`}}if(property.optional&&value===null&&trailKeys.length===1){return ok}let result={ok:false,reason:``};property.types.some((type=>{const childPath=typeof childKey==="number"?`${path}[${childKey}]`:`${path}/${childKey}`;result=checkType(childPath,type,value,partial,trailKeys.slice(1));return result.ok}));return result}if(value===null){return ok}if(type.instanceOf===Object&&(typeof value!=="object"||value instanceof Array||value instanceof Date)){return{ok:false,reason:`path "${path}" must be an object collection`}}if(type.instanceOf&&(typeof value!=="object"||value.constructor!==type.instanceOf)){return{ok:false,reason:`path "${path}" must be an instance of ${type.instanceOf.name}`}}if("value"in type&&value!==type.value){return{ok:false,reason:`path "${path}" must be value: ${type.value}`}}if(typeof value!==type.typeOf){return{ok:false,reason:`path "${path}" must be typeof ${type.typeOf}`}}if(type.instanceOf===Array&&type.genericTypes&&!value.every((v=>{var _a;return((_a=type.genericTypes)!==null&&_a!==void 0?_a:[]).some((t=>checkType(path,t,v,false).ok))}))){return{ok:false,reason:`every array value of path "${path}" must match one of the specified types`}}if(type.typeOf==="object"&&type.children){return checkObject(path,type.children,value,partial)}if(type.matches&&!type.matches.test(value)){return{ok:false,reason:`path "${path}" must match regular expression /${type.matches.source}/${type.matches.flags}`}}return ok}function getConstructorType(val){switch(val){case String:return"string";case Number:return"number";case Boolean:return"boolean";case Date:return"Date";case BigInt:return"bigint";case Array:throw new Error("Schema error: Array cannot be used without a type. Use string[] or Array<string> instead");default:throw new Error(`Schema error: unknown type used: ${val.name}`)}}class SchemaDefinition{constructor(definition,handling={warnOnly:false}){this.handling=handling;this.source=definition;if(typeof definition==="object"){const toTS=obj=>"{"+Object.keys(obj).map((key=>{let val=obj[key];if(val===undefined){val="undefined"}else if(val instanceof RegExp){val=`/${val.source}/${val.flags}`}else if(typeof val==="object"){val=toTS(val)}else if(typeof val==="function"){val=getConstructorType(val)}else if(!["string","number","boolean","bigint"].includes(typeof val)){throw new Error(`Type definition for key "${key}" must be a string, number, boolean, bigint, object, regular expression, or one of these classes: String, Number, Boolean, Date, BigInt`)}return`${key}:${val}`})).join(",")+"}";this.text=toTS(definition)}else if(typeof definition==="string"){this.text=definition}else{throw new Error("Type definiton must be a string or an object")}this.type=parse(this.text)}check(path,value,partial,trailKeys){const result=checkType(path,this.type,value,partial,trailKeys);if(!result.ok&&this.handling.warnOnly){result.warning=`${partial?"Partial schema":"Schema"} check on path "${path}"${trailKeys?` for child "${trailKeys.join("/")}"`:""} failed: ${result.reason}`;result.ok=true;if(typeof this.handling.warnCallback==="function")this.handling.warnCallback(result.warning)}return result}}exports.SchemaDefinition=SchemaDefinition},{}],265:[function(require,module,exports){arguments[4][244][0].apply(exports,arguments)},{dup:244}],266:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});class SimpleObservable{constructor(create){this._active=false;this._subscribers=[];this._create=create}subscribe(subscriber){if(!this._active){const next=value=>{this._subscribers.forEach((s=>{try{s(value)}catch(err){console.error("Error in subscriber callback:",err)}}))};const observer={next:next};this._cleanup=this._create(observer);this._active=true}this._subscribers.push(subscriber);const unsubscribe=()=>{this._subscribers.splice(this._subscribers.indexOf(subscriber),1);if(this._subscribers.length===0){this._active=false;this._cleanup()}};const subscription={unsubscribe:unsubscribe};return subscription}}exports.default=SimpleObservable},{}],267:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EventStream=exports.EventPublisher=exports.EventSubscription=void 0;class EventSubscription{constructor(stop){this.stop=stop;this._internal={state:"init",activatePromises:[]}}activated(callback){if(callback){this._internal.activatePromises.push({callback:callback});if(this._internal.state==="active"){callback(true)}else if(this._internal.state==="canceled"){callback(false,this._internal.cancelReason)}}return new Promise(((resolve,reject)=>{if(this._internal.state==="active"){return resolve()}else if(this._internal.state==="canceled"&&!callback){return reject(new Error(this._internal.cancelReason))}const noop=()=>{};this._internal.activatePromises.push({resolve:resolve,reject:callback?noop:reject})}))}_setActivationState(activated,cancelReason){this._internal.cancelReason=cancelReason;this._internal.state=activated?"active":"canceled";while(this._internal.activatePromises.length>0){const p=this._internal.activatePromises.shift();if(p&&activated){p.callback&&p.callback(true);p.resolve&&p.resolve()}else if(p){p.callback&&p.callback(false,cancelReason);p.reject&&p.reject(cancelReason)}}}}exports.EventSubscription=EventSubscription;class EventPublisher{constructor(publish,start,cancel){this.publish=publish;this.start=start;this.cancel=cancel}}exports.EventPublisher=EventPublisher;class EventStream{constructor(eventPublisherCallback){const subscribers=[];let noMoreSubscribersCallback;let activationState;const STATE_STOPPED="stopped (no more subscribers)";this.subscribe=(callback,activationCallback)=>{if(typeof callback!=="function"){throw new TypeError("callback must be a function")}else if(activationState===STATE_STOPPED){throw new Error("stream can't be used anymore because all subscribers were stopped")}const sub={callback:callback,activationCallback:function(activated,cancelReason){activationCallback===null||activationCallback===void 0?void 0:activationCallback(activated,cancelReason);this.subscription._setActivationState(activated,cancelReason)},subscription:new EventSubscription((function stop(){subscribers.splice(subscribers.indexOf(sub),1);return checkActiveSubscribers()}))};subscribers.push(sub);if(typeof activationState!=="undefined"){if(activationState===true){activationCallback===null||activationCallback===void 0?void 0:activationCallback(true);sub.subscription._setActivationState(true)}else if(typeof activationState==="string"){activationCallback===null||activationCallback===void 0?void 0:activationCallback(false,activationState);sub.subscription._setActivationState(false,activationState)}}return sub.subscription};const checkActiveSubscribers=()=>{let ret;if(subscribers.length===0){ret=noMoreSubscribersCallback===null||noMoreSubscribersCallback===void 0?void 0:noMoreSubscribersCallback();activationState=STATE_STOPPED}return Promise.resolve(ret)};this.unsubscribe=callback=>{const remove=callback?subscribers.filter((sub=>sub.callback===callback)):subscribers;remove.forEach((sub=>{const i=subscribers.indexOf(sub);subscribers.splice(i,1)}));checkActiveSubscribers()};this.stop=()=>{subscribers.splice(0);checkActiveSubscribers()};const publish=val=>{subscribers.forEach((sub=>{try{sub.callback(val)}catch(err){console.error(`Error running subscriber callback: ${err.message}`)}}));if(subscribers.length===0){checkActiveSubscribers()}return subscribers.length>0};const start=allSubscriptionsStoppedCallback=>{activationState=true;noMoreSubscribersCallback=allSubscriptionsStoppedCallback;subscribers.forEach((sub=>{var _a;(_a=sub.activationCallback)===null||_a===void 0?void 0:_a.call(sub,true)}))};const cancel=reason=>{activationState=reason;subscribers.forEach((sub=>{var _a;(_a=sub.activationCallback)===null||_a===void 0?void 0:_a.call(sub,false,reason||new Error("unknown reason"))}));subscribers.splice(0)};const publisher=new EventPublisher(publish,start,cancel);eventPublisherCallback(publisher)}}exports.EventStream=EventStream},{}],268:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.deserialize2=exports.serialize2=exports.serialize=exports.detectSerializeVersion=exports.deserialize=void 0;const Ascii85_1=__importDefault(require("./Ascii85"));const PartialArray_1=require("./PartialArray");const PathInfo_1=__importStar(require("./PathInfo"));const Utils_1=require("./Utils");const deserialize=data=>{if(data.map===null||typeof data.map==="undefined"){if(typeof data.val==="undefined"){throw new Error("serialized value must have a val property")}return data.val}const deserializeValue=(type,val)=>{if(type==="date"){return new Date(val)}else if(type==="binary"){return Ascii85_1.default.decode(val)}else if(type==="reference"){return new PathInfo_1.PathReference(val)}else if(type==="regexp"){return new RegExp(val.pattern,val.flags)}else if(type==="array"){return new PartialArray_1.PartialArray(val)}else if(type==="bigint"){return BigInt(val)}return val};if(typeof data.map==="string"){return deserializeValue(data.map,data.val)}Object.keys(data.map).forEach((path=>{const type=data.map[path];const keys=PathInfo_1.default.getPathKeys(path);let parent=data;let key="val";let val=data.val;keys.forEach((k=>{key=k;parent=val;val=val[key]}));parent[key]=deserializeValue(type,val)}));return data.val};exports.deserialize=deserialize;const detectSerializeVersion=data=>{if(typeof data!=="object"||data===null){return 2}if("map"in data&&"val"in data){return 1}else if("val"in data){if(Object.keys(data).length>1){return 2}return 1}return 2};exports.detectSerializeVersion=detectSerializeVersion;const serialize=obj=>{var _a;if(obj===null||typeof obj!=="object"||obj instanceof Date||obj instanceof ArrayBuffer||obj instanceof PathInfo_1.PathReference||obj instanceof RegExp){const ser=(0,exports.serialize)({value:obj});return{map:(_a=ser.map)===null||_a===void 0?void 0:_a.value,val:ser.val.value}}obj=(0,Utils_1.cloneObject)(obj);const process=(obj,mappings,prefix)=>{if(obj instanceof PartialArray_1.PartialArray){mappings[prefix]="array"}Object.keys(obj).forEach((key=>{const val=obj[key];const path=prefix.length===0?key:`${prefix}/${key}`;if(typeof val==="bigint"){obj[key]=val.toString();mappings[path]="bigint"}else if(val instanceof Date){obj[key]=val.toISOString();mappings[path]="date"}else if(val instanceof ArrayBuffer){obj[key]=Ascii85_1.default.encode(val);mappings[path]="binary"}else if(val instanceof PathInfo_1.PathReference){obj[key]=val.path;mappings[path]="reference"}else if(val instanceof RegExp){obj[key]={pattern:val.source,flags:val.flags};mappings[path]="regexp"}else if(typeof val==="object"&&val!==null){process(val,mappings,path)}}))};const mappings={};process(obj,mappings,"");const serialized={val:obj};if(Object.keys(mappings).length>0){serialized.map=mappings}return serialized};exports.serialize=serialize;const serialize2=obj=>{const getSerializedValue=val=>{if(typeof val==="bigint"){return{".type":"bigint",".val":val.toString()}}else if(val instanceof Date){return{".type":"date",".val":val.toISOString()}}else if(val instanceof ArrayBuffer){return{".type":"binary",".val":Ascii85_1.default.encode(val)}}else if(val instanceof PathInfo_1.PathReference){return{".type":"reference",".val":val.path}}else if(val instanceof RegExp){return{".type":"regexp",".val":`/${val.source}/${val.flags}`}}else if(typeof val==="object"&&val!==null){if(val instanceof Array){const copy=[];for(let i=0;i<val.length;i++){copy[i]=getSerializedValue(val[i])}return copy}else{const copy={};if(val instanceof PartialArray_1.PartialArray){copy[".type"]="array"}for(const prop in val){copy[prop]=getSerializedValue(val[prop])}return copy}}else{return val}};const serialized=getSerializedValue(obj);if(serialized!==null&&typeof serialized==="object"&&"val"in serialized&&Object.keys(serialized).length===1){serialized[".version"]=2}return serialized};exports.serialize2=serialize2;const deserialize2=data=>{if(typeof data!=="object"||data===null){return data}if(typeof data[".type"]==="undefined"){if(data instanceof Array){const copy=[];const arr=data;for(let i=0;i<arr.length;i++){copy.push((0,exports.deserialize2)(arr[i]))}return copy}else{const copy={};const obj=data;for(const prop in obj){copy[prop]=(0,exports.deserialize2)(obj[prop])}return copy}}else if(typeof data[".type"]==="string"){const dataType=data[".type"].toLowerCase();if(dataType==="bigint"){const val=data[".val"];return BigInt(val)}else if(dataType==="array"){const arr=data;const copy={};for(const index in arr){copy[index]=(0,exports.deserialize2)(arr[index])}delete copy[".type"];return new PartialArray_1.PartialArray(copy)}else if(dataType==="date"){const val=data[".val"];return new Date(val)}else if(dataType==="binary"){const val=data[".val"];return Ascii85_1.default.decode(val)}else if(dataType==="reference"){const val=data[".val"];return new PathInfo_1.PathReference(val)}else if(dataType==="regexp"){const val=data[".val"];if(typeof val==="string"){const match=/^\/(.*)\/([a-z]+)$/.exec(val);return match?new RegExp(match[1],match[2]):null}return new RegExp(val.pattern,val.flags)}}throw new Error(`Unknown data type "${data[".type"]}" in serialized value`)};exports.deserialize2=deserialize2},{"./Ascii85":256,"./PartialArray":262,"./PathInfo":263,"./Utils":270}],269:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});const Utils_1=require("./Utils");const PathInfo_1=__importDefault(require("./PathInfo"));const reference_1=require("../DataBase/reference");const snapshot_1=require("../DataBase/snapshot");function get(mappings,path){path=path.replace(/^\/|\/$/g,"");const keys=PathInfo_1.default.getPathKeys(path);const mappedPath=Object.keys(mappings).find((mpath=>{const mkeys=PathInfo_1.default.getPathKeys(mpath);if(mkeys.length!==keys.length){return false}return mkeys.every(((mkey,index)=>{if(mkey==="*"||typeof mkey==="string"&&mkey[0]==="$"){return true}return mkey===keys[index]}))}));if(!mappedPath)return;const mapping=mappings[mappedPath];return mapping}function map(mappings,path){const targetPath=PathInfo_1.default.get(path).parentPath;if(targetPath===null){return}return get(mappings,targetPath)}function mapDeep(mappings,entryPath){entryPath=entryPath.replace(/^\/|\/$/g,"");const pathInfo=PathInfo_1.default.get(entryPath);const startPath=pathInfo.parentPath;const keys=startPath?PathInfo_1.default.getPathKeys(startPath):[];const matches=Object.keys(mappings).reduce(((m,mpath)=>{const mkeys=PathInfo_1.default.getPathKeys(mpath);if(mkeys.length<keys.length){return m}let isMatch=true;if(keys.length===0&&startPath!==null){isMatch=mkeys.length===1&&(mkeys[0]==="*"||typeof mkeys[0]==="string"&&mkeys[0][0]==="$")}else{mkeys.every(((mkey,index)=>{if(index>=keys.length){return false}else if(mkey==="*"||typeof mkey==="string"&&mkey[0]==="$"||mkey===keys[index]){return true}else{isMatch=false;return false}}))}if(isMatch){const mapping=mappings[mpath];m.push({path:mpath,type:mapping})}return m}),[]);return matches}function process(db,mappings,path,obj,action){if(obj===null||typeof obj!=="object"){return obj}const keys=PathInfo_1.default.getPathKeys(path);const m=mapDeep(mappings,path);const changes=[];m.sort(((a,b)=>PathInfo_1.default.getPathKeys(a.path).length>PathInfo_1.default.getPathKeys(b.path).length?-1:1));m.forEach((mapping=>{const mkeys=PathInfo_1.default.getPathKeys(mapping.path);mkeys.push("*");const mTrailKeys=mkeys.slice(keys.length);if(mTrailKeys.length===0){const vars=PathInfo_1.default.extractVariables(mapping.path,path);const ref=new reference_1.DataReference(db,path,vars);if(action==="serialize"){obj=mapping.type.serialize(obj,ref)}else if(action==="deserialize"){const snap=new snapshot_1.DataSnapshot(ref,obj);obj=mapping.type.deserialize(snap)}return}const process=(parentPath,parent,keys)=>{if(obj===null||typeof obj!=="object"){return obj}const key=keys[0];let children=[];if(key==="*"||typeof key==="string"&&key[0]==="$"){if(parent instanceof Array){children=parent.map(((val,index)=>({key:index,val:val})))}else{children=Object.keys(parent).map((k=>({key:k,val:parent[k]})))}}else{const child=parent[key];if(typeof child==="object"){children.push({key:key,val:child})}}children.forEach((child=>{const childPath=PathInfo_1.default.getChildPath(parentPath,child.key);const vars=PathInfo_1.default.extractVariables(mapping.path,childPath);const ref=new reference_1.DataReference(db,childPath,vars);if(keys.length===1){if(action==="serialize"){changes.push({parent:parent,key:child.key,original:parent[child.key]});parent[child.key]=mapping.type.serialize(child.val,ref)}else if(action==="deserialize"){const snap=new snapshot_1.DataSnapshot(ref,child.val);parent[child.key]=mapping.type.deserialize(snap)}}else{process(childPath,child.val,keys.slice(1))}}))};process(path,obj,mTrailKeys)}));if(action==="serialize"){obj=(0,Utils_1.cloneObject)(obj);if(changes.length>0){changes.forEach((change=>{change.parent[change.key]=change.original}))}}return obj}const _mappings=Symbol("mappings");class TypeMappings{constructor(db){this.db=db;this[_mappings]={}}get mappings(){return this[_mappings]}map(path){return map(this[_mappings],path)}bind(path,type,options={}){if(typeof path!=="string"){throw new TypeError("path must be a string")}if(typeof type!=="function"){throw new TypeError("constructor must be a function")}if(typeof options.serializer==="undefined"){}else if(typeof options.serializer==="string"){if(typeof type.prototype[options.serializer]==="function"){options.serializer=type.prototype[options.serializer]}else{throw new TypeError(`${type.name}.prototype.${options.serializer} is not a function, cannot use it as serializer`)}}else if(typeof options.serializer!=="function"){throw new TypeError(`serializer for class ${type.name} must be a function, or the name of a prototype method`)}if(typeof options.creator==="undefined"){if(typeof type.create==="function"){options.creator=type.create}}else if(typeof options.creator==="string"){if(typeof type[options.creator]==="function"){options.creator=type[options.creator]}else{throw new TypeError(`${type.name}.${options.creator} is not a function, cannot use it as creator`)}}else if(typeof options.creator!=="function"){throw new TypeError(`creator for class ${type.name} must be a function, or the name of a static method`)}path=path.replace(/^\/|\/$/g,"");this[_mappings][path]={db:this.db,type:type,creator:options.creator,serializer:options.serializer,deserialize(snap){let obj;if(this.creator){obj=this.creator.call(this.type,snap)}else{obj=new this.type(snap)}return obj},serialize(obj,ref){if(this.serializer){obj=this.serializer.call(obj,ref,obj)}else if(obj&&typeof obj.serialize==="function"){obj=obj.serialize(ref,obj)}return obj}}}serialize(path,obj){return process(this.db,this[_mappings],path,obj,"serialize")}deserialize(path,obj){return process(this.db,this[_mappings],path,obj,"deserialize")}}exports.default=TypeMappings},{"../DataBase/reference":254,"../DataBase/snapshot":255,"./PathInfo":263,"./Utils":270}],270:[function(require,module,exports){(function(global,Buffer){(function(){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.uuidv4=exports.deepEqual=exports.isEmpty=exports.safeGet=exports.contains=exports.getGlobalObject=exports.defer=exports.getChildValues=exports.getMutations=exports.compareValues=exports.isDate=exports.ObjectDifferences=exports.valuesAreEqual=exports.cloneObject=exports.concatTypedArrays=exports.decodeString=exports.encodeString=exports.bytesToBigint=exports.bigintToBytes=exports.bytesToNumber=exports.numberToBytes=void 0;const PathInfo_1=require("./PathInfo");const PartialArray_1=require("./PartialArray");const process_1=__importDefault(require("../process"));function numberToBytes(number){const bytes=new Uint8Array(8);const view=new DataView(bytes.buffer);view.setFloat64(0,number);return new Array(...bytes)}exports.numberToBytes=numberToBytes;function bytesToNumber(bytes){const length=Array.isArray(bytes)?bytes.length:bytes.byteLength;if(length!==8){throw new TypeError("must be 8 bytes")}const bin=new Uint8Array(bytes);const view=new DataView(bin.buffer);const nr=view.getFloat64(0);return nr}exports.bytesToNumber=bytesToNumber;const hasBigIntSupport=(()=>{try{return typeof BigInt(0)==="bigint"}catch(err){return false}})();const noBigIntError="BigInt is not supported on this platform";const bigIntFunctions={bigintToBytes(number){throw new Error(noBigIntError)},bytesToBigint(bytes){throw new Error(noBigIntError)}};if(hasBigIntSupport){const big={zero:BigInt(0),one:BigInt(1),two:BigInt(2),eight:BigInt(8),ff:BigInt(255)};bigIntFunctions.bigintToBytes=function bigintToBytes(number){if(typeof number!=="bigint"){throw new Error("number must be a bigint")}const bytes=[];const negative=number<big.zero;do{const byte=Number(number&big.ff);bytes.push(byte);number=number>>big.eight}while(number!==(negative?-big.one:big.zero));bytes.reverse();if(negative?bytes[0]<128:bytes[0]>=128){bytes.unshift(negative?255:0)}return bytes};bigIntFunctions.bytesToBigint=function bytesToBigint(bytes){const negative=bytes[0]>=128;let number=big.zero;for(let b of bytes){if(negative){b=~b&255}number=(number<<big.eight)+BigInt(b)}if(negative){number=-(number+big.one)}return number}}exports.bigintToBytes=bigIntFunctions.bigintToBytes;exports.bytesToBigint=bigIntFunctions.bytesToBigint;function encodeString(str){if(typeof TextEncoder!=="undefined"){const encoder=new TextEncoder;return encoder.encode(str)}else if(typeof Buffer==="function"){const buf=Buffer.from(str,"utf-8");return new Uint8Array(buf.buffer,buf.byteOffset,buf.byteLength)}else{const arr=[];for(let i=0;i<str.length;i++){let code=str.charCodeAt(i);if(code>128){if((code&55296)===55296){const nextCode=str.charCodeAt(i+1);if((nextCode&56320)!==56320){throw new Error("follow-up utf-16 character does not start with 0xDC00")}i++;const p1=code&1023;const p2=nextCode&1023;code=65536|p1<<10|p2}if(code<2048){const b1=192|code>>6&31;const b2=128|code&63;arr.push(b1,b2)}else if(code<65536){const b1=224|code>>12&15;const b2=128|code>>6&63;const b3=128|code&63;arr.push(b1,b2,b3)}else if(code<2097152){const b1=240|code>>18&7;const b2=128|code>>12&63;const b3=128|code>>6&63;const b4=128|code&63;arr.push(b1,b2,b3,b4)}else{throw new Error(`Cannot convert character ${str.charAt(i)} (code ${code}) to utf-8`)}}else{arr.push(code<128?code:63)}}return new Uint8Array(arr)}}exports.encodeString=encodeString;function decodeString(buffer){if(typeof TextDecoder!=="undefined"){const decoder=new TextDecoder;if(buffer instanceof Uint8Array){return decoder.decode(buffer)}const buf=Uint8Array.from(buffer);return decoder.decode(buf)}else if(typeof Buffer==="function"){if(buffer instanceof Array){buffer=Uint8Array.from(buffer)}if(!(buffer instanceof Buffer)&&"buffer"in buffer&&buffer.buffer instanceof ArrayBuffer){const typedArray=buffer;buffer=Buffer.from(typedArray.buffer,typedArray.byteOffset,typedArray.byteLength)}if(!(buffer instanceof Buffer)){throw new Error("Unsupported buffer argument")}return buffer.toString("utf-8")}else{if(!(buffer instanceof Uint8Array)&&"buffer"in buffer&&buffer["buffer"]instanceof ArrayBuffer){const typedArray=buffer;buffer=new Uint8Array(typedArray.buffer,typedArray.byteOffset,typedArray.byteLength)}if(buffer instanceof Buffer||buffer instanceof Array||buffer instanceof Uint8Array){let str="";for(let i=0;i<buffer.length;i++){let code=buffer[i];if(code>128){if((code&240)===240){const b1=code,b2=buffer[i+1],b3=buffer[i+2],b4=buffer[i+3];code=(b1&7)<<18|(b2&63)<<12|(b3&63)<<6|b4&63;i+=3}else if((code&224)===224){const b1=code,b2=buffer[i+1],b3=buffer[i+2];code=(b1&15)<<12|(b2&63)<<6|b3&63;i+=2}else if((code&192)===192){const b1=code,b2=buffer[i+1];code=(b1&31)<<6|b2&63;i++}else{throw new Error("invalid utf-8 data")}}if(code>=65536){code^=65536;const p1=55296|code>>10;const p2=56320|code&1023;str+=String.fromCharCode(p1);str+=String.fromCharCode(p2)}else{str+=String.fromCharCode(code)}}return str}else{throw new Error("Unsupported buffer argument")}}}exports.decodeString=decodeString;function concatTypedArrays(a,b){const c=new a.constructor(a.length+b.length);c.set(a);c.set(b,a.length);return c}exports.concatTypedArrays=concatTypedArrays;function cloneObject(original,stack=[]){var _a;if(((_a=original===null||original===void 0?void 0:original.constructor)===null||_a===void 0?void 0:_a.name)==="DataSnapshot"){throw new TypeError(`Object to clone is a DataSnapshot (path "${original.ref.path}")`)}const checkAndFixTypedArray=obj=>{if(obj!==null&&typeof obj==="object"&&typeof obj.constructor==="function"&&typeof obj.constructor.name==="string"&&["Buffer","Uint8Array","Int8Array","Uint16Array","Int16Array","Uint32Array","Int32Array","BigUint64Array","BigInt64Array"].includes(obj.constructor.name)){obj=obj.buffer.slice(obj.byteOffset,obj.byteOffset+obj.byteLength)}return obj};original=checkAndFixTypedArray(original);if(typeof original!=="object"||original===null||original instanceof Date||original instanceof ArrayBuffer||original instanceof PathInfo_1.PathReference||original instanceof RegExp){return original}const cloneValue=val=>{if(stack.indexOf(val)>=0){throw new ReferenceError("object contains a circular reference")}val=checkAndFixTypedArray(val);if(val===null||val instanceof Date||val instanceof ArrayBuffer||val instanceof PathInfo_1.PathReference||val instanceof RegExp){return val}else if(typeof val==="object"){stack.push(val);val=cloneObject(val,stack);stack.pop();return val}else{return val}};if(typeof stack==="undefined"){stack=[original]}const clone=original instanceof Array?[]:original instanceof PartialArray_1.PartialArray?new PartialArray_1.PartialArray:{};Object.keys(original).forEach((key=>{const val=original[key];if(typeof val==="function"){return}clone[key]=cloneValue(val)}));return clone}exports.cloneObject=cloneObject;const isTypedArray=val=>typeof val==="object"&&["ArrayBuffer","Buffer","Uint8Array","Uint16Array","Uint32Array","Int8Array","Int16Array","Int32Array"].includes(val.constructor.name);function valuesAreEqual(val1,val2){if(val1===val2){return true}if(typeof val1!==typeof val2){return false}if(typeof val1==="object"||typeof val2==="object"){if(val1===null||val2===null){return false}if(val1 instanceof PathInfo_1.PathReference||val2 instanceof PathInfo_1.PathReference){return val1 instanceof PathInfo_1.PathReference&&val2 instanceof PathInfo_1.PathReference&&val1.path===val2.path}if(val1 instanceof Date||val2 instanceof Date){return val1 instanceof Date&&val2 instanceof Date&&val1.getTime()===val2.getTime()}if(val1 instanceof Array||val2 instanceof Array){return val1 instanceof Array&&val2 instanceof Array&&val1.length===val2.length&&val1.every(((item,i)=>valuesAreEqual(val1[i],val2[i])))}if(isTypedArray(val1)||isTypedArray(val2)){if(!isTypedArray(val1)||!isTypedArray(val2)||val1.byteLength===val2.byteLength){return false}const typed1=val1 instanceof ArrayBuffer?new Uint8Array(val1):new Uint8Array(val1.buffer,val1.byteOffset,val1.byteLength),typed2=val2 instanceof ArrayBuffer?new Uint8Array(val2):new Uint8Array(val2.buffer,val2.byteOffset,val2.byteLength);return typed1.every(((val,i)=>typed2[i]===val))}const keys1=Object.keys(val1),keys2=Object.keys(val2);return keys1.length===keys2.length&&keys1.every((key=>keys2.includes(key)))&&keys1.every((key=>valuesAreEqual(val1[key],val2[key])))}return false}exports.valuesAreEqual=valuesAreEqual;class ObjectDifferences{constructor(added,removed,changed){this.added=added;this.removed=removed;this.changed=changed}forChild(key){if(this.added.includes(key)){return"added"}if(this.removed.includes(key)){return"removed"}const changed=this.changed.find((ch=>ch.key===key));return changed?changed.change:"identical"}}exports.ObjectDifferences=ObjectDifferences;const isDate=function(value){return value instanceof Date||typeof value==="string"&&!isNaN(Date.parse(value))};exports.isDate=isDate;function compareValues(oldVal,newVal,sortedResults=false){const voids=[undefined,null];if(oldVal===newVal){return"identical"}else if(voids.indexOf(oldVal)>=0&&voids.indexOf(newVal)<0){return"added"}else if(voids.indexOf(oldVal)<0&&voids.indexOf(newVal)>=0){return"removed"}else if(typeof oldVal!==typeof newVal){return"changed"}else if(isTypedArray(oldVal)||isTypedArray(newVal)){if(!isTypedArray(oldVal)||!isTypedArray(newVal)){return"changed"}const typed1=oldVal instanceof Uint8Array?oldVal:oldVal instanceof ArrayBuffer?new Uint8Array(oldVal):new Uint8Array(oldVal.buffer,oldVal.byteOffset,oldVal.byteLength);const typed2=newVal instanceof Uint8Array?newVal:newVal instanceof ArrayBuffer?new Uint8Array(newVal):new Uint8Array(newVal.buffer,newVal.byteOffset,newVal.byteLength);return typed1.byteLength===typed2.byteLength&&typed1.every(((val,i)=>typed2[i]===val))?"identical":"changed"}else if((0,exports.isDate)(oldVal)||(0,exports.isDate)(newVal)){return(0,exports.isDate)(oldVal)&&(0,exports.isDate)(newVal)&&new Date(oldVal).getTime()===new Date(newVal).getTime()?"identical":"changed"}else if(oldVal instanceof PathInfo_1.PathReference||newVal instanceof PathInfo_1.PathReference){return oldVal instanceof PathInfo_1.PathReference&&newVal instanceof PathInfo_1.PathReference&&oldVal.path===newVal.path?"identical":"changed"}else if(typeof oldVal==="object"){const isArray=oldVal instanceof Array;const getKeys=obj=>{let keys=Object.keys(obj).filter((key=>!voids.includes(obj[key])));if(isArray){keys=keys.map((v=>parseInt(v)))}return keys};const oldKeys=getKeys(oldVal);const newKeys=getKeys(newVal);const removedKeys=oldKeys.filter((key=>!newKeys.includes(key)));const addedKeys=newKeys.filter((key=>!oldKeys.includes(key)));const changedKeys=newKeys.reduce(((changed,key)=>{if(oldKeys.includes(key)){const val1=oldVal[key];const val2=newVal[key];const c=compareValues(val1,val2);if(c!=="identical"){changed.push({key:key,change:c})}}return changed}),[]);if(addedKeys.length===0&&removedKeys.length===0&&changedKeys.length===0){return"identical"}else{return new ObjectDifferences(addedKeys,removedKeys,sortedResults?changedKeys.sort(((a,b)=>a.key<b.key?-1:1)):changedKeys)}}return"changed"}exports.compareValues=compareValues;function getMutations(oldVal,newVal,sortedResults=false){const process=(target,compareResult,prev,val)=>{switch(compareResult){case"identical":return[];case"changed":return[{target:target,prev:prev,val:val}];case"added":return[{target:target,prev:null,val:val}];case"removed":return[{target:target,prev:prev,val:null}];default:{let changes=[];compareResult.added.forEach((key=>changes.push({target:target.concat(key),prev:null,val:val[key]})));compareResult.removed.forEach((key=>changes.push({target:target.concat(key),prev:prev[key],val:null})));compareResult.changed.forEach((item=>{const childChanges=process(target.concat(item.key),item.change,prev[item.key],val[item.key]);changes=changes.concat(childChanges)}));return changes}}};const compareResult=compareValues(oldVal,newVal,sortedResults);return process([],compareResult,oldVal,newVal)}exports.getMutations=getMutations;function getChildValues(childKey,oldValue,newValue){oldValue=oldValue===null?null:oldValue[childKey];if(typeof oldValue==="undefined"){oldValue=null}newValue=newValue===null?null:newValue[childKey];if(typeof newValue==="undefined"){newValue=null}return{oldValue:oldValue,newValue:newValue}}exports.getChildValues=getChildValues;function defer(fn){process_1.default.nextTick(fn)}exports.defer=defer;function getGlobalObject(){if(typeof globalThis!=="undefined"){return globalThis}if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("Unable to locate global object.")}exports.getGlobalObject=getGlobalObject;function contains(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}exports.contains=contains;function safeGet(obj,key){if(Object.prototype.hasOwnProperty.call(obj,key)){return obj[key]}else{return undefined}}exports.safeGet=safeGet;function isEmpty(obj){for(const key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){return false}}return true}exports.isEmpty=isEmpty;function deepEqual(a,b){if(a===b){return true}const aKeys=Object.keys(a);const bKeys=Object.keys(b);for(const k of aKeys){if(!bKeys.includes(k)){return false}const aProp=a[k];const bProp=b[k];if(isObject(aProp)&&isObject(bProp)){if(!deepEqual(aProp,bProp)){return false}}else if(aProp!==bProp){return false}}for(const k of bKeys){if(!aKeys.includes(k)){return false}}return true}exports.deepEqual=deepEqual;function isObject(thing){return thing!==null&&typeof thing==="object"}function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(c=>{const r=Math.random()*16|0,v=c==="x"?r:r&3|8;return v.toString(16)}))}exports.uuidv4=uuidv4}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"../process":274,"./PartialArray":262,"./PathInfo":263,buffer:88}],271:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.assert=void 0;var Assert_1=require("./Assert");Object.defineProperty(exports,"assert",{enumerable:true,get:function(){return Assert_1.assert}})},{"./Assert":257}],272:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true})},{}],273:[function(require,module,exports){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){if(k2===undefined)k2=k;var desc=Object.getOwnPropertyDescriptor(m,k);if(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable)){desc={enumerable:true,get:function(){return m[k]}}}Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}:function(o,v){o["default"]=v});var __importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.ObjectCollection=exports.PartialArray=exports.SimpleObservable=exports.SchemaDefinition=exports.SimpleEventEmitter=exports.ascii85=exports.Utils=exports.TypeMappings=exports.Transport=exports.EventSubscription=exports.EventPublisher=exports.EventStream=exports.PathInfo=exports.PathReference=exports.ID=exports.DebugLogger=exports.Lib=exports.MutationsDataSnapshot=exports.DataSnapshot=exports.DataReferencesArray=exports.DataSnapshotsArray=exports.QueryDataRetrievalOptions=exports.DataRetrievalOptions=exports.DataReferenceQuery=exports.DataReference=exports.Types=exports.Api=exports.DataBaseSettings=exports.DataBase=void 0;var DataBase_1=require("./DataBase");Object.defineProperty(exports,"DataBase",{enumerable:true,get:function(){return DataBase_1.DataBase}});Object.defineProperty(exports,"DataBaseSettings",{enumerable:true,get:function(){return DataBase_1.DataBaseSettings}});var api_1=require("./DataBase/api");Object.defineProperty(exports,"Api",{enumerable:true,get:function(){return __importDefault(api_1).default}});exports.Types=__importStar(require("./Types"));var reference_1=require("./DataBase/reference");Object.defineProperty(exports,"DataReference",{enumerable:true,get:function(){return reference_1.DataReference}});Object.defineProperty(exports,"DataReferenceQuery",{enumerable:true,get:function(){return reference_1.DataReferenceQuery}});Object.defineProperty(exports,"DataRetrievalOptions",{enumerable:true,get:function(){return reference_1.DataRetrievalOptions}});Object.defineProperty(exports,"QueryDataRetrievalOptions",{enumerable:true,get:function(){return reference_1.QueryDataRetrievalOptions}});Object.defineProperty(exports,"DataSnapshotsArray",{enumerable:true,get:function(){return reference_1.DataSnapshotsArray}});Object.defineProperty(exports,"DataReferencesArray",{enumerable:true,get:function(){return reference_1.DataReferencesArray}});var snapshot_1=require("./DataBase/snapshot");Object.defineProperty(exports,"DataSnapshot",{enumerable:true,get:function(){return snapshot_1.DataSnapshot}});Object.defineProperty(exports,"MutationsDataSnapshot",{enumerable:true,get:function(){return snapshot_1.MutationsDataSnapshot}});exports.Lib=__importStar(require("./Lib"));var DebugLogger_1=require("./Lib/DebugLogger");Object.defineProperty(exports,"DebugLogger",{enumerable:true,get:function(){return __importDefault(DebugLogger_1).default}});var ID_1=require("./Lib/ID");Object.defineProperty(exports,"ID",{enumerable:true,get:function(){return __importDefault(ID_1).default}});var PathInfo_1=require("./Lib/PathInfo");Object.defineProperty(exports,"PathReference",{enumerable:true,get:function(){return PathInfo_1.PathReference}});Object.defineProperty(exports,"PathInfo",{enumerable:true,get:function(){return PathInfo_1.PathInfo}});var Subscription_1=require("./Lib/Subscription");Object.defineProperty(exports,"EventStream",{enumerable:true,get:function(){return Subscription_1.EventStream}});Object.defineProperty(exports,"EventPublisher",{enumerable:true,get:function(){return Subscription_1.EventPublisher}});Object.defineProperty(exports,"EventSubscription",{enumerable:true,get:function(){return Subscription_1.EventSubscription}});exports.Transport=__importStar(require("./Lib/Transport"));var TypeMappings_1=require("./Lib/TypeMappings");Object.defineProperty(exports,"TypeMappings",{enumerable:true,get:function(){return __importDefault(TypeMappings_1).default}});exports.Utils=__importStar(require("./Lib/Utils"));var Ascii85_1=require("./Lib/Ascii85");Object.defineProperty(exports,"ascii85",{enumerable:true,get:function(){return Ascii85_1.ascii85}});var SimpleEventEmitter_1=require("./Lib/SimpleEventEmitter");Object.defineProperty(exports,"SimpleEventEmitter",{enumerable:true,get:function(){return __importDefault(SimpleEventEmitter_1).default}});var Schema_1=require("./Lib/Schema");Object.defineProperty(exports,"SchemaDefinition",{enumerable:true,get:function(){return Schema_1.SchemaDefinition}});var SimpleObservable_1=require("./Lib/SimpleObservable");Object.defineProperty(exports,"SimpleObservable",{enumerable:true,get:function(){return __importDefault(SimpleObservable_1).default}});var PartialArray_1=require("./Lib/PartialArray");Object.defineProperty(exports,"PartialArray",{enumerable:true,get:function(){return PartialArray_1.PartialArray}});var ObjectCollection_1=require("./Lib/ObjectCollection");Object.defineProperty(exports,"ObjectCollection",{enumerable:true,get:function(){return ObjectCollection_1.ObjectCollection}})},{"./DataBase":253,"./DataBase/api":252,"./DataBase/reference":254,"./DataBase/snapshot":255,"./Lib":271,"./Lib/Ascii85":256,"./Lib/DebugLogger":258,"./Lib/ID":259,"./Lib/ObjectCollection":260,"./Lib/PartialArray":262,"./Lib/PathInfo":263,"./Lib/Schema":264,"./Lib/SimpleEventEmitter":265,"./Lib/SimpleObservable":266,"./Lib/Subscription":267,"./Lib/Transport":268,"./Lib/TypeMappings":269,"./Lib/Utils":270,"./Types":272}],274:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default={nextTick(fn){setTimeout(fn,0)}}},{}],275:[function(require,module,exports){"use strict";var cheerio=require("./lib/cheerio");var makeJuiceClient=require("./lib/inline");var juiceClient=makeJuiceClient((function(html,options){return cheerio(html,{xmlMode:options&&options.xmlMode},juiceDocument,[options])}));var juiceDocument=function(html,options){return juiceClient.juiceDocument(html,options)};juiceClient.inlineContent=function(html,css,options){return cheerio(html,{xmlMode:options&&options.xmlMode},juiceClient.inlineDocument,[css,options])};juiceClient.codeBlocks=cheerio.codeBlocks;module.exports=juiceClient},{"./lib/cheerio":276,"./lib/inline":277}],276:[function(require,module,exports){"use strict";var cheerio=require("cheerio");var utils=require("./utils");var cheerioLoad=function(html,options,encodeEntities){options=Object.assign({decodeEntities:false,_useHtmlParser2:true},options);html=encodeEntities(html);return cheerio.load(html,options)};var createEntityConverters=function(){var codeBlockLookup=[];var encodeCodeBlocks=function(html){var blocks=module.exports.codeBlocks;Object.keys(blocks).forEach((function(key){var re=new RegExp(blocks[key].start+"([\\S\\s]*?)"+blocks[key].end,"g");html=html.replace(re,(function(match,subMatch){codeBlockLookup.push(match);return"JUICE_CODE_BLOCK_"+(codeBlockLookup.length-1)+"_"}))}));return html};var decodeCodeBlocks=function(html){for(var index=0;index<codeBlockLookup.length;index++){var re=new RegExp("JUICE_CODE_BLOCK_"+index+'_(="")?',"gi");html=html.replace(re,(function(){return codeBlockLookup[index]}))}return html};return{encodeEntities:encodeCodeBlocks,decodeEntities:decodeCodeBlocks}};module.exports=function(html,options,callback,callbackExtraArguments){var entityConverters=createEntityConverters();var $=cheerioLoad(html,options,entityConverters.encodeEntities);var args=[$];args.push.apply(args,callbackExtraArguments);var doc=callback.apply(undefined,args)||$;if(options&&options.xmlMode){return entityConverters.decodeEntities(doc.xml())}return entityConverters.decodeEntities(doc.html())};module.exports.codeBlocks={EJS:{start:"<%",end:"%>"},HBS:{start:"{{",end:"}}"}}},{"./utils":281,cheerio:103}],277:[function(require,module,exports){"use strict";var utils=require("./utils");var numbers=require("./numbers");var variables=require("./variables");module.exports=function makeJuiceClient(juiceClient){juiceClient.ignoredPseudos=["hover","active","focus","visited","link"];juiceClient.widthElements=["TABLE","TD","TH","IMG"];juiceClient.heightElements=["TABLE","TD","TH","IMG"];juiceClient.tableElements=["TABLE","TH","TR","TD","CAPTION","COLGROUP","COL","THEAD","TBODY","TFOOT"];juiceClient.nonVisualElements=["HEAD","TITLE","BASE","LINK","STYLE","META","SCRIPT","NOSCRIPT"];juiceClient.styleToAttribute={"background-color":"bgcolor","background-image":"background","text-align":"align","vertical-align":"valign"};juiceClient.excludedProperties=[];juiceClient.juiceDocument=juiceDocument;juiceClient.inlineDocument=inlineDocument;function inlineDocument($,css,options){options=options||{};var rules=utils.parseCSS(css);var editedElements=[];var styleAttributeName="style";var counters={};if(options.styleAttributeName){styleAttributeName=options.styleAttributeName}rules.forEach(handleRule);editedElements.forEach(setStyleAttrs);if(options.inlinePseudoElements){editedElements.forEach(inlinePseudoElements)}if(options.applyWidthAttributes){editedElements.forEach((function(el){setDimensionAttrs(el,"width")}))}if(options.applyHeightAttributes){editedElements.forEach((function(el){setDimensionAttrs(el,"height")}))}if(options.applyAttributesTableElements){editedElements.forEach(setAttributesOnTableElements)}if(options.insertPreservedExtraCss&&options.extraCss){var preservedText=utils.getPreservedText(options.extraCss,{mediaQueries:options.preserveMediaQueries,fontFaces:options.preserveFontFaces,keyFrames:options.preserveKeyFrames});if(preservedText){var $appendTo=null;if(options.insertPreservedExtraCss!==true){$appendTo=$(options.insertPreservedExtraCss)}else{$appendTo=$("head");if(!$appendTo.length){$appendTo=$("body")}if(!$appendTo.length){$appendTo=$.root()}}$appendTo.first().append("<style>"+preservedText+"</style>")}}function handleRule(rule){var sel=rule[0];var style=rule[1];var selector=new utils.Selector(sel);var parsedSelector=selector.parsed();if(!parsedSelector){return}var pseudoElementType=getPseudoElementType(parsedSelector);for(var i=0;i<parsedSelector.length;++i){var subSel=parsedSelector[i];if(subSel.pseudos){for(var j=0;j<subSel.pseudos.length;++j){var subSelPseudo=subSel.pseudos[j];if(juiceClient.ignoredPseudos.indexOf(subSelPseudo.name)>=0){return}}}}if(pseudoElementType){var last=parsedSelector[parsedSelector.length-1];var pseudos=last.pseudos;last.pseudos=filterElementPseudos(last.pseudos);sel=parsedSelector.toString();last.pseudos=pseudos}var els;try{els=$(sel)}catch(err){return}els.each((function(){var el=this;if(el.name&&juiceClient.nonVisualElements.indexOf(el.name.toUpperCase())>=0){return}if(!el.counterProps){el.counterProps=el.parent&&el.parent.counterProps?Object.create(el.parent.counterProps):{}}if(pseudoElementType){var pseudoElPropName="pseudo"+pseudoElementType;var pseudoEl=el[pseudoElPropName];if(!pseudoEl){pseudoEl=el[pseudoElPropName]=$("<span />").get(0);pseudoEl.pseudoElementType=pseudoElementType;pseudoEl.pseudoElementParent=el;pseudoEl.counterProps=el.counterProps;el[pseudoElPropName]=pseudoEl}el=pseudoEl}if(!el.styleProps){el.styleProps={};if($(el).attr(styleAttributeName)){var cssText="* { "+$(el).attr(styleAttributeName)+" } ";addProps(utils.parseCSS(cssText)[0][1],new utils.Selector("<style>",true))}editedElements.push(el)}function resetCounter(el,value){var tokens=value.split(/\s+/);for(var j=0;j<tokens.length;j++){var counter=tokens[j];var resetval=parseInt(tokens[j+1],10);isNaN(resetval)?el.counterProps[counter]=counters[counter]=0:el.counterProps[counter]=counters[tokens[j++]]=resetval}}function incrementCounter(el,value){var tokens=value.split(/\s+/);for(var j=0;j<tokens.length;j++){var counter=tokens[j];if(el.counterProps[counter]===undefined){continue}var incrval=parseInt(tokens[j+1],10);isNaN(incrval)?el.counterProps[counter]=counters[counter]+=1:el.counterProps[counter]=counters[tokens[j++]]+=incrval}}function addProps(style,selector){for(var i=0,l=style.length;i<l;i++){if(style[i].type=="property"){var name=style[i].name;var value=style[i].value;if(name==="counter-reset"){resetCounter(el,value)}if(name==="counter-increment"){incrementCounter(el,value)}var important=value.match(/!important$/)!==null;if(important&&!options.preserveImportant)value=removeImportant(value);var additionalPriority=[style[i].position.start.line,style[i].position.start.col];var prop=new utils.Property(name,value,selector,important?2:0,additionalPriority);var existing=el.styleProps[name];if(juiceClient.excludedProperties.indexOf(name)<0){if(existing&&existing.compare(prop)===prop||!existing){if(existing&&existing.selector!==selector){delete el.styleProps[name]}else if(existing){prop.nextProp=existing}el.styleProps[name]=prop}}}}}addProps(style,selector)}))}function setStyleAttrs(el){var l=Object.keys(el.styleProps).length;var props=[];Object.keys(el.styleProps).forEach((function(key){var np=el.styleProps[key];while(typeof np!=="undefined"){props.push(np);np=np.nextProp}}));props.sort((function(a,b){return a.compareFunc(b)}));var string=props.filter((function(prop){if(options.resolveCSSVariables&&prop.prop.indexOf("--")===0){return false}return prop.prop!=="content"})).map((function(prop){if(options.resolveCSSVariables){prop.value=variables.replaceVariables(el,prop.value)}return prop.prop+": "+prop.value.replace(/["]/g,"'")+";"})).join(" ");if(string){$(el).attr(styleAttributeName,string)}}function inlinePseudoElements(el){if(el.pseudoElementType&&el.styleProps.content){var parsed=parseContent(el);if(parsed.img){el.name="img";$(el).attr("src",parsed.img)}else{$(el).text(parsed)}var parent=el.pseudoElementParent;if(el.pseudoElementType==="before"){$(parent).prepend(el)}else{$(parent).append(el)}}}function setDimensionAttrs(el,dimension){if(!el.name){return}var elName=el.name.toUpperCase();if(juiceClient[dimension+"Elements"].indexOf(elName)>-1){for(var i in el.styleProps){if(el.styleProps[i].prop===dimension){var value=el.styleProps[i].value;if(options.preserveImportant){value=removeImportant(value)}if(value.match(/(px|auto)/)){var size=value.replace("px","");$(el).attr(dimension,size);return}if(juiceClient.tableElements.indexOf(elName)>-1&&value.match(/\%/)){$(el).attr(dimension,value);return}}}}}function extractBackgroundUrl(value){return value.indexOf("url(")!==0?value:value.replace(/^url\((["'])?([^"']+)\1\)$/,"$2")}function setAttributesOnTableElements(el){if(!el.name){return}var elName=el.name.toUpperCase();var styleProps=Object.keys(juiceClient.styleToAttribute);if(juiceClient.tableElements.indexOf(elName)>-1){for(var i in el.styleProps){if(styleProps.indexOf(el.styleProps[i].prop)>-1){var prop=juiceClient.styleToAttribute[el.styleProps[i].prop];var value=el.styleProps[i].value;if(options.preserveImportant){value=removeImportant(value)}if(prop==="background"){value=extractBackgroundUrl(value)}if(/(linear|radial)-gradient\(/i.test(value)){continue}$(el).attr(prop,value)}}}}}function removeImportant(value){return value.replace(/\s*!important$/,"")}function applyCounterStyle(counter,style){switch(style){case"lower-roman":return numbers.romanize(counter).toLowerCase();case"upper-roman":return numbers.romanize(counter);case"lower-latin":case"lower-alpha":return numbers.alphanumeric(counter).toLowerCase();case"upper-latin":case"upper-alpha":return numbers.alphanumeric(counter);default:return counter.toString()}}function parseContent(el){var content=el.styleProps.content.value;if(content==="none"||content==="normal"){return""}var imageUrlMatch=content.match(/^\s*url\s*\(\s*(.*?)\s*\)\s*$/i);if(imageUrlMatch){var url=imageUrlMatch[1].replace(/^['"]|['"]$/g,"");return{img:url}}var parsed=[];var tokens=content.split(/['"]/);for(var i=0;i<tokens.length;i++){if(tokens[i]==="")continue;var varMatch=tokens[i].match(/var\s*\(\s*(.*?)\s*(,\s*(.*?)\s*)?\s*\)/i);if(varMatch){var variable=variables.findVariableValue(el,varMatch[1])||varMatch[2];parsed.push(variable.replace(/^['"]|['"]$/g,""));continue}var counterMatch=tokens[i].match(/counter\s*\(\s*(.*?)\s*(,\s*(.*?)\s*)?\s*\)/i);if(counterMatch&&counterMatch[1]in el.counterProps){var counter=el.counterProps[counterMatch[1]];parsed.push(applyCounterStyle(counter,counterMatch[3]));continue}var attrMatch=tokens[i].match(/attr\s*\(\s*(.*?)\s*\)/i);if(attrMatch){var attr=attrMatch[1];parsed.push(el.pseudoElementParent?el.pseudoElementParent.attribs[attr]:el.attribs[attr]);continue}parsed.push(tokens[i])}content=parsed.join("");content=content.replace(/\\/g,"");return content}function getPseudoElementType(selector){if(selector.length===0){return}var pseudos=selector[selector.length-1].pseudos;if(!pseudos){return}for(var i=0;i<pseudos.length;i++){if(isPseudoElementName(pseudos[i])){return pseudos[i].name}}}function isPseudoElementName(pseudo){return pseudo.name==="before"||pseudo.name==="after"}function filterElementPseudos(pseudos){return pseudos.filter((function(pseudo){return!isPseudoElementName(pseudo)}))}function juiceDocument($,options){options=utils.getDefaultOptions(options);var css=extractCssFromDocument($,options);css+="\n"+options.extraCss;inlineDocument($,css,options);return $}function getStylesData($,options){var results=[];var stylesList=$("style");var styleDataList,styleData,styleElement;stylesList.each((function(){styleElement=this;var usingParse5=!!styleElement.childNodes;styleDataList=usingParse5?styleElement.childNodes:styleElement.children;if(styleDataList.length!==1){if(options.removeStyleTags){$(styleElement).remove()}return}styleData=styleDataList[0].data;if(options.applyStyleTags&&$(styleElement).attr("data-embed")===undefined){results.push(styleData)}if(options.removeStyleTags&&$(styleElement).attr("data-embed")===undefined){var text=usingParse5?styleElement.childNodes[0].nodeValue:styleElement.children[0].data;var preservedText=utils.getPreservedText(text,{mediaQueries:options.preserveMediaQueries,fontFaces:options.preserveFontFaces,keyFrames:options.preserveKeyFrames,pseudos:options.preservePseudos},juiceClient.ignoredPseudos);if(preservedText){if(usingParse5){styleElement.childNodes[0].nodeValue=preservedText}else{styleElement.children[0].data=preservedText}}else{$(styleElement).remove()}}$(styleElement).removeAttr("data-embed")}));return results}function extractCssFromDocument($,options){var results=getStylesData($,options);var css=results.join("\n");return css}return juiceClient}},{"./numbers":278,"./utils":281,"./variables":282}],278:[function(require,module,exports){"use strict";exports.romanize=function(num){if(isNaN(num))return NaN;var digits=String(+num).split(""),key=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],roman="",i=3;while(i--)roman=(key[+digits.pop()+i*10]||"")+roman;return Array(+digits.join("")+1).join("M")+roman};exports.alphanumeric=function(num){var s="",t;while(num>0){t=(num-1)%26;s=String.fromCharCode(65+t)+s;num=(num-t)/26|0}return s||undefined}},{}],279:[function(require,module,exports){"use strict";module.exports=exports=Property;var utils=require("./utils");function Property(prop,value,selector,priority,additionalPriority){this.prop=prop;this.value=value;this.selector=selector;this.priority=priority||0;this.additionalPriority=additionalPriority||[]}Property.prototype.compareFunc=function(property){var a=[];a.push.apply(a,this.selector.specificity());a.push.apply(a,this.additionalPriority);a[0]+=this.priority;var b=[];b.push.apply(b,property.selector.specificity());b.push.apply(b,property.additionalPriority);b[0]+=property.priority;return utils.compareFunc(a,b)};Property.prototype.compare=function(property){var winner=this.compareFunc(property);if(winner===1){return this}return property};Property.prototype.toString=function(){return this.prop+": "+this.value.replace(/['"]+/g,"")+";"}},{"./utils":281}],280:[function(require,module,exports){"use strict";var parser=require("slick/parser");module.exports=exports=Selector;function Selector(text,styleAttribute){this.text=text;this.spec=undefined;this.styleAttribute=styleAttribute||false}Selector.prototype.parsed=function(){if(!this.tokens){this.tokens=parse(this.text)}return this.tokens};Selector.prototype.specificity=function(){var styleAttribute=this.styleAttribute;if(!this.spec){this.spec=specificity(this.text,this.parsed())}return this.spec;function specificity(text,parsed){var expressions=parsed||parse(text);var spec=[styleAttribute?1:0,0,0,0];var nots=[];for(var i=0;i<expressions.length;i++){var expression=expressions[i];var pseudos=expression.pseudos;if(expression.id){spec[1]++}if(expression.attributes){spec[2]+=expression.attributes.length}if(expression.classList){spec[2]+=expression.classList.length}if(expression.tag&&expression.tag!=="*"){spec[3]++}if(pseudos){spec[3]+=pseudos.length;for(var p=0;p<pseudos.length;p++){if(pseudos[p].name==="not"){nots.push(pseudos[p].value);spec[3]--}}}}for(var ii=nots.length;ii--;){var not=specificity(nots[ii]);for(var jj=4;jj--;){spec[jj]+=not[jj]}}return spec}};function parse(text){try{return parser(text)[0]}catch(e){return[]}}},{"slick/parser":397}],281:[function(require,module,exports){"use strict";var mensch=require("mensch");var Selector=require("./selector");var Property=require("./property");exports.Selector=Selector;exports.Property=Property;
/**
 * Returns an array of the selectors.
 *
 * @license Sizzle CSS Selector Engine - MIT
 * @param {String} selectorText from mensch
 * @api public
 */exports.extract=function extract(selectorText){var attr=0;var sels=[];var sel="";for(var i=0,l=selectorText.length;i<l;i++){var c=selectorText.charAt(i);if(attr){if("]"===c||")"===c){attr--}sel+=c}else{if(","===c){sels.push(sel);sel=""}else{if("["===c||"("===c){attr++}if(sel.length||c!==","&&c!=="\n"&&c!==" "){sel+=c}}}}if(sel.length){sels.push(sel)}return sels};exports.parseCSS=function(css){var parsed=mensch.parse(css,{position:true,comments:true});var rules=typeof parsed.stylesheet!="undefined"&&parsed.stylesheet.rules?parsed.stylesheet.rules:[];var ret=[];for(var i=0,l=rules.length;i<l;i++){if(rules[i].type=="rule"){var rule=rules[i];var selectors=rule.selectors;for(var ii=0,ll=selectors.length;ii<ll;ii++){ret.push([selectors[ii],rule.declarations])}}}return ret};exports.getPreservedText=function(css,options,ignoredPseudos){var parsed=mensch.parse(css,{position:true,comments:true});var rules=typeof parsed.stylesheet!="undefined"&&parsed.stylesheet.rules?parsed.stylesheet.rules:[];var preserved=[];var lastStart=null;for(var i=rules.length-1;i>=0;i--){if(options.fontFaces&&rules[i].type==="font-face"||options.mediaQueries&&rules[i].type==="media"||options.keyFrames&&rules[i].type==="keyframes"||options.pseudos&&rules[i].selectors&&this.matchesPseudo(rules[i].selectors[0],ignoredPseudos)){preserved.unshift(mensch.stringify({stylesheet:{rules:[rules[i]]}},{comments:false,indentation:"  "}))}lastStart=rules[i].position.start}if(preserved.length===0){return false}return"\n"+preserved.join("\n")+"\n"};exports.normalizeLineEndings=function(text){return text.replace(/\r\n/g,"\n").replace(/\n/g,"\r\n")};exports.matchesPseudo=function(needle,haystack){return haystack.find((function(element){return needle.indexOf(element)>-1}))};exports.compareFunc=function(a,b){var min=Math.min(a.length,b.length);for(var i=0;i<min;i++){if(a[i]===b[i]){continue}if(a[i]>b[i]){return 1}return-1}return a.length-b.length};exports.compare=function(a,b){return exports.compareFunc(a,b)==1?a:b};exports.getDefaultOptions=function(options){var result=Object.assign({extraCss:"",insertPreservedExtraCss:true,applyStyleTags:true,removeStyleTags:true,preserveMediaQueries:true,preserveFontFaces:true,preserveKeyFrames:true,preservePseudos:true,applyWidthAttributes:true,applyHeightAttributes:true,applyAttributesTableElements:true,resolveCSSVariables:true,url:""},options);result.webResources=result.webResources||{};return result}},{"./property":279,"./selector":280,mensch:284}],282:[function(require,module,exports){"use strict";const uniqueString=string=>{let str="";do{str=(Math.random()+1).toString(36).substring(2)}while(string.indexOf(str)!==-1);return str};const replaceVariables=(el,value)=>{let funcReg=/([a-z\-]+)\s*\(\s*([^\(\)]*?)\s*(?:,\s*([^\(\)]*?)\s*)?\s*\)/i;let replacements=[];let match;let uniq=uniqueString(value);while((match=funcReg.exec(value))!==null){let i=`${replacements.length}`;if(match[1].toLowerCase()=="var"){const varValue=findVariableValue(el,match[2]);if(varValue){value=value.replace(match[0],varValue);continue}if(match[3]){value=value.replace(match[0],match[3]);continue}}let placeholder=`${uniq}${i.padStart(5,"-")}`;value=value.replace(match[0],placeholder);replacements.push({placeholder:placeholder,replace:match[0]})}for(var i=replacements.length-1;i>=0;i--){const replacement=replacements[i];value=value.replace(replacement.placeholder,replacement.replace)}return value};const findVariableValue=(el,variable)=>{while(el){if(el.styleProps&&variable in el.styleProps){return el.styleProps[variable].value}var el=el.pseudoElementParent||el.parent}};module.exports={replaceVariables:replaceVariables,findVariableValue:findVariableValue}},{}],283:[function(require,module,exports){"use strict";var inherits=require("inherits");var HashBase=require("hash-base");var Buffer=require("safe-buffer").Buffer;var ARRAY16=new Array(16);function MD5(){HashBase.call(this,64);this._a=1732584193;this._b=4023233417;this._c=2562383102;this._d=271733878}inherits(MD5,HashBase);MD5.prototype._update=function(){var M=ARRAY16;for(var i=0;i<16;++i)M[i]=this._block.readInt32LE(i*4);var a=this._a;var b=this._b;var c=this._c;var d=this._d;a=fnF(a,b,c,d,M[0],3614090360,7);d=fnF(d,a,b,c,M[1],3905402710,12);c=fnF(c,d,a,b,M[2],606105819,17);b=fnF(b,c,d,a,M[3],3250441966,22);a=fnF(a,b,c,d,M[4],4118548399,7);d=fnF(d,a,b,c,M[5],1200080426,12);c=fnF(c,d,a,b,M[6],2821735955,17);b=fnF(b,c,d,a,M[7],4249261313,22);a=fnF(a,b,c,d,M[8],1770035416,7);d=fnF(d,a,b,c,M[9],2336552879,12);c=fnF(c,d,a,b,M[10],4294925233,17);b=fnF(b,c,d,a,M[11],2304563134,22);a=fnF(a,b,c,d,M[12],1804603682,7);d=fnF(d,a,b,c,M[13],4254626195,12);c=fnF(c,d,a,b,M[14],2792965006,17);b=fnF(b,c,d,a,M[15],1236535329,22);a=fnG(a,b,c,d,M[1],4129170786,5);d=fnG(d,a,b,c,M[6],3225465664,9);c=fnG(c,d,a,b,M[11],643717713,14);b=fnG(b,c,d,a,M[0],3921069994,20);a=fnG(a,b,c,d,M[5],3593408605,5);d=fnG(d,a,b,c,M[10],38016083,9);c=fnG(c,d,a,b,M[15],3634488961,14);b=fnG(b,c,d,a,M[4],3889429448,20);a=fnG(a,b,c,d,M[9],568446438,5);d=fnG(d,a,b,c,M[14],3275163606,9);c=fnG(c,d,a,b,M[3],4107603335,14);b=fnG(b,c,d,a,M[8],1163531501,20);a=fnG(a,b,c,d,M[13],2850285829,5);d=fnG(d,a,b,c,M[2],4243563512,9);c=fnG(c,d,a,b,M[7],1735328473,14);b=fnG(b,c,d,a,M[12],2368359562,20);a=fnH(a,b,c,d,M[5],4294588738,4);d=fnH(d,a,b,c,M[8],2272392833,11);c=fnH(c,d,a,b,M[11],1839030562,16);b=fnH(b,c,d,a,M[14],4259657740,23);a=fnH(a,b,c,d,M[1],2763975236,4);d=fnH(d,a,b,c,M[4],1272893353,11);c=fnH(c,d,a,b,M[7],4139469664,16);b=fnH(b,c,d,a,M[10],3200236656,23);a=fnH(a,b,c,d,M[13],681279174,4);d=fnH(d,a,b,c,M[0],3936430074,11);c=fnH(c,d,a,b,M[3],3572445317,16);b=fnH(b,c,d,a,M[6],76029189,23);a=fnH(a,b,c,d,M[9],3654602809,4);d=fnH(d,a,b,c,M[12],3873151461,11);c=fnH(c,d,a,b,M[15],530742520,16);b=fnH(b,c,d,a,M[2],3299628645,23);a=fnI(a,b,c,d,M[0],4096336452,6);d=fnI(d,a,b,c,M[7],1126891415,10);c=fnI(c,d,a,b,M[14],2878612391,15);b=fnI(b,c,d,a,M[5],4237533241,21);a=fnI(a,b,c,d,M[12],1700485571,6);d=fnI(d,a,b,c,M[3],2399980690,10);c=fnI(c,d,a,b,M[10],4293915773,15);b=fnI(b,c,d,a,M[1],2240044497,21);a=fnI(a,b,c,d,M[8],1873313359,6);d=fnI(d,a,b,c,M[15],4264355552,10);c=fnI(c,d,a,b,M[6],2734768916,15);b=fnI(b,c,d,a,M[13],1309151649,21);a=fnI(a,b,c,d,M[4],4149444226,6);d=fnI(d,a,b,c,M[11],3174756917,10);c=fnI(c,d,a,b,M[2],718787259,15);b=fnI(b,c,d,a,M[9],3951481745,21);this._a=this._a+a|0;this._b=this._b+b|0;this._c=this._c+c|0;this._d=this._d+d|0};MD5.prototype._digest=function(){this._block[this._blockOffset++]=128;if(this._blockOffset>56){this._block.fill(0,this._blockOffset,64);this._update();this._blockOffset=0}this._block.fill(0,this._blockOffset,56);this._block.writeUInt32LE(this._length[0],56);this._block.writeUInt32LE(this._length[1],60);this._update();var buffer=Buffer.allocUnsafe(16);buffer.writeInt32LE(this._a,0);buffer.writeInt32LE(this._b,4);buffer.writeInt32LE(this._c,8);buffer.writeInt32LE(this._d,12);return buffer};function rotl(x,n){return x<<n|x>>>32-n}function fnF(a,b,c,d,m,k,s){return rotl(a+(b&c|~b&d)+m+k|0,s)+b|0}function fnG(a,b,c,d,m,k,s){return rotl(a+(b&d|c&~d)+m+k|0,s)+b|0}function fnH(a,b,c,d,m,k,s){return rotl(a+(b^c^d)+m+k|0,s)+b|0}function fnI(a,b,c,d,m,k,s){return rotl(a+(c^(b|~d))+m+k|0,s)+b|0}module.exports=MD5},{"hash-base":199,inherits:233,"safe-buffer":385}],284:[function(require,module,exports){module.exports={lex:require("./lib/lexer"),parse:require("./lib/parser"),stringify:require("./lib/stringify")}},{"./lib/lexer":286,"./lib/parser":287,"./lib/stringify":288}],285:[function(require,module,exports){(function(process){(function(){exports=module.exports=debug;function debug(label){return _debug.bind(null,label)}function _debug(label){var args=[].slice.call(arguments,1);args.unshift("["+label+"]");process.stderr.write(args.join(" ")+"\n")}}).call(this)}).call(this,require("_process"))},{_process:88}],286:[function(require,module,exports){var DEBUG=false;var TIMER=false;var debug=require("./debug")("lex");exports=module.exports=lex;function lex(css){var start;var buffer="";var ch;var column=0;var cursor=-1;var depth=0;var line=1;var state="before-selector";var stack=[state];var token={};var tokens=[];var atRules=["media","keyframes",{name:"-webkit-keyframes",type:"keyframes",prefix:"-webkit-"},{name:"-moz-keyframes",type:"keyframes",prefix:"-moz-"},{name:"-ms-keyframes",type:"keyframes",prefix:"-ms-"},{name:"-o-keyframes",type:"keyframes",prefix:"-o-"},"font-face",{name:"import",state:"before-at-value"},{name:"charset",state:"before-at-value"},"supports","viewport",{name:"namespace",state:"before-at-value"},"document",{name:"-moz-document",type:"document",prefix:"-moz-"},"page"];function getCh(){skip();return css[cursor]}function getState(index){return index?stack[stack.length-1-index]:state}function isNextString(str){var start=cursor+1;return str===css.slice(start,start+str.length)}function find(str){var pos=css.slice(cursor).indexOf(str);return pos>0?pos:false}function isNextChar(ch){return ch===peek(1)}function peek(offset){return css[cursor+(offset||1)]}function popState(){var removed=stack.pop();state=stack[stack.length-1];return removed}function pushState(newState){state=newState;stack.push(state);return stack.length}function replaceState(newState){var previousState=state;stack[stack.length-1]=state=newState;return previousState}function skip(n){if((n||1)==1){if(css[cursor]=="\n"){line++;column=1}else{column++}cursor++}else{var skipStr=css.slice(cursor,cursor+n).split("\n");if(skipStr.length>1){line+=skipStr.length-1;column=1}column+=skipStr[skipStr.length-1].length;cursor=cursor+n}}function addToken(){token.end={line:line,col:column};DEBUG&&debug("addToken:",JSON.stringify(token,null,2));tokens.push(token);buffer="";token={}}function initializeToken(type){token={type:type,start:{line:line,col:column}}}TIMER&&(start=Date.now());while(ch=getCh()){DEBUG&&debug(ch,getState());switch(ch){case" ":switch(getState()){case"selector":case"value":case"value-paren":case"at-group":case"at-value":case"comment":case"double-string":case"single-string":buffer+=ch;break}break;case"\n":case"\t":case"\r":case"\f":switch(getState()){case"value":case"value-paren":case"at-group":case"comment":case"single-string":case"double-string":case"selector":buffer+=ch;break;case"at-value":if("\n"===ch){token.value=buffer.trim();addToken();popState()}break}break;case":":switch(getState()){case"name":token.name=buffer.trim();buffer="";replaceState("before-value");break;case"before-selector":buffer+=ch;initializeToken("selector");pushState("selector");break;case"before-value":replaceState("value");buffer+=ch;break;default:buffer+=ch;break}break;case";":switch(getState()){case"name":case"before-value":case"value":if(buffer.trim().length>0){token.value=buffer.trim(),addToken()}replaceState("before-name");break;case"value-paren":buffer+=ch;break;case"at-value":token.value=buffer.trim();addToken();popState();break;case"before-name":break;default:buffer+=ch;break}break;case"{":switch(getState()){case"selector":if(peek(-1)==="\\"){buffer+=ch;break}token.text=buffer.trim();addToken();replaceState("before-name");depth=depth+1;break;case"at-group":token.name=buffer.trim();switch(token.type){case"font-face":case"viewport":case"page":pushState("before-name");break;default:pushState("before-selector")}addToken();depth=depth+1;break;case"name":case"at-rule":token.name=buffer.trim();addToken();pushState("before-name");depth=depth+1;break;case"comment":case"double-string":case"single-string":buffer+=ch;break;case"before-value":replaceState("value");buffer+=ch;break}break;case"}":switch(getState()){case"before-name":case"name":case"before-value":case"value":if(buffer){token.value=buffer.trim()}if(token.name&&token.value){addToken()}initializeToken("end");addToken();popState();if("at-group"===getState()){initializeToken("at-group-end");addToken();popState()}if(depth>0){depth=depth-1}break;case"at-group":case"before-selector":case"selector":if(peek(-1)==="\\"){buffer+=ch;break}if(depth>0){if("at-group"===getState(1)){initializeToken("at-group-end");addToken()}}if(depth>1){popState()}if(depth>0){depth=depth-1}break;case"double-string":case"single-string":case"comment":buffer+=ch;break}break;case'"':case"'":switch(getState()){case"double-string":if('"'===ch&&"\\"!==peek(-1)){popState()}break;case"single-string":if("'"===ch&&"\\"!==peek(-1)){popState()}break;case"before-at-value":replaceState("at-value");pushState('"'===ch?"double-string":"single-string");break;case"before-value":replaceState("value");pushState('"'===ch?"double-string":"single-string");break;case"comment":break;default:if("\\"!==peek(-1)){pushState('"'===ch?"double-string":"single-string")}}buffer+=ch;break;case"/":switch(getState()){case"comment":case"double-string":case"single-string":buffer+=ch;break;case"before-value":case"selector":case"name":case"value":if(isNextChar("*")){var pos=find("*/");if(pos){skip(pos+1)}}else{if(getState()=="before-value")replaceState("value");buffer+=ch}break;default:if(isNextChar("*")){initializeToken("comment");pushState("comment");skip()}else{buffer+=ch}break}break;case"*":switch(getState()){case"comment":if(isNextChar("/")){token.text=buffer;skip();addToken();popState()}else{buffer+=ch}break;case"before-selector":buffer+=ch;initializeToken("selector");pushState("selector");break;case"before-value":replaceState("value");buffer+=ch;break;default:buffer+=ch}break;case"@":switch(getState()){case"comment":case"double-string":case"single-string":buffer+=ch;break;case"before-value":replaceState("value");buffer+=ch;break;default:var tokenized=false;var name;var rule;for(var j=0,len=atRules.length;!tokenized&&j<len;++j){rule=atRules[j];name=rule.name||rule;if(!isNextString(name)){continue}tokenized=true;initializeToken(name);pushState(rule.state||"at-group");skip(name.length);if(rule.prefix){token.prefix=rule.prefix}if(rule.type){token.type=rule.type}}if(!tokenized){buffer+=ch}break}break;case"(":switch(getState()){case"value":pushState("value-paren");break;case"before-value":replaceState("value");break}buffer+=ch;break;case")":switch(getState()){case"value-paren":popState();break;case"before-value":replaceState("value");break}buffer+=ch;break;default:switch(getState()){case"before-selector":initializeToken("selector");pushState("selector");break;case"before-name":initializeToken("property");replaceState("name");break;case"before-value":replaceState("value");break;case"before-at-value":replaceState("at-value");break}buffer+=ch;break}}TIMER&&debug("ran in",Date.now()-start+"ms");return tokens}},{"./debug":285}],287:[function(require,module,exports){var DEBUG=false;var TIMER=false;var debug=require("./debug")("parse");var lex=require("./lexer");exports=module.exports=parse;var _comments;var _depth;var _position;var _tokens;function parse(css,options){var start;options||(options={});_comments=!!options.comments;_position=!!options.position;_depth=0;_tokens=Array.isArray(css)?css.slice():lex(css);var rule;var rules=[];var token;TIMER&&(start=Date.now());while(token=next()){rule=parseToken(token);rule&&rules.push(rule)}TIMER&&debug("ran in",Date.now()-start+"ms");return{type:"stylesheet",stylesheet:{rules:rules}}}function astNode(token,override){override||(override={});var key;var keys=["type","name","value"];var node={};for(var i=0;i<keys.length;++i){key=keys[i];if(token[key]){node[key]=override[key]||token[key]}}keys=Object.keys(override);for(i=0;i<keys.length;++i){key=keys[i];if(!node[key]){node[key]=override[key]}}if(_position){node.position={start:token.start,end:token.end}}DEBUG&&debug("astNode:",JSON.stringify(node,null,2));return node}function next(){var token=_tokens.shift();DEBUG&&debug("next:",JSON.stringify(token,null,2));return token}function parseAtGroup(token){_depth=_depth+1;var overrides={};switch(token.type){case"font-face":case"viewport":overrides.declarations=parseDeclarations();break;case"page":overrides.prefix=token.prefix;overrides.declarations=parseDeclarations();break;default:overrides.prefix=token.prefix;overrides.rules=parseRules()}return astNode(token,overrides)}function parseAtImport(token){return astNode(token)}function parseCharset(token){return astNode(token)}function parseComment(token){return astNode(token,{text:token.text})}function parseNamespace(token){return astNode(token)}function parseProperty(token){return astNode(token)}function parseSelector(token){function trim(str){return str.trim()}return astNode(token,{type:"rule",selectors:token.text.split(",").map(trim),declarations:parseDeclarations(token)})}function parseToken(token){switch(token.type){case"property":return parseProperty(token);case"selector":return parseSelector(token);case"at-group-end":_depth=_depth-1;return;case"media":case"keyframes":return parseAtGroup(token);case"comment":if(_comments){return parseComment(token)}break;case"charset":return parseCharset(token);case"import":return parseAtImport(token);case"namespace":return parseNamespace(token);case"font-face":case"supports":case"viewport":case"document":case"page":return parseAtGroup(token)}DEBUG&&debug("parseToken: unexpected token:",JSON.stringify(token))}function parseTokensWhile(conditionFn){var node;var nodes=[];var token;while((token=next())&&(conditionFn&&conditionFn(token))){node=parseToken(token);node&&nodes.push(node)}if(token&&token.type!=="end"){_tokens.unshift(token)}return nodes}function parseDeclarations(){return parseTokensWhile((function(token){return token.type==="property"||token.type==="comment"}))}function parseRules(){return parseTokensWhile((function(){return _depth}))}},{"./debug":285,"./lexer":286}],288:[function(require,module,exports){var DEBUG=false;var TIMER=false;var debug=require("./debug")("stringify");var _comments;var _compress;var _indentation;var _level;var _n;var _s;exports=module.exports=stringify;function stringify(ast,options){var start;options||(options={});_indentation=options.indentation||"";_compress=!!options.compress;_comments=!!options.comments;_level=1;if(_compress){_n=_s=""}else{_n="\n";_s=" "}TIMER&&(start=Date.now());var css=reduce(ast.stylesheet.rules,stringifyNode).join("\n").trim();TIMER&&debug("ran in",Date.now()-start+"ms");return css}function indent(level){if(level){_level+=level;return}if(_compress){return""}return Array(_level).join(_indentation||"")}function stringifyAtRule(node){return"@"+node.type+" "+node.value+";"+_n}function stringifyAtGroup(node){var label="";var prefix=node.prefix||"";if(node.name){label=" "+node.name}var chomp=node.type!=="page";return"@"+prefix+node.type+label+_s+stringifyBlock(node,chomp)+_n}function stringifyComment(node){if(!_comments){return""}return"/*"+(node.text||"")+"*/"+_n}function stringifyRule(node){var label;if(node.selectors){label=node.selectors.join(","+_n)}else{label="@"+node.type;label+=node.name?" "+node.name:""}return indent()+label+_s+stringifyBlock(node)+_n}function reduce(items,fn){return items.reduce((function(results,item){var result=item.type==="comment"?stringifyComment(item):fn(item);result&&results.push(result);return results}),[])}function stringifyBlock(node,chomp){var children=node.declarations;var fn=stringifyDeclaration;if(node.rules){children=node.rules;fn=stringifyRule}children=stringifyChildren(children,fn);children&&(children=_n+children+(chomp?"":_n));return"{"+children+indent()+"}"}function stringifyChildren(children,fn){if(!children){return""}indent(1);var results=reduce(children,fn);indent(-1);if(!results.length){return""}return results.join(_n)}function stringifyDeclaration(node){if(node.type==="property"){return stringifyProperty(node)}DEBUG&&debug("stringifyDeclaration: unexpected node:",JSON.stringify(node))}function stringifyNode(node){switch(node.type){case"rule":return stringifyRule(node);case"media":case"keyframes":return stringifyAtGroup(node);case"comment":return stringifyComment(node);case"import":case"charset":case"namespace":return stringifyAtRule(node);case"font-face":case"supports":case"viewport":case"document":case"page":return stringifyAtGroup(node)}DEBUG&&debug("stringifyNode: unexpected node: "+JSON.stringify(node))}function stringifyProperty(node){var name=node.name?node.name+":"+_s:"";return indent()+name+node.value+";"}},{"./debug":285}],289:[function(require,module,exports){var bn=require("bn.js");var brorand=require("brorand");function MillerRabin(rand){this.rand=rand||new brorand.Rand}module.exports=MillerRabin;MillerRabin.create=function create(rand){return new MillerRabin(rand)};MillerRabin.prototype._randbelow=function _randbelow(n){var len=n.bitLength();var min_bytes=Math.ceil(len/8);do{var a=new bn(this.rand.generate(min_bytes))}while(a.cmp(n)>=0);return a};MillerRabin.prototype._randrange=function _randrange(start,stop){var size=stop.sub(start);return start.add(this._randbelow(size))};MillerRabin.prototype.test=function test(n,k,cb){var len=n.bitLength();var red=bn.mont(n);var rone=new bn(1).toRed(red);if(!k)k=Math.max(1,len/48|0);var n1=n.subn(1);for(var s=0;!n1.testn(s);s++){}var d=n.shrn(s);var rn1=n1.toRed(red);var prime=true;for(;k>0;k--){var a=this._randrange(new bn(2),n1);if(cb)cb(a);var x=a.toRed(red).redPow(d);if(x.cmp(rone)===0||x.cmp(rn1)===0)continue;for(var i=1;i<s;i++){x=x.redSqr();if(x.cmp(rone)===0)return false;if(x.cmp(rn1)===0)break}if(i===s)return false}return prime};MillerRabin.prototype.getDivisor=function getDivisor(n,k){var len=n.bitLength();var red=bn.mont(n);var rone=new bn(1).toRed(red);if(!k)k=Math.max(1,len/48|0);var n1=n.subn(1);for(var s=0;!n1.testn(s);s++){}var d=n.shrn(s);var rn1=n1.toRed(red);for(;k>0;k--){var a=this._randrange(new bn(2),n1);var g=n.gcd(a);if(g.cmpn(1)!==0)return g;var x=a.toRed(red).redPow(d);if(x.cmp(rone)===0||x.cmp(rn1)===0)continue;for(var i=1;i<s;i++){x=x.redSqr();if(x.cmp(rone)===0)return x.fromRed().subn(1).gcd(n);if(x.cmp(rn1)===0)break}if(i===s){x=x.redSqr();return x.fromRed().subn(1).gcd(n)}}return false}},{"bn.js":290,brorand:42}],290:[function(require,module,exports){arguments[4][34][0].apply(exports,arguments)},{buffer:88,dup:34}],291:[function(require,module,exports){module.exports=assert;function assert(val,msg){if(!val)throw new Error(msg||"Assertion failed")}assert.equal=function assertEqual(l,r,msg){if(l!=r)throw new Error(msg||"Assertion failed: "+l+" != "+r)}},{}],292:[function(require,module,exports){"use strict";var utils=exports;function toArray(msg,enc){if(Array.isArray(msg))return msg.slice();if(!msg)return[];var res=[];if(typeof msg!=="string"){for(var i=0;i<msg.length;i++)res[i]=msg[i]|0;return res}if(enc==="hex"){msg=msg.replace(/[^a-z0-9]+/gi,"");if(msg.length%2!==0)msg="0"+msg;for(var i=0;i<msg.length;i+=2)res.push(parseInt(msg[i]+msg[i+1],16))}else{for(var i=0;i<msg.length;i++){var c=msg.charCodeAt(i);var hi=c>>8;var lo=c&255;if(hi)res.push(hi,lo);else res.push(lo)}}return res}utils.toArray=toArray;function zero2(word){if(word.length===1)return"0"+word;else return word}utils.zero2=zero2;function toHex(msg){var res="";for(var i=0;i<msg.length;i++)res+=zero2(msg[i].toString(16));return res}utils.toHex=toHex;utils.encode=function encode(arr,enc){if(enc==="hex")return toHex(arr);else return arr}},{}],293:[function(require,module,exports){"use strict";function _handleAddress(tokens){let token;let isGroup=false;let state="text";let address;let addresses=[];let data={address:[],comment:[],group:[],text:[]};let i;let len;for(i=0,len=tokens.length;i<len;i++){token=tokens[i];if(token.type==="operator"){switch(token.value){case"<":state="address";break;case"(":state="comment";break;case":":state="group";isGroup=true;break;default:state="text"}}else if(token.value){if(state==="address"){token.value=token.value.replace(/^[^<]*<\s*/,"")}data[state].push(token.value)}}if(!data.text.length&&data.comment.length){data.text=data.comment;data.comment=[]}if(isGroup){data.text=data.text.join(" ");addresses.push({name:data.text||address&&address.name,group:data.group.length?addressparser(data.group.join(",")):[]})}else{if(!data.address.length&&data.text.length){for(i=data.text.length-1;i>=0;i--){if(data.text[i].match(/^[^@\s]+@[^@\s]+$/)){data.address=data.text.splice(i,1);break}}let _regexHandler=function(address){if(!data.address.length){data.address=[address.trim()];return" "}else{return address}};if(!data.address.length){for(i=data.text.length-1;i>=0;i--){data.text[i]=data.text[i].replace(/\s*\b[^@\s]+@[^\s]+\b\s*/,_regexHandler).trim();if(data.address.length){break}}}}if(!data.text.length&&data.comment.length){data.text=data.comment;data.comment=[]}if(data.address.length>1){data.text=data.text.concat(data.address.splice(1))}data.text=data.text.join(" ");data.address=data.address.join(" ");if(!data.address&&isGroup){return[]}else{address={address:data.address||data.text||"",name:data.text||data.address||""};if(address.address===address.name){if((address.address||"").match(/@/)){address.name=""}else{address.address=""}}addresses.push(address)}}return addresses}class Tokenizer{constructor(str){this.str=(str||"").toString();this.operatorCurrent="";this.operatorExpecting="";this.node=null;this.escaped=false;this.list=[];this.operators={'"':'"',"(":")","<":">",",":"",":":";",";":""}}tokenize(){let chr,list=[];for(let i=0,len=this.str.length;i<len;i++){chr=this.str.charAt(i);this.checkChar(chr)}this.list.forEach((node=>{node.value=(node.value||"").toString().trim();if(node.value){list.push(node)}}));return list}checkChar(chr){if(this.escaped){}else if(chr===this.operatorExpecting){this.node={type:"operator",value:chr};this.list.push(this.node);this.node=null;this.operatorExpecting="";this.escaped=false;return}else if(!this.operatorExpecting&&chr in this.operators){this.node={type:"operator",value:chr};this.list.push(this.node);this.node=null;this.operatorExpecting=this.operators[chr];this.escaped=false;return}else if(['"',"'"].includes(this.operatorExpecting)&&chr==="\\"){this.escaped=true;return}if(!this.node){this.node={type:"text",value:""};this.list.push(this.node)}if(chr==="\n"){chr=" "}if(chr.charCodeAt(0)>=33||[" ","\t"].includes(chr)){this.node.value+=chr}this.escaped=false}}function addressparser(str,options){options=options||{};let tokenizer=new Tokenizer(str);let tokens=tokenizer.tokenize();let addresses=[];let address=[];let parsedAddresses=[];tokens.forEach((token=>{if(token.type==="operator"&&(token.value===","||token.value===";")){if(address.length){addresses.push(address)}address=[]}else{address.push(token)}}));if(address.length){addresses.push(address)}addresses.forEach((address=>{address=_handleAddress(address);if(address.length){parsedAddresses=parsedAddresses.concat(address)}}));if(options.flatten){let addresses=[];let walkAddressList=list=>{list.forEach((address=>{if(address.group){return walkAddressList(address.group)}else{addresses.push(address)}}))};walkAddressList(parsedAddresses);return addresses}return parsedAddresses}module.exports=addressparser},{}],294:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const Transform=require("stream").Transform;function encode(buffer){if(typeof buffer==="string"){buffer=Buffer.from(buffer,"utf-8")}return buffer.toString("base64")}function wrap(str,lineLength){str=(str||"").toString();lineLength=lineLength||76;if(str.length<=lineLength){return str}let result=[];let pos=0;let chunkLength=lineLength*1024;while(pos<str.length){let wrappedLines=str.substr(pos,chunkLength).replace(new RegExp(".{"+lineLength+"}","g"),"$&\r\n").trim();result.push(wrappedLines);pos+=chunkLength}return result.join("\r\n").trim()}class Encoder extends Transform{constructor(options){super();this.options=options||{};if(this.options.lineLength!==false){this.options.lineLength=this.options.lineLength||76}this._curLine="";this._remainingBytes=false;this.inputBytes=0;this.outputBytes=0}_transform(chunk,encoding,done){if(encoding!=="buffer"){chunk=Buffer.from(chunk,encoding)}if(!chunk||!chunk.length){return setImmediate(done)}this.inputBytes+=chunk.length;if(this._remainingBytes&&this._remainingBytes.length){chunk=Buffer.concat([this._remainingBytes,chunk],this._remainingBytes.length+chunk.length);this._remainingBytes=false}if(chunk.length%3){this._remainingBytes=chunk.slice(chunk.length-chunk.length%3);chunk=chunk.slice(0,chunk.length-chunk.length%3)}else{this._remainingBytes=false}let b64=this._curLine+encode(chunk);if(this.options.lineLength){b64=wrap(b64,this.options.lineLength);let lastLF=b64.lastIndexOf("\n");if(lastLF<0){this._curLine=b64;b64=""}else if(lastLF===b64.length-1){this._curLine=""}else{this._curLine=b64.substr(lastLF+1);b64=b64.substr(0,lastLF+1)}}if(b64){this.outputBytes+=b64.length;this.push(Buffer.from(b64,"ascii"))}setImmediate(done)}_flush(done){if(this._remainingBytes&&this._remainingBytes.length){this._curLine+=encode(this._remainingBytes)}if(this._curLine){this._curLine=wrap(this._curLine,this.options.lineLength);this.outputBytes+=this._curLine.length;this.push(this._curLine,"ascii");this._curLine=""}done()}}module.exports={encode:encode,wrap:wrap,Encoder:Encoder}}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{buffer:88,stream:398,timers:433}],295:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const MessageParser=require("./message-parser");const RelaxedBody=require("./relaxed-body");const sign=require("./sign");const PassThrough=require("stream").PassThrough;const fs=require("fs");const path=require("path");const crypto=require("crypto");const DKIM_ALGO="sha256";const MAX_MESSAGE_SIZE=128*1024;class DKIMSigner{constructor(options,keys,input,output){this.options=options||{};this.keys=keys;this.cacheTreshold=Number(this.options.cacheTreshold)||MAX_MESSAGE_SIZE;this.hashAlgo=this.options.hashAlgo||DKIM_ALGO;this.cacheDir=this.options.cacheDir||false;this.chunks=[];this.chunklen=0;this.readPos=0;this.cachePath=this.cacheDir?path.join(this.cacheDir,"message."+Date.now()+"-"+crypto.randomBytes(14).toString("hex")):false;this.cache=false;this.headers=false;this.bodyHash=false;this.parser=false;this.relaxedBody=false;this.input=input;this.output=output;this.output.usingCache=false;this.hasErrored=false;this.input.on("error",(err=>{this.hasErrored=true;this.cleanup();output.emit("error",err)}))}cleanup(){if(!this.cache||!this.cachePath){return}fs.unlink(this.cachePath,(()=>false))}createReadCache(){this.cache=fs.createReadStream(this.cachePath);this.cache.once("error",(err=>{this.cleanup();this.output.emit("error",err)}));this.cache.once("close",(()=>{this.cleanup()}));this.cache.pipe(this.output)}sendNextChunk(){if(this.hasErrored){return}if(this.readPos>=this.chunks.length){if(!this.cache){return this.output.end()}return this.createReadCache()}let chunk=this.chunks[this.readPos++];if(this.output.write(chunk)===false){return this.output.once("drain",(()=>{this.sendNextChunk()}))}setImmediate((()=>this.sendNextChunk()))}sendSignedOutput(){let keyPos=0;let signNextKey=()=>{if(keyPos>=this.keys.length){this.output.write(this.parser.rawHeaders);return setImmediate((()=>this.sendNextChunk()))}let key=this.keys[keyPos++];let dkimField=sign(this.headers,this.hashAlgo,this.bodyHash,{domainName:key.domainName,keySelector:key.keySelector,privateKey:key.privateKey,headerFieldNames:this.options.headerFieldNames,skipFields:this.options.skipFields});if(dkimField){this.output.write(Buffer.from(dkimField+"\r\n"))}return setImmediate(signNextKey)};if(this.bodyHash&&this.headers){return signNextKey()}this.output.write(this.parser.rawHeaders);this.sendNextChunk()}createWriteCache(){this.output.usingCache=true;this.cache=fs.createWriteStream(this.cachePath);this.cache.once("error",(err=>{this.cleanup();this.relaxedBody.unpipe(this.cache);this.relaxedBody.on("readable",(()=>{while(this.relaxedBody.read()!==null){}}));this.hasErrored=true;this.output.emit("error",err)}));this.cache.once("close",(()=>{this.sendSignedOutput()}));this.relaxedBody.removeAllListeners("readable");this.relaxedBody.pipe(this.cache)}signStream(){this.parser=new MessageParser;this.relaxedBody=new RelaxedBody({hashAlgo:this.hashAlgo});this.parser.on("headers",(value=>{this.headers=value}));this.relaxedBody.on("hash",(value=>{this.bodyHash=value}));this.relaxedBody.on("readable",(()=>{let chunk;if(this.cache){return}while((chunk=this.relaxedBody.read())!==null){this.chunks.push(chunk);this.chunklen+=chunk.length;if(this.chunklen>=this.cacheTreshold&&this.cachePath){return this.createWriteCache()}}}));this.relaxedBody.on("end",(()=>{if(this.cache){return}this.sendSignedOutput()}));this.parser.pipe(this.relaxedBody);setImmediate((()=>this.input.pipe(this.parser)))}}class DKIM{constructor(options){this.options=options||{};this.keys=[].concat(this.options.keys||{domainName:options.domainName,keySelector:options.keySelector,privateKey:options.privateKey})}sign(input,extraOptions){let output=new PassThrough;let inputStream=input;let writeValue=false;if(Buffer.isBuffer(input)){writeValue=input;inputStream=new PassThrough}else if(typeof input==="string"){writeValue=Buffer.from(input);inputStream=new PassThrough}let options=this.options;if(extraOptions&&Object.keys(extraOptions).length){options={};Object.keys(this.options||{}).forEach((key=>{options[key]=this.options[key]}));Object.keys(extraOptions||{}).forEach((key=>{if(!(key in options)){options[key]=extraOptions[key]}}))}let signer=new DKIMSigner(options,this.keys,inputStream,output);setImmediate((()=>{signer.signStream();if(writeValue){setImmediate((()=>{inputStream.end(writeValue)}))}}));return output}}module.exports=DKIM}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{"./message-parser":296,"./relaxed-body":297,"./sign":298,buffer:88,crypto:118,fs:88,path:368,stream:398,timers:433}],296:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const Transform=require("stream").Transform;class MessageParser extends Transform{constructor(options){super(options);this.lastBytes=Buffer.alloc(4);this.headersParsed=false;this.headerBytes=0;this.headerChunks=[];this.rawHeaders=false;this.bodySize=0}updateLastBytes(data){let lblen=this.lastBytes.length;let nblen=Math.min(data.length,lblen);for(let i=0,len=lblen-nblen;i<len;i++){this.lastBytes[i]=this.lastBytes[i+nblen]}for(let i=1;i<=nblen;i++){this.lastBytes[lblen-i]=data[data.length-i]}}checkHeaders(data){if(this.headersParsed){return true}let lblen=this.lastBytes.length;let headerPos=0;this.curLinePos=0;for(let i=0,len=this.lastBytes.length+data.length;i<len;i++){let chr;if(i<lblen){chr=this.lastBytes[i]}else{chr=data[i-lblen]}if(chr===10&&i){let pr1=i-1<lblen?this.lastBytes[i-1]:data[i-1-lblen];let pr2=i>1?i-2<lblen?this.lastBytes[i-2]:data[i-2-lblen]:false;if(pr1===10){this.headersParsed=true;headerPos=i-lblen+1;this.headerBytes+=headerPos;break}else if(pr1===13&&pr2===10){this.headersParsed=true;headerPos=i-lblen+1;this.headerBytes+=headerPos;break}}}if(this.headersParsed){this.headerChunks.push(data.slice(0,headerPos));this.rawHeaders=Buffer.concat(this.headerChunks,this.headerBytes);this.headerChunks=null;this.emit("headers",this.parseHeaders());if(data.length-1>headerPos){let chunk=data.slice(headerPos);this.bodySize+=chunk.length;setImmediate((()=>this.push(chunk)))}return false}else{this.headerBytes+=data.length;this.headerChunks.push(data)}this.updateLastBytes(data);return false}_transform(chunk,encoding,callback){if(!chunk||!chunk.length){return callback()}if(typeof chunk==="string"){chunk=Buffer.from(chunk,encoding)}let headersFound;try{headersFound=this.checkHeaders(chunk)}catch(E){return callback(E)}if(headersFound){this.bodySize+=chunk.length;this.push(chunk)}setImmediate(callback)}_flush(callback){if(this.headerChunks){let chunk=Buffer.concat(this.headerChunks,this.headerBytes);this.bodySize+=chunk.length;this.push(chunk);this.headerChunks=null}callback()}parseHeaders(){let lines=(this.rawHeaders||"").toString().split(/\r?\n/);for(let i=lines.length-1;i>0;i--){if(/^\s/.test(lines[i])){lines[i-1]+="\n"+lines[i];lines.splice(i,1)}}return lines.filter((line=>line.trim())).map((line=>({key:line.substr(0,line.indexOf(":")).trim().toLowerCase(),line:line})))}}module.exports=MessageParser}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{buffer:88,stream:398,timers:433}],297:[function(require,module,exports){(function(Buffer){(function(){"use strict";const Transform=require("stream").Transform;const crypto=require("crypto");class RelaxedBody extends Transform{constructor(options){super();options=options||{};this.chunkBuffer=[];this.chunkBufferLen=0;this.bodyHash=crypto.createHash(options.hashAlgo||"sha1");this.remainder="";this.byteLength=0;this.debug=options.debug;this._debugBody=options.debug?[]:false}updateHash(chunk){let bodyStr;let nextRemainder="";let state="file";for(let i=chunk.length-1;i>=0;i--){let c=chunk[i];if(state==="file"&&(c===10||c===13)){}else if(state==="file"&&(c===9||c===32)){state="line"}else if(state==="line"&&(c===9||c===32)){}else if(state==="file"||state==="line"){state="body";if(i===chunk.length-1){break}}if(i===0){if(state==="file"&&(!this.remainder||/[\r\n]$/.test(this.remainder))||state==="line"&&(!this.remainder||/[ \t]$/.test(this.remainder))){this.remainder+=chunk.toString("binary");return}else if(state==="line"||state==="file"){nextRemainder=chunk.toString("binary");chunk=false;break}}if(state!=="body"){continue}nextRemainder=chunk.slice(i+1).toString("binary");chunk=chunk.slice(0,i+1);break}let needsFixing=!!this.remainder;if(chunk&&!needsFixing){for(let i=0,len=chunk.length;i<len;i++){if(i&&chunk[i]===10&&chunk[i-1]!==13){needsFixing=true;break}else if(i&&chunk[i]===13&&chunk[i-1]===32){needsFixing=true;break}else if(i&&chunk[i]===32&&chunk[i-1]===32){needsFixing=true;break}else if(chunk[i]===9){needsFixing=true;break}}}if(needsFixing){bodyStr=this.remainder+(chunk?chunk.toString("binary"):"");this.remainder=nextRemainder;bodyStr=bodyStr.replace(/\r?\n/g,"\n").replace(/[ \t]*$/gm,"").replace(/[ \t]+/gm," ").replace(/\n/g,"\r\n");chunk=Buffer.from(bodyStr,"binary")}else if(nextRemainder){this.remainder=nextRemainder}if(this.debug){this._debugBody.push(chunk)}this.bodyHash.update(chunk)}_transform(chunk,encoding,callback){if(!chunk||!chunk.length){return callback()}if(typeof chunk==="string"){chunk=Buffer.from(chunk,encoding)}this.updateHash(chunk);this.byteLength+=chunk.length;this.push(chunk);callback()}_flush(callback){if(/[\r\n]$/.test(this.remainder)&&this.byteLength>2){this.bodyHash.update(Buffer.from("\r\n"))}if(!this.byteLength){this.push(Buffer.from("\r\n"))}this.emit("hash",this.bodyHash.digest("base64"),this.debug?Buffer.concat(this._debugBody):false);callback()}}module.exports=RelaxedBody}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88,crypto:118,stream:398}],298:[function(require,module,exports){"use strict";const punycode=require("punycode");const mimeFuncs=require("../mime-funcs");const crypto=require("crypto");module.exports=(headers,hashAlgo,bodyHash,options)=>{options=options||{};let defaultFieldNames="From:Sender:Reply-To:Subject:Date:Message-ID:To:"+"Cc:MIME-Version:Content-Type:Content-Transfer-Encoding:Content-ID:"+"Content-Description:Resent-Date:Resent-From:Resent-Sender:"+"Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:"+"List-Id:List-Help:List-Unsubscribe:List-Subscribe:List-Post:"+"List-Owner:List-Archive";let fieldNames=options.headerFieldNames||defaultFieldNames;let canonicalizedHeaderData=relaxedHeaders(headers,fieldNames,options.skipFields);let dkimHeader=generateDKIMHeader(options.domainName,options.keySelector,canonicalizedHeaderData.fieldNames,hashAlgo,bodyHash);let signer,signature;canonicalizedHeaderData.headers+="dkim-signature:"+relaxedHeaderLine(dkimHeader);signer=crypto.createSign(("rsa-"+hashAlgo).toUpperCase());signer.update(canonicalizedHeaderData.headers);try{signature=signer.sign(options.privateKey,"base64")}catch(E){return false}return dkimHeader+signature.replace(/(^.{73}|.{75}(?!\r?\n|\r))/g,"$&\r\n ").trim()};module.exports.relaxedHeaders=relaxedHeaders;function generateDKIMHeader(domainName,keySelector,fieldNames,hashAlgo,bodyHash){let dkim=["v=1","a=rsa-"+hashAlgo,"c=relaxed/relaxed","d="+punycode.toASCII(domainName),"q=dns/txt","s="+keySelector,"bh="+bodyHash,"h="+fieldNames].join("; ");return mimeFuncs.foldLines("DKIM-Signature: "+dkim,76)+";\r\n b="}function relaxedHeaders(headers,fieldNames,skipFields){let includedFields=new Set;let skip=new Set;let headerFields=new Map;(skipFields||"").toLowerCase().split(":").forEach((field=>{skip.add(field.trim())}));(fieldNames||"").toLowerCase().split(":").filter((field=>!skip.has(field.trim()))).forEach((field=>{includedFields.add(field.trim())}));for(let i=headers.length-1;i>=0;i--){let line=headers[i];if(includedFields.has(line.key)&&!headerFields.has(line.key)){headerFields.set(line.key,relaxedHeaderLine(line.line))}}let headersList=[];let fields=[];includedFields.forEach((field=>{if(headerFields.has(field)){fields.push(field);headersList.push(field+":"+headerFields.get(field))}}));return{headers:headersList.join("\r\n")+"\r\n",fieldNames:fields.join(":")}}function relaxedHeaderLine(line){return line.substr(line.indexOf(":")+1).replace(/\r?\n/g,"").replace(/\s+/g," ").trim()}},{"../mime-funcs":305,crypto:118,punycode:89}],299:[function(require,module,exports){"use strict";const urllib=require("url");const SESSION_TIMEOUT=1800;class Cookies{constructor(options){this.options=options||{};this.cookies=[]}set(cookieStr,url){let urlparts=urllib.parse(url||"");let cookie=this.parse(cookieStr);let domain;if(cookie.domain){domain=cookie.domain.replace(/^\./,"");if(urlparts.hostname.length<domain.length||("."+urlparts.hostname).substr(-domain.length+1)!=="."+domain){cookie.domain=urlparts.hostname}}else{cookie.domain=urlparts.hostname}if(!cookie.path){cookie.path=this.getPath(urlparts.pathname)}if(!cookie.expires){cookie.expires=new Date(Date.now()+(Number(this.options.sessionTimeout||SESSION_TIMEOUT)||SESSION_TIMEOUT)*1e3)}return this.add(cookie)}get(url){return this.list(url).map((cookie=>cookie.name+"="+cookie.value)).join("; ")}list(url){let result=[];let i;let cookie;for(i=this.cookies.length-1;i>=0;i--){cookie=this.cookies[i];if(this.isExpired(cookie)){this.cookies.splice(i,i);continue}if(this.match(cookie,url)){result.unshift(cookie)}}return result}parse(cookieStr){let cookie={};(cookieStr||"").toString().split(";").forEach((cookiePart=>{let valueParts=cookiePart.split("=");let key=valueParts.shift().trim().toLowerCase();let value=valueParts.join("=").trim();let domain;if(!key){return}switch(key){case"expires":value=new Date(value);if(value.toString()!=="Invalid Date"){cookie.expires=value}break;case"path":cookie.path=value;break;case"domain":domain=value.toLowerCase();if(domain.length&&domain.charAt(0)!=="."){domain="."+domain}cookie.domain=domain;break;case"max-age":cookie.expires=new Date(Date.now()+(Number(value)||0)*1e3);break;case"secure":cookie.secure=true;break;case"httponly":cookie.httponly=true;break;default:if(!cookie.name){cookie.name=key;cookie.value=value}}}));return cookie}match(cookie,url){let urlparts=urllib.parse(url||"");if(urlparts.hostname!==cookie.domain&&(cookie.domain.charAt(0)!=="."||("."+urlparts.hostname).substr(-cookie.domain.length)!==cookie.domain)){return false}let path=this.getPath(urlparts.pathname);if(path.substr(0,cookie.path.length)!==cookie.path){return false}if(cookie.secure&&urlparts.protocol!=="https:"){return false}return true}add(cookie){let i;let len;if(!cookie||!cookie.name){return false}for(i=0,len=this.cookies.length;i<len;i++){if(this.compare(this.cookies[i],cookie)){if(this.isExpired(cookie)){this.cookies.splice(i,1);return false}this.cookies[i]=cookie;return true}}if(!this.isExpired(cookie)){this.cookies.push(cookie)}return true}compare(a,b){return a.name===b.name&&a.path===b.path&&a.domain===b.domain&&a.secure===b.secure&&a.httponly===a.httponly}isExpired(cookie){return cookie.expires&&cookie.expires<new Date||!cookie.value}getPath(pathname){let path=(pathname||"/").split("/");path.pop();path=path.join("/").trim();if(path.charAt(0)!=="/"){path="/"+path}if(path.substr(-1)!=="/"){path+="/"}return path}}module.exports=Cookies},{url:439}],300:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const http=require("http");const https=require("https");const urllib=require("url");const zlib=require("zlib");const PassThrough=require("stream").PassThrough;const Cookies=require("./cookies");const packageData=require("../../package.json");const net=require("net");const MAX_REDIRECTS=5;module.exports=function(url,options){return nmfetch(url,options)};module.exports.Cookies=Cookies;function nmfetch(url,options){options=options||{};options.fetchRes=options.fetchRes||new PassThrough;options.cookies=options.cookies||new Cookies;options.redirects=options.redirects||0;options.maxRedirects=isNaN(options.maxRedirects)?MAX_REDIRECTS:options.maxRedirects;if(options.cookie){[].concat(options.cookie||[]).forEach((cookie=>{options.cookies.set(cookie,url)}));options.cookie=false}let fetchRes=options.fetchRes;let parsed=urllib.parse(url);let method=(options.method||"").toString().trim().toUpperCase()||"GET";let finished=false;let cookies;let body;let handler=parsed.protocol==="https:"?https:http;let headers={"accept-encoding":"gzip,deflate","user-agent":"nodemailer/"+packageData.version};Object.keys(options.headers||{}).forEach((key=>{headers[key.toLowerCase().trim()]=options.headers[key]}));if(options.userAgent){headers["user-agent"]=options.userAgent}if(parsed.auth){headers.Authorization="Basic "+Buffer.from(parsed.auth).toString("base64")}if(cookies=options.cookies.get(url)){headers.cookie=cookies}if(options.body){if(options.contentType!==false){headers["Content-Type"]=options.contentType||"application/x-www-form-urlencoded"}if(typeof options.body.pipe==="function"){headers["Transfer-Encoding"]="chunked";body=options.body;body.on("error",(err=>{if(finished){return}finished=true;err.type="FETCH";err.sourceUrl=url;fetchRes.emit("error",err)}))}else{if(options.body instanceof Buffer){body=options.body}else if(typeof options.body==="object"){try{body=Buffer.from(Object.keys(options.body).map((key=>{let value=options.body[key].toString().trim();return encodeURIComponent(key)+"="+encodeURIComponent(value)})).join("&"))}catch(E){if(finished){return}finished=true;E.type="FETCH";E.sourceUrl=url;fetchRes.emit("error",E);return}}else{body=Buffer.from(options.body.toString().trim())}headers["Content-Type"]=options.contentType||"application/x-www-form-urlencoded";headers["Content-Length"]=body.length}method=(options.method||"").toString().trim().toUpperCase()||"POST"}let req;let reqOptions={method:method,host:parsed.hostname,path:parsed.path,port:parsed.port?parsed.port:parsed.protocol==="https:"?443:80,headers:headers,rejectUnauthorized:false,agent:false};if(options.tls){Object.keys(options.tls).forEach((key=>{reqOptions[key]=options.tls[key]}))}if(parsed.protocol==="https:"&&parsed.hostname&&parsed.hostname!==reqOptions.host&&!net.isIP(parsed.hostname)&&!reqOptions.servername){reqOptions.servername=parsed.hostname}try{req=handler.request(reqOptions)}catch(E){finished=true;setImmediate((()=>{E.type="FETCH";E.sourceUrl=url;fetchRes.emit("error",E)}));return fetchRes}if(options.timeout){req.setTimeout(options.timeout,(()=>{if(finished){return}finished=true;req.abort();let err=new Error("Request Timeout");err.type="FETCH";err.sourceUrl=url;fetchRes.emit("error",err)}))}req.on("error",(err=>{if(finished){return}finished=true;err.type="FETCH";err.sourceUrl=url;fetchRes.emit("error",err)}));req.on("response",(res=>{let inflate;if(finished){return}switch(res.headers["content-encoding"]){case"gzip":case"deflate":inflate=zlib.createUnzip();break}if(res.headers["set-cookie"]){[].concat(res.headers["set-cookie"]||[]).forEach((cookie=>{options.cookies.set(cookie,url)}))}if([301,302,303,307,308].includes(res.statusCode)&&res.headers.location){options.redirects++;if(options.redirects>options.maxRedirects){finished=true;let err=new Error("Maximum redirect count exceeded");err.type="FETCH";err.sourceUrl=url;fetchRes.emit("error",err);req.abort();return}options.method="GET";options.body=false;return nmfetch(urllib.resolve(url,res.headers.location),options)}fetchRes.statusCode=res.statusCode;fetchRes.headers=res.headers;if(res.statusCode>=300&&!options.allowErrorResponse){finished=true;let err=new Error("Invalid status code "+res.statusCode);err.type="FETCH";err.sourceUrl=url;fetchRes.emit("error",err);req.abort();return}res.on("error",(err=>{if(finished){return}finished=true;err.type="FETCH";err.sourceUrl=url;fetchRes.emit("error",err);req.abort()}));if(inflate){res.pipe(inflate).pipe(fetchRes);inflate.on("error",(err=>{if(finished){return}finished=true;err.type="FETCH";err.sourceUrl=url;fetchRes.emit("error",err);req.abort()}))}else{res.pipe(fetchRes)}}));setImmediate((()=>{if(body){try{if(typeof body.pipe==="function"){return body.pipe(req)}else{req.write(body)}}catch(err){finished=true;err.type="FETCH";err.sourceUrl=url;fetchRes.emit("error",err);return}}req.end()}));return fetchRes}}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{"../../package.json":326,"./cookies":299,buffer:88,http:413,https:232,net:88,stream:398,timers:433,url:439,zlib:87}],301:[function(require,module,exports){(function(setImmediate){(function(){"use strict";const packageData=require("../../package.json");const shared=require("../shared");class JSONTransport{constructor(options){options=options||{};this.options=options||{};this.name="JSONTransport";this.version=packageData.version;this.logger=shared.getLogger(this.options,{component:this.options.component||"json-transport"})}send(mail,done){mail.message.keepBcc=true;let envelope=mail.data.envelope||mail.message.getEnvelope();let messageId=mail.message.messageId();let recipients=[].concat(envelope.to||[]);if(recipients.length>3){recipients.push("...and "+recipients.splice(2).length+" more")}this.logger.info({tnx:"send",messageId:messageId},"Composing JSON structure of %s to <%s>",messageId,recipients.join(", "));setImmediate((()=>{mail.normalize(((err,data)=>{if(err){this.logger.error({err:err,tnx:"send",messageId:messageId},"Failed building JSON structure for %s. %s",messageId,err.message);return done(err)}delete data.envelope;delete data.normalizedHeaders;return done(null,{envelope:envelope,messageId:messageId,message:this.options.skipEncoding?data:JSON.stringify(data)})}))}))}}module.exports=JSONTransport}).call(this)}).call(this,require("timers").setImmediate)},{"../../package.json":326,"../shared":315,timers:433}],302:[function(require,module,exports){(function(Buffer){(function(){"use strict";const MimeNode=require("../mime-node");const mimeFuncs=require("../mime-funcs");class MailComposer{constructor(mail){this.mail=mail||{};this.message=false}compile(){this._alternatives=this.getAlternatives();this._htmlNode=this._alternatives.filter((alternative=>/^text\/html\b/i.test(alternative.contentType))).pop();this._attachments=this.getAttachments(!!this._htmlNode);this._useRelated=!!(this._htmlNode&&this._attachments.related.length);this._useAlternative=this._alternatives.length>1;this._useMixed=this._attachments.attached.length>1||this._alternatives.length&&this._attachments.attached.length===1;if(this.mail.raw){this.message=new MimeNode("message/rfc822",{newline:this.mail.newline}).setRaw(this.mail.raw)}else if(this._useMixed){this.message=this._createMixed()}else if(this._useAlternative){this.message=this._createAlternative()}else if(this._useRelated){this.message=this._createRelated()}else{this.message=this._createContentNode(false,[].concat(this._alternatives||[]).concat(this._attachments.attached||[]).shift()||{contentType:"text/plain",content:""})}if(this.mail.headers){this.message.addHeader(this.mail.headers)}["from","sender","to","cc","bcc","reply-to","in-reply-to","references","subject","message-id","date"].forEach((header=>{let key=header.replace(/-(\w)/g,((o,c)=>c.toUpperCase()));if(this.mail[key]){this.message.setHeader(header,this.mail[key])}}));if(this.mail.envelope){this.message.setEnvelope(this.mail.envelope)}this.message.messageId();return this.message}getAttachments(findRelated){let icalEvent,eventObject;let attachments=[].concat(this.mail.attachments||[]).map(((attachment,i)=>{let data;let isMessageNode=/^message\//i.test(attachment.contentType);if(/^data:/i.test(attachment.path||attachment.href)){attachment=this._processDataUrl(attachment)}let contentType=attachment.contentType||mimeFuncs.detectMimeType(attachment.filename||attachment.path||attachment.href||"bin");let isImage=/^image\//i.test(contentType);let contentDisposition=attachment.contentDisposition||(isMessageNode||isImage&&attachment.cid?"inline":"attachment");data={contentType:contentType,contentDisposition:contentDisposition,contentTransferEncoding:"contentTransferEncoding"in attachment?attachment.contentTransferEncoding:"base64"};if(attachment.filename){data.filename=attachment.filename}else if(!isMessageNode&&attachment.filename!==false){data.filename=(attachment.path||attachment.href||"").split("/").pop().split("?").shift()||"attachment-"+(i+1);if(data.filename.indexOf(".")<0){data.filename+="."+mimeFuncs.detectExtension(data.contentType)}}if(/^https?:\/\//i.test(attachment.path)){attachment.href=attachment.path;attachment.path=undefined}if(attachment.cid){data.cid=attachment.cid}if(attachment.raw){data.raw=attachment.raw}else if(attachment.path){data.content={path:attachment.path}}else if(attachment.href){data.content={href:attachment.href,httpHeaders:attachment.httpHeaders}}else{data.content=attachment.content||""}if(attachment.encoding){data.encoding=attachment.encoding}if(attachment.headers){data.headers=attachment.headers}return data}));if(this.mail.icalEvent){if(typeof this.mail.icalEvent==="object"&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)){icalEvent=this.mail.icalEvent}else{icalEvent={content:this.mail.icalEvent}}eventObject={};Object.keys(icalEvent).forEach((key=>{eventObject[key]=icalEvent[key]}));eventObject.contentType="application/ics";if(!eventObject.headers){eventObject.headers={}}eventObject.filename=eventObject.filename||"invite.ics";eventObject.headers["Content-Disposition"]="attachment";eventObject.headers["Content-Transfer-Encoding"]="base64"}if(!findRelated){return{attached:attachments.concat(eventObject||[]),related:[]}}else{return{attached:attachments.filter((attachment=>!attachment.cid)).concat(eventObject||[]),related:attachments.filter((attachment=>!!attachment.cid))}}}getAlternatives(){let alternatives=[],text,html,watchHtml,amp,icalEvent,eventObject;if(this.mail.text){if(typeof this.mail.text==="object"&&(this.mail.text.content||this.mail.text.path||this.mail.text.href||this.mail.text.raw)){text=this.mail.text}else{text={content:this.mail.text}}text.contentType="text/plain; charset=utf-8"}if(this.mail.watchHtml){if(typeof this.mail.watchHtml==="object"&&(this.mail.watchHtml.content||this.mail.watchHtml.path||this.mail.watchHtml.href||this.mail.watchHtml.raw)){watchHtml=this.mail.watchHtml}else{watchHtml={content:this.mail.watchHtml}}watchHtml.contentType="text/watch-html; charset=utf-8"}if(this.mail.amp){if(typeof this.mail.amp==="object"&&(this.mail.amp.content||this.mail.amp.path||this.mail.amp.href||this.mail.amp.raw)){amp=this.mail.amp}else{amp={content:this.mail.amp}}amp.contentType="text/x-amp-html; charset=utf-8"}if(this.mail.icalEvent){if(typeof this.mail.icalEvent==="object"&&(this.mail.icalEvent.content||this.mail.icalEvent.path||this.mail.icalEvent.href||this.mail.icalEvent.raw)){icalEvent=this.mail.icalEvent}else{icalEvent={content:this.mail.icalEvent}}eventObject={};Object.keys(icalEvent).forEach((key=>{eventObject[key]=icalEvent[key]}));if(eventObject.content&&typeof eventObject.content==="object"){eventObject.content._resolve=true}eventObject.filename=false;eventObject.contentType="text/calendar; charset=utf-8; method="+(eventObject.method||"PUBLISH").toString().trim().toUpperCase();if(!eventObject.headers){eventObject.headers={}}}if(this.mail.html){if(typeof this.mail.html==="object"&&(this.mail.html.content||this.mail.html.path||this.mail.html.href||this.mail.html.raw)){html=this.mail.html}else{html={content:this.mail.html}}html.contentType="text/html; charset=utf-8"}[].concat(text||[]).concat(watchHtml||[]).concat(amp||[]).concat(html||[]).concat(eventObject||[]).concat(this.mail.alternatives||[]).forEach((alternative=>{let data;if(/^data:/i.test(alternative.path||alternative.href)){alternative=this._processDataUrl(alternative)}data={contentType:alternative.contentType||mimeFuncs.detectMimeType(alternative.filename||alternative.path||alternative.href||"txt"),contentTransferEncoding:alternative.contentTransferEncoding};if(alternative.filename){data.filename=alternative.filename}if(/^https?:\/\//i.test(alternative.path)){alternative.href=alternative.path;alternative.path=undefined}if(alternative.raw){data.raw=alternative.raw}else if(alternative.path){data.content={path:alternative.path}}else if(alternative.href){data.content={href:alternative.href}}else{data.content=alternative.content||""}if(alternative.encoding){data.encoding=alternative.encoding}if(alternative.headers){data.headers=alternative.headers}alternatives.push(data)}));return alternatives}_createMixed(parentNode){let node;if(!parentNode){node=new MimeNode("multipart/mixed",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline})}else{node=parentNode.createChild("multipart/mixed",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline})}if(this._useAlternative){this._createAlternative(node)}else if(this._useRelated){this._createRelated(node)}[].concat(!this._useAlternative&&this._alternatives||[]).concat(this._attachments.attached||[]).forEach((element=>{if(!this._useRelated||element!==this._htmlNode){this._createContentNode(node,element)}}));return node}_createAlternative(parentNode){let node;if(!parentNode){node=new MimeNode("multipart/alternative",{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline})}else{node=parentNode.createChild("multipart/alternative",{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline})}this._alternatives.forEach((alternative=>{if(this._useRelated&&this._htmlNode===alternative){this._createRelated(node)}else{this._createContentNode(node,alternative)}}));return node}_createRelated(parentNode){let node;if(!parentNode){node=new MimeNode('multipart/related; type="text/html"',{baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline})}else{node=parentNode.createChild('multipart/related; type="text/html"',{disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline})}this._createContentNode(node,this._htmlNode);this._attachments.related.forEach((alternative=>this._createContentNode(node,alternative)));return node}_createContentNode(parentNode,element){element=element||{};element.content=element.content||"";let node;let encoding=(element.encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!parentNode){node=new MimeNode(element.contentType,{filename:element.filename,baseBoundary:this.mail.baseBoundary,textEncoding:this.mail.textEncoding,boundaryPrefix:this.mail.boundaryPrefix,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline})}else{node=parentNode.createChild(element.contentType,{filename:element.filename,textEncoding:this.mail.textEncoding,disableUrlAccess:this.mail.disableUrlAccess,disableFileAccess:this.mail.disableFileAccess,normalizeHeaderKey:this.mail.normalizeHeaderKey,newline:this.mail.newline})}if(element.headers){node.addHeader(element.headers)}if(element.cid){node.setHeader("Content-Id","<"+element.cid.replace(/[<>]/g,"")+">")}if(element.contentTransferEncoding){node.setHeader("Content-Transfer-Encoding",element.contentTransferEncoding)}else if(this.mail.encoding&&/^text\//i.test(element.contentType)){node.setHeader("Content-Transfer-Encoding",this.mail.encoding)}if(!/^text\//i.test(element.contentType)||element.contentDisposition){node.setHeader("Content-Disposition",element.contentDisposition||(element.cid&&/^image\//i.test(element.contentType)?"inline":"attachment"))}if(typeof element.content==="string"&&!["utf8","usascii","ascii"].includes(encoding)){element.content=Buffer.from(element.content,encoding)}if(element.raw){node.setRaw(element.raw)}else{node.setContent(element.content)}return node}_processDataUrl(element){let parts=(element.path||element.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);if(!parts){return element}element.content=/\bbase64$/i.test(parts[1])?Buffer.from(parts[2],"base64"):Buffer.from(decodeURIComponent(parts[2]));if("path"in element){element.path=false}if("href"in element){element.href=false}parts[1].split(";").forEach((item=>{if(/^\w+\/[^/]+$/i.test(item)){element.contentType=element.contentType||item.toLowerCase()}}));return element}}module.exports=MailComposer}).call(this)}).call(this,require("buffer").Buffer)},{"../mime-funcs":305,"../mime-node":307,buffer:88}],303:[function(require,module,exports){"use strict";const EventEmitter=require("events");const shared=require("../shared");const mimeTypes=require("../mime-funcs/mime-types");const MailComposer=require("../mail-composer");const DKIM=require("../dkim");const httpProxyClient=require("../smtp-connection/http-proxy-client");const util=require("util");const urllib=require("url");const packageData=require("../../package.json");const MailMessage=require("./mail-message");const net=require("net");const dns=require("dns");const crypto=require("crypto");class Mail extends EventEmitter{constructor(transporter,options,defaults){super();this.options=options||{};this._defaults=defaults||{};this._defaultPlugins={compile:[(...args)=>this._convertDataImages(...args)],stream:[]};this._userPlugins={compile:[],stream:[]};this.meta=new Map;this.dkim=this.options.dkim?new DKIM(this.options.dkim):false;this.transporter=transporter;this.transporter.mailer=this;this.logger=shared.getLogger(this.options,{component:this.options.component||"mail"});this.logger.debug({tnx:"create"},"Creating transport: %s",this.getVersionString());if(typeof this.transporter.on==="function"){this.transporter.on("log",(log=>{this.logger.debug({tnx:"transport"},"%s: %s",log.type,log.message)}));this.transporter.on("error",(err=>{this.logger.error({err:err,tnx:"transport"},"Transport Error: %s",err.message);this.emit("error",err)}));this.transporter.on("idle",((...args)=>{this.emit("idle",...args)}))}["close","isIdle","verify"].forEach((method=>{this[method]=(...args)=>{if(typeof this.transporter[method]==="function"){if(method==="verify"&&typeof this.getSocket==="function"){this.transporter.getSocket=this.getSocket;this.getSocket=false}return this.transporter[method](...args)}else{this.logger.warn({tnx:"transport",methodName:method},"Non existing method %s called for transport",method);return false}}}));if(this.options.proxy&&typeof this.options.proxy==="string"){this.setupProxy(this.options.proxy)}}use(step,plugin){step=(step||"").toString();if(!this._userPlugins.hasOwnProperty(step)){this._userPlugins[step]=[plugin]}else{this._userPlugins[step].push(plugin)}return this}sendMail(data,callback=null){let promise;if(!callback){promise=new Promise(((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)}))}if(typeof this.getSocket==="function"){this.transporter.getSocket=this.getSocket;this.getSocket=false}let mail=new MailMessage(this,data);this.logger.debug({tnx:"transport",name:this.transporter.name,version:this.transporter.version,action:"send"},"Sending mail using %s/%s",this.transporter.name,this.transporter.version);this._processPlugins("compile",mail,(err=>{if(err){this.logger.error({err:err,tnx:"plugin",action:"compile"},"PluginCompile Error: %s",err.message);return callback(err)}mail.message=new MailComposer(mail.data).compile();mail.setMailerHeader();mail.setPriorityHeaders();mail.setListHeaders();this._processPlugins("stream",mail,(err=>{if(err){this.logger.error({err:err,tnx:"plugin",action:"stream"},"PluginStream Error: %s",err.message);return callback(err)}if(mail.data.dkim||this.dkim){mail.message.processFunc((input=>{let dkim=mail.data.dkim?new DKIM(mail.data.dkim):this.dkim;this.logger.debug({tnx:"DKIM",messageId:mail.message.messageId(),dkimDomains:dkim.keys.map((key=>key.keySelector+"."+key.domainName)).join(", ")},"Signing outgoing message with %s keys",dkim.keys.length);return dkim.sign(input,mail.data._dkim)}))}this.transporter.send(mail,((...args)=>{if(args[0]){this.logger.error({err:args[0],tnx:"transport",action:"send"},"Send Error: %s",args[0].message)}callback(...args)}))}))}));return promise}getVersionString(){return util.format("%s (%s; +%s; %s/%s)",packageData.name,packageData.version,packageData.homepage,this.transporter.name,this.transporter.version)}_processPlugins(step,mail,callback){step=(step||"").toString();if(!this._userPlugins.hasOwnProperty(step)){return callback()}let userPlugins=this._userPlugins[step]||[];let defaultPlugins=this._defaultPlugins[step]||[];if(userPlugins.length){this.logger.debug({tnx:"transaction",pluginCount:userPlugins.length,step:step},"Using %s plugins for %s",userPlugins.length,step)}if(userPlugins.length+defaultPlugins.length===0){return callback()}let pos=0;let block="default";let processPlugins=()=>{let curplugins=block==="default"?defaultPlugins:userPlugins;if(pos>=curplugins.length){if(block==="default"&&userPlugins.length){block="user";pos=0;curplugins=userPlugins}else{return callback()}}let plugin=curplugins[pos++];plugin(mail,(err=>{if(err){return callback(err)}processPlugins()}))};processPlugins()}setupProxy(proxyUrl){let proxy=urllib.parse(proxyUrl);this.getSocket=(options,callback)=>{let protocol=proxy.protocol.replace(/:$/,"").toLowerCase();if(this.meta.has("proxy_handler_"+protocol)){return this.meta.get("proxy_handler_"+protocol)(proxy,options,callback)}switch(protocol){case"http":case"https":httpProxyClient(proxy.href,options.port,options.host,((err,socket)=>{if(err){return callback(err)}return callback(null,{connection:socket})}));return;case"socks":case"socks5":case"socks4":case"socks4a":{if(!this.meta.has("proxy_socks_module")){return callback(new Error("Socks module not loaded"))}let connect=ipaddress=>{let proxyV2=!!this.meta.get("proxy_socks_module").SocksClient;let socksClient=proxyV2?this.meta.get("proxy_socks_module").SocksClient:this.meta.get("proxy_socks_module");let proxyType=Number(proxy.protocol.replace(/\D/g,""))||5;let connectionOpts={proxy:{ipaddress:ipaddress,port:Number(proxy.port),type:proxyType},[proxyV2?"destination":"target"]:{host:options.host,port:options.port},command:"connect"};if(proxy.auth){let username=decodeURIComponent(proxy.auth.split(":").shift());let password=decodeURIComponent(proxy.auth.split(":").pop());if(proxyV2){connectionOpts.proxy.userId=username;connectionOpts.proxy.password=password}else if(proxyType===4){connectionOpts.userid=username}else{connectionOpts.authentication={username:username,password:password}}}socksClient.createConnection(connectionOpts,((err,info)=>{if(err){return callback(err)}return callback(null,{connection:info.socket||info})}))};if(net.isIP(proxy.hostname)){return connect(proxy.hostname)}return dns.resolve(proxy.hostname,((err,address)=>{if(err){return callback(err)}connect(Array.isArray(address)?address[0]:address)}))}}callback(new Error("Unknown proxy configuration"))}}_convertDataImages(mail,callback){if(!this.options.attachDataUrls&&!mail.data.attachDataUrls||!mail.data.html){return callback()}mail.resolveContent(mail.data,"html",((err,html)=>{if(err){return callback(err)}let cidCounter=0;html=(html||"").toString().replace(/(<img\b[^>]* src\s*=[\s"']*)(data:([^;]+);[^"'>\s]+)/gi,((match,prefix,dataUri,mimeType)=>{let cid=crypto.randomBytes(10).toString("hex")+"@localhost";if(!mail.data.attachments){mail.data.attachments=[]}if(!Array.isArray(mail.data.attachments)){mail.data.attachments=[].concat(mail.data.attachments||[])}mail.data.attachments.push({path:dataUri,cid:cid,filename:"image-"+ ++cidCounter+"."+mimeTypes.detectExtension(mimeType)});return prefix+"cid:"+cid}));mail.data.html=html;callback()}))}set(key,value){return this.meta.set(key,value)}get(key){return this.meta.get(key)}}module.exports=Mail},{"../../package.json":326,"../dkim":295,"../mail-composer":302,"../mime-funcs/mime-types":306,"../shared":315,"../smtp-connection/http-proxy-client":317,"./mail-message":304,crypto:118,dns:88,events:187,net:88,url:439,util:443}],304:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const shared=require("../shared");const MimeNode=require("../mime-node");const mimeFuncs=require("../mime-funcs");class MailMessage{constructor(mailer,data){this.mailer=mailer;this.data={};this.message=null;data=data||{};let options=mailer.options||{};let defaults=mailer._defaults||{};Object.keys(data).forEach((key=>{this.data[key]=data[key]}));this.data.headers=this.data.headers||{};Object.keys(defaults).forEach((key=>{if(!(key in this.data)){this.data[key]=defaults[key]}else if(key==="headers"){Object.keys(defaults.headers).forEach((key=>{if(!(key in this.data.headers)){this.data.headers[key]=defaults.headers[key]}}))}}));["disableFileAccess","disableUrlAccess","normalizeHeaderKey"].forEach((key=>{if(key in options){this.data[key]=options[key]}}))}resolveContent(...args){return shared.resolveContent(...args)}resolveAll(callback){let keys=[[this.data,"html"],[this.data,"text"],[this.data,"watchHtml"],[this.data,"amp"],[this.data,"icalEvent"]];if(this.data.alternatives&&this.data.alternatives.length){this.data.alternatives.forEach(((alternative,i)=>{keys.push([this.data.alternatives,i])}))}if(this.data.attachments&&this.data.attachments.length){this.data.attachments.forEach(((attachment,i)=>{if(!attachment.filename){attachment.filename=(attachment.path||attachment.href||"").split("/").pop().split("?").shift()||"attachment-"+(i+1);if(attachment.filename.indexOf(".")<0){attachment.filename+="."+mimeFuncs.detectExtension(attachment.contentType)}}if(!attachment.contentType){attachment.contentType=mimeFuncs.detectMimeType(attachment.filename||attachment.path||attachment.href||"bin")}keys.push([this.data.attachments,i])}))}let mimeNode=new MimeNode;let addressKeys=["from","to","cc","bcc","sender","replyTo"];addressKeys.forEach((address=>{let value;if(this.message){value=[].concat(mimeNode._parseAddresses(this.message.getHeader(address==="replyTo"?"reply-to":address))||[])}else if(this.data[address]){value=[].concat(mimeNode._parseAddresses(this.data[address])||[])}if(value&&value.length){this.data[address]=value}else if(address in this.data){this.data[address]=null}}));let singleKeys=["from","sender"];singleKeys.forEach((address=>{if(this.data[address]){this.data[address]=this.data[address].shift()}}));let pos=0;let resolveNext=()=>{if(pos>=keys.length){return callback(null,this.data)}let args=keys[pos++];if(!args[0]||!args[0][args[1]]){return resolveNext()}shared.resolveContent(...args,((err,value)=>{if(err){return callback(err)}let node={content:value};if(args[0][args[1]]&&typeof args[0][args[1]]==="object"&&!Buffer.isBuffer(args[0][args[1]])){Object.keys(args[0][args[1]]).forEach((key=>{if(!(key in node)&&!["content","path","href","raw"].includes(key)){node[key]=args[0][args[1]][key]}}))}args[0][args[1]]=node;resolveNext()}))};setImmediate((()=>resolveNext()))}normalize(callback){let envelope=this.data.envelope||this.message.getEnvelope();let messageId=this.message.messageId();this.resolveAll(((err,data)=>{if(err){return callback(err)}data.envelope=envelope;data.messageId=messageId;["html","text","watchHtml","amp"].forEach((key=>{if(data[key]&&data[key].content){if(typeof data[key].content==="string"){data[key]=data[key].content}else if(Buffer.isBuffer(data[key].content)){data[key]=data[key].content.toString()}}}));if(data.icalEvent&&Buffer.isBuffer(data.icalEvent.content)){data.icalEvent.content=data.icalEvent.content.toString("base64");data.icalEvent.encoding="base64"}if(data.alternatives&&data.alternatives.length){data.alternatives.forEach((alternative=>{if(alternative&&alternative.content&&Buffer.isBuffer(alternative.content)){alternative.content=alternative.content.toString("base64");alternative.encoding="base64"}}))}if(data.attachments&&data.attachments.length){data.attachments.forEach((attachment=>{if(attachment&&attachment.content&&Buffer.isBuffer(attachment.content)){attachment.content=attachment.content.toString("base64");attachment.encoding="base64"}}))}data.normalizedHeaders={};Object.keys(data.headers||{}).forEach((key=>{let value=[].concat(data.headers[key]||[]).shift();value=value&&value.value||value;if(value){if(["references","in-reply-to","message-id","content-id"].includes(key)){value=this.message._encodeHeaderValue(key,value)}data.normalizedHeaders[key]=value}}));if(data.list&&typeof data.list==="object"){let listHeaders=this._getListHeaders(data.list);listHeaders.forEach((entry=>{data.normalizedHeaders[entry.key]=entry.value.map((val=>val&&val.value||val)).join(", ")}))}if(data.references){data.normalizedHeaders.references=this.message._encodeHeaderValue("references",data.references)}if(data.inReplyTo){data.normalizedHeaders["in-reply-to"]=this.message._encodeHeaderValue("in-reply-to",data.inReplyTo)}return callback(null,data)}))}setMailerHeader(){if(!this.message||!this.data.xMailer){return}this.message.setHeader("X-Mailer",this.data.xMailer)}setPriorityHeaders(){if(!this.message||!this.data.priority){return}switch((this.data.priority||"").toString().toLowerCase()){case"high":this.message.setHeader("X-Priority","1 (Highest)");this.message.setHeader("X-MSMail-Priority","High");this.message.setHeader("Importance","High");break;case"low":this.message.setHeader("X-Priority","5 (Lowest)");this.message.setHeader("X-MSMail-Priority","Low");this.message.setHeader("Importance","Low");break;default:}}setListHeaders(){if(!this.message||!this.data.list||typeof this.data.list!=="object"){return}if(this.data.list&&typeof this.data.list==="object"){this._getListHeaders(this.data.list).forEach((listHeader=>{listHeader.value.forEach((value=>{this.message.addHeader(listHeader.key,value)}))}))}}_getListHeaders(listData){return Object.keys(listData).map((key=>({key:"list-"+key.toLowerCase().trim(),value:[].concat(listData[key]||[]).map((value=>({prepared:true,foldLines:true,value:[].concat(value||[]).map((value=>{if(typeof value==="string"){value={url:value}}if(value&&value.url){if(key.toLowerCase().trim()==="id"){let comment=value.comment||"";if(mimeFuncs.isPlainText(comment)){comment='"'+comment+'"'}else{comment=mimeFuncs.encodeWord(comment)}return(value.comment?comment+" ":"")+this._formatListUrl(value.url).replace(/^<[^:]+\/{,2}/,"")}let comment=value.comment||"";if(!mimeFuncs.isPlainText(comment)){comment=mimeFuncs.encodeWord(comment)}return this._formatListUrl(value.url)+(value.comment?" ("+comment+")":"")}return""})).filter((value=>value)).join(", ")})))})))}_formatListUrl(url){url=url.replace(/[\s<]+|[\s>]+/g,"");if(/^(https?|mailto|ftp):/.test(url)){return"<"+url+">"}if(/^[^@]+@[^@]+$/.test(url)){return"<mailto:"+url+">"}return"<http://"+url+">"}}module.exports=MailMessage}).call(this)}).call(this,{isBuffer:require("../../../is-buffer/index.js")},require("timers").setImmediate)},{"../../../is-buffer/index.js":235,"../mime-funcs":305,"../mime-node":307,"../shared":315,timers:433}],305:[function(require,module,exports){(function(Buffer){(function(){"use strict";const base64=require("../base64");const qp=require("../qp");const mimeTypes=require("./mime-types");module.exports={isPlainText(value,isParam){const re=isParam?/[\x00-\x08\x0b\x0c\x0e-\x1f"\u0080-\uFFFF]/:/[\x00-\x08\x0b\x0c\x0e-\x1f\u0080-\uFFFF]/;if(typeof value!=="string"||re.test(value)){return false}else{return true}},hasLongerLines(str,lineLength){if(str.length>128*1024){return true}return new RegExp("^.{"+(lineLength+1)+",}","m").test(str)},encodeWord(data,mimeWordEncoding,maxLength){mimeWordEncoding=(mimeWordEncoding||"Q").toString().toUpperCase().trim().charAt(0);maxLength=maxLength||0;let encodedStr;let toCharset="UTF-8";if(maxLength&&maxLength>7+toCharset.length){maxLength-=7+toCharset.length}if(mimeWordEncoding==="Q"){encodedStr=qp.encode(data).replace(/[^a-z0-9!*+\-/=]/gi,(chr=>{let ord=chr.charCodeAt(0).toString(16).toUpperCase();if(chr===" "){return"_"}else{return"="+(ord.length===1?"0"+ord:ord)}}))}else if(mimeWordEncoding==="B"){encodedStr=typeof data==="string"?data:base64.encode(data);maxLength=maxLength?Math.max(3,(maxLength-maxLength%4)/4*3):0}if(maxLength&&(mimeWordEncoding!=="B"?encodedStr:base64.encode(data)).length>maxLength){if(mimeWordEncoding==="Q"){encodedStr=this.splitMimeEncodedString(encodedStr,maxLength).join("?= =?"+toCharset+"?"+mimeWordEncoding+"?")}else{let parts=[];let lpart="";for(let i=0,len=encodedStr.length;i<len;i++){let chr=encodedStr.charAt(i);if(/[\ud83c\ud83d\ud83e]/.test(chr)&&i<len-1){chr+=encodedStr.charAt(++i)}if(Buffer.byteLength(lpart+chr)<=maxLength||i===0){lpart+=chr}else{parts.push(base64.encode(lpart));lpart=chr}}if(lpart){parts.push(base64.encode(lpart))}if(parts.length>1){encodedStr=parts.join("?= =?"+toCharset+"?"+mimeWordEncoding+"?")}else{encodedStr=parts.join("")}}}else if(mimeWordEncoding==="B"){encodedStr=base64.encode(data)}return"=?"+toCharset+"?"+mimeWordEncoding+"?"+encodedStr+(encodedStr.substr(-2)==="?="?"":"?=")},encodeWords(value,mimeWordEncoding,maxLength,encodeAll){maxLength=maxLength||0;let encodedValue;let firstMatch=value.match(/(?:^|\s)([^\s]*["\u0080-\uFFFF])/);if(!firstMatch){return value}if(encodeAll){return this.encodeWord(value,mimeWordEncoding,maxLength)}let lastMatch=value.match(/(["\u0080-\uFFFF][^\s]*)[^"\u0080-\uFFFF]*$/);if(!lastMatch){return value}let startIndex=firstMatch.index+(firstMatch[0].match(/[^\s]/)||{index:0}).index;let endIndex=lastMatch.index+(lastMatch[1]||"").length;encodedValue=(startIndex?value.substr(0,startIndex):"")+this.encodeWord(value.substring(startIndex,endIndex),mimeWordEncoding||"Q",maxLength)+(endIndex<value.length?value.substr(endIndex):"");return encodedValue},buildHeaderValue(structured){let paramsArray=[];Object.keys(structured.params||{}).forEach((param=>{let value=structured.params[param];if(!this.isPlainText(value,true)||value.length>=75){this.buildHeaderParam(param,value,50).forEach((encodedParam=>{if(!/[\s"\\;:/=(),<>@[\]?]|^[-']|'$/.test(encodedParam.value)||encodedParam.key.substr(-1)==="*"){paramsArray.push(encodedParam.key+"="+encodedParam.value)}else{paramsArray.push(encodedParam.key+"="+JSON.stringify(encodedParam.value))}}))}else if(/[\s'"\\;:/=(),<>@[\]?]|^-/.test(value)){paramsArray.push(param+"="+JSON.stringify(value))}else{paramsArray.push(param+"="+value)}}));return structured.value+(paramsArray.length?"; "+paramsArray.join("; "):"")},buildHeaderParam(key,data,maxLength){let list=[];let encodedStr=typeof data==="string"?data:(data||"").toString();let encodedStrArr;let chr,ord;let line;let startPos=0;let i,len;maxLength=maxLength||50;if(this.isPlainText(data,true)){if(encodedStr.length<=maxLength){return[{key:key,value:encodedStr}]}encodedStr=encodedStr.replace(new RegExp(".{"+maxLength+"}","g"),(str=>{list.push({line:str});return""}));if(encodedStr){list.push({line:encodedStr})}}else{if(/[\uD800-\uDBFF]/.test(encodedStr)){encodedStrArr=[];for(i=0,len=encodedStr.length;i<len;i++){chr=encodedStr.charAt(i);ord=chr.charCodeAt(0);if(ord>=55296&&ord<=56319&&i<len-1){chr+=encodedStr.charAt(i+1);encodedStrArr.push(chr);i++}else{encodedStrArr.push(chr)}}encodedStr=encodedStrArr}line="utf-8''";let encoded=true;startPos=0;for(i=0,len=encodedStr.length;i<len;i++){chr=encodedStr[i];if(encoded){chr=this.safeEncodeURIComponent(chr)}else{chr=chr===" "?chr:this.safeEncodeURIComponent(chr);if(chr!==encodedStr[i]){if((this.safeEncodeURIComponent(line)+chr).length>=maxLength){list.push({line:line,encoded:encoded});line="";startPos=i-1}else{encoded=true;i=startPos;line="";continue}}}if((line+chr).length>=maxLength){list.push({line:line,encoded:encoded});line=chr=encodedStr[i]===" "?" ":this.safeEncodeURIComponent(encodedStr[i]);if(chr===encodedStr[i]){encoded=false;startPos=i-1}else{encoded=true}}else{line+=chr}}if(line){list.push({line:line,encoded:encoded})}}return list.map(((item,i)=>({key:key+"*"+i+(item.encoded?"*":""),value:item.line})))},parseHeaderValue(str){let response={value:false,params:{}};let key=false;let value="";let type="value";let quote=false;let escaped=false;let chr;for(let i=0,len=str.length;i<len;i++){chr=str.charAt(i);if(type==="key"){if(chr==="="){key=value.trim().toLowerCase();type="value";value="";continue}value+=chr}else{if(escaped){value+=chr}else if(chr==="\\"){escaped=true;continue}else if(quote&&chr===quote){quote=false}else if(!quote&&chr==='"'){quote=chr}else if(!quote&&chr===";"){if(key===false){response.value=value.trim()}else{response.params[key]=value.trim()}type="key";value=""}else{value+=chr}escaped=false}}if(type==="value"){if(key===false){response.value=value.trim()}else{response.params[key]=value.trim()}}else if(value.trim()){response.params[value.trim().toLowerCase()]=""}Object.keys(response.params).forEach((key=>{let actualKey,nr,match,value;if(match=key.match(/(\*(\d+)|\*(\d+)\*|\*)$/)){actualKey=key.substr(0,match.index);nr=Number(match[2]||match[3])||0;if(!response.params[actualKey]||typeof response.params[actualKey]!=="object"){response.params[actualKey]={charset:false,values:[]}}value=response.params[key];if(nr===0&&match[0].substr(-1)==="*"&&(match=value.match(/^([^']*)'[^']*'(.*)$/))){response.params[actualKey].charset=match[1]||"iso-8859-1";value=match[2]}response.params[actualKey].values[nr]=value;delete response.params[key]}}));Object.keys(response.params).forEach((key=>{let value;if(response.params[key]&&Array.isArray(response.params[key].values)){value=response.params[key].values.map((val=>val||"")).join("");if(response.params[key].charset){response.params[key]="=?"+response.params[key].charset+"?Q?"+value.replace(/[=?_\s]/g,(s=>{let c=s.charCodeAt(0).toString(16);if(s===" "){return"_"}else{return"%"+(c.length<2?"0":"")+c}})).replace(/%/g,"=")+"?="}else{response.params[key]=value}}}));return response},detectExtension:mimeType=>mimeTypes.detectExtension(mimeType),detectMimeType:extension=>mimeTypes.detectMimeType(extension),foldLines(str,lineLength,afterSpace){str=(str||"").toString();lineLength=lineLength||76;let pos=0,len=str.length,result="",line,match;while(pos<len){line=str.substr(pos,lineLength);if(line.length<lineLength){result+=line;break}if(match=line.match(/^[^\n\r]*(\r?\n|\r)/)){line=match[0];result+=line;pos+=line.length;continue}else if((match=line.match(/(\s+)[^\s]*$/))&&match[0].length-(afterSpace?(match[1]||"").length:0)<line.length){line=line.substr(0,line.length-(match[0].length-(afterSpace?(match[1]||"").length:0)))}else if(match=str.substr(pos+line.length).match(/^[^\s]+(\s*)/)){line=line+match[0].substr(0,match[0].length-(!afterSpace?(match[1]||"").length:0))}result+=line;pos+=line.length;if(pos<len){result+="\r\n"}}return result},splitMimeEncodedString:(str,maxlen)=>{let curLine,match,chr,done,lines=[];maxlen=Math.max(maxlen||0,12);while(str.length){curLine=str.substr(0,maxlen);if(match=curLine.match(/[=][0-9A-F]?$/i)){curLine=curLine.substr(0,match.index)}done=false;while(!done){done=true;if(match=str.substr(curLine.length).match(/^[=]([0-9A-F]{2})/i)){chr=parseInt(match[1],16);if(chr<194&&chr>127){curLine=curLine.substr(0,curLine.length-3);done=false}}}if(curLine.length){lines.push(curLine)}str=str.substr(curLine.length)}return lines},encodeURICharComponent:chr=>{let res="";let ord=chr.charCodeAt(0).toString(16).toUpperCase();if(ord.length%2){ord="0"+ord}if(ord.length>2){for(let i=0,len=ord.length/2;i<len;i++){res+="%"+ord.substr(i,2)}}else{res+="%"+ord}return res},safeEncodeURIComponent(str){str=(str||"").toString();try{str=encodeURIComponent(str)}catch(E){return str.replace(/[^\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]+/g,"")}return str.replace(/[\x00-\x1F *'()<>@,;:\\"[\]?=\u007F-\uFFFF]/g,(chr=>this.encodeURICharComponent(chr)))}}}).call(this)}).call(this,require("buffer").Buffer)},{"../base64":294,"../qp":312,"./mime-types":306,buffer:88}],306:[function(require,module,exports){"use strict";const path=require("path");const defaultMimeType="application/octet-stream";const defaultExtension="bin";const mimeTypes=new Map([["application/acad","dwg"],["application/applixware","aw"],["application/arj","arj"],["application/atom+xml","xml"],["application/atomcat+xml","atomcat"],["application/atomsvc+xml","atomsvc"],["application/base64",["mm","mme"]],["application/binhex","hqx"],["application/binhex4","hqx"],["application/book",["book","boo"]],["application/ccxml+xml,","ccxml"],["application/cdf","cdf"],["application/cdmi-capability","cdmia"],["application/cdmi-container","cdmic"],["application/cdmi-domain","cdmid"],["application/cdmi-object","cdmio"],["application/cdmi-queue","cdmiq"],["application/clariscad","ccad"],["application/commonground","dp"],["application/cu-seeme","cu"],["application/davmount+xml","davmount"],["application/drafting","drw"],["application/dsptype","tsp"],["application/dssc+der","dssc"],["application/dssc+xml","xdssc"],["application/dxf","dxf"],["application/ecmascript",["js","es"]],["application/emma+xml","emma"],["application/envoy","evy"],["application/epub+zip","epub"],["application/excel",["xls","xl","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/exi","exi"],["application/font-tdpfr","pfr"],["application/fractals","fif"],["application/freeloader","frl"],["application/futuresplash","spl"],["application/gnutar","tgz"],["application/groupwise","vew"],["application/hlp","hlp"],["application/hta","hta"],["application/hyperstudio","stk"],["application/i-deas","unv"],["application/iges",["iges","igs"]],["application/inf","inf"],["application/internet-property-stream","acx"],["application/ipfix","ipfix"],["application/java","class"],["application/java-archive","jar"],["application/java-byte-code","class"],["application/java-serialized-object","ser"],["application/java-vm","class"],["application/javascript","js"],["application/json","json"],["application/lha","lha"],["application/lzx","lzx"],["application/mac-binary","bin"],["application/mac-binhex","hqx"],["application/mac-binhex40","hqx"],["application/mac-compactpro","cpt"],["application/macbinary","bin"],["application/mads+xml","mads"],["application/marc","mrc"],["application/marcxml+xml","mrcx"],["application/mathematica","ma"],["application/mathml+xml","mathml"],["application/mbedlet","mbd"],["application/mbox","mbox"],["application/mcad","mcd"],["application/mediaservercontrol+xml","mscml"],["application/metalink4+xml","meta4"],["application/mets+xml","mets"],["application/mime","aps"],["application/mods+xml","mods"],["application/mp21","m21"],["application/mp4","mp4"],["application/mspowerpoint",["ppt","pot","pps","ppz"]],["application/msword",["doc","dot","w6w","wiz","word"]],["application/mswrite","wri"],["application/mxf","mxf"],["application/netmc","mcp"],["application/octet-stream",["*"]],["application/oda","oda"],["application/oebps-package+xml","opf"],["application/ogg","ogx"],["application/olescript","axs"],["application/onenote","onetoc"],["application/patch-ops-error+xml","xer"],["application/pdf","pdf"],["application/pgp-encrypted","asc"],["application/pgp-signature","pgp"],["application/pics-rules","prf"],["application/pkcs-12","p12"],["application/pkcs-crl","crl"],["application/pkcs10","p10"],["application/pkcs7-mime",["p7c","p7m"]],["application/pkcs7-signature","p7s"],["application/pkcs8","p8"],["application/pkix-attr-cert","ac"],["application/pkix-cert",["cer","crt"]],["application/pkix-crl","crl"],["application/pkix-pkipath","pkipath"],["application/pkixcmp","pki"],["application/plain","text"],["application/pls+xml","pls"],["application/postscript",["ps","ai","eps"]],["application/powerpoint","ppt"],["application/pro_eng",["part","prt"]],["application/prs.cww","cww"],["application/pskc+xml","pskcxml"],["application/rdf+xml","rdf"],["application/reginfo+xml","rif"],["application/relax-ng-compact-syntax","rnc"],["application/resource-lists+xml","rl"],["application/resource-lists-diff+xml","rld"],["application/ringing-tones","rng"],["application/rls-services+xml","rs"],["application/rsd+xml","rsd"],["application/rss+xml","xml"],["application/rtf",["rtf","rtx"]],["application/sbml+xml","sbml"],["application/scvp-cv-request","scq"],["application/scvp-cv-response","scs"],["application/scvp-vp-request","spq"],["application/scvp-vp-response","spp"],["application/sdp","sdp"],["application/sea","sea"],["application/set","set"],["application/set-payment-initiation","setpay"],["application/set-registration-initiation","setreg"],["application/shf+xml","shf"],["application/sla","stl"],["application/smil",["smi","smil"]],["application/smil+xml","smi"],["application/solids","sol"],["application/sounder","sdr"],["application/sparql-query","rq"],["application/sparql-results+xml","srx"],["application/srgs","gram"],["application/srgs+xml","grxml"],["application/sru+xml","sru"],["application/ssml+xml","ssml"],["application/step",["step","stp"]],["application/streamingmedia","ssm"],["application/tei+xml","tei"],["application/thraud+xml","tfi"],["application/timestamped-data","tsd"],["application/toolbook","tbk"],["application/vda","vda"],["application/vnd.3gpp.pic-bw-large","plb"],["application/vnd.3gpp.pic-bw-small","psb"],["application/vnd.3gpp.pic-bw-var","pvb"],["application/vnd.3gpp2.tcap","tcap"],["application/vnd.3m.post-it-notes","pwn"],["application/vnd.accpac.simply.aso","aso"],["application/vnd.accpac.simply.imp","imp"],["application/vnd.acucobol","acu"],["application/vnd.acucorp","atc"],["application/vnd.adobe.air-application-installer-package+zip","air"],["application/vnd.adobe.fxp","fxp"],["application/vnd.adobe.xdp+xml","xdp"],["application/vnd.adobe.xfdf","xfdf"],["application/vnd.ahead.space","ahead"],["application/vnd.airzip.filesecure.azf","azf"],["application/vnd.airzip.filesecure.azs","azs"],["application/vnd.amazon.ebook","azw"],["application/vnd.americandynamics.acc","acc"],["application/vnd.amiga.ami","ami"],["application/vnd.android.package-archive","apk"],["application/vnd.anser-web-certificate-issue-initiation","cii"],["application/vnd.anser-web-funds-transfer-initiation","fti"],["application/vnd.antix.game-component","atx"],["application/vnd.apple.installer+xml","mpkg"],["application/vnd.apple.mpegurl","m3u8"],["application/vnd.aristanetworks.swi","swi"],["application/vnd.audiograph","aep"],["application/vnd.blueice.multipass","mpm"],["application/vnd.bmi","bmi"],["application/vnd.businessobjects","rep"],["application/vnd.chemdraw+xml","cdxml"],["application/vnd.chipnuts.karaoke-mmd","mmd"],["application/vnd.cinderella","cdy"],["application/vnd.claymore","cla"],["application/vnd.cloanto.rp9","rp9"],["application/vnd.clonk.c4group","c4g"],["application/vnd.cluetrust.cartomobile-config","c11amc"],["application/vnd.cluetrust.cartomobile-config-pkg","c11amz"],["application/vnd.commonspace","csp"],["application/vnd.contact.cmsg","cdbcmsg"],["application/vnd.cosmocaller","cmc"],["application/vnd.crick.clicker","clkx"],["application/vnd.crick.clicker.keyboard","clkk"],["application/vnd.crick.clicker.palette","clkp"],["application/vnd.crick.clicker.template","clkt"],["application/vnd.crick.clicker.wordbank","clkw"],["application/vnd.criticaltools.wbs+xml","wbs"],["application/vnd.ctc-posml","pml"],["application/vnd.cups-ppd","ppd"],["application/vnd.curl.car","car"],["application/vnd.curl.pcurl","pcurl"],["application/vnd.data-vision.rdz","rdz"],["application/vnd.denovo.fcselayout-link","fe_launch"],["application/vnd.dna","dna"],["application/vnd.dolby.mlp","mlp"],["application/vnd.dpgraph","dpg"],["application/vnd.dreamfactory","dfac"],["application/vnd.dvb.ait","ait"],["application/vnd.dvb.service","svc"],["application/vnd.dynageo","geo"],["application/vnd.ecowin.chart","mag"],["application/vnd.enliven","nml"],["application/vnd.epson.esf","esf"],["application/vnd.epson.msf","msf"],["application/vnd.epson.quickanime","qam"],["application/vnd.epson.salt","slt"],["application/vnd.epson.ssf","ssf"],["application/vnd.eszigno3+xml","es3"],["application/vnd.ezpix-album","ez2"],["application/vnd.ezpix-package","ez3"],["application/vnd.fdf","fdf"],["application/vnd.fdsn.seed","seed"],["application/vnd.flographit","gph"],["application/vnd.fluxtime.clip","ftc"],["application/vnd.framemaker","fm"],["application/vnd.frogans.fnc","fnc"],["application/vnd.frogans.ltf","ltf"],["application/vnd.fsc.weblaunch","fsc"],["application/vnd.fujitsu.oasys","oas"],["application/vnd.fujitsu.oasys2","oa2"],["application/vnd.fujitsu.oasys3","oa3"],["application/vnd.fujitsu.oasysgp","fg5"],["application/vnd.fujitsu.oasysprs","bh2"],["application/vnd.fujixerox.ddd","ddd"],["application/vnd.fujixerox.docuworks","xdw"],["application/vnd.fujixerox.docuworks.binder","xbd"],["application/vnd.fuzzysheet","fzs"],["application/vnd.genomatix.tuxedo","txd"],["application/vnd.geogebra.file","ggb"],["application/vnd.geogebra.tool","ggt"],["application/vnd.geometry-explorer","gex"],["application/vnd.geonext","gxt"],["application/vnd.geoplan","g2w"],["application/vnd.geospace","g3w"],["application/vnd.gmx","gmx"],["application/vnd.google-earth.kml+xml","kml"],["application/vnd.google-earth.kmz","kmz"],["application/vnd.grafeq","gqf"],["application/vnd.groove-account","gac"],["application/vnd.groove-help","ghf"],["application/vnd.groove-identity-message","gim"],["application/vnd.groove-injector","grv"],["application/vnd.groove-tool-message","gtm"],["application/vnd.groove-tool-template","tpl"],["application/vnd.groove-vcard","vcg"],["application/vnd.hal+xml","hal"],["application/vnd.handheld-entertainment+xml","zmm"],["application/vnd.hbci","hbci"],["application/vnd.hhe.lesson-player","les"],["application/vnd.hp-hpgl",["hgl","hpg","hpgl"]],["application/vnd.hp-hpid","hpid"],["application/vnd.hp-hps","hps"],["application/vnd.hp-jlyt","jlt"],["application/vnd.hp-pcl","pcl"],["application/vnd.hp-pclxl","pclxl"],["application/vnd.hydrostatix.sof-data","sfd-hdstx"],["application/vnd.hzn-3d-crossword","x3d"],["application/vnd.ibm.minipay","mpy"],["application/vnd.ibm.modcap","afp"],["application/vnd.ibm.rights-management","irm"],["application/vnd.ibm.secure-container","sc"],["application/vnd.iccprofile","icc"],["application/vnd.igloader","igl"],["application/vnd.immervision-ivp","ivp"],["application/vnd.immervision-ivu","ivu"],["application/vnd.insors.igm","igm"],["application/vnd.intercon.formnet","xpw"],["application/vnd.intergeo","i2g"],["application/vnd.intu.qbo","qbo"],["application/vnd.intu.qfx","qfx"],["application/vnd.ipunplugged.rcprofile","rcprofile"],["application/vnd.irepository.package+xml","irp"],["application/vnd.is-xpr","xpr"],["application/vnd.isac.fcs","fcs"],["application/vnd.jam","jam"],["application/vnd.jcp.javame.midlet-rms","rms"],["application/vnd.jisp","jisp"],["application/vnd.joost.joda-archive","joda"],["application/vnd.kahootz","ktz"],["application/vnd.kde.karbon","karbon"],["application/vnd.kde.kchart","chrt"],["application/vnd.kde.kformula","kfo"],["application/vnd.kde.kivio","flw"],["application/vnd.kde.kontour","kon"],["application/vnd.kde.kpresenter","kpr"],["application/vnd.kde.kspread","ksp"],["application/vnd.kde.kword","kwd"],["application/vnd.kenameaapp","htke"],["application/vnd.kidspiration","kia"],["application/vnd.kinar","kne"],["application/vnd.koan","skp"],["application/vnd.kodak-descriptor","sse"],["application/vnd.las.las+xml","lasxml"],["application/vnd.llamagraphics.life-balance.desktop","lbd"],["application/vnd.llamagraphics.life-balance.exchange+xml","lbe"],["application/vnd.lotus-1-2-3","123"],["application/vnd.lotus-approach","apr"],["application/vnd.lotus-freelance","pre"],["application/vnd.lotus-notes","nsf"],["application/vnd.lotus-organizer","org"],["application/vnd.lotus-screencam","scm"],["application/vnd.lotus-wordpro","lwp"],["application/vnd.macports.portpkg","portpkg"],["application/vnd.mcd","mcd"],["application/vnd.medcalcdata","mc1"],["application/vnd.mediastation.cdkey","cdkey"],["application/vnd.mfer","mwf"],["application/vnd.mfmp","mfm"],["application/vnd.micrografx.flo","flo"],["application/vnd.micrografx.igx","igx"],["application/vnd.mif","mif"],["application/vnd.mobius.daf","daf"],["application/vnd.mobius.dis","dis"],["application/vnd.mobius.mbk","mbk"],["application/vnd.mobius.mqy","mqy"],["application/vnd.mobius.msl","msl"],["application/vnd.mobius.plc","plc"],["application/vnd.mobius.txf","txf"],["application/vnd.mophun.application","mpn"],["application/vnd.mophun.certificate","mpc"],["application/vnd.mozilla.xul+xml","xul"],["application/vnd.ms-artgalry","cil"],["application/vnd.ms-cab-compressed","cab"],["application/vnd.ms-excel",["xls","xla","xlc","xlm","xlt","xlw","xlb","xll"]],["application/vnd.ms-excel.addin.macroenabled.12","xlam"],["application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsb"],["application/vnd.ms-excel.sheet.macroenabled.12","xlsm"],["application/vnd.ms-excel.template.macroenabled.12","xltm"],["application/vnd.ms-fontobject","eot"],["application/vnd.ms-htmlhelp","chm"],["application/vnd.ms-ims","ims"],["application/vnd.ms-lrm","lrm"],["application/vnd.ms-officetheme","thmx"],["application/vnd.ms-outlook","msg"],["application/vnd.ms-pki.certstore","sst"],["application/vnd.ms-pki.pko","pko"],["application/vnd.ms-pki.seccat","cat"],["application/vnd.ms-pki.stl","stl"],["application/vnd.ms-pkicertstore","sst"],["application/vnd.ms-pkiseccat","cat"],["application/vnd.ms-pkistl","stl"],["application/vnd.ms-powerpoint",["ppt","pot","pps","ppa","pwz"]],["application/vnd.ms-powerpoint.addin.macroenabled.12","ppam"],["application/vnd.ms-powerpoint.presentation.macroenabled.12","pptm"],["application/vnd.ms-powerpoint.slide.macroenabled.12","sldm"],["application/vnd.ms-powerpoint.slideshow.macroenabled.12","ppsm"],["application/vnd.ms-powerpoint.template.macroenabled.12","potm"],["application/vnd.ms-project","mpp"],["application/vnd.ms-word.document.macroenabled.12","docm"],["application/vnd.ms-word.template.macroenabled.12","dotm"],["application/vnd.ms-works",["wks","wcm","wdb","wps"]],["application/vnd.ms-wpl","wpl"],["application/vnd.ms-xpsdocument","xps"],["application/vnd.mseq","mseq"],["application/vnd.musician","mus"],["application/vnd.muvee.style","msty"],["application/vnd.neurolanguage.nlu","nlu"],["application/vnd.noblenet-directory","nnd"],["application/vnd.noblenet-sealer","nns"],["application/vnd.noblenet-web","nnw"],["application/vnd.nokia.configuration-message","ncm"],["application/vnd.nokia.n-gage.data","ngdat"],["application/vnd.nokia.n-gage.symbian.install","n-gage"],["application/vnd.nokia.radio-preset","rpst"],["application/vnd.nokia.radio-presets","rpss"],["application/vnd.nokia.ringing-tone","rng"],["application/vnd.novadigm.edm","edm"],["application/vnd.novadigm.edx","edx"],["application/vnd.novadigm.ext","ext"],["application/vnd.oasis.opendocument.chart","odc"],["application/vnd.oasis.opendocument.chart-template","otc"],["application/vnd.oasis.opendocument.database","odb"],["application/vnd.oasis.opendocument.formula","odf"],["application/vnd.oasis.opendocument.formula-template","odft"],["application/vnd.oasis.opendocument.graphics","odg"],["application/vnd.oasis.opendocument.graphics-template","otg"],["application/vnd.oasis.opendocument.image","odi"],["application/vnd.oasis.opendocument.image-template","oti"],["application/vnd.oasis.opendocument.presentation","odp"],["application/vnd.oasis.opendocument.presentation-template","otp"],["application/vnd.oasis.opendocument.spreadsheet","ods"],["application/vnd.oasis.opendocument.spreadsheet-template","ots"],["application/vnd.oasis.opendocument.text","odt"],["application/vnd.oasis.opendocument.text-master","odm"],["application/vnd.oasis.opendocument.text-template","ott"],["application/vnd.oasis.opendocument.text-web","oth"],["application/vnd.olpc-sugar","xo"],["application/vnd.oma.dd2+xml","dd2"],["application/vnd.openofficeorg.extension","oxt"],["application/vnd.openxmlformats-officedocument.presentationml.presentation","pptx"],["application/vnd.openxmlformats-officedocument.presentationml.slide","sldx"],["application/vnd.openxmlformats-officedocument.presentationml.slideshow","ppsx"],["application/vnd.openxmlformats-officedocument.presentationml.template","potx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlsx"],["application/vnd.openxmlformats-officedocument.spreadsheetml.template","xltx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.document","docx"],["application/vnd.openxmlformats-officedocument.wordprocessingml.template","dotx"],["application/vnd.osgeo.mapguide.package","mgp"],["application/vnd.osgi.dp","dp"],["application/vnd.palm","pdb"],["application/vnd.pawaafile","paw"],["application/vnd.pg.format","str"],["application/vnd.pg.osasli","ei6"],["application/vnd.picsel","efif"],["application/vnd.pmi.widget","wg"],["application/vnd.pocketlearn","plf"],["application/vnd.powerbuilder6","pbd"],["application/vnd.previewsystems.box","box"],["application/vnd.proteus.magazine","mgz"],["application/vnd.publishare-delta-tree","qps"],["application/vnd.pvi.ptid1","ptid"],["application/vnd.quark.quarkxpress","qxd"],["application/vnd.realvnc.bed","bed"],["application/vnd.recordare.musicxml","mxl"],["application/vnd.recordare.musicxml+xml","musicxml"],["application/vnd.rig.cryptonote","cryptonote"],["application/vnd.rim.cod","cod"],["application/vnd.rn-realmedia","rm"],["application/vnd.rn-realplayer","rnx"],["application/vnd.route66.link66+xml","link66"],["application/vnd.sailingtracker.track","st"],["application/vnd.seemail","see"],["application/vnd.sema","sema"],["application/vnd.semd","semd"],["application/vnd.semf","semf"],["application/vnd.shana.informed.formdata","ifm"],["application/vnd.shana.informed.formtemplate","itp"],["application/vnd.shana.informed.interchange","iif"],["application/vnd.shana.informed.package","ipk"],["application/vnd.simtech-mindmapper","twd"],["application/vnd.smaf","mmf"],["application/vnd.smart.teacher","teacher"],["application/vnd.solent.sdkm+xml","sdkm"],["application/vnd.spotfire.dxp","dxp"],["application/vnd.spotfire.sfs","sfs"],["application/vnd.stardivision.calc","sdc"],["application/vnd.stardivision.draw","sda"],["application/vnd.stardivision.impress","sdd"],["application/vnd.stardivision.math","smf"],["application/vnd.stardivision.writer","sdw"],["application/vnd.stardivision.writer-global","sgl"],["application/vnd.stepmania.stepchart","sm"],["application/vnd.sun.xml.calc","sxc"],["application/vnd.sun.xml.calc.template","stc"],["application/vnd.sun.xml.draw","sxd"],["application/vnd.sun.xml.draw.template","std"],["application/vnd.sun.xml.impress","sxi"],["application/vnd.sun.xml.impress.template","sti"],["application/vnd.sun.xml.math","sxm"],["application/vnd.sun.xml.writer","sxw"],["application/vnd.sun.xml.writer.global","sxg"],["application/vnd.sun.xml.writer.template","stw"],["application/vnd.sus-calendar","sus"],["application/vnd.svd","svd"],["application/vnd.symbian.install","sis"],["application/vnd.syncml+xml","xsm"],["application/vnd.syncml.dm+wbxml","bdm"],["application/vnd.syncml.dm+xml","xdm"],["application/vnd.tao.intent-module-archive","tao"],["application/vnd.tmobile-livetv","tmo"],["application/vnd.trid.tpt","tpt"],["application/vnd.triscape.mxs","mxs"],["application/vnd.trueapp","tra"],["application/vnd.ufdl","ufd"],["application/vnd.uiq.theme","utz"],["application/vnd.umajin","umj"],["application/vnd.unity","unityweb"],["application/vnd.uoml+xml","uoml"],["application/vnd.vcx","vcx"],["application/vnd.visio","vsd"],["application/vnd.visionary","vis"],["application/vnd.vsf","vsf"],["application/vnd.wap.wbxml","wbxml"],["application/vnd.wap.wmlc","wmlc"],["application/vnd.wap.wmlscriptc","wmlsc"],["application/vnd.webturbo","wtb"],["application/vnd.wolfram.player","nbp"],["application/vnd.wordperfect","wpd"],["application/vnd.wqd","wqd"],["application/vnd.wt.stf","stf"],["application/vnd.xara",["web","xar"]],["application/vnd.xfdl","xfdl"],["application/vnd.yamaha.hv-dic","hvd"],["application/vnd.yamaha.hv-script","hvs"],["application/vnd.yamaha.hv-voice","hvp"],["application/vnd.yamaha.openscoreformat","osf"],["application/vnd.yamaha.openscoreformat.osfpvg+xml","osfpvg"],["application/vnd.yamaha.smaf-audio","saf"],["application/vnd.yamaha.smaf-phrase","spf"],["application/vnd.yellowriver-custom-menu","cmp"],["application/vnd.zul","zir"],["application/vnd.zzazz.deck+xml","zaz"],["application/vocaltec-media-desc","vmd"],["application/vocaltec-media-file","vmf"],["application/voicexml+xml","vxml"],["application/widget","wgt"],["application/winhlp","hlp"],["application/wordperfect",["wp","wp5","wp6","wpd"]],["application/wordperfect6.0",["w60","wp5"]],["application/wordperfect6.1","w61"],["application/wsdl+xml","wsdl"],["application/wspolicy+xml","wspolicy"],["application/x-123","wk1"],["application/x-7z-compressed","7z"],["application/x-abiword","abw"],["application/x-ace-compressed","ace"],["application/x-aim","aim"],["application/x-authorware-bin","aab"],["application/x-authorware-map","aam"],["application/x-authorware-seg","aas"],["application/x-bcpio","bcpio"],["application/x-binary","bin"],["application/x-binhex40","hqx"],["application/x-bittorrent","torrent"],["application/x-bsh",["bsh","sh","shar"]],["application/x-bytecode.elisp","elc"],["application/x-bytecode.python","pyc"],["application/x-bzip","bz"],["application/x-bzip2",["boz","bz2"]],["application/x-cdf","cdf"],["application/x-cdlink","vcd"],["application/x-chat",["cha","chat"]],["application/x-chess-pgn","pgn"],["application/x-cmu-raster","ras"],["application/x-cocoa","cco"],["application/x-compactpro","cpt"],["application/x-compress","z"],["application/x-compressed",["tgz","gz","z","zip"]],["application/x-conference","nsc"],["application/x-cpio","cpio"],["application/x-cpt","cpt"],["application/x-csh","csh"],["application/x-debian-package","deb"],["application/x-deepv","deepv"],["application/x-director",["dir","dcr","dxr"]],["application/x-doom","wad"],["application/x-dtbncx+xml","ncx"],["application/x-dtbook+xml","dtb"],["application/x-dtbresource+xml","res"],["application/x-dvi","dvi"],["application/x-elc","elc"],["application/x-envoy",["env","evy"]],["application/x-esrehber","es"],["application/x-excel",["xls","xla","xlb","xlc","xld","xlk","xll","xlm","xlt","xlv","xlw"]],["application/x-font-bdf","bdf"],["application/x-font-ghostscript","gsf"],["application/x-font-linux-psf","psf"],["application/x-font-otf","otf"],["application/x-font-pcf","pcf"],["application/x-font-snf","snf"],["application/x-font-ttf","ttf"],["application/x-font-type1","pfa"],["application/x-font-woff","woff"],["application/x-frame","mif"],["application/x-freelance","pre"],["application/x-futuresplash","spl"],["application/x-gnumeric","gnumeric"],["application/x-gsp","gsp"],["application/x-gss","gss"],["application/x-gtar","gtar"],["application/x-gzip",["gz","gzip"]],["application/x-hdf","hdf"],["application/x-helpfile",["help","hlp"]],["application/x-httpd-imap","imap"],["application/x-ima","ima"],["application/x-internet-signup",["ins","isp"]],["application/x-internett-signup","ins"],["application/x-inventor","iv"],["application/x-ip2","ip"],["application/x-iphone","iii"],["application/x-java-class","class"],["application/x-java-commerce","jcm"],["application/x-java-jnlp-file","jnlp"],["application/x-javascript","js"],["application/x-koan",["skd","skm","skp","skt"]],["application/x-ksh","ksh"],["application/x-latex",["latex","ltx"]],["application/x-lha","lha"],["application/x-lisp","lsp"],["application/x-livescreen","ivy"],["application/x-lotus","wq1"],["application/x-lotusscreencam","scm"],["application/x-lzh","lzh"],["application/x-lzx","lzx"],["application/x-mac-binhex40","hqx"],["application/x-macbinary","bin"],["application/x-magic-cap-package-1.0","mc$"],["application/x-mathcad","mcd"],["application/x-meme","mm"],["application/x-midi",["mid","midi"]],["application/x-mif","mif"],["application/x-mix-transfer","nix"],["application/x-mobipocket-ebook","prc"],["application/x-mplayer2","asx"],["application/x-ms-application","application"],["application/x-ms-wmd","wmd"],["application/x-ms-wmz","wmz"],["application/x-ms-xbap","xbap"],["application/x-msaccess","mdb"],["application/x-msbinder","obd"],["application/x-mscardfile","crd"],["application/x-msclip","clp"],["application/x-msdownload",["exe","dll"]],["application/x-msexcel",["xls","xla","xlw"]],["application/x-msmediaview",["mvb","m13","m14"]],["application/x-msmetafile","wmf"],["application/x-msmoney","mny"],["application/x-mspowerpoint","ppt"],["application/x-mspublisher","pub"],["application/x-msschedule","scd"],["application/x-msterminal","trm"],["application/x-mswrite","wri"],["application/x-navi-animation","ani"],["application/x-navidoc","nvd"],["application/x-navimap","map"],["application/x-navistyle","stl"],["application/x-netcdf",["cdf","nc"]],["application/x-newton-compatible-pkg","pkg"],["application/x-nokia-9000-communicator-add-on-software","aos"],["application/x-omc","omc"],["application/x-omcdatamaker","omcd"],["application/x-omcregerator","omcr"],["application/x-pagemaker",["pm4","pm5"]],["application/x-pcl","pcl"],["application/x-perfmon",["pma","pmc","pml","pmr","pmw"]],["application/x-pixclscript","plx"],["application/x-pkcs10","p10"],["application/x-pkcs12",["p12","pfx"]],["application/x-pkcs7-certificates",["p7b","spc"]],["application/x-pkcs7-certreqresp","p7r"],["application/x-pkcs7-mime",["p7m","p7c"]],["application/x-pkcs7-signature",["p7s","p7a"]],["application/x-pointplus","css"],["application/x-portable-anymap","pnm"],["application/x-project",["mpc","mpt","mpv","mpx"]],["application/x-qpro","wb1"],["application/x-rar-compressed","rar"],["application/x-rtf","rtf"],["application/x-sdp","sdp"],["application/x-sea","sea"],["application/x-seelogo","sl"],["application/x-sh","sh"],["application/x-shar",["shar","sh"]],["application/x-shockwave-flash","swf"],["application/x-silverlight-app","xap"],["application/x-sit","sit"],["application/x-sprite",["spr","sprite"]],["application/x-stuffit","sit"],["application/x-stuffitx","sitx"],["application/x-sv4cpio","sv4cpio"],["application/x-sv4crc","sv4crc"],["application/x-tar","tar"],["application/x-tbook",["sbk","tbk"]],["application/x-tcl","tcl"],["application/x-tex","tex"],["application/x-tex-tfm","tfm"],["application/x-texinfo",["texi","texinfo"]],["application/x-troff",["roff","t","tr"]],["application/x-troff-man","man"],["application/x-troff-me","me"],["application/x-troff-ms","ms"],["application/x-troff-msvideo","avi"],["application/x-ustar","ustar"],["application/x-visio",["vsd","vst","vsw"]],["application/x-vnd.audioexplosion.mzz","mzz"],["application/x-vnd.ls-xpix","xpix"],["application/x-vrml","vrml"],["application/x-wais-source",["src","wsrc"]],["application/x-winhelp","hlp"],["application/x-wintalk","wtk"],["application/x-world",["wrl","svr"]],["application/x-wpwin","wpd"],["application/x-wri","wri"],["application/x-x509-ca-cert",["cer","crt","der"]],["application/x-x509-user-cert","crt"],["application/x-xfig","fig"],["application/x-xpinstall","xpi"],["application/x-zip-compressed","zip"],["application/xcap-diff+xml","xdf"],["application/xenc+xml","xenc"],["application/xhtml+xml","xhtml"],["application/xml","xml"],["application/xml-dtd","dtd"],["application/xop+xml","xop"],["application/xslt+xml","xslt"],["application/xspf+xml","xspf"],["application/xv+xml","mxml"],["application/yang","yang"],["application/yin+xml","yin"],["application/ynd.ms-pkipko","pko"],["application/zip","zip"],["audio/adpcm","adp"],["audio/aiff",["aiff","aif","aifc"]],["audio/basic",["snd","au"]],["audio/it","it"],["audio/make",["funk","my","pfunk"]],["audio/make.my.funk","pfunk"],["audio/mid",["mid","rmi"]],["audio/midi",["midi","kar","mid"]],["audio/mod","mod"],["audio/mp4","mp4a"],["audio/mpeg",["mpga","mp3","m2a","mp2","mpa","mpg"]],["audio/mpeg3","mp3"],["audio/nspaudio",["la","lma"]],["audio/ogg","oga"],["audio/s3m","s3m"],["audio/tsp-audio","tsi"],["audio/tsplayer","tsp"],["audio/vnd.dece.audio","uva"],["audio/vnd.digital-winds","eol"],["audio/vnd.dra","dra"],["audio/vnd.dts","dts"],["audio/vnd.dts.hd","dtshd"],["audio/vnd.lucent.voice","lvp"],["audio/vnd.ms-playready.media.pya","pya"],["audio/vnd.nuera.ecelp4800","ecelp4800"],["audio/vnd.nuera.ecelp7470","ecelp7470"],["audio/vnd.nuera.ecelp9600","ecelp9600"],["audio/vnd.qcelp","qcp"],["audio/vnd.rip","rip"],["audio/voc","voc"],["audio/voxware","vox"],["audio/wav","wav"],["audio/webm","weba"],["audio/x-aac","aac"],["audio/x-adpcm","snd"],["audio/x-aiff",["aiff","aif","aifc"]],["audio/x-au","au"],["audio/x-gsm",["gsd","gsm"]],["audio/x-jam","jam"],["audio/x-liveaudio","lam"],["audio/x-mid",["mid","midi"]],["audio/x-midi",["midi","mid"]],["audio/x-mod","mod"],["audio/x-mpeg","mp2"],["audio/x-mpeg-3","mp3"],["audio/x-mpegurl","m3u"],["audio/x-mpequrl","m3u"],["audio/x-ms-wax","wax"],["audio/x-ms-wma","wma"],["audio/x-nspaudio",["la","lma"]],["audio/x-pn-realaudio",["ra","ram","rm","rmm","rmp"]],["audio/x-pn-realaudio-plugin",["ra","rmp","rpm"]],["audio/x-psid","sid"],["audio/x-realaudio","ra"],["audio/x-twinvq","vqf"],["audio/x-twinvq-plugin",["vqe","vql"]],["audio/x-vnd.audioexplosion.mjuicemediafile","mjf"],["audio/x-voc","voc"],["audio/x-wav","wav"],["audio/xm","xm"],["chemical/x-cdx","cdx"],["chemical/x-cif","cif"],["chemical/x-cmdf","cmdf"],["chemical/x-cml","cml"],["chemical/x-csml","csml"],["chemical/x-pdb",["pdb","xyz"]],["chemical/x-xyz","xyz"],["drawing/x-dwf","dwf"],["i-world/i-vrml","ivr"],["image/bmp",["bmp","bm"]],["image/cgm","cgm"],["image/cis-cod","cod"],["image/cmu-raster",["ras","rast"]],["image/fif","fif"],["image/florian",["flo","turbot"]],["image/g3fax","g3"],["image/gif","gif"],["image/ief",["ief","iefs"]],["image/jpeg",["jpeg","jpe","jpg","jfif","jfif-tbnl"]],["image/jutvision","jut"],["image/ktx","ktx"],["image/naplps",["nap","naplps"]],["image/pict",["pic","pict"]],["image/pipeg","jfif"],["image/pjpeg",["jfif","jpe","jpeg","jpg"]],["image/png",["png","x-png"]],["image/prs.btif","btif"],["image/svg+xml","svg"],["image/tiff",["tif","tiff"]],["image/vasa","mcf"],["image/vnd.adobe.photoshop","psd"],["image/vnd.dece.graphic","uvi"],["image/vnd.djvu","djvu"],["image/vnd.dvb.subtitle","sub"],["image/vnd.dwg",["dwg","dxf","svf"]],["image/vnd.dxf","dxf"],["image/vnd.fastbidsheet","fbs"],["image/vnd.fpx","fpx"],["image/vnd.fst","fst"],["image/vnd.fujixerox.edmics-mmr","mmr"],["image/vnd.fujixerox.edmics-rlc","rlc"],["image/vnd.ms-modi","mdi"],["image/vnd.net-fpx",["fpx","npx"]],["image/vnd.rn-realflash","rf"],["image/vnd.rn-realpix","rp"],["image/vnd.wap.wbmp","wbmp"],["image/vnd.xiff","xif"],["image/webp","webp"],["image/x-cmu-raster","ras"],["image/x-cmx","cmx"],["image/x-dwg",["dwg","dxf","svf"]],["image/x-freehand","fh"],["image/x-icon","ico"],["image/x-jg","art"],["image/x-jps","jps"],["image/x-niff",["niff","nif"]],["image/x-pcx","pcx"],["image/x-pict",["pct","pic"]],["image/x-portable-anymap","pnm"],["image/x-portable-bitmap","pbm"],["image/x-portable-graymap","pgm"],["image/x-portable-greymap","pgm"],["image/x-portable-pixmap","ppm"],["image/x-quicktime",["qif","qti","qtif"]],["image/x-rgb","rgb"],["image/x-tiff",["tif","tiff"]],["image/x-windows-bmp","bmp"],["image/x-xbitmap","xbm"],["image/x-xbm","xbm"],["image/x-xpixmap",["xpm","pm"]],["image/x-xwd","xwd"],["image/x-xwindowdump","xwd"],["image/xbm","xbm"],["image/xpm","xpm"],["message/rfc822",["eml","mht","mhtml","nws","mime"]],["model/iges",["iges","igs"]],["model/mesh","msh"],["model/vnd.collada+xml","dae"],["model/vnd.dwf","dwf"],["model/vnd.gdl","gdl"],["model/vnd.gtw","gtw"],["model/vnd.mts","mts"],["model/vnd.vtu","vtu"],["model/vrml",["vrml","wrl","wrz"]],["model/x-pov","pov"],["multipart/x-gzip","gzip"],["multipart/x-ustar","ustar"],["multipart/x-zip","zip"],["music/crescendo",["mid","midi"]],["music/x-karaoke","kar"],["paleovu/x-pv","pvu"],["text/asp","asp"],["text/calendar","ics"],["text/css","css"],["text/csv","csv"],["text/ecmascript","js"],["text/h323","323"],["text/html",["html","htm","stm","acgi","htmls","htx","shtml"]],["text/iuls","uls"],["text/javascript","js"],["text/mcf","mcf"],["text/n3","n3"],["text/pascal","pas"],["text/plain",["txt","bas","c","h","c++","cc","com","conf","cxx","def","f","f90","for","g","hh","idc","jav","java","list","log","lst","m","mar","pl","sdml","text"]],["text/plain-bas","par"],["text/prs.lines.tag","dsc"],["text/richtext",["rtx","rt","rtf"]],["text/scriplet","wsc"],["text/scriptlet","sct"],["text/sgml",["sgm","sgml"]],["text/tab-separated-values","tsv"],["text/troff","t"],["text/turtle","ttl"],["text/uri-list",["uni","unis","uri","uris"]],["text/vnd.abc","abc"],["text/vnd.curl","curl"],["text/vnd.curl.dcurl","dcurl"],["text/vnd.curl.mcurl","mcurl"],["text/vnd.curl.scurl","scurl"],["text/vnd.fly","fly"],["text/vnd.fmi.flexstor","flx"],["text/vnd.graphviz","gv"],["text/vnd.in3d.3dml","3dml"],["text/vnd.in3d.spot","spot"],["text/vnd.rn-realtext","rt"],["text/vnd.sun.j2me.app-descriptor","jad"],["text/vnd.wap.wml","wml"],["text/vnd.wap.wmlscript","wmls"],["text/webviewhtml","htt"],["text/x-asm",["asm","s"]],["text/x-audiosoft-intra","aip"],["text/x-c",["c","cc","cpp"]],["text/x-component","htc"],["text/x-fortran",["for","f","f77","f90"]],["text/x-h",["h","hh"]],["text/x-java-source",["java","jav"]],["text/x-java-source,java","java"],["text/x-la-asf","lsx"],["text/x-m","m"],["text/x-pascal","p"],["text/x-script","hlb"],["text/x-script.csh","csh"],["text/x-script.elisp","el"],["text/x-script.guile","scm"],["text/x-script.ksh","ksh"],["text/x-script.lisp","lsp"],["text/x-script.perl","pl"],["text/x-script.perl-module","pm"],["text/x-script.phyton","py"],["text/x-script.rexx","rexx"],["text/x-script.scheme","scm"],["text/x-script.sh","sh"],["text/x-script.tcl","tcl"],["text/x-script.tcsh","tcsh"],["text/x-script.zsh","zsh"],["text/x-server-parsed-html",["shtml","ssi"]],["text/x-setext","etx"],["text/x-sgml",["sgm","sgml"]],["text/x-speech",["spc","talk"]],["text/x-uil","uil"],["text/x-uuencode",["uu","uue"]],["text/x-vcalendar","vcs"],["text/x-vcard","vcf"],["text/xml","xml"],["video/3gpp","3gp"],["video/3gpp2","3g2"],["video/animaflex","afl"],["video/avi","avi"],["video/avs-video","avs"],["video/dl","dl"],["video/fli","fli"],["video/gl","gl"],["video/h261","h261"],["video/h263","h263"],["video/h264","h264"],["video/jpeg","jpgv"],["video/jpm","jpm"],["video/mj2","mj2"],["video/mp4","mp4"],["video/mpeg",["mpeg","mp2","mpa","mpe","mpg","mpv2","m1v","m2v","mp3"]],["video/msvideo","avi"],["video/ogg","ogv"],["video/quicktime",["mov","qt","moov"]],["video/vdo","vdo"],["video/vivo",["viv","vivo"]],["video/vnd.dece.hd","uvh"],["video/vnd.dece.mobile","uvm"],["video/vnd.dece.pd","uvp"],["video/vnd.dece.sd","uvs"],["video/vnd.dece.video","uvv"],["video/vnd.fvt","fvt"],["video/vnd.mpegurl","mxu"],["video/vnd.ms-playready.media.pyv","pyv"],["video/vnd.rn-realvideo","rv"],["video/vnd.uvvu.mp4","uvu"],["video/vnd.vivo",["viv","vivo"]],["video/vosaic","vos"],["video/webm","webm"],["video/x-amt-demorun","xdr"],["video/x-amt-showrun","xsr"],["video/x-atomic3d-feature","fmf"],["video/x-dl","dl"],["video/x-dv",["dif","dv"]],["video/x-f4v","f4v"],["video/x-fli","fli"],["video/x-flv","flv"],["video/x-gl","gl"],["video/x-isvideo","isu"],["video/x-la-asf",["lsf","lsx"]],["video/x-m4v","m4v"],["video/x-motion-jpeg","mjpg"],["video/x-mpeg",["mp3","mp2"]],["video/x-mpeq2a","mp2"],["video/x-ms-asf",["asf","asr","asx"]],["video/x-ms-asf-plugin","asx"],["video/x-ms-wm","wm"],["video/x-ms-wmv","wmv"],["video/x-ms-wmx","wmx"],["video/x-ms-wvx","wvx"],["video/x-msvideo","avi"],["video/x-qtc","qtc"],["video/x-scm","scm"],["video/x-sgi-movie",["movie","mv"]],["windows/metafile","wmf"],["www/mime","mime"],["x-conference/x-cooltalk","ice"],["x-music/x-midi",["mid","midi"]],["x-world/x-3dmf",["3dm","3dmf","qd3","qd3d"]],["x-world/x-svr","svr"],["x-world/x-vrml",["flr","vrml","wrl","wrz","xaf","xof"]],["x-world/x-vrt","vrt"],["xgl/drawing","xgz"],["xgl/movie","xmz"]]);const extensions=new Map([["123","application/vnd.lotus-1-2-3"],["323","text/h323"],["*","application/octet-stream"],["3dm","x-world/x-3dmf"],["3dmf","x-world/x-3dmf"],["3dml","text/vnd.in3d.3dml"],["3g2","video/3gpp2"],["3gp","video/3gpp"],["7z","application/x-7z-compressed"],["a","application/octet-stream"],["aab","application/x-authorware-bin"],["aac","audio/x-aac"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abc","text/vnd.abc"],["abw","application/x-abiword"],["ac","application/pkix-attr-cert"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acgi","text/html"],["acu","application/vnd.acucobol"],["acx","application/internet-property-stream"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afl","video/animaflex"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/postscript"],["aif",["audio/aiff","audio/x-aiff"]],["aifc",["audio/aiff","audio/x-aiff"]],["aiff",["audio/aiff","audio/x-aiff"]],["aim","application/x-aim"],["aip","text/x-audiosoft-intra"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["ani","application/x-navi-animation"],["aos","application/x-nokia-9000-communicator-add-on-software"],["apk","application/vnd.android.package-archive"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["aps","application/mime"],["arc","application/octet-stream"],["arj",["application/arj","application/octet-stream"]],["art","image/x-jg"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asp","text/asp"],["asr","video/x-ms-asf"],["asx",["video/x-ms-asf","application/x-mplayer2","video/x-ms-asf-plugin"]],["atc","application/vnd.acucorp"],["atomcat","application/atomcat+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au",["audio/basic","audio/x-au"]],["avi",["video/avi","video/msvideo","application/x-troff-msvideo","video/x-msvideo"]],["avs","video/avs-video"],["aw","application/applixware"],["axs","application/olescript"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azw","application/vnd.amazon.ebook"],["bas","text/plain"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin",["application/octet-stream","application/mac-binary","application/macbinary","application/x-macbinary","application/x-binary"]],["bm","image/bmp"],["bmi","application/vnd.bmi"],["bmp",["image/bmp","image/x-windows-bmp"]],["boo","application/book"],["book","application/book"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bsh","application/x-bsh"],["btif","image/prs.btif"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c",["text/plain","text/x-c"]],["c++","text/plain"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["c4g","application/vnd.clonk.c4group"],["cab","application/vnd.ms-cab-compressed"],["car","application/vnd.curl.car"],["cat",["application/vnd.ms-pkiseccat","application/vnd.ms-pki.seccat"]],["cc",["text/plain","text/x-c"]],["ccad","application/clariscad"],["cco","application/x-cocoa"],["ccxml","application/ccxml+xml,"],["cdbcmsg","application/vnd.contact.cmsg"],["cdf",["application/cdf","application/x-cdf","application/x-netcdf"]],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer",["application/pkix-cert","application/x-x509-ca-cert"]],["cgm","image/cgm"],["cha","application/x-chat"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cla","application/vnd.claymore"],["class",["application/octet-stream","application/java","application/java-byte-code","application/java-vm","application/x-java-class"]],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod",["image/cis-cod","application/vnd.rim.cod"]],["com",["application/octet-stream","text/plain"]],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt",["application/mac-compactpro","application/x-compactpro","application/x-cpt"]],["crd","application/x-mscardfile"],["crl",["application/pkix-crl","application/pkcs-crl"]],["crt",["application/pkix-cert","application/x-x509-user-cert","application/x-x509-ca-cert"]],["cryptonote","application/vnd.rig.cryptonote"],["csh",["text/x-script.csh","application/x-csh"]],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["css",["text/css","application/x-pointplus"]],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxx","text/plain"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["davmount","application/davmount+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["deb","application/x-debian-package"],["deepv","application/x-deepv"],["def","text/plain"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dif","video/x-dv"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["djvu","image/vnd.djvu"],["dl",["video/dl","video/x-dl"]],["dll","application/x-msdownload"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.document.macroenabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroenabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp",["application/commonground","application/vnd.osgi.dp"]],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drw","application/drafting"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dv","video/x-dv"],["dvi","application/x-dvi"],["dwf",["model/vnd.dwf","drawing/x-dwf"]],["dwg",["application/acad","image/vnd.dwg","image/x-dwg"]],["dxf",["application/dxf","image/vnd.dwg","image/vnd.dxf","image/x-dwg"]],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["el","text/x-script.elisp"],["elc",["application/x-elc","application/x-bytecode.elisp"]],["eml","message/rfc822"],["emma","application/emma+xml"],["env","application/x-envoy"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es",["application/ecmascript","application/x-esrehber"]],["es3","application/vnd.eszigno3+xml"],["esf","application/vnd.epson.esf"],["etx","text/x-setext"],["evy",["application/envoy","application/x-envoy"]],["exe",["application/octet-stream","application/x-msdownload"]],["exi","application/exi"],["ext","application/vnd.novadigm.ext"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f",["text/plain","text/x-fortran"]],["f4v","video/x-f4v"],["f77","text/x-fortran"],["f90",["text/plain","text/x-fortran"]],["fbs","image/vnd.fastbidsheet"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fh","image/x-freehand"],["fif",["application/fractals","image/fif"]],["fig","application/x-xfig"],["fli",["video/fli","video/x-fli"]],["flo",["image/florian","application/vnd.micrografx.flo"]],["flr","x-world/x-vrml"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fmf","video/x-atomic3d-feature"],["fnc","application/vnd.frogans.fnc"],["for",["text/plain","text/x-fortran"]],["fpx",["image/vnd.fpx","image/vnd.net-fpx"]],["frl","application/freeloader"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["funk","audio/make"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g","text/plain"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gdl","model/vnd.gdl"],["geo","application/vnd.dynageo"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["gl",["video/gl","video/x-gl"]],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gph","application/vnd.flographit"],["gqf","application/vnd.grafeq"],["gram","application/srgs"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsd","audio/x-gsm"],["gsf","application/x-font-ghostscript"],["gsm","audio/x-gsm"],["gsp","application/x-gsp"],["gss","application/x-gss"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxt","application/vnd.geonext"],["gz",["application/x-gzip","application/x-compressed"]],["gzip",["multipart/x-gzip","application/x-gzip"]],["h",["text/plain","text/x-h"]],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hdf","application/x-hdf"],["help","application/x-helpfile"],["hgl","application/vnd.hp-hpgl"],["hh",["text/plain","text/x-h"]],["hlb","text/x-script"],["hlp",["application/winhlp","application/hlp","application/x-helpfile","application/x-winhelp"]],["hpg","application/vnd.hp-hpgl"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx",["application/mac-binhex40","application/binhex","application/binhex4","application/mac-binhex","application/x-binhex40","application/x-mac-binhex40"]],["hta","application/hta"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["htmls","text/html"],["htt","text/webviewhtml"],["htx","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["ico","image/x-icon"],["ics","text/calendar"],["idc","text/plain"],["ief","image/ief"],["iefs","image/ief"],["ifm","application/vnd.shana.informed.formdata"],["iges",["application/iges","model/iges"]],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs",["application/iges","model/iges"]],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["iii","application/x-iphone"],["ima","application/x-ima"],["imap","application/x-httpd-imap"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["inf","application/inf"],["ins",["application/x-internet-signup","application/x-internett-signup"]],["ip","application/x-ip2"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["isp","application/x-internet-signup"],["isu","video/x-isvideo"],["it","audio/it"],["itp","application/vnd.shana.informed.formtemplate"],["iv","application/x-inventor"],["ivp","application/vnd.immervision-ivp"],["ivr","i-world/i-vrml"],["ivu","application/vnd.immervision-ivu"],["ivy","application/x-livescreen"],["jad","text/vnd.sun.j2me.app-descriptor"],["jam",["application/vnd.jam","audio/x-jam"]],["jar","application/java-archive"],["jav",["text/plain","text/x-java-source"]],["java",["text/plain","text/x-java-source,java","text/x-java-source"]],["jcm","application/x-java-commerce"],["jfif",["image/pipeg","image/jpeg","image/pjpeg"]],["jfif-tbnl","image/jpeg"],["jisp","application/vnd.jisp"],["jlt","application/vnd.hp-jlyt"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jpe",["image/jpeg","image/pjpeg"]],["jpeg",["image/jpeg","image/pjpeg"]],["jpg",["image/jpeg","image/pjpeg"]],["jpgv","video/jpeg"],["jpm","video/jpm"],["jps","image/x-jps"],["js",["application/javascript","application/ecmascript","text/javascript","text/ecmascript","application/x-javascript"]],["json","application/json"],["jut","image/jutvision"],["kar",["audio/midi","music/x-karaoke"]],["karbon","application/vnd.kde.karbon"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["ksh",["application/x-ksh","text/x-script.ksh"]],["ksp","application/vnd.kde.kspread"],["ktx","image/ktx"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["la",["audio/nspaudio","audio/x-nspaudio"]],["lam","audio/x-liveaudio"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["lha",["application/octet-stream","application/lha","application/x-lha"]],["lhx","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["lma",["audio/nspaudio","audio/x-nspaudio"]],["log","text/plain"],["lrm","application/vnd.ms-lrm"],["lsf","video/x-la-asf"],["lsp",["application/x-lisp","text/x-script.lisp"]],["lst","text/plain"],["lsx",["video/x-la-asf","text/x-la-asf"]],["ltf","application/vnd.frogans.ltf"],["ltx","application/x-latex"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh",["application/octet-stream","application/x-lzh"]],["lzx",["application/lzx","application/octet-stream","application/x-lzx"]],["m",["text/plain","text/x-m"]],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m1v","video/mpeg"],["m21","application/mp21"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3u",["audio/x-mpegurl","audio/x-mpequrl"]],["m3u8","application/vnd.apple.mpegurl"],["m4v","video/x-m4v"],["ma","application/mathematica"],["mads","application/mads+xml"],["mag","application/vnd.ecowin.chart"],["man","application/x-troff-man"],["map","application/x-navimap"],["mar","text/plain"],["mathml","application/mathml+xml"],["mbd","application/mbedlet"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc$","application/x-magic-cap-package-1.0"],["mc1","application/vnd.medcalcdata"],["mcd",["application/mcad","application/vnd.mcd","application/x-mathcad"]],["mcf",["image/vasa","text/mcf"]],["mcp","application/netmc"],["mcurl","text/vnd.curl.mcurl"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["me","application/x-troff-me"],["meta4","application/metalink4+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mht","message/rfc822"],["mhtml","message/rfc822"],["mid",["audio/mid","audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["midi",["audio/midi","music/crescendo","x-music/x-midi","audio/x-midi","application/x-midi","audio/x-mid"]],["mif",["application/vnd.mif","application/x-mif","application/x-frame"]],["mime",["message/rfc822","www/mime"]],["mj2","video/mj2"],["mjf","audio/x-vnd.audioexplosion.mjuicemediafile"],["mjpg","video/x-motion-jpeg"],["mlp","application/vnd.dolby.mlp"],["mm",["application/base64","application/x-meme"]],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mme","application/base64"],["mmf","application/vnd.smaf"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mny","application/x-msmoney"],["mod",["audio/mod","audio/x-mod"]],["mods","application/mods+xml"],["moov","video/quicktime"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2",["video/mpeg","audio/mpeg","video/x-mpeg","audio/x-mpeg","video/x-mpeq2a"]],["mp3",["audio/mpeg","audio/mpeg3","video/mpeg","audio/x-mpeg-3","video/x-mpeg"]],["mp4",["video/mp4","application/mp4"]],["mp4a","audio/mp4"],["mpa",["video/mpeg","audio/mpeg"]],["mpc",["application/vnd.mophun.certificate","application/x-project"]],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg",["video/mpeg","audio/mpeg"]],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/x-project"],["mpv","application/x-project"],["mpv2","video/mpeg"],["mpx","application/x-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","application/x-troff-ms"],["mscml","application/mediaservercontrol+xml"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msl","application/vnd.mobius.msl"],["msty","application/vnd.muvee.style"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musicxml","application/vnd.recordare.musicxml+xml"],["mv","video/x-sgi-movie"],["mvb","application/x-msmediaview"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["my","audio/make"],["mzz","application/x-vnd.audioexplosion.mzz"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nap","image/naplps"],["naplps","image/naplps"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncm","application/vnd.nokia.configuration-message"],["ncx","application/x-dtbncx+xml"],["ngdat","application/vnd.nokia.n-gage.data"],["nif","image/x-niff"],["niff","image/x-niff"],["nix","application/x-mix-transfer"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nvd","application/x-navidoc"],["nws","message/rfc822"],["o","application/octet-stream"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omc","application/x-omc"],["omcd","application/x-omcdatamaker"],["omcr","application/x-omcregerator"],["onetoc","application/onenote"],["opf","application/oebps-package+xml"],["org","application/vnd.lotus-organizer"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","application/x-font-otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p10",["application/pkcs10","application/x-pkcs10"]],["p12",["application/pkcs-12","application/x-pkcs12"]],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7m",["application/pkcs7-mime","application/x-pkcs7-mime"]],["p7r","application/x-pkcs7-certreqresp"],["p7s",["application/pkcs7-signature","application/x-pkcs7-signature"]],["p8","application/pkcs8"],["par","text/plain-bas"],["part","application/pro_eng"],["pas","text/pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcf","application/x-font-pcf"],["pcl",["application/vnd.hp-pcl","application/x-pcl"]],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb",["application/vnd.palm","chemical/x-pdb"]],["pdf","application/pdf"],["pfa","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfunk",["audio/make","audio/make.my.funk"]],["pfx","application/x-pkcs12"],["pgm",["image/x-portable-graymap","image/x-portable-greymap"]],["pgn","application/x-chess-pgn"],["pgp","application/pgp-signature"],["pic",["image/pict","image/x-pict"]],["pict","image/pict"],["pkg","application/x-newton-compatible-pkg"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pko",["application/ynd.ms-pkipko","application/vnd.ms-pki.pko"]],["pl",["text/plain","text/x-script.perl"]],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["plx","application/x-pixclscript"],["pm",["text/x-script.perl-module","image/x-xpixmap"]],["pm4","application/x-pagemaker"],["pm5","application/x-pagemaker"],["pma","application/x-perfmon"],["pmc","application/x-perfmon"],["pml",["application/vnd.ctc-posml","application/x-perfmon"]],["pmr","application/x-perfmon"],["pmw","application/x-perfmon"],["png","image/png"],["pnm",["application/x-portable-anymap","image/x-portable-anymap"]],["portpkg","application/vnd.macports.portpkg"],["pot",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["potm","application/vnd.ms-powerpoint.template.macroenabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["pov","model/x-pov"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroenabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps",["application/vnd.ms-powerpoint","application/mspowerpoint"]],["ppsm","application/vnd.ms-powerpoint.slideshow.macroenabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt",["application/vnd.ms-powerpoint","application/mspowerpoint","application/powerpoint","application/x-mspowerpoint"]],["pptm","application/vnd.ms-powerpoint.presentation.macroenabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["ppz","application/mspowerpoint"],["prc","application/x-mobipocket-ebook"],["pre",["application/vnd.lotus-freelance","application/x-freelance"]],["prf","application/pics-rules"],["prt","application/pro_eng"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd",["application/octet-stream","image/vnd.adobe.photoshop"]],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pvu","paleovu/x-pv"],["pwn","application/vnd.3m.post-it-notes"],["pwz","application/vnd.ms-powerpoint"],["py","text/x-script.phyton"],["pya","audio/vnd.ms-playready.media.pya"],["pyc","application/x-bytecode.python"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qcp","audio/vnd.qcelp"],["qd3","x-world/x-3dmf"],["qd3d","x-world/x-3dmf"],["qfx","application/vnd.intu.qfx"],["qif","image/x-quicktime"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qtc","video/x-qtc"],["qti","image/x-quicktime"],["qtif","image/x-quicktime"],["qxd","application/vnd.quark.quarkxpress"],["ra",["audio/x-realaudio","audio/x-pn-realaudio","audio/x-pn-realaudio-plugin"]],["ram","audio/x-pn-realaudio"],["rar","application/x-rar-compressed"],["ras",["image/cmu-raster","application/x-cmu-raster","image/x-cmu-raster"]],["rast","image/cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rexx","text/x-script.rexx"],["rf","image/vnd.rn-realflash"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm",["application/vnd.rn-realmedia","audio/x-pn-realaudio"]],["rmi","audio/mid"],["rmm","audio/x-pn-realaudio"],["rmp",["audio/x-pn-realaudio-plugin","audio/x-pn-realaudio"]],["rms","application/vnd.jcp.javame.midlet-rms"],["rnc","application/relax-ng-compact-syntax"],["rng",["application/ringing-tones","application/vnd.nokia.ringing-tone"]],["rnx","application/vnd.rn-realplayer"],["roff","application/x-troff"],["rp","image/vnd.rn-realpix"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsd","application/rsd+xml"],["rt",["text/richtext","text/vnd.rn-realtext"]],["rtf",["application/rtf","text/richtext","application/x-rtf"]],["rtx",["text/richtext","application/rtf"]],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["saveme","application/octet-stream"],["sbk","application/x-tbook"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm",["application/vnd.lotus-screencam","video/x-scm","text/x-script.guile","application/x-lotusscreencam","text/x-script.scheme"]],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["sct","text/scriptlet"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkm","application/vnd.solent.sdkm+xml"],["sdml","text/plain"],["sdp",["application/sdp","application/x-sdp"]],["sdr","application/sounder"],["sdw","application/vnd.stardivision.writer"],["sea",["application/sea","application/x-sea"]],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["ser","application/java-serialized-object"],["set","application/set"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sgl","application/vnd.stardivision.writer-global"],["sgm",["text/sgml","text/x-sgml"]],["sgml",["text/sgml","text/x-sgml"]],["sh",["application/x-shar","application/x-bsh","application/x-sh","text/x-script.sh"]],["shar",["application/x-bsh","application/x-shar"]],["shf","application/shf+xml"],["shtml",["text/html","text/x-server-parsed-html"]],["sid","audio/x-psid"],["sis","application/vnd.symbian.install"],["sit",["application/x-stuffit","application/x-sit"]],["sitx","application/x-stuffitx"],["skd","application/x-koan"],["skm","application/x-koan"],["skp",["application/vnd.koan","application/x-koan"]],["skt","application/x-koan"],["sl","application/x-seelogo"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi",["application/smil","application/smil+xml"]],["smil","application/smil"],["snd",["audio/basic","audio/x-adpcm"]],["snf","application/x-font-snf"],["sol","application/solids"],["spc",["text/x-speech","application/x-pkcs7-certificates"]],["spf","application/vnd.yamaha.smaf-phrase"],["spl",["application/futuresplash","application/x-futuresplash"]],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spr","application/x-sprite"],["sprite","application/x-sprite"],["src","application/x-wais-source"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssi","text/x-server-parsed-html"],["ssm","application/streamingmedia"],["ssml","application/ssml+xml"],["sst",["application/vnd.ms-pkicertstore","application/vnd.ms-pki.certstore"]],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["step","application/step"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl",["application/vnd.ms-pkistl","application/sla","application/vnd.ms-pki.stl","application/x-navistyle"]],["stm","text/html"],["stp","application/step"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["sub","image/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svf",["image/vnd.dwg","image/x-dwg"]],["svg","image/svg+xml"],["svr",["x-world/x-svr","application/x-world"]],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t",["text/troff","application/x-troff"]],["talk","text/x-speech"],["tao","application/vnd.tao.intent-module-archive"],["tar","application/x-tar"],["tbk",["application/toolbook","application/x-tbook"]],["tcap","application/vnd.3gpp2.tcap"],["tcl",["text/x-script.tcl","application/x-tcl"]],["tcsh","text/x-script.tcsh"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text",["application/plain","text/plain"]],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tgz",["application/gnutar","application/x-compressed"]],["thmx","application/vnd.ms-officetheme"],["tif",["image/tiff","image/x-tiff"]],["tiff",["image/tiff","image/x-tiff"]],["tmo","application/vnd.tmobile-livetv"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","application/x-troff"],["tra","application/vnd.trueapp"],["trm","application/x-msterminal"],["tsd","application/timestamped-data"],["tsi","audio/tsp-audio"],["tsp",["application/dsptype","audio/tsplayer"]],["tsv","text/tab-separated-values"],["ttf","application/x-font-ttf"],["ttl","text/turtle"],["turbot","image/florian"],["twd","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["ufd","application/vnd.ufdl"],["uil","text/x-uil"],["uls","text/iuls"],["umj","application/vnd.umajin"],["uni","text/uri-list"],["unis","text/uri-list"],["unityweb","application/vnd.unity"],["unv","application/i-deas"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["ustar",["application/x-ustar","multipart/x-ustar"]],["utz","application/vnd.uiq.theme"],["uu",["application/octet-stream","text/x-uuencode"]],["uue","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vda","application/vda"],["vdo","video/vdo"],["vew","application/groupwise"],["vis","application/vnd.visionary"],["viv",["video/vivo","video/vnd.vivo"]],["vivo",["video/vivo","video/vnd.vivo"]],["vmd","application/vocaltec-media-desc"],["vmf","application/vocaltec-media-file"],["voc",["audio/voc","audio/x-voc"]],["vos","video/vosaic"],["vox","audio/voxware"],["vqe","audio/x-twinvq-plugin"],["vqf","audio/x-twinvq"],["vql","audio/x-twinvq-plugin"],["vrml",["model/vrml","x-world/x-vrml","application/x-vrml"]],["vrt","x-world/x-vrt"],["vsd",["application/vnd.visio","application/x-visio"]],["vsf","application/vnd.vsf"],["vst","application/x-visio"],["vsw","application/x-visio"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w60","application/wordperfect6.0"],["w61","application/wordperfect6.1"],["w6w","application/msword"],["wad","application/x-doom"],["wav",["audio/wav","audio/x-wav"]],["wax","audio/x-ms-wax"],["wb1","application/x-qpro"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/vnd.wap.wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["web","application/vnd.xara"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wiz","application/msword"],["wk1","application/x-123"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf",["windows/metafile","application/x-msmetafile"]],["wml","text/vnd.wap.wml"],["wmlc","application/vnd.wap.wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-ms-wmz"],["woff","application/x-font-woff"],["word","application/msword"],["wp","application/wordperfect"],["wp5",["application/wordperfect","application/wordperfect6.0"]],["wp6","application/wordperfect"],["wpd",["application/wordperfect","application/vnd.wordperfect","application/x-wpwin"]],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wq1","application/x-lotus"],["wqd","application/vnd.wqd"],["wri",["application/mswrite","application/x-wri","application/x-mswrite"]],["wrl",["model/vrml","x-world/x-vrml","application/x-world"]],["wrz",["model/vrml","x-world/x-vrml"]],["wsc","text/scriplet"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wsrc","application/x-wais-source"],["wtb","application/vnd.webturbo"],["wtk","application/x-wintalk"],["wvx","video/x-ms-wvx"],["x-png","image/png"],["x3d","application/vnd.hzn-3d-crossword"],["xaf","x-world/x-vrml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm",["image/xbm","image/x-xbm","image/x-xbitmap"]],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdr","video/x-amt-demorun"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xgz","xgl/drawing"],["xhtml","application/xhtml+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlam","application/vnd.ms-excel.addin.macroenabled.12"],["xlb",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlc",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xld",["application/excel","application/x-excel"]],["xlk",["application/excel","application/x-excel"]],["xll",["application/excel","application/vnd.ms-excel","application/x-excel"]],["xlm",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xls",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xlsb","application/vnd.ms-excel.sheet.binary.macroenabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroenabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt",["application/vnd.ms-excel","application/excel","application/x-excel"]],["xltm","application/vnd.ms-excel.template.macroenabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlv",["application/excel","application/x-excel"]],["xlw",["application/vnd.ms-excel","application/excel","application/x-msexcel","application/x-excel"]],["xm","audio/xm"],["xml",["application/xml","text/xml","application/atom+xml","application/rss+xml"]],["xmz","xgl/movie"],["xo","application/vnd.olpc-sugar"],["xof","x-world/x-vrml"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpix","application/x-vnd.ls-xpix"],["xpm",["image/xpm","image/x-xpixmap"]],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xsr","video/x-amt-showrun"],["xul","application/vnd.mozilla.xul+xml"],["xwd",["image/x-xwd","image/x-xwindowdump"]],["xyz",["chemical/x-xyz","chemical/x-pdb"]],["yang","application/yang"],["yin","application/yin+xml"],["z",["application/x-compressed","application/x-compress"]],["zaz","application/vnd.zzazz.deck+xml"],["zip",["application/zip","multipart/x-zip","application/x-zip-compressed","application/x-compressed"]],["zir","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zoo","application/octet-stream"],["zsh","text/x-script.zsh"]]);module.exports={detectMimeType(filename){if(!filename){return defaultMimeType}let parsed=path.parse(filename);let extension=(parsed.ext.substr(1)||parsed.name||"").split("?").shift().trim().toLowerCase();let value=defaultMimeType;if(extensions.has(extension)){value=extensions.get(extension)}if(Array.isArray(value)){return value[0]}return value},detectExtension(mimeType){if(!mimeType){return defaultExtension}let parts=(mimeType||"").toLowerCase().trim().split("/");let rootType=parts.shift().trim();let subType=parts.join("/").trim();if(mimeTypes.has(rootType+"/"+subType)){let value=mimeTypes.get(rootType+"/"+subType);if(Array.isArray(value)){return value[0]}return value}switch(rootType){case"text":return"txt";default:return"bin"}}}},{path:368}],307:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const crypto=require("crypto");const fs=require("fs");const punycode=require("punycode");const PassThrough=require("stream").PassThrough;const shared=require("../shared");const mimeFuncs=require("../mime-funcs");const qp=require("../qp");const base64=require("../base64");const addressparser=require("../addressparser");const nmfetch=require("../fetch");const LastNewline=require("./last-newline");const LeWindows=require("./le-windows");const LeUnix=require("./le-unix");class MimeNode{constructor(contentType,options){this.nodeCounter=0;options=options||{};this.baseBoundary=options.baseBoundary||crypto.randomBytes(8).toString("hex");this.boundaryPrefix=options.boundaryPrefix||"--_NmP";this.disableFileAccess=!!options.disableFileAccess;this.disableUrlAccess=!!options.disableUrlAccess;this.normalizeHeaderKey=options.normalizeHeaderKey;this.date=new Date;this.rootNode=options.rootNode||this;this.keepBcc=!!options.keepBcc;if(options.filename){this.filename=options.filename;if(!contentType){contentType=mimeFuncs.detectMimeType(this.filename.split(".").pop())}}this.textEncoding=(options.textEncoding||"").toString().trim().charAt(0).toUpperCase();this.parentNode=options.parentNode;this.hostname=options.hostname;this.newline=options.newline;this.childNodes=[];this._nodeId=++this.rootNode.nodeCounter;this._headers=[];this._isPlainText=false;this._hasLongLines=false;this._envelope=false;this._raw=false;this._transforms=[];this._processFuncs=[];if(contentType){this.setHeader("Content-Type",contentType)}}createChild(contentType,options){if(!options&&typeof contentType==="object"){options=contentType;contentType=undefined}let node=new MimeNode(contentType,options);this.appendChild(node);return node}appendChild(childNode){if(childNode.rootNode!==this.rootNode){childNode.rootNode=this.rootNode;childNode._nodeId=++this.rootNode.nodeCounter}childNode.parentNode=this;this.childNodes.push(childNode);return childNode}replace(node){if(node===this){return this}this.parentNode.childNodes.forEach(((childNode,i)=>{if(childNode===this){node.rootNode=this.rootNode;node.parentNode=this.parentNode;node._nodeId=this._nodeId;this.rootNode=this;this.parentNode=undefined;node.parentNode.childNodes[i]=node}}));return node}remove(){if(!this.parentNode){return this}for(let i=this.parentNode.childNodes.length-1;i>=0;i--){if(this.parentNode.childNodes[i]===this){this.parentNode.childNodes.splice(i,1);this.parentNode=undefined;this.rootNode=this;return this}}}setHeader(key,value){let added=false,headerValue;if(!value&&key&&typeof key==="object"){if(key.key&&"value"in key){this.setHeader(key.key,key.value)}else if(Array.isArray(key)){key.forEach((i=>{this.setHeader(i.key,i.value)}))}else{Object.keys(key).forEach((i=>{this.setHeader(i,key[i])}))}return this}key=this._normalizeHeaderKey(key);headerValue={key:key,value:value};for(let i=0,len=this._headers.length;i<len;i++){if(this._headers[i].key===key){if(!added){this._headers[i]=headerValue;added=true}else{this._headers.splice(i,1);i--;len--}}}if(!added){this._headers.push(headerValue)}return this}addHeader(key,value){if(!value&&key&&typeof key==="object"){if(key.key&&key.value){this.addHeader(key.key,key.value)}else if(Array.isArray(key)){key.forEach((i=>{this.addHeader(i.key,i.value)}))}else{Object.keys(key).forEach((i=>{this.addHeader(i,key[i])}))}return this}else if(Array.isArray(value)){value.forEach((val=>{this.addHeader(key,val)}));return this}this._headers.push({key:this._normalizeHeaderKey(key),value:value});return this}getHeader(key){key=this._normalizeHeaderKey(key);for(let i=0,len=this._headers.length;i<len;i++){if(this._headers[i].key===key){return this._headers[i].value}}}setContent(content){this.content=content;if(typeof this.content.pipe==="function"){this._contentErrorHandler=err=>{this.content.removeListener("error",this._contentErrorHandler);this.content=err};this.content.once("error",this._contentErrorHandler)}else if(typeof this.content==="string"){this._isPlainText=mimeFuncs.isPlainText(this.content);if(this._isPlainText&&mimeFuncs.hasLongerLines(this.content,76)){this._hasLongLines=true}}return this}build(callback){let promise;if(!callback){promise=new Promise(((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)}))}let stream=this.createReadStream();let buf=[];let buflen=0;let returned=false;stream.on("readable",(()=>{let chunk;while((chunk=stream.read())!==null){buf.push(chunk);buflen+=chunk.length}}));stream.once("error",(err=>{if(returned){return}returned=true;return callback(err)}));stream.once("end",(chunk=>{if(returned){return}returned=true;if(chunk&&chunk.length){buf.push(chunk);buflen+=chunk.length}return callback(null,Buffer.concat(buf,buflen))}));return promise}getTransferEncoding(){let transferEncoding=false;let contentType=(this.getHeader("Content-Type")||"").toString().toLowerCase().trim();if(this.content){transferEncoding=(this.getHeader("Content-Transfer-Encoding")||"").toString().toLowerCase().trim();if(!transferEncoding||!["base64","quoted-printable"].includes(transferEncoding)){if(/^text\//i.test(contentType)){if(this._isPlainText&&!this._hasLongLines){transferEncoding="7bit"}else if(typeof this.content==="string"||this.content instanceof Buffer){transferEncoding=this._getTextEncoding(this.content)==="Q"?"quoted-printable":"base64"}else{transferEncoding=this.textEncoding==="B"?"base64":"quoted-printable"}}else if(!/^(multipart|message)\//i.test(contentType)){transferEncoding=transferEncoding||"base64"}}}return transferEncoding}buildHeaders(){let transferEncoding=this.getTransferEncoding();let headers=[];if(transferEncoding){this.setHeader("Content-Transfer-Encoding",transferEncoding)}if(this.filename&&!this.getHeader("Content-Disposition")){this.setHeader("Content-Disposition","attachment")}if(this.rootNode===this){if(!this.getHeader("Date")){this.setHeader("Date",this.date.toUTCString().replace(/GMT/,"+0000"))}this.messageId();if(!this.getHeader("MIME-Version")){this.setHeader("MIME-Version","1.0")}}this._headers.forEach((header=>{let key=header.key;let value=header.value;let structured;let param;let options={};let formattedHeaders=["From","Sender","To","Cc","Bcc","Reply-To","Date","References"];if(value&&typeof value==="object"&&!formattedHeaders.includes(key)){Object.keys(value).forEach((key=>{if(key!=="value"){options[key]=value[key]}}));value=(value.value||"").toString();if(!value.trim()){return}}if(options.prepared){if(options.foldLines){headers.push(mimeFuncs.foldLines(key+": "+value))}else{headers.push(key+": "+value)}return}switch(header.key){case"Content-Disposition":structured=mimeFuncs.parseHeaderValue(value);if(this.filename){structured.params.filename=this.filename}value=mimeFuncs.buildHeaderValue(structured);break;case"Content-Type":structured=mimeFuncs.parseHeaderValue(value);this._handleContentType(structured);if(structured.value.match(/^text\/plain\b/)&&typeof this.content==="string"&&/[\u0080-\uFFFF]/.test(this.content)){structured.params.charset="utf-8"}value=mimeFuncs.buildHeaderValue(structured);if(this.filename){param=this._encodeWords(this.filename);if(param!==this.filename||/[\s'"\\;:/=(),<>@[\]?]|^-/.test(param)){param='"'+param+'"'}value+="; name="+param}break;case"Bcc":if(!this.keepBcc){return}break}value=this._encodeHeaderValue(key,value);if(!(value||"").toString().trim()){return}if(typeof this.normalizeHeaderKey==="function"){let normalized=this.normalizeHeaderKey(key,value);if(normalized&&typeof normalized==="string"&&normalized.length){key=normalized}}headers.push(mimeFuncs.foldLines(key+": "+value,76))}));return headers.join("\r\n")}createReadStream(options){options=options||{};let stream=new PassThrough(options);let outputStream=stream;let transform;this.stream(stream,options,(err=>{if(err){outputStream.emit("error",err);return}stream.end()}));for(let i=0,len=this._transforms.length;i<len;i++){transform=typeof this._transforms[i]==="function"?this._transforms[i]():this._transforms[i];outputStream.once("error",(err=>{transform.emit("error",err)}));outputStream=outputStream.pipe(transform)}transform=new LastNewline;outputStream.once("error",(err=>{transform.emit("error",err)}));outputStream=outputStream.pipe(transform);for(let i=0,len=this._processFuncs.length;i<len;i++){transform=this._processFuncs[i];outputStream=transform(outputStream)}if(this.newline){const winbreak=["win","windows","dos","\r\n"].includes(this.newline.toString().toLowerCase());const newlineTransform=winbreak?new LeWindows:new LeUnix;const stream=outputStream.pipe(newlineTransform);outputStream.on("error",(err=>stream.emit("error",err)));return stream}return outputStream}transform(transform){this._transforms.push(transform)}processFunc(processFunc){this._processFuncs.push(processFunc)}stream(outputStream,options,done){let transferEncoding=this.getTransferEncoding();let contentStream;let localStream;let returned=false;let callback=err=>{if(returned){return}returned=true;done(err)};let finalize=()=>{let childId=0;let processChildNode=()=>{if(childId>=this.childNodes.length){outputStream.write("\r\n--"+this.boundary+"--\r\n");return callback()}let child=this.childNodes[childId++];outputStream.write((childId>1?"\r\n":"")+"--"+this.boundary+"\r\n");child.stream(outputStream,options,(err=>{if(err){return callback(err)}setImmediate(processChildNode)}))};if(this.multipart){setImmediate(processChildNode)}else{return callback()}};let sendContent=()=>{if(this.content){if(Object.prototype.toString.call(this.content)==="[object Error]"){return callback(this.content)}if(typeof this.content.pipe==="function"){this.content.removeListener("error",this._contentErrorHandler);this._contentErrorHandler=err=>callback(err);this.content.once("error",this._contentErrorHandler)}let createStream=()=>{if(["quoted-printable","base64"].includes(transferEncoding)){contentStream=new(transferEncoding==="base64"?base64:qp).Encoder(options);contentStream.pipe(outputStream,{end:false});contentStream.once("end",finalize);contentStream.once("error",(err=>callback(err)));localStream=this._getStream(this.content);localStream.pipe(contentStream)}else{localStream=this._getStream(this.content);localStream.pipe(outputStream,{end:false});localStream.once("end",finalize)}localStream.once("error",(err=>callback(err)))};if(this.content._resolve){let chunks=[];let chunklen=0;let returned=false;let sourceStream=this._getStream(this.content);sourceStream.on("error",(err=>{if(returned){return}returned=true;callback(err)}));sourceStream.on("readable",(()=>{let chunk;while((chunk=sourceStream.read())!==null){chunks.push(chunk);chunklen+=chunk.length}}));sourceStream.on("end",(()=>{if(returned){return}returned=true;this.content._resolve=false;this.content._resolvedValue=Buffer.concat(chunks,chunklen);setImmediate(createStream)}))}else{setImmediate(createStream)}return}else{return setImmediate(finalize)}};if(this._raw){setImmediate((()=>{if(Object.prototype.toString.call(this._raw)==="[object Error]"){return callback(this._raw)}if(typeof this._raw.pipe==="function"){this._raw.removeListener("error",this._contentErrorHandler)}let raw=this._getStream(this._raw);raw.pipe(outputStream,{end:false});raw.on("error",(err=>outputStream.emit("error",err)));raw.on("end",finalize)}))}else{outputStream.write(this.buildHeaders()+"\r\n\r\n");setImmediate(sendContent)}}setEnvelope(envelope){let list;this._envelope={from:false,to:[]};if(envelope.from){list=[];this._convertAddresses(this._parseAddresses(envelope.from),list);list=list.filter((address=>address&&address.address));if(list.length&&list[0]){this._envelope.from=list[0].address}}["to","cc","bcc"].forEach((key=>{if(envelope[key]){this._convertAddresses(this._parseAddresses(envelope[key]),this._envelope.to)}}));this._envelope.to=this._envelope.to.map((to=>to.address)).filter((address=>address));let standardFields=["to","cc","bcc","from"];Object.keys(envelope).forEach((key=>{if(!standardFields.includes(key)){this._envelope[key]=envelope[key]}}));return this}getAddresses(){let addresses={};this._headers.forEach((header=>{let key=header.key.toLowerCase();if(["from","sender","reply-to","to","cc","bcc"].includes(key)){if(!Array.isArray(addresses[key])){addresses[key]=[]}this._convertAddresses(this._parseAddresses(header.value),addresses[key])}}));return addresses}getEnvelope(){if(this._envelope){return this._envelope}let envelope={from:false,to:[]};this._headers.forEach((header=>{let list=[];if(header.key==="From"||!envelope.from&&["Reply-To","Sender"].includes(header.key)){this._convertAddresses(this._parseAddresses(header.value),list);if(list.length&&list[0]){envelope.from=list[0].address}}else if(["To","Cc","Bcc"].includes(header.key)){this._convertAddresses(this._parseAddresses(header.value),envelope.to)}}));envelope.to=envelope.to.map((to=>to.address));return envelope}messageId(){let messageId=this.getHeader("Message-ID");if(!messageId){messageId=this._generateMessageId();this.setHeader("Message-ID",messageId)}return messageId}setRaw(raw){this._raw=raw;if(this._raw&&typeof this._raw.pipe==="function"){this._contentErrorHandler=err=>{this._raw.removeListener("error",this._contentErrorHandler);this._raw=err};this._raw.once("error",this._contentErrorHandler)}return this}_getStream(content){let contentStream;if(content._resolvedValue){contentStream=new PassThrough;setImmediate((()=>{try{contentStream.end(content._resolvedValue)}catch(err){contentStream.emit("error",err)}}));return contentStream}else if(typeof content.pipe==="function"){return content}else if(content&&typeof content.path==="string"&&!content.href){if(this.disableFileAccess){contentStream=new PassThrough;setImmediate((()=>contentStream.emit("error",new Error("File access rejected for "+content.path))));return contentStream}return fs.createReadStream(content.path)}else if(content&&typeof content.href==="string"){if(this.disableUrlAccess){contentStream=new PassThrough;setImmediate((()=>contentStream.emit("error",new Error("Url access rejected for "+content.href))));return contentStream}return nmfetch(content.href,{headers:content.httpHeaders})}else{contentStream=new PassThrough;setImmediate((()=>{try{contentStream.end(content||"")}catch(err){contentStream.emit("error",err)}}));return contentStream}}_parseAddresses(addresses){return[].concat.apply([],[].concat(addresses).map((address=>{if(address&&address.address){address.address=this._normalizeAddress(address.address);address.name=address.name||"";return[address]}return addressparser(address)})))}_normalizeHeaderKey(key){key=(key||"").toString().replace(/\r?\n|\r/g," ").trim().toLowerCase().replace(/^X-SMTPAPI$|^(MIME|DKIM|ARC|BIMI)\b|^[a-z]|-(SPF|FBL|ID|MD5)$|-[a-z]/gi,(c=>c.toUpperCase())).replace(/^Content-Features$/i,"Content-features");return key}_handleContentType(structured){this.contentType=structured.value.trim().toLowerCase();this.multipart=/^multipart\//i.test(this.contentType)?this.contentType.substr(this.contentType.indexOf("/")+1):false;if(this.multipart){this.boundary=structured.params.boundary=structured.params.boundary||this.boundary||this._generateBoundary()}else{this.boundary=false}}_generateBoundary(){return this.rootNode.boundaryPrefix+"-"+this.rootNode.baseBoundary+"-Part_"+this._nodeId}_encodeHeaderValue(key,value){key=this._normalizeHeaderKey(key);switch(key){case"From":case"Sender":case"To":case"Cc":case"Bcc":case"Reply-To":return this._convertAddresses(this._parseAddresses(value));case"Message-ID":case"In-Reply-To":case"Content-Id":value=(value||"").toString().replace(/\r?\n|\r/g," ");if(value.charAt(0)!=="<"){value="<"+value}if(value.charAt(value.length-1)!==">"){value=value+">"}return value;case"References":value=[].concat.apply([],[].concat(value||"").map((elm=>{elm=(elm||"").toString().replace(/\r?\n|\r/g," ").trim();return elm.replace(/<[^>]*>/g,(str=>str.replace(/\s/g,""))).split(/\s+/)}))).map((elm=>{if(elm.charAt(0)!=="<"){elm="<"+elm}if(elm.charAt(elm.length-1)!==">"){elm=elm+">"}return elm}));return value.join(" ").trim();case"Date":if(Object.prototype.toString.call(value)==="[object Date]"){return value.toUTCString().replace(/GMT/,"+0000")}value=(value||"").toString().replace(/\r?\n|\r/g," ");return this._encodeWords(value);case"Content-Type":case"Content-Disposition":return(value||"").toString().replace(/\r?\n|\r/g," ");default:value=(value||"").toString().replace(/\r?\n|\r/g," ");return this._encodeWords(value)}}_convertAddresses(addresses,uniqueList){let values=[];uniqueList=uniqueList||[];[].concat(addresses||[]).forEach((address=>{if(address.address){address.address=this._normalizeAddress(address.address);if(!address.name){values.push(address.address.indexOf(" ")>=0?`<${address.address}>`:`${address.address}`)}else if(address.name){values.push(`${this._encodeAddressName(address.name)} <${address.address}>`)}if(address.address){if(!uniqueList.filter((a=>a.address===address.address)).length){uniqueList.push(address)}}}else if(address.group){let groupListAddresses=(address.group.length?this._convertAddresses(address.group,uniqueList):"").trim();values.push(`${this._encodeAddressName(address.name)}:${groupListAddresses};`)}}));return values.join(", ")}_normalizeAddress(address){address=(address||"").toString().replace(/[\x00-\x1F<>]+/g," ").trim();let lastAt=address.lastIndexOf("@");if(lastAt<0){return address}let user=address.substr(0,lastAt);let domain=address.substr(lastAt+1);let encodedDomain;try{encodedDomain=punycode.toASCII(domain.toLowerCase())}catch(err){}if(user.indexOf(" ")>=0){if(user.charAt(0)!=='"'){user='"'+user}if(user.substr(-1)!=='"'){user=user+'"'}}return`${user}@${encodedDomain}`}_encodeAddressName(name){if(!/^[\w ']*$/.test(name)){if(/^[\x20-\x7e]*$/.test(name)){return'"'+name.replace(/([\\"])/g,"\\$1")+'"'}else{return mimeFuncs.encodeWord(name,this._getTextEncoding(name),52)}}return name}_encodeWords(value){return mimeFuncs.encodeWords(value,this._getTextEncoding(value),52,true)}_getTextEncoding(value){value=(value||"").toString();let encoding=this.textEncoding;let latinLen;let nonLatinLen;if(!encoding){nonLatinLen=(value.match(/[\x00-\x08\x0B\x0C\x0E-\x1F\u0080-\uFFFF]/g)||[]).length;latinLen=(value.match(/[a-z]/gi)||[]).length;encoding=nonLatinLen<latinLen?"Q":"B"}return encoding}_generateMessageId(){return"<"+[2,2,2,6].reduce(((prev,len)=>prev+"-"+crypto.randomBytes(len).toString("hex")),crypto.randomBytes(4).toString("hex"))+"@"+(this.getEnvelope().from||this.hostname||"localhost").split("@").pop()+">"}}module.exports=MimeNode}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{"../addressparser":293,"../base64":294,"../fetch":300,"../mime-funcs":305,"../qp":312,"../shared":315,"./last-newline":308,"./le-unix":309,"./le-windows":310,buffer:88,crypto:118,fs:88,punycode:89,stream:398,timers:433}],308:[function(require,module,exports){(function(Buffer){(function(){"use strict";const Transform=require("stream").Transform;class LastNewline extends Transform{constructor(){super();this.lastByte=false}_transform(chunk,encoding,done){if(chunk.length){this.lastByte=chunk[chunk.length-1]}this.push(chunk);done()}_flush(done){if(this.lastByte===10){return done()}if(this.lastByte===13){this.push(Buffer.from("\n"));return done()}this.push(Buffer.from("\r\n"));return done()}}module.exports=LastNewline}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88,stream:398}],309:[function(require,module,exports){"use strict";const stream=require("stream");const Transform=stream.Transform;class LeWindows extends Transform{constructor(options){super(options);this.options=options||{}}_transform(chunk,encoding,done){let buf;let lastPos=0;for(let i=0,len=chunk.length;i<len;i++){if(chunk[i]===13){buf=chunk.slice(lastPos,i);lastPos=i+1;this.push(buf)}}if(lastPos&&lastPos<chunk.length){buf=chunk.slice(lastPos);this.push(buf)}else if(!lastPos){this.push(chunk)}done()}}module.exports=LeWindows},{stream:398}],310:[function(require,module,exports){(function(Buffer){(function(){"use strict";const stream=require("stream");const Transform=stream.Transform;class LeWindows extends Transform{constructor(options){super(options);this.options=options||{};this.lastByte=false}_transform(chunk,encoding,done){let buf;let lastPos=0;for(let i=0,len=chunk.length;i<len;i++){if(chunk[i]===10){if(i&&chunk[i-1]!==13||!i&&this.lastByte!==13){if(i>lastPos){buf=chunk.slice(lastPos,i);this.push(buf)}this.push(Buffer.from("\r\n"));lastPos=i+1}}}if(lastPos&&lastPos<chunk.length){buf=chunk.slice(lastPos);this.push(buf)}else if(!lastPos){this.push(chunk)}this.lastByte=chunk[chunk.length-1];done()}}module.exports=LeWindows}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88,stream:398}],311:[function(require,module,exports){(function(process,Buffer,setImmediate){(function(){"use strict";const Mailer=require("./mailer");const shared=require("./shared");const SMTPPool=require("./smtp-pool");const SMTPTransport=require("./smtp-transport");const SendmailTransport=require("./sendmail-transport");const StreamTransport=require("./stream-transport");const JSONTransport=require("./json-transport");const SESTransport=require("./ses-transport");const nmfetch=require("./fetch");const packageData=require("../package.json");const ETHEREAL_API=(process.env.ETHEREAL_API||"https://api.nodemailer.com").replace(/\/+$/,"");const ETHEREAL_WEB=(process.env.ETHEREAL_WEB||"https://ethereal.email").replace(/\/+$/,"");const ETHEREAL_CACHE=["true","yes","y","1"].includes((process.env.ETHEREAL_CACHE||"yes").toString().trim().toLowerCase());let testAccount=false;module.exports.createTransport=function(transporter,defaults){let urlConfig;let options;let mailer;if(typeof transporter==="object"&&typeof transporter.send!=="function"||typeof transporter==="string"&&/^(smtps?|direct):/i.test(transporter)){if(urlConfig=typeof transporter==="string"?transporter:transporter.url){options=shared.parseConnectionUrl(urlConfig)}else{options=transporter}if(options.pool){transporter=new SMTPPool(options)}else if(options.sendmail){transporter=new SendmailTransport(options)}else if(options.streamTransport){transporter=new StreamTransport(options)}else if(options.jsonTransport){transporter=new JSONTransport(options)}else if(options.SES){transporter=new SESTransport(options)}else{transporter=new SMTPTransport(options)}}mailer=new Mailer(transporter,options,defaults);return mailer};module.exports.createTestAccount=function(apiUrl,callback){let promise;if(!callback&&typeof apiUrl==="function"){callback=apiUrl;apiUrl=false}if(!callback){promise=new Promise(((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)}))}if(ETHEREAL_CACHE&&testAccount){setImmediate((()=>callback(null,testAccount)));return promise}apiUrl=apiUrl||ETHEREAL_API;let chunks=[];let chunklen=0;let req=nmfetch(apiUrl+"/user",{contentType:"application/json",method:"POST",body:Buffer.from(JSON.stringify({requestor:packageData.name,version:packageData.version}))});req.on("readable",(()=>{let chunk;while((chunk=req.read())!==null){chunks.push(chunk);chunklen+=chunk.length}}));req.once("error",(err=>callback(err)));req.once("end",(()=>{let res=Buffer.concat(chunks,chunklen);let data;let err;try{data=JSON.parse(res.toString())}catch(E){err=E}if(err){return callback(err)}if(data.status!=="success"||data.error){return callback(new Error(data.error||"Request failed"))}delete data.status;testAccount=data;callback(null,testAccount)}));return promise};module.exports.getTestMessageUrl=function(info){if(!info||!info.response){return false}let infoProps=new Map;info.response.replace(/\[([^\]]+)\]$/,((m,props)=>{props.replace(/\b([A-Z0-9]+)=([^\s]+)/g,((m,key,value)=>{infoProps.set(key,value)}))}));if(infoProps.has("STATUS")&&infoProps.has("MSGID")){return(testAccount.web||ETHEREAL_WEB)+"/message/"+infoProps.get("MSGID")}return false}}).call(this)}).call(this,require("_process"),require("buffer").Buffer,require("timers").setImmediate)},{"../package.json":326,"./fetch":300,"./json-transport":301,"./mailer":303,"./sendmail-transport":313,"./ses-transport":314,"./shared":315,"./smtp-pool":319,"./smtp-transport":321,"./stream-transport":322,_process:88,buffer:88,timers:433}],312:[function(require,module,exports){(function(Buffer){(function(){"use strict";const Transform=require("stream").Transform;function encode(buffer){if(typeof buffer==="string"){buffer=Buffer.from(buffer,"utf-8")}let ranges=[[9],[10],[13],[32,60],[62,126]];let result="";let ord;for(let i=0,len=buffer.length;i<len;i++){ord=buffer[i];if(checkRanges(ord,ranges)&&!((ord===32||ord===9)&&(i===len-1||buffer[i+1]===10||buffer[i+1]===13))){result+=String.fromCharCode(ord);continue}result+="="+(ord<16?"0":"")+ord.toString(16).toUpperCase()}return result}function wrap(str,lineLength){str=(str||"").toString();lineLength=lineLength||76;if(str.length<=lineLength){return str}let pos=0;let len=str.length;let match,code,line;let lineMargin=Math.floor(lineLength/3);let result="";while(pos<len){line=str.substr(pos,lineLength);if(match=line.match(/\r\n/)){line=line.substr(0,match.index+match[0].length);result+=line;pos+=line.length;continue}if(line.substr(-1)==="\n"){result+=line;pos+=line.length;continue}else if(match=line.substr(-lineMargin).match(/\n.*?$/)){line=line.substr(0,line.length-(match[0].length-1));result+=line;pos+=line.length;continue}else if(line.length>lineLength-lineMargin&&(match=line.substr(-lineMargin).match(/[ \t.,!?][^ \t.,!?]*$/))){line=line.substr(0,line.length-(match[0].length-1))}else if(line.match(/[=][\da-f]{0,2}$/i)){if(match=line.match(/[=][\da-f]{0,1}$/i)){line=line.substr(0,line.length-match[0].length)}while(line.length>3&&line.length<len-pos&&!line.match(/^(?:=[\da-f]{2}){1,4}$/i)&&(match=line.match(/[=][\da-f]{2}$/gi))){code=parseInt(match[0].substr(1,2),16);if(code<128){break}line=line.substr(0,line.length-3);if(code>=192){break}}}if(pos+line.length<len&&line.substr(-1)!=="\n"){if(line.length===lineLength&&line.match(/[=][\da-f]{2}$/i)){line=line.substr(0,line.length-3)}else if(line.length===lineLength){line=line.substr(0,line.length-1)}pos+=line.length;line+="=\r\n"}else{pos+=line.length}result+=line}return result}function checkRanges(nr,ranges){for(let i=ranges.length-1;i>=0;i--){if(!ranges[i].length){continue}if(ranges[i].length===1&&nr===ranges[i][0]){return true}if(ranges[i].length===2&&nr>=ranges[i][0]&&nr<=ranges[i][1]){return true}}return false}class Encoder extends Transform{constructor(options){super();this.options=options||{};if(this.options.lineLength!==false){this.options.lineLength=this.options.lineLength||76}this._curLine="";this.inputBytes=0;this.outputBytes=0}_transform(chunk,encoding,done){let qp;if(encoding!=="buffer"){chunk=Buffer.from(chunk,encoding)}if(!chunk||!chunk.length){return done()}this.inputBytes+=chunk.length;if(this.options.lineLength){qp=this._curLine+encode(chunk);qp=wrap(qp,this.options.lineLength);qp=qp.replace(/(^|\n)([^\n]*)$/,((match,lineBreak,lastLine)=>{this._curLine=lastLine;return lineBreak}));if(qp){this.outputBytes+=qp.length;this.push(qp)}}else{qp=encode(chunk);this.outputBytes+=qp.length;this.push(qp,"ascii")}done()}_flush(done){if(this._curLine){this.outputBytes+=this._curLine.length;this.push(this._curLine,"ascii")}done()}}module.exports={encode:encode,wrap:wrap,Encoder:Encoder}}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88,stream:398}],313:[function(require,module,exports){"use strict";const spawn=require("child_process").spawn;const packageData=require("../../package.json");const shared=require("../shared");class SendmailTransport{constructor(options){options=options||{};this._spawn=spawn;this.options=options||{};this.name="Sendmail";this.version=packageData.version;this.path="sendmail";this.args=false;this.winbreak=false;this.logger=shared.getLogger(this.options,{component:this.options.component||"sendmail"});if(options){if(typeof options==="string"){this.path=options}else if(typeof options==="object"){if(options.path){this.path=options.path}if(Array.isArray(options.args)){this.args=options.args}this.winbreak=["win","windows","dos","\r\n"].includes((options.newline||"").toString().toLowerCase())}}}send(mail,done){mail.message.keepBcc=true;let envelope=mail.data.envelope||mail.message.getEnvelope();let messageId=mail.message.messageId();let args;let sendmail;let returned;const hasInvalidAddresses=[].concat(envelope.from||[]).concat(envelope.to||[]).some((addr=>/^-/.test(addr)));if(hasInvalidAddresses){return done(new Error("Can not send mail. Invalid envelope addresses."))}if(this.args){args=["-i"].concat(this.args).concat(envelope.to)}else{args=["-i"].concat(envelope.from?["-f",envelope.from]:[]).concat(envelope.to)}let callback=err=>{if(returned){return}returned=true;if(typeof done==="function"){if(err){return done(err)}else{return done(null,{envelope:mail.data.envelope||mail.message.getEnvelope(),messageId:messageId,response:"Messages queued for delivery"})}}};try{sendmail=this._spawn(this.path,args)}catch(E){this.logger.error({err:E,tnx:"spawn",messageId:messageId},"Error occurred while spawning sendmail. %s",E.message);return callback(E)}if(sendmail){sendmail.on("error",(err=>{this.logger.error({err:err,tnx:"spawn",messageId:messageId},"Error occurred when sending message %s. %s",messageId,err.message);callback(err)}));sendmail.once("exit",(code=>{if(!code){return callback()}let err;if(code===127){err=new Error("Sendmail command not found, process exited with code "+code)}else{err=new Error("Sendmail exited with code "+code)}this.logger.error({err:err,tnx:"stdin",messageId:messageId},"Error sending message %s to sendmail. %s",messageId,err.message);callback(err)}));sendmail.once("close",callback);sendmail.stdin.on("error",(err=>{this.logger.error({err:err,tnx:"stdin",messageId:messageId},"Error occurred when piping message %s to sendmail. %s",messageId,err.message);callback(err)}));let recipients=[].concat(envelope.to||[]);if(recipients.length>3){recipients.push("...and "+recipients.splice(2).length+" more")}this.logger.info({tnx:"send",messageId:messageId},"Sending message %s to <%s>",messageId,recipients.join(", "));let sourceStream=mail.message.createReadStream();sourceStream.once("error",(err=>{this.logger.error({err:err,tnx:"stdin",messageId:messageId},"Error occurred when generating message %s. %s",messageId,err.message);sendmail.kill("SIGINT");callback(err)}));sourceStream.pipe(sendmail.stdin)}else{return callback(new Error("sendmail was not found"))}}}module.exports=SendmailTransport},{"../../package.json":326,"../shared":315,child_process:88}],314:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const EventEmitter=require("events");const packageData=require("../../package.json");const shared=require("../shared");const LeWindows=require("../mime-node/le-windows");class SESTransport extends EventEmitter{constructor(options){super();options=options||{};this.options=options||{};this.ses=this.options.SES;this.name="SESTransport";this.version=packageData.version;this.logger=shared.getLogger(this.options,{component:this.options.component||"ses-transport"});this.maxConnections=Number(this.options.maxConnections)||Infinity;this.connections=0;this.sendingRate=Number(this.options.sendingRate)||Infinity;this.sendingRateTTL=null;this.rateInterval=1e3;this.rateMessages=[];this.pending=[];this.idling=true;setImmediate((()=>{if(this.idling){this.emit("idle")}}))}send(mail,callback){if(this.connections>=this.maxConnections){this.idling=false;return this.pending.push({mail:mail,callback:callback})}if(!this._checkSendingRate()){this.idling=false;return this.pending.push({mail:mail,callback:callback})}this._send(mail,((...args)=>{setImmediate((()=>callback(...args)));this._sent()}))}_checkRatedQueue(){if(this.connections>=this.maxConnections||!this._checkSendingRate()){return}if(!this.pending.length){if(!this.idling){this.idling=true;this.emit("idle")}return}let next=this.pending.shift();this._send(next.mail,((...args)=>{setImmediate((()=>next.callback(...args)));this._sent()}))}_checkSendingRate(){clearTimeout(this.sendingRateTTL);let now=Date.now();let oldest=false;for(let i=this.rateMessages.length-1;i>=0;i--){if(this.rateMessages[i].ts>=now-this.rateInterval&&(!oldest||this.rateMessages[i].ts<oldest)){oldest=this.rateMessages[i].ts}if(this.rateMessages[i].ts<now-this.rateInterval&&!this.rateMessages[i].pending){this.rateMessages.splice(i,1)}}if(this.rateMessages.length<this.sendingRate){return true}let delay=Math.max(oldest+1001,now+20);this.sendingRateTTL=setTimeout((()=>this._checkRatedQueue()),now-delay);try{this.sendingRateTTL.unref()}catch(E){}return false}_sent(){this.connections--;this._checkRatedQueue()}isIdle(){return this.idling}_send(mail,callback){let statObject={ts:Date.now(),pending:true};this.connections++;this.rateMessages.push(statObject);let envelope=mail.data.envelope||mail.message.getEnvelope();let messageId=mail.message.messageId();let recipients=[].concat(envelope.to||[]);if(recipients.length>3){recipients.push("...and "+recipients.splice(2).length+" more")}this.logger.info({tnx:"send",messageId:messageId},"Sending message %s to <%s>",messageId,recipients.join(", "));let getRawMessage=next=>{if(!mail.data._dkim){mail.data._dkim={}}if(mail.data._dkim.skipFields&&typeof mail.data._dkim.skipFields==="string"){mail.data._dkim.skipFields+=":date:message-id"}else{mail.data._dkim.skipFields="date:message-id"}let sourceStream=mail.message.createReadStream();let stream=sourceStream.pipe(new LeWindows);let chunks=[];let chunklen=0;stream.on("readable",(()=>{let chunk;while((chunk=stream.read())!==null){chunks.push(chunk);chunklen+=chunk.length}}));sourceStream.once("error",(err=>stream.emit("error",err)));stream.once("error",(err=>{next(err)}));stream.once("end",(()=>next(null,Buffer.concat(chunks,chunklen))))};setImmediate((()=>getRawMessage(((err,raw)=>{if(err){this.logger.error({err:err,tnx:"send",messageId:messageId},"Failed creating message for %s. %s",messageId,err.message);statObject.pending=false;return callback(err)}let sesMessage={RawMessage:{Data:raw},Source:envelope.from,Destinations:envelope.to};Object.keys(mail.data.ses||{}).forEach((key=>{sesMessage[key]=mail.data.ses[key]}));let ses=(this.ses.aws?this.ses.ses:this.ses)||{};let aws=this.ses.aws||{};let getRegion=cb=>{if(ses.config&&typeof ses.config.region==="function"){return ses.config.region().then((region=>cb(null,region))).catch((err=>cb(err)))}return cb(null,ses.config&&ses.config.region||"us-east-1")};getRegion(((err,region)=>{if(err||!region){region="us-east-1"}let sendPromise;if(typeof ses.send==="function"&&aws.SendRawEmailCommand){sendPromise=ses.send(new aws.SendRawEmailCommand(sesMessage))}else{sendPromise=ses.sendRawEmail(sesMessage).promise()}sendPromise.then((data=>{if(region==="us-east-1"){region="email"}statObject.pending=false;callback(null,{envelope:{from:envelope.from,to:envelope.to},messageId:"<"+data.MessageId+(!/@/.test(data.MessageId)?"@"+region+".amazonses.com":"")+">",response:data.MessageId,raw:raw})})).catch((err=>{this.logger.error({err:err,tnx:"send"},"Send error for %s: %s",messageId,err.message);statObject.pending=false;callback(err)}))}))}))))}verify(callback){let promise;let ses=(this.ses.aws?this.ses.ses:this.ses)||{};let aws=this.ses.aws||{};const sesMessage={RawMessage:{Data:"From: invalid@invalid\r\nTo: invalid@invalid\r\n Subject: Invalid\r\n\r\nInvalid"},Source:"invalid@invalid",Destinations:["invalid@invalid"]};if(!callback){promise=new Promise(((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)}))}const cb=err=>{if(err&&(err.code||err.Code)!=="InvalidParameterValue"){return callback(err)}return callback(null,true)};if(typeof ses.send==="function"&&aws.SendRawEmailCommand){sesMessage.RawMessage.Data=Buffer.from(sesMessage.RawMessage.Data);ses.send(new aws.SendRawEmailCommand(sesMessage),cb)}else{ses.sendRawEmail(sesMessage,cb)}return promise}}module.exports=SESTransport}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{"../../package.json":326,"../mime-node/le-windows":310,"../shared":315,buffer:88,events:187,timers:433}],315:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const urllib=require("url");const util=require("util");const fs=require("fs");const nmfetch=require("../fetch");const dns=require("dns");const net=require("net");const os=require("os");const DNS_TTL=5*60*1e3;let networkInterfaces;try{networkInterfaces=os.networkInterfaces()}catch(err){}module.exports.networkInterfaces=networkInterfaces;const isFamilySupported=(family,allowInternal)=>{let networkInterfaces=module.exports.networkInterfaces;if(!networkInterfaces){return true}const familySupported=Object.keys(networkInterfaces).map((key=>networkInterfaces[key])).reduce(((acc,val)=>acc.concat(val)),[]).filter((i=>!i.internal||allowInternal)).filter((i=>i.family==="IPv"+family||i.family===family)).length>0;return familySupported};const resolver=(family,hostname,options,callback)=>{options=options||{};const familySupported=isFamilySupported(family,options.allowInternalNetworkInterfaces);if(!familySupported){return callback(null,[])}const resolver=dns.Resolver?new dns.Resolver(options):dns;resolver["resolve"+family](hostname,((err,addresses)=>{if(err){switch(err.code){case dns.NODATA:case dns.NOTFOUND:case dns.NOTIMP:case dns.SERVFAIL:case dns.CONNREFUSED:case dns.REFUSED:case"EAI_AGAIN":return callback(null,[])}return callback(err)}return callback(null,Array.isArray(addresses)?addresses:[].concat(addresses||[]))}))};const dnsCache=module.exports.dnsCache=new Map;const formatDNSValue=(value,extra)=>{if(!value){return Object.assign({},extra||{})}return Object.assign({servername:value.servername,host:!value.addresses||!value.addresses.length?null:value.addresses.length===1?value.addresses[0]:value.addresses[Math.floor(Math.random()*value.addresses.length)]},extra||{})};module.exports.resolveHostname=(options,callback)=>{options=options||{};if(!options.host&&options.servername){options.host=options.servername}if(!options.host||net.isIP(options.host)){let value={addresses:[options.host],servername:options.servername||false};return callback(null,formatDNSValue(value,{cached:false}))}let cached;if(dnsCache.has(options.host)){cached=dnsCache.get(options.host);if(!cached.expires||cached.expires>=Date.now()){return callback(null,formatDNSValue(cached.value,{cached:true}))}}resolver(4,options.host,options,((err,addresses)=>{if(err){if(cached){return callback(null,formatDNSValue(cached.value,{cached:true,error:err}))}return callback(err)}if(addresses&&addresses.length){let value={addresses:addresses,servername:options.servername||options.host};dnsCache.set(options.host,{value:value,expires:Date.now()+(options.dnsTtl||DNS_TTL)});return callback(null,formatDNSValue(value,{cached:false}))}resolver(6,options.host,options,((err,addresses)=>{if(err){if(cached){return callback(null,formatDNSValue(cached.value,{cached:true,error:err}))}return callback(err)}if(addresses&&addresses.length){let value={addresses:addresses,servername:options.servername||options.host};dnsCache.set(options.host,{value:value,expires:Date.now()+(options.dnsTtl||DNS_TTL)});return callback(null,formatDNSValue(value,{cached:false}))}try{dns.lookup(options.host,{all:true},((err,addresses)=>{if(err){if(cached){return callback(null,formatDNSValue(cached.value,{cached:true,error:err}))}return callback(err)}let address=addresses?addresses.filter((addr=>isFamilySupported(addr.family))).map((addr=>addr.address)).shift():false;if(addresses&&addresses.length&&!address){console.warn(`Failed to resolve IPv${addresses[0].family} addresses with current network`)}if(!address&&cached){return callback(null,formatDNSValue(cached.value,{cached:true}))}let value={addresses:address?[address]:[options.host],servername:options.servername||options.host};dnsCache.set(options.host,{value:value,expires:Date.now()+(options.dnsTtl||DNS_TTL)});return callback(null,formatDNSValue(value,{cached:false}))}))}catch(err){if(cached){return callback(null,formatDNSValue(cached.value,{cached:true,error:err}))}return callback(err)}}))}))};module.exports.parseConnectionUrl=str=>{str=str||"";let options={};[urllib.parse(str,true)].forEach((url=>{let auth;switch(url.protocol){case"smtp:":options.secure=false;break;case"smtps:":options.secure=true;break;case"direct:":options.direct=true;break}if(!isNaN(url.port)&&Number(url.port)){options.port=Number(url.port)}if(url.hostname){options.host=url.hostname}if(url.auth){auth=url.auth.split(":");if(!options.auth){options.auth={}}options.auth.user=auth.shift();options.auth.pass=auth.join(":")}Object.keys(url.query||{}).forEach((key=>{let obj=options;let lKey=key;let value=url.query[key];if(!isNaN(value)){value=Number(value)}switch(value){case"true":value=true;break;case"false":value=false;break}if(key.indexOf("tls.")===0){lKey=key.substr(4);if(!options.tls){options.tls={}}obj=options.tls}else if(key.indexOf(".")>=0){return}if(!(lKey in obj)){obj[lKey]=value}}))}));return options};module.exports._logFunc=(logger,level,defaults,data,message,...args)=>{let entry={};Object.keys(defaults||{}).forEach((key=>{if(key!=="level"){entry[key]=defaults[key]}}));Object.keys(data||{}).forEach((key=>{if(key!=="level"){entry[key]=data[key]}}));logger[level](entry,message,...args)};module.exports.getLogger=(options,defaults)=>{options=options||{};let response={};let levels=["trace","debug","info","warn","error","fatal"];if(!options.logger){levels.forEach((level=>{response[level]=()=>false}));return response}let logger=options.logger;if(options.logger===true){logger=createDefaultLogger(levels)}levels.forEach((level=>{response[level]=(data,message,...args)=>{module.exports._logFunc(logger,level,defaults,data,message,...args)}}));return response};module.exports.callbackPromise=(resolve,reject)=>function(){let args=Array.from(arguments);let err=args.shift();if(err){reject(err)}else{resolve(...args)}};module.exports.resolveContent=(data,key,callback)=>{let promise;if(!callback){promise=new Promise(((resolve,reject)=>{callback=module.exports.callbackPromise(resolve,reject)}))}let content=data&&data[key]&&data[key].content||data[key];let contentStream;let encoding=(typeof data[key]==="object"&&data[key].encoding||"utf8").toString().toLowerCase().replace(/[-_\s]/g,"");if(!content){return callback(null,content)}if(typeof content==="object"){if(typeof content.pipe==="function"){return resolveStream(content,((err,value)=>{if(err){return callback(err)}if(data[key].content){data[key].content=value}else{data[key]=value}callback(null,value)}))}else if(/^https?:\/\//i.test(content.path||content.href)){contentStream=nmfetch(content.path||content.href);return resolveStream(contentStream,callback)}else if(/^data:/i.test(content.path||content.href)){let parts=(content.path||content.href).match(/^data:((?:[^;]*;)*(?:[^,]*)),(.*)$/i);if(!parts){return callback(null,Buffer.from(0))}return callback(null,/\bbase64$/i.test(parts[1])?Buffer.from(parts[2],"base64"):Buffer.from(decodeURIComponent(parts[2])))}else if(content.path){return resolveStream(fs.createReadStream(content.path),callback)}}if(typeof data[key].content==="string"&&!["utf8","usascii","ascii"].includes(encoding)){content=Buffer.from(data[key].content,encoding)}setImmediate((()=>callback(null,content)));return promise};module.exports.assign=function(){let args=Array.from(arguments);let target=args.shift()||{};args.forEach((source=>{Object.keys(source||{}).forEach((key=>{if(["tls","auth"].includes(key)&&source[key]&&typeof source[key]==="object"){if(!target[key]){target[key]={}}Object.keys(source[key]).forEach((subKey=>{target[key][subKey]=source[key][subKey]}))}else{target[key]=source[key]}}))}));return target};module.exports.encodeXText=str=>{if(!/[^\x21-\x2A\x2C-\x3C\x3E-\x7E]/.test(str)){return str}let buf=Buffer.from(str);let result="";for(let i=0,len=buf.length;i<len;i++){let c=buf[i];if(c<33||c>126||c===43||c===61){result+="+"+(c<16?"0":"")+c.toString(16).toUpperCase()}else{result+=String.fromCharCode(c)}}return result};function resolveStream(stream,callback){let responded=false;let chunks=[];let chunklen=0;stream.on("error",(err=>{if(responded){return}responded=true;callback(err)}));stream.on("readable",(()=>{let chunk;while((chunk=stream.read())!==null){chunks.push(chunk);chunklen+=chunk.length}}));stream.on("end",(()=>{if(responded){return}responded=true;let value;try{value=Buffer.concat(chunks,chunklen)}catch(E){return callback(E)}callback(null,value)}))}function createDefaultLogger(levels){let levelMaxLen=0;let levelNames=new Map;levels.forEach((level=>{if(level.length>levelMaxLen){levelMaxLen=level.length}}));levels.forEach((level=>{let levelName=level.toUpperCase();if(levelName.length<levelMaxLen){levelName+=" ".repeat(levelMaxLen-levelName.length)}levelNames.set(level,levelName)}));let print=(level,entry,message,...args)=>{let prefix="";if(entry){if(entry.tnx==="server"){prefix="S: "}else if(entry.tnx==="client"){prefix="C: "}if(entry.sid){prefix="["+entry.sid+"] "+prefix}if(entry.cid){prefix="[#"+entry.cid+"] "+prefix}}message=util.format(message,...args);message.split(/\r?\n/).forEach((line=>{console.log("[%s] %s %s",(new Date).toISOString().substr(0,19).replace(/T/," "),levelNames.get(level),prefix+line)}))};let logger={};levels.forEach((level=>{logger[level]=print.bind(null,level)}));return logger}}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{"../fetch":300,buffer:88,dns:88,fs:88,net:88,os:336,timers:433,url:439,util:443}],316:[function(require,module,exports){(function(Buffer){(function(){"use strict";const stream=require("stream");const Transform=stream.Transform;class DataStream extends Transform{constructor(options){super(options);this.options=options||{};this._curLine="";this.inByteCount=0;this.outByteCount=0;this.lastByte=false}_transform(chunk,encoding,done){let chunks=[];let chunklen=0;let i,len,lastPos=0;let buf;if(!chunk||!chunk.length){return done()}if(typeof chunk==="string"){chunk=Buffer.from(chunk)}this.inByteCount+=chunk.length;for(i=0,len=chunk.length;i<len;i++){if(chunk[i]===46){if(i&&chunk[i-1]===10||!i&&(!this.lastByte||this.lastByte===10)){buf=chunk.slice(lastPos,i+1);chunks.push(buf);chunks.push(Buffer.from("."));chunklen+=buf.length+1;lastPos=i+1}}else if(chunk[i]===10){if(i&&chunk[i-1]!==13||!i&&this.lastByte!==13){if(i>lastPos){buf=chunk.slice(lastPos,i);chunks.push(buf);chunklen+=buf.length+2}else{chunklen+=2}chunks.push(Buffer.from("\r\n"));lastPos=i+1}}}if(chunklen){if(lastPos<chunk.length){buf=chunk.slice(lastPos);chunks.push(buf);chunklen+=buf.length}this.outByteCount+=chunklen;this.push(Buffer.concat(chunks,chunklen))}else{this.outByteCount+=chunk.length;this.push(chunk)}this.lastByte=chunk[chunk.length-1];done()}_flush(done){let buf;if(this.lastByte===10){buf=Buffer.from(".\r\n")}else if(this.lastByte===13){buf=Buffer.from("\n.\r\n")}else{buf=Buffer.from("\r\n.\r\n")}this.outByteCount+=buf.length;this.push(buf);done()}}module.exports=DataStream}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88,stream:398}],317:[function(require,module,exports){(function(Buffer){(function(){"use strict";const net=require("net");const tls=require("tls");const urllib=require("url");function httpProxyClient(proxyUrl,destinationPort,destinationHost,callback){let proxy=urllib.parse(proxyUrl);let options;let connect;let socket;options={host:proxy.hostname,port:Number(proxy.port)?Number(proxy.port):proxy.protocol==="https:"?443:80};if(proxy.protocol==="https:"){options.rejectUnauthorized=false;connect=tls.connect.bind(tls)}else{connect=net.connect.bind(net)}let finished=false;let tempSocketErr=err=>{if(finished){return}finished=true;try{socket.destroy()}catch(E){}callback(err)};let timeoutErr=()=>{let err=new Error("Proxy socket timed out");err.code="ETIMEDOUT";tempSocketErr(err)};socket=connect(options,(()=>{if(finished){return}let reqHeaders={Host:destinationHost+":"+destinationPort,Connection:"close"};if(proxy.auth){reqHeaders["Proxy-Authorization"]="Basic "+Buffer.from(proxy.auth).toString("base64")}socket.write("CONNECT "+destinationHost+":"+destinationPort+" HTTP/1.1\r\n"+Object.keys(reqHeaders).map((key=>key+": "+reqHeaders[key])).join("\r\n")+"\r\n\r\n");let headers="";let onSocketData=chunk=>{let match;let remainder;if(finished){return}headers+=chunk.toString("binary");if(match=headers.match(/\r\n\r\n/)){socket.removeListener("data",onSocketData);remainder=headers.substr(match.index+match[0].length);headers=headers.substr(0,match.index);if(remainder){socket.unshift(Buffer.from(remainder,"binary"))}finished=true;match=headers.match(/^HTTP\/\d+\.\d+ (\d+)/i);if(!match||(match[1]||"").charAt(0)!=="2"){try{socket.destroy()}catch(E){}return callback(new Error("Invalid response from proxy"+(match&&": "+match[1]||"")))}socket.removeListener("error",tempSocketErr);socket.removeListener("timeout",timeoutErr);socket.setTimeout(0);return callback(null,socket)}};socket.on("data",onSocketData)}));socket.setTimeout(httpProxyClient.timeout||30*1e3);socket.on("timeout",timeoutErr);socket.once("error",tempSocketErr)}module.exports=httpProxyClient}).call(this)}).call(this,require("buffer").Buffer)},{buffer:88,net:88,tls:88,url:439}],318:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const packageInfo=require("../../package.json");const EventEmitter=require("events").EventEmitter;const net=require("net");const tls=require("tls");const os=require("os");const crypto=require("crypto");const DataStream=require("./data-stream");const PassThrough=require("stream").PassThrough;const shared=require("../shared");const CONNECTION_TIMEOUT=2*60*1e3;const SOCKET_TIMEOUT=10*60*1e3;const GREETING_TIMEOUT=30*1e3;const DNS_TIMEOUT=30*1e3;class SMTPConnection extends EventEmitter{constructor(options){super(options);this.id=crypto.randomBytes(8).toString("base64").replace(/\W/g,"");this.stage="init";this.options=options||{};this.secureConnection=!!this.options.secure;this.alreadySecured=!!this.options.secured;this.port=Number(this.options.port)||(this.secureConnection?465:587);this.host=this.options.host||"localhost";this.allowInternalNetworkInterfaces=this.options.allowInternalNetworkInterfaces||false;if(typeof this.options.secure==="undefined"&&this.port===465){this.secureConnection=true}this.name=this.options.name||this._getHostname();this.logger=shared.getLogger(this.options,{component:this.options.component||"smtp-connection",sid:this.id});this.customAuth=new Map;Object.keys(this.options.customAuth||{}).forEach((key=>{let mapKey=(key||"").toString().trim().toUpperCase();if(!mapKey){return}this.customAuth.set(mapKey,this.options.customAuth[key])}));this.version=packageInfo.version;this.authenticated=false;this.destroyed=false;this.secure=!!this.secureConnection;this._remainder="";this._responseQueue=[];this.lastServerResponse=false;this._socket=false;this._supportedAuth=[];this.allowsAuth=false;this._envelope=false;this._supportedExtensions=[];this._maxAllowedSize=0;this._responseActions=[];this._recipientQueue=[];this._greetingTimeout=false;this._connectionTimeout=false;this._destroyed=false;this._closing=false;this._onSocketData=chunk=>this._onData(chunk);this._onSocketError=error=>this._onError(error,"ESOCKET",false,"CONN");this._onSocketClose=()=>this._onClose();this._onSocketEnd=()=>this._onEnd();this._onSocketTimeout=()=>this._onTimeout()}connect(connectCallback){if(typeof connectCallback==="function"){this.once("connect",(()=>{this.logger.debug({tnx:"smtp"},"SMTP handshake finished");connectCallback()}));const isDestroyedMessage=this._isDestroyedMessage("connect");if(isDestroyedMessage){return connectCallback(this._formatError(isDestroyedMessage,"ECONNECTION",false,"CONN"))}}let opts={port:this.port,host:this.host,allowInternalNetworkInterfaces:this.allowInternalNetworkInterfaces,timeout:this.options.dnsTimeout||DNS_TIMEOUT};if(this.options.localAddress){opts.localAddress=this.options.localAddress}let setupConnectionHandlers=()=>{this._connectionTimeout=setTimeout((()=>{this._onError("Connection timeout","ETIMEDOUT",false,"CONN")}),this.options.connectionTimeout||CONNECTION_TIMEOUT);this._socket.on("error",this._onSocketError)};if(this.options.connection){this._socket=this.options.connection;if(this.secureConnection&&!this.alreadySecured){setImmediate((()=>this._upgradeConnection((err=>{if(err){this._onError(new Error("Error initiating TLS - "+(err.message||err)),"ETLS",false,"CONN");return}this._onConnect()}))))}else{setImmediate((()=>this._onConnect()))}return}else if(this.options.socket){this._socket=this.options.socket;return shared.resolveHostname(opts,((err,resolved)=>{if(err){return setImmediate((()=>this._onError(err,"EDNS",false,"CONN")))}this.logger.debug({tnx:"dns",source:opts.host,resolved:resolved.host,cached:!!resolved.cached},"Resolved %s as %s [cache %s]",opts.host,resolved.host,resolved.cached?"hit":"miss");Object.keys(resolved).forEach((key=>{if(key.charAt(0)!=="_"&&resolved[key]){opts[key]=resolved[key]}}));try{this._socket.connect(this.port,this.host,(()=>{this._socket.setKeepAlive(true);this._onConnect()}));setupConnectionHandlers()}catch(E){return setImmediate((()=>this._onError(E,"ECONNECTION",false,"CONN")))}}))}else if(this.secureConnection){if(this.options.tls){Object.keys(this.options.tls).forEach((key=>{opts[key]=this.options.tls[key]}))}return shared.resolveHostname(opts,((err,resolved)=>{if(err){return setImmediate((()=>this._onError(err,"EDNS",false,"CONN")))}this.logger.debug({tnx:"dns",source:opts.host,resolved:resolved.host,cached:!!resolved.cached},"Resolved %s as %s [cache %s]",opts.host,resolved.host,resolved.cached?"hit":"miss");Object.keys(resolved).forEach((key=>{if(key.charAt(0)!=="_"&&resolved[key]){opts[key]=resolved[key]}}));try{this._socket=tls.connect(opts,(()=>{this._socket.setKeepAlive(true);this._onConnect()}));setupConnectionHandlers()}catch(E){return setImmediate((()=>this._onError(E,"ECONNECTION",false,"CONN")))}}))}else{return shared.resolveHostname(opts,((err,resolved)=>{if(err){return setImmediate((()=>this._onError(err,"EDNS",false,"CONN")))}this.logger.debug({tnx:"dns",source:opts.host,resolved:resolved.host,cached:!!resolved.cached},"Resolved %s as %s [cache %s]",opts.host,resolved.host,resolved.cached?"hit":"miss");Object.keys(resolved).forEach((key=>{if(key.charAt(0)!=="_"&&resolved[key]){opts[key]=resolved[key]}}));try{this._socket=net.connect(opts,(()=>{this._socket.setKeepAlive(true);this._onConnect()}));setupConnectionHandlers()}catch(E){return setImmediate((()=>this._onError(E,"ECONNECTION",false,"CONN")))}}))}}quit(){this._sendCommand("QUIT");this._responseActions.push(this.close)}close(){clearTimeout(this._connectionTimeout);clearTimeout(this._greetingTimeout);this._responseActions=[];if(this._closing){return}this._closing=true;let closeMethod="end";if(this.stage==="init"){closeMethod="destroy"}this.logger.debug({tnx:"smtp"},'Closing connection to the server using "%s"',closeMethod);let socket=this._socket&&this._socket.socket||this._socket;if(socket&&!socket.destroyed){try{this._socket[closeMethod]()}catch(E){}}this._destroy()}login(authData,callback){const isDestroyedMessage=this._isDestroyedMessage("login");if(isDestroyedMessage){return callback(this._formatError(isDestroyedMessage,"ECONNECTION",false,"API"))}this._auth=authData||{};this._authMethod=(this._auth.method||"").toString().trim().toUpperCase()||false;if(!this._authMethod&&this._auth.oauth2&&!this._auth.credentials){this._authMethod="XOAUTH2"}else if(!this._authMethod||this._authMethod==="XOAUTH2"&&!this._auth.oauth2){this._authMethod=(this._supportedAuth[0]||"PLAIN").toUpperCase().trim()}if(this._authMethod!=="XOAUTH2"&&(!this._auth.credentials||!this._auth.credentials.user||!this._auth.credentials.pass)){if(this._auth.user&&this._auth.pass||this.customAuth.has(this._authMethod)){this._auth.credentials={user:this._auth.user,pass:this._auth.pass,options:this._auth.options}}else{return callback(this._formatError('Missing credentials for "'+this._authMethod+'"',"EAUTH",false,"API"))}}if(this.customAuth.has(this._authMethod)){let handler=this.customAuth.get(this._authMethod);let lastResponse;let returned=false;let resolve=()=>{if(returned){return}returned=true;this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user));this.authenticated=true;callback(null,true)};let reject=err=>{if(returned){return}returned=true;callback(this._formatError(err,"EAUTH",lastResponse,"AUTH "+this._authMethod))};let handlerResponse=handler({auth:this._auth,method:this._authMethod,extensions:[].concat(this._supportedExtensions),authMethods:[].concat(this._supportedAuth),maxAllowedSize:this._maxAllowedSize||false,sendCommand:(cmd,done)=>{let promise;if(!done){promise=new Promise(((resolve,reject)=>{done=shared.callbackPromise(resolve,reject)}))}this._responseActions.push((str=>{lastResponse=str;let codes=str.match(/^(\d+)(?:\s(\d+\.\d+\.\d+))?\s/);let data={command:cmd,response:str};if(codes){data.status=Number(codes[1])||0;if(codes[2]){data.code=codes[2]}data.text=str.substr(codes[0].length)}else{data.text=str;data.status=0}done(null,data)}));setImmediate((()=>this._sendCommand(cmd)));return promise},resolve:resolve,reject:reject});if(handlerResponse&&typeof handlerResponse.catch==="function"){handlerResponse.then(resolve).catch(reject)}return}switch(this._authMethod){case"XOAUTH2":this._handleXOauth2Token(false,callback);return;case"LOGIN":this._responseActions.push((str=>{this._actionAUTH_LOGIN_USER(str,callback)}));this._sendCommand("AUTH LOGIN");return;case"PLAIN":this._responseActions.push((str=>{this._actionAUTHComplete(str,callback)}));this._sendCommand("AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0"+this._auth.credentials.pass,"utf-8").toString("base64"),"AUTH PLAIN "+Buffer.from("\0"+this._auth.credentials.user+"\0"+"/* secret */","utf-8").toString("base64"));return;case"CRAM-MD5":this._responseActions.push((str=>{this._actionAUTH_CRAM_MD5(str,callback)}));this._sendCommand("AUTH CRAM-MD5");return}return callback(this._formatError('Unknown authentication method "'+this._authMethod+'"',"EAUTH",false,"API"))}send(envelope,message,done){if(!message){return done(this._formatError("Empty message","EMESSAGE",false,"API"))}const isDestroyedMessage=this._isDestroyedMessage("send message");if(isDestroyedMessage){return done(this._formatError(isDestroyedMessage,"ECONNECTION",false,"API"))}if(this._maxAllowedSize&&envelope.size>this._maxAllowedSize){return setImmediate((()=>{done(this._formatError("Message size larger than allowed "+this._maxAllowedSize,"EMESSAGE",false,"MAIL FROM"))}))}let returned=false;let callback=function(){if(returned){return}returned=true;done(...arguments)};if(typeof message.on==="function"){message.on("error",(err=>callback(this._formatError(err,"ESTREAM",false,"API"))))}let startTime=Date.now();this._setEnvelope(envelope,((err,info)=>{if(err){return callback(err)}let envelopeTime=Date.now();let stream=this._createSendStream(((err,str)=>{if(err){return callback(err)}info.envelopeTime=envelopeTime-startTime;info.messageTime=Date.now()-envelopeTime;info.messageSize=stream.outByteCount;info.response=str;return callback(null,info)}));if(typeof message.pipe==="function"){message.pipe(stream)}else{stream.write(message);stream.end()}}))}reset(callback){this._sendCommand("RSET");this._responseActions.push((str=>{if(str.charAt(0)!=="2"){return callback(this._formatError("Could not reset session state. response="+str,"EPROTOCOL",str,"RSET"))}this._envelope=false;return callback(null,true)}))}_onConnect(){clearTimeout(this._connectionTimeout);this.logger.info({tnx:"network",localAddress:this._socket.localAddress,localPort:this._socket.localPort,remoteAddress:this._socket.remoteAddress,remotePort:this._socket.remotePort},"%s established to %s:%s",this.secure?"Secure connection":"Connection",this._socket.remoteAddress,this._socket.remotePort);if(this._destroyed){this.close();return}this.stage="connected";this._socket.removeListener("data",this._onSocketData);this._socket.removeListener("timeout",this._onSocketTimeout);this._socket.removeListener("close",this._onSocketClose);this._socket.removeListener("end",this._onSocketEnd);this._socket.on("data",this._onSocketData);this._socket.once("close",this._onSocketClose);this._socket.once("end",this._onSocketEnd);this._socket.setTimeout(this.options.socketTimeout||SOCKET_TIMEOUT);this._socket.on("timeout",this._onSocketTimeout);this._greetingTimeout=setTimeout((()=>{if(this._socket&&!this._destroyed&&this._responseActions[0]===this._actionGreeting){this._onError("Greeting never received","ETIMEDOUT",false,"CONN")}}),this.options.greetingTimeout||GREETING_TIMEOUT);this._responseActions.push(this._actionGreeting);this._socket.resume()}_onData(chunk){if(this._destroyed||!chunk||!chunk.length){return}let data=(chunk||"").toString("binary");let lines=(this._remainder+data).split(/\r?\n/);let lastline;this._remainder=lines.pop();for(let i=0,len=lines.length;i<len;i++){if(this._responseQueue.length){lastline=this._responseQueue[this._responseQueue.length-1];if(/^\d+-/.test(lastline.split("\n").pop())){this._responseQueue[this._responseQueue.length-1]+="\n"+lines[i];continue}}this._responseQueue.push(lines[i])}if(this._responseQueue.length){lastline=this._responseQueue[this._responseQueue.length-1];if(/^\d+-/.test(lastline.split("\n").pop())){return}}this._processResponse()}_onError(err,type,data,command){clearTimeout(this._connectionTimeout);clearTimeout(this._greetingTimeout);if(this._destroyed){return}err=this._formatError(err,type,data,command);this.logger.error(data,err.message);this.emit("error",err);this.close()}_formatError(message,type,response,command){let err;if(/Error\]$/i.test(Object.prototype.toString.call(message))){err=message}else{err=new Error(message)}if(type&&type!=="Error"){err.code=type}if(response){err.response=response;err.message+=": "+response}let responseCode=typeof response==="string"&&Number((response.match(/^\d+/)||[])[0])||false;if(responseCode){err.responseCode=responseCode}if(command){err.command=command}return err}_onClose(){let serverResponse=false;if(this._remainder&&this._remainder.trim()){if(this.options.debug||this.options.transactionLog){this.logger.debug({tnx:"server"},this._remainder.replace(/\r?\n$/,""))}this.lastServerResponse=serverResponse=this._remainder.trim()}this.logger.info({tnx:"network"},"Connection closed");if(this.upgrading&&!this._destroyed){return this._onError(new Error("Connection closed unexpectedly"),"ETLS",serverResponse,"CONN")}else if(![this._actionGreeting,this.close].includes(this._responseActions[0])&&!this._destroyed){return this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",serverResponse,"CONN")}else if(/^[45]\d{2}\b/.test(serverResponse)){return this._onError(new Error("Connection closed unexpectedly"),"ECONNECTION",serverResponse,"CONN")}this._destroy()}_onEnd(){if(this._socket&&!this._socket.destroyed){this._socket.destroy()}}_onTimeout(){return this._onError(new Error("Timeout"),"ETIMEDOUT",false,"CONN")}_destroy(){if(this._destroyed){return}this._destroyed=true;this.emit("end")}_upgradeConnection(callback){this._socket.removeListener("data",this._onSocketData);this._socket.removeListener("timeout",this._onSocketTimeout);let socketPlain=this._socket;let opts={socket:this._socket,host:this.host};Object.keys(this.options.tls||{}).forEach((key=>{opts[key]=this.options.tls[key]}));this.upgrading=true;try{this._socket=tls.connect(opts,(()=>{this.secure=true;this.upgrading=false;this._socket.on("data",this._onSocketData);socketPlain.removeListener("close",this._onSocketClose);socketPlain.removeListener("end",this._onSocketEnd);return callback(null,true)}))}catch(err){return callback(err)}this._socket.on("error",this._onSocketError);this._socket.once("close",this._onSocketClose);this._socket.once("end",this._onSocketEnd);this._socket.setTimeout(this.options.socketTimeout||SOCKET_TIMEOUT);this._socket.on("timeout",this._onSocketTimeout);socketPlain.resume()}_processResponse(){if(!this._responseQueue.length){return false}let str=this.lastServerResponse=(this._responseQueue.shift()||"").toString();if(/^\d+-/.test(str.split("\n").pop())){return}if(this.options.debug||this.options.transactionLog){this.logger.debug({tnx:"server"},str.replace(/\r?\n$/,""))}if(!str.trim()){setImmediate((()=>this._processResponse()))}let action=this._responseActions.shift();if(typeof action==="function"){action.call(this,str);setImmediate((()=>this._processResponse()))}else{return this._onError(new Error("Unexpected Response"),"EPROTOCOL",str,"CONN")}}_sendCommand(str,logStr){if(this._destroyed){return}if(this._socket.destroyed){return this.close()}if(this.options.debug||this.options.transactionLog){this.logger.debug({tnx:"client"},(logStr||str||"").toString().replace(/\r?\n$/,""))}this._socket.write(Buffer.from(str+"\r\n","utf-8"))}_setEnvelope(envelope,callback){let args=[];let useSmtpUtf8=false;this._envelope=envelope||{};this._envelope.from=(this._envelope.from&&this._envelope.from.address||this._envelope.from||"").toString().trim();this._envelope.to=[].concat(this._envelope.to||[]).map((to=>(to&&to.address||to||"").toString().trim()));if(!this._envelope.to.length){return callback(this._formatError("No recipients defined","EENVELOPE",false,"API"))}if(this._envelope.from&&/[\r\n<>]/.test(this._envelope.from)){return callback(this._formatError("Invalid sender "+JSON.stringify(this._envelope.from),"EENVELOPE",false,"API"))}if(/[\x80-\uFFFF]/.test(this._envelope.from)){useSmtpUtf8=true}for(let i=0,len=this._envelope.to.length;i<len;i++){if(!this._envelope.to[i]||/[\r\n<>]/.test(this._envelope.to[i])){return callback(this._formatError("Invalid recipient "+JSON.stringify(this._envelope.to[i]),"EENVELOPE",false,"API"))}if(/[\x80-\uFFFF]/.test(this._envelope.to[i])){useSmtpUtf8=true}}this._envelope.rcptQueue=JSON.parse(JSON.stringify(this._envelope.to||[]));this._envelope.rejected=[];this._envelope.rejectedErrors=[];this._envelope.accepted=[];if(this._envelope.dsn){try{this._envelope.dsn=this._setDsnEnvelope(this._envelope.dsn)}catch(err){return callback(this._formatError("Invalid DSN "+err.message,"EENVELOPE",false,"API"))}}this._responseActions.push((str=>{this._actionMAIL(str,callback)}));if(useSmtpUtf8&&this._supportedExtensions.includes("SMTPUTF8")){args.push("SMTPUTF8");this._usingSmtpUtf8=true}if(this._envelope.use8BitMime&&this._supportedExtensions.includes("8BITMIME")){args.push("BODY=8BITMIME");this._using8BitMime=true}if(this._envelope.size&&this._supportedExtensions.includes("SIZE")){args.push("SIZE="+this._envelope.size)}if(this._envelope.dsn&&this._supportedExtensions.includes("DSN")){if(this._envelope.dsn.ret){args.push("RET="+shared.encodeXText(this._envelope.dsn.ret))}if(this._envelope.dsn.envid){args.push("ENVID="+shared.encodeXText(this._envelope.dsn.envid))}}this._sendCommand("MAIL FROM:<"+this._envelope.from+">"+(args.length?" "+args.join(" "):""))}_setDsnEnvelope(params){let ret=(params.ret||params.return||"").toString().toUpperCase()||null;if(ret){switch(ret){case"HDRS":case"HEADERS":ret="HDRS";break;case"FULL":case"BODY":ret="FULL";break}}if(ret&&!["FULL","HDRS"].includes(ret)){throw new Error("ret: "+JSON.stringify(ret))}let envid=(params.envid||params.id||"").toString()||null;let notify=params.notify||null;if(notify){if(typeof notify==="string"){notify=notify.split(",")}notify=notify.map((n=>n.trim().toUpperCase()));let validNotify=["NEVER","SUCCESS","FAILURE","DELAY"];let invaliNotify=notify.filter((n=>!validNotify.includes(n)));if(invaliNotify.length||notify.length>1&&notify.includes("NEVER")){throw new Error("notify: "+JSON.stringify(notify.join(",")))}notify=notify.join(",")}let orcpt=(params.recipient||params.orcpt||"").toString()||null;if(orcpt&&orcpt.indexOf(";")<0){orcpt="rfc822;"+orcpt}return{ret:ret,envid:envid,notify:notify,orcpt:orcpt}}_getDsnRcptToArgs(){let args=[];if(this._envelope.dsn&&this._supportedExtensions.includes("DSN")){if(this._envelope.dsn.notify){args.push("NOTIFY="+shared.encodeXText(this._envelope.dsn.notify))}if(this._envelope.dsn.orcpt){args.push("ORCPT="+shared.encodeXText(this._envelope.dsn.orcpt))}}return args.length?" "+args.join(" "):""}_createSendStream(callback){let dataStream=new DataStream;let logStream;if(this.options.lmtp){this._envelope.accepted.forEach(((recipient,i)=>{let final=i===this._envelope.accepted.length-1;this._responseActions.push((str=>{this._actionLMTPStream(recipient,final,str,callback)}))}))}else{this._responseActions.push((str=>{this._actionSMTPStream(str,callback)}))}dataStream.pipe(this._socket,{end:false});if(this.options.debug){logStream=new PassThrough;logStream.on("readable",(()=>{let chunk;while(chunk=logStream.read()){this.logger.debug({tnx:"message"},chunk.toString("binary").replace(/\r?\n$/,""))}}));dataStream.pipe(logStream)}dataStream.once("end",(()=>{this.logger.info({tnx:"message",inByteCount:dataStream.inByteCount,outByteCount:dataStream.outByteCount},"<%s bytes encoded mime message (source size %s bytes)>",dataStream.outByteCount,dataStream.inByteCount)}));return dataStream}_actionGreeting(str){clearTimeout(this._greetingTimeout);if(str.substr(0,3)!=="220"){this._onError(new Error("Invalid greeting. response="+str),"EPROTOCOL",str,"CONN");return}if(this.options.lmtp){this._responseActions.push(this._actionLHLO);this._sendCommand("LHLO "+this.name)}else{this._responseActions.push(this._actionEHLO);this._sendCommand("EHLO "+this.name)}}_actionLHLO(str){if(str.charAt(0)!=="2"){this._onError(new Error("Invalid LHLO. response="+str),"EPROTOCOL",str,"LHLO");return}this._actionEHLO(str)}_actionEHLO(str){let match;if(str.substr(0,3)==="421"){this._onError(new Error("Server terminates connection. response="+str),"ECONNECTION",str,"EHLO");return}if(str.charAt(0)!=="2"){if(this.options.requireTLS){this._onError(new Error("EHLO failed but HELO does not support required STARTTLS. response="+str),"ECONNECTION",str,"EHLO");return}this._responseActions.push(this._actionHELO);this._sendCommand("HELO "+this.name);return}this._ehloLines=str.split(/\r?\n/).map((line=>line.replace(/^\d+[ -]/,"").trim())).filter((line=>line)).slice(1);if(!this.secure&&!this.options.ignoreTLS&&(/[ -]STARTTLS\b/im.test(str)||this.options.requireTLS)){this._sendCommand("STARTTLS");this._responseActions.push(this._actionSTARTTLS);return}if(/[ -]SMTPUTF8\b/im.test(str)){this._supportedExtensions.push("SMTPUTF8")}if(/[ -]DSN\b/im.test(str)){this._supportedExtensions.push("DSN")}if(/[ -]8BITMIME\b/im.test(str)){this._supportedExtensions.push("8BITMIME")}if(/[ -]PIPELINING\b/im.test(str)){this._supportedExtensions.push("PIPELINING")}if(/[ -]AUTH\b/i.test(str)){this.allowsAuth=true}if(/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)PLAIN/i.test(str)){this._supportedAuth.push("PLAIN")}if(/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)LOGIN/i.test(str)){this._supportedAuth.push("LOGIN")}if(/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)CRAM-MD5/i.test(str)){this._supportedAuth.push("CRAM-MD5")}if(/[ -]AUTH(?:(\s+|=)[^\n]*\s+|\s+|=)XOAUTH2/i.test(str)){this._supportedAuth.push("XOAUTH2")}if(match=str.match(/[ -]SIZE(?:[ \t]+(\d+))?/im)){this._supportedExtensions.push("SIZE");this._maxAllowedSize=Number(match[1])||0}this.emit("connect")}_actionHELO(str){if(str.charAt(0)!=="2"){this._onError(new Error("Invalid HELO. response="+str),"EPROTOCOL",str,"HELO");return}this.allowsAuth=true;this.emit("connect")}_actionSTARTTLS(str){if(str.charAt(0)!=="2"){if(this.options.opportunisticTLS){this.logger.info({tnx:"smtp"},"Failed STARTTLS upgrade, continuing unencrypted");return this.emit("connect")}this._onError(new Error("Error upgrading connection with STARTTLS"),"ETLS",str,"STARTTLS");return}this._upgradeConnection(((err,secured)=>{if(err){this._onError(new Error("Error initiating TLS - "+(err.message||err)),"ETLS",false,"STARTTLS");return}this.logger.info({tnx:"smtp"},"Connection upgraded with STARTTLS");if(secured){if(this.options.lmtp){this._responseActions.push(this._actionLHLO);this._sendCommand("LHLO "+this.name)}else{this._responseActions.push(this._actionEHLO);this._sendCommand("EHLO "+this.name)}}else{this.emit("connect")}}))}_actionAUTH_LOGIN_USER(str,callback){if(!/^334[ -]/.test(str)){callback(this._formatError('Invalid login sequence while waiting for "334 VXNlcm5hbWU6"',"EAUTH",str,"AUTH LOGIN"));return}this._responseActions.push((str=>{this._actionAUTH_LOGIN_PASS(str,callback)}));this._sendCommand(Buffer.from(this._auth.credentials.user+"","utf-8").toString("base64"))}_actionAUTH_CRAM_MD5(str,callback){let challengeMatch=str.match(/^334\s+(.+)$/);let challengeString="";if(!challengeMatch){return callback(this._formatError("Invalid login sequence while waiting for server challenge string","EAUTH",str,"AUTH CRAM-MD5"))}else{challengeString=challengeMatch[1]}let base64decoded=Buffer.from(challengeString,"base64").toString("ascii"),hmacMD5=crypto.createHmac("md5",this._auth.credentials.pass);hmacMD5.update(base64decoded);let prepended=this._auth.credentials.user+" "+hmacMD5.digest("hex");this._responseActions.push((str=>{this._actionAUTH_CRAM_MD5_PASS(str,callback)}));this._sendCommand(Buffer.from(prepended).toString("base64"),Buffer.from(this._auth.credentials.user+" /* secret */").toString("base64"))}_actionAUTH_CRAM_MD5_PASS(str,callback){if(!str.match(/^235\s+/)){return callback(this._formatError('Invalid login sequence while waiting for "235"',"EAUTH",str,"AUTH CRAM-MD5"))}this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user));this.authenticated=true;callback(null,true)}_actionAUTH_LOGIN_PASS(str,callback){if(!/^334[ -]/.test(str)){return callback(this._formatError('Invalid login sequence while waiting for "334 UGFzc3dvcmQ6"',"EAUTH",str,"AUTH LOGIN"))}this._responseActions.push((str=>{this._actionAUTHComplete(str,callback)}));this._sendCommand(Buffer.from((this._auth.credentials.pass||"").toString(),"utf-8").toString("base64"),Buffer.from("/* secret */","utf-8").toString("base64"))}_actionAUTHComplete(str,isRetry,callback){if(!callback&&typeof isRetry==="function"){callback=isRetry;isRetry=false}if(str.substr(0,3)==="334"){this._responseActions.push((str=>{if(isRetry||this._authMethod!=="XOAUTH2"){this._actionAUTHComplete(str,true,callback)}else{setImmediate((()=>this._handleXOauth2Token(true,callback)))}}));this._sendCommand("");return}if(str.charAt(0)!=="2"){this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user));return callback(this._formatError("Invalid login","EAUTH",str,"AUTH "+this._authMethod))}this.logger.info({tnx:"smtp",username:this._auth.user,action:"authenticated",method:this._authMethod},"User %s authenticated",JSON.stringify(this._auth.user));this.authenticated=true;callback(null,true)}_actionMAIL(str,callback){let message,curRecipient;if(Number(str.charAt(0))!==2){if(this._usingSmtpUtf8&&/^550 /.test(str)&&/[\x80-\uFFFF]/.test(this._envelope.from)){message="Internationalized mailbox name not allowed"}else{message="Mail command failed"}return callback(this._formatError(message,"EENVELOPE",str,"MAIL FROM"))}if(!this._envelope.rcptQueue.length){return callback(this._formatError("Can't send mail - no recipients defined","EENVELOPE",false,"API"))}else{this._recipientQueue=[];if(this._supportedExtensions.includes("PIPELINING")){while(this._envelope.rcptQueue.length){curRecipient=this._envelope.rcptQueue.shift();this._recipientQueue.push(curRecipient);this._responseActions.push((str=>{this._actionRCPT(str,callback)}));this._sendCommand("RCPT TO:<"+curRecipient+">"+this._getDsnRcptToArgs())}}else{curRecipient=this._envelope.rcptQueue.shift();this._recipientQueue.push(curRecipient);this._responseActions.push((str=>{this._actionRCPT(str,callback)}));this._sendCommand("RCPT TO:<"+curRecipient+">"+this._getDsnRcptToArgs())}}}_actionRCPT(str,callback){let message,err,curRecipient=this._recipientQueue.shift();if(Number(str.charAt(0))!==2){if(this._usingSmtpUtf8&&/^553 /.test(str)&&/[\x80-\uFFFF]/.test(curRecipient)){message="Internationalized mailbox name not allowed"}else{message="Recipient command failed"}this._envelope.rejected.push(curRecipient);err=this._formatError(message,"EENVELOPE",str,"RCPT TO");err.recipient=curRecipient;this._envelope.rejectedErrors.push(err)}else{this._envelope.accepted.push(curRecipient)}if(!this._envelope.rcptQueue.length&&!this._recipientQueue.length){if(this._envelope.rejected.length<this._envelope.to.length){this._responseActions.push((str=>{this._actionDATA(str,callback)}));this._sendCommand("DATA")}else{err=this._formatError("Can't send mail - all recipients were rejected","EENVELOPE",str,"RCPT TO");err.rejected=this._envelope.rejected;err.rejectedErrors=this._envelope.rejectedErrors;return callback(err)}}else if(this._envelope.rcptQueue.length){curRecipient=this._envelope.rcptQueue.shift();this._recipientQueue.push(curRecipient);this._responseActions.push((str=>{this._actionRCPT(str,callback)}));this._sendCommand("RCPT TO:<"+curRecipient+">"+this._getDsnRcptToArgs())}}_actionDATA(str,callback){if(!/^[23]/.test(str)){return callback(this._formatError("Data command failed","EENVELOPE",str,"DATA"))}let response={accepted:this._envelope.accepted,rejected:this._envelope.rejected};if(this._ehloLines&&this._ehloLines.length){response.ehlo=this._ehloLines}if(this._envelope.rejectedErrors.length){response.rejectedErrors=this._envelope.rejectedErrors}callback(null,response)}_actionSMTPStream(str,callback){if(Number(str.charAt(0))!==2){return callback(this._formatError("Message failed","EMESSAGE",str,"DATA"))}else{return callback(null,str)}}_actionLMTPStream(recipient,final,str,callback){let err;if(Number(str.charAt(0))!==2){err=this._formatError("Message failed for recipient "+recipient,"EMESSAGE",str,"DATA");err.recipient=recipient;this._envelope.rejected.push(recipient);this._envelope.rejectedErrors.push(err);for(let i=0,len=this._envelope.accepted.length;i<len;i++){if(this._envelope.accepted[i]===recipient){this._envelope.accepted.splice(i,1)}}}if(final){return callback(null,str)}}_handleXOauth2Token(isRetry,callback){this._auth.oauth2.getToken(isRetry,((err,accessToken)=>{if(err){this.logger.info({tnx:"smtp",username:this._auth.user,action:"authfail",method:this._authMethod},"User %s failed to authenticate",JSON.stringify(this._auth.user));return callback(this._formatError(err,"EAUTH",false,"AUTH XOAUTH2"))}this._responseActions.push((str=>{this._actionAUTHComplete(str,isRetry,callback)}));this._sendCommand("AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token(accessToken),"AUTH XOAUTH2 "+this._auth.oauth2.buildXOAuth2Token("/* secret */"))}))}_isDestroyedMessage(command){if(this._destroyed){return"Cannot "+command+" - smtp connection is already destroyed."}if(this._socket){if(this._socket.destroyed){return"Cannot "+command+" - smtp connection socket is already destroyed."}if(!this._socket.writable){return"Cannot "+command+" - smtp connection socket is already half-closed."}}}_getHostname(){let defaultHostname;try{defaultHostname=os.hostname()||""}catch(err){defaultHostname="localhost"}if(!defaultHostname||defaultHostname.indexOf(".")<0){defaultHostname="[127.0.0.1]"}if(defaultHostname.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)){defaultHostname="["+defaultHostname+"]"}return defaultHostname}}module.exports=SMTPConnection}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{"../../package.json":326,"../shared":315,"./data-stream":316,buffer:88,crypto:118,events:187,net:88,os:336,stream:398,timers:433,tls:88}],319:[function(require,module,exports){(function(setImmediate){(function(){"use strict";const EventEmitter=require("events");const PoolResource=require("./pool-resource");const SMTPConnection=require("../smtp-connection");const wellKnown=require("../well-known");const shared=require("../shared");const packageData=require("../../package.json");class SMTPPool extends EventEmitter{constructor(options){super();options=options||{};if(typeof options==="string"){options={url:options}}let urlData;let service=options.service;if(typeof options.getSocket==="function"){this.getSocket=options.getSocket}if(options.url){urlData=shared.parseConnectionUrl(options.url);service=service||urlData.service}this.options=shared.assign(false,options,urlData,service&&wellKnown(service));this.options.maxConnections=this.options.maxConnections||5;this.options.maxMessages=this.options.maxMessages||100;this.logger=shared.getLogger(this.options,{component:this.options.component||"smtp-pool"});let connection=new SMTPConnection(this.options);this.name="SMTP (pool)";this.version=packageData.version+"[client:"+connection.version+"]";this._rateLimit={counter:0,timeout:null,waiting:[],checkpoint:false,delta:Number(this.options.rateDelta)||1e3,limit:Number(this.options.rateLimit)||0};this._closed=false;this._queue=[];this._connections=[];this._connectionCounter=0;this.idling=true;setImmediate((()=>{if(this.idling){this.emit("idle")}}))}getSocket(options,callback){return setImmediate((()=>callback(null,false)))}send(mail,callback){if(this._closed){return false}this._queue.push({mail:mail,requeueAttempts:0,callback:callback});if(this.idling&&this._queue.length>=this.options.maxConnections){this.idling=false}setImmediate((()=>this._processMessages()));return true}close(){let connection;let len=this._connections.length;this._closed=true;clearTimeout(this._rateLimit.timeout);if(!len&&!this._queue.length){return}for(let i=len-1;i>=0;i--){if(this._connections[i]&&this._connections[i].available){connection=this._connections[i];connection.close();this.logger.info({tnx:"connection",cid:connection.id,action:"removed"},"Connection #%s removed",connection.id)}}if(len&&!this._connections.length){this.logger.debug({tnx:"connection"},"All connections removed")}if(!this._queue.length){return}let invokeCallbacks=()=>{if(!this._queue.length){this.logger.debug({tnx:"connection"},"Pending queue entries cleared");return}let entry=this._queue.shift();if(entry&&typeof entry.callback==="function"){try{entry.callback(new Error("Connection pool was closed"))}catch(E){this.logger.error({err:E,tnx:"callback",cid:connection.id},"Callback error for #%s: %s",connection.id,E.message)}}setImmediate(invokeCallbacks)};setImmediate(invokeCallbacks)}_processMessages(){let connection;let i,len;if(this._closed){return}if(!this._queue.length){if(!this.idling){this.idling=true;this.emit("idle")}return}for(i=0,len=this._connections.length;i<len;i++){if(this._connections[i].available){connection=this._connections[i];break}}if(!connection&&this._connections.length<this.options.maxConnections){connection=this._createConnection()}if(!connection){this.idling=false;return}if(!this.idling&&this._queue.length<this.options.maxConnections){this.idling=true;this.emit("idle")}let entry=connection.queueEntry=this._queue.shift();entry.messageId=(connection.queueEntry.mail.message.getHeader("message-id")||"").replace(/[<>\s]/g,"");connection.available=false;this.logger.debug({tnx:"pool",cid:connection.id,messageId:entry.messageId,action:"assign"},"Assigned message <%s> to #%s (%s)",entry.messageId,connection.id,connection.messages+1);if(this._rateLimit.limit){this._rateLimit.counter++;if(!this._rateLimit.checkpoint){this._rateLimit.checkpoint=Date.now()}}connection.send(entry.mail,((err,info)=>{if(entry===connection.queueEntry){try{entry.callback(err,info)}catch(E){this.logger.error({err:E,tnx:"callback",cid:connection.id},"Callback error for #%s: %s",connection.id,E.message)}connection.queueEntry=false}}))}_createConnection(){let connection=new PoolResource(this);connection.id=++this._connectionCounter;this.logger.info({tnx:"pool",cid:connection.id,action:"conection"},"Created new pool resource #%s",connection.id);connection.on("available",(()=>{this.logger.debug({tnx:"connection",cid:connection.id,action:"available"},"Connection #%s became available",connection.id);if(this._closed){this.close()}else{this._processMessages()}}));connection.once("error",(err=>{if(err.code!=="EMAXLIMIT"){this.logger.error({err:err,tnx:"pool",cid:connection.id},"Pool Error for #%s: %s",connection.id,err.message)}else{this.logger.debug({tnx:"pool",cid:connection.id,action:"maxlimit"},"Max messages limit exchausted for #%s",connection.id)}if(connection.queueEntry){try{connection.queueEntry.callback(err)}catch(E){this.logger.error({err:E,tnx:"callback",cid:connection.id},"Callback error for #%s: %s",connection.id,E.message)}connection.queueEntry=false}this._removeConnection(connection);this._continueProcessing()}));connection.once("close",(()=>{this.logger.info({tnx:"connection",cid:connection.id,action:"closed"},"Connection #%s was closed",connection.id);this._removeConnection(connection);if(connection.queueEntry){setTimeout((()=>{if(connection.queueEntry){if(this._shouldRequeuOnConnectionClose(connection.queueEntry)){this._requeueEntryOnConnectionClose(connection)}else{this._failDeliveryOnConnectionClose(connection)}}this._continueProcessing()}),50)}else{this._continueProcessing()}}));this._connections.push(connection);return connection}_shouldRequeuOnConnectionClose(queueEntry){if(this.options.maxRequeues===undefined||this.options.maxRequeues<0){return true}return queueEntry.requeueAttempts<this.options.maxRequeues}_failDeliveryOnConnectionClose(connection){if(connection.queueEntry&&connection.queueEntry.callback){try{connection.queueEntry.callback(new Error("Reached maximum number of retries after connection was closed"))}catch(E){this.logger.error({err:E,tnx:"callback",messageId:connection.queueEntry.messageId,cid:connection.id},"Callback error for #%s: %s",connection.id,E.message)}connection.queueEntry=false}}_requeueEntryOnConnectionClose(connection){connection.queueEntry.requeueAttempts=connection.queueEntry.requeueAttempts+1;this.logger.debug({tnx:"pool",cid:connection.id,messageId:connection.queueEntry.messageId,action:"requeue"},"Re-queued message <%s> for #%s. Attempt: #%s",connection.queueEntry.messageId,connection.id,connection.queueEntry.requeueAttempts);this._queue.unshift(connection.queueEntry);connection.queueEntry=false}_continueProcessing(){if(this._closed){this.close()}else{setTimeout((()=>this._processMessages()),100)}}_removeConnection(connection){let index=this._connections.indexOf(connection);if(index!==-1){this._connections.splice(index,1)}}_checkRateLimit(callback){if(!this._rateLimit.limit){return callback()}let now=Date.now();if(this._rateLimit.counter<this._rateLimit.limit){return callback()}this._rateLimit.waiting.push(callback);if(this._rateLimit.checkpoint<=now-this._rateLimit.delta){return this._clearRateLimit()}else if(!this._rateLimit.timeout){this._rateLimit.timeout=setTimeout((()=>this._clearRateLimit()),this._rateLimit.delta-(now-this._rateLimit.checkpoint));this._rateLimit.checkpoint=now}}_clearRateLimit(){clearTimeout(this._rateLimit.timeout);this._rateLimit.timeout=null;this._rateLimit.counter=0;this._rateLimit.checkpoint=false;while(this._rateLimit.waiting.length){let cb=this._rateLimit.waiting.shift();setImmediate(cb)}}isIdle(){return this.idling}verify(callback){let promise;if(!callback){promise=new Promise(((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)}))}let auth=new PoolResource(this).auth;this.getSocket(this.options,((err,socketOptions)=>{if(err){return callback(err)}let options=this.options;if(socketOptions&&socketOptions.connection){this.logger.info({tnx:"proxy",remoteAddress:socketOptions.connection.remoteAddress,remotePort:socketOptions.connection.remotePort,destHost:options.host||"",destPort:options.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",socketOptions.connection.remoteAddress,socketOptions.connection.remotePort,options.host||"",options.port||"");options=shared.assign(false,options);Object.keys(socketOptions).forEach((key=>{options[key]=socketOptions[key]}))}let connection=new SMTPConnection(options);let returned=false;connection.once("error",(err=>{if(returned){return}returned=true;connection.close();return callback(err)}));connection.once("end",(()=>{if(returned){return}returned=true;return callback(new Error("Connection closed"))}));let finalize=()=>{if(returned){return}returned=true;connection.quit();return callback(null,true)};connection.connect((()=>{if(returned){return}if(auth&&(connection.allowsAuth||options.forceAuth)){connection.login(auth,(err=>{if(returned){return}if(err){returned=true;connection.close();return callback(err)}finalize()}))}else if(!auth&&connection.allowsAuth&&options.forceAuth){let err=new Error("Authentication info was not provided");err.code="NoAuth";returned=true;connection.close();return callback(err)}else{finalize()}}))}));return promise}}module.exports=SMTPPool}).call(this)}).call(this,require("timers").setImmediate)},{"../../package.json":326,"../shared":315,"../smtp-connection":318,"../well-known":323,"./pool-resource":320,events:187,timers:433}],320:[function(require,module,exports){(function(setImmediate){(function(){"use strict";const SMTPConnection=require("../smtp-connection");const assign=require("../shared").assign;const XOAuth2=require("../xoauth2");const EventEmitter=require("events");class PoolResource extends EventEmitter{constructor(pool){super();this.pool=pool;this.options=pool.options;this.logger=this.pool.logger;if(this.options.auth){switch((this.options.auth.type||"").toString().toUpperCase()){case"OAUTH2":{let oauth2=new XOAuth2(this.options.auth,this.logger);oauth2.provisionCallback=this.pool.mailer&&this.pool.mailer.get("oauth2_provision_cb")||oauth2.provisionCallback;this.auth={type:"OAUTH2",user:this.options.auth.user,oauth2:oauth2,method:"XOAUTH2"};oauth2.on("token",(token=>this.pool.mailer.emit("token",token)));oauth2.on("error",(err=>this.emit("error",err)));break}default:if(!this.options.auth.user&&!this.options.auth.pass){break}this.auth={type:(this.options.auth.type||"").toString().toUpperCase()||"LOGIN",user:this.options.auth.user,credentials:{user:this.options.auth.user||"",pass:this.options.auth.pass,options:this.options.auth.options},method:(this.options.auth.method||"").trim().toUpperCase()||this.options.authMethod||false}}}this._connection=false;this._connected=false;this.messages=0;this.available=true}connect(callback){this.pool.getSocket(this.options,((err,socketOptions)=>{if(err){return callback(err)}let returned=false;let options=this.options;if(socketOptions&&socketOptions.connection){this.logger.info({tnx:"proxy",remoteAddress:socketOptions.connection.remoteAddress,remotePort:socketOptions.connection.remotePort,destHost:options.host||"",destPort:options.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",socketOptions.connection.remoteAddress,socketOptions.connection.remotePort,options.host||"",options.port||"");options=assign(false,options);Object.keys(socketOptions).forEach((key=>{options[key]=socketOptions[key]}))}this.connection=new SMTPConnection(options);this.connection.once("error",(err=>{this.emit("error",err);if(returned){return}returned=true;return callback(err)}));this.connection.once("end",(()=>{this.close();if(returned){return}returned=true;let timer=setTimeout((()=>{if(returned){return}let err=new Error("Unexpected socket close");if(this.connection&&this.connection._socket&&this.connection._socket.upgrading){err.code="ETLS"}callback(err)}),1e3);try{timer.unref()}catch(E){}}));this.connection.connect((()=>{if(returned){return}if(this.auth&&(this.connection.allowsAuth||options.forceAuth)){this.connection.login(this.auth,(err=>{if(returned){return}returned=true;if(err){this.connection.close();this.emit("error",err);return callback(err)}this._connected=true;callback(null,true)}))}else{returned=true;this._connected=true;return callback(null,true)}}))}))}send(mail,callback){if(!this._connected){return this.connect((err=>{if(err){return callback(err)}return this.send(mail,callback)}))}let envelope=mail.message.getEnvelope();let messageId=mail.message.messageId();let recipients=[].concat(envelope.to||[]);if(recipients.length>3){recipients.push("...and "+recipients.splice(2).length+" more")}this.logger.info({tnx:"send",messageId:messageId,cid:this.id},"Sending message %s using #%s to <%s>",messageId,this.id,recipients.join(", "));if(mail.data.dsn){envelope.dsn=mail.data.dsn}this.connection.send(envelope,mail.message.createReadStream(),((err,info)=>{this.messages++;if(err){this.connection.close();this.emit("error",err);return callback(err)}info.envelope={from:envelope.from,to:envelope.to};info.messageId=messageId;setImmediate((()=>{let err;if(this.messages>=this.options.maxMessages){err=new Error("Resource exhausted");err.code="EMAXLIMIT";this.connection.close();this.emit("error",err)}else{this.pool._checkRateLimit((()=>{this.available=true;this.emit("available")}))}}));callback(null,info)}))}close(){this._connected=false;if(this.auth&&this.auth.oauth2){this.auth.oauth2.removeAllListeners()}if(this.connection){this.connection.close()}this.emit("close")}}module.exports=PoolResource}).call(this)}).call(this,require("timers").setImmediate)},{"../shared":315,"../smtp-connection":318,"../xoauth2":325,events:187,timers:433}],321:[function(require,module,exports){(function(setImmediate){(function(){"use strict";const EventEmitter=require("events");const SMTPConnection=require("../smtp-connection");const wellKnown=require("../well-known");const shared=require("../shared");const XOAuth2=require("../xoauth2");const packageData=require("../../package.json");class SMTPTransport extends EventEmitter{constructor(options){super();options=options||{};if(typeof options==="string"){options={url:options}}let urlData;let service=options.service;if(typeof options.getSocket==="function"){this.getSocket=options.getSocket}if(options.url){urlData=shared.parseConnectionUrl(options.url);service=service||urlData.service}this.options=shared.assign(false,options,urlData,service&&wellKnown(service));this.logger=shared.getLogger(this.options,{component:this.options.component||"smtp-transport"});let connection=new SMTPConnection(this.options);this.name="SMTP";this.version=packageData.version+"[client:"+connection.version+"]";if(this.options.auth){this.auth=this.getAuth({})}}getSocket(options,callback){return setImmediate((()=>callback(null,false)))}getAuth(authOpts){if(!authOpts){return this.auth}let hasAuth=false;let authData={};if(this.options.auth&&typeof this.options.auth==="object"){Object.keys(this.options.auth).forEach((key=>{hasAuth=true;authData[key]=this.options.auth[key]}))}if(authOpts&&typeof authOpts==="object"){Object.keys(authOpts).forEach((key=>{hasAuth=true;authData[key]=authOpts[key]}))}if(!hasAuth){return false}switch((authData.type||"").toString().toUpperCase()){case"OAUTH2":{if(!authData.service&&!authData.user){return false}let oauth2=new XOAuth2(authData,this.logger);oauth2.provisionCallback=this.mailer&&this.mailer.get("oauth2_provision_cb")||oauth2.provisionCallback;oauth2.on("token",(token=>this.mailer.emit("token",token)));oauth2.on("error",(err=>this.emit("error",err)));return{type:"OAUTH2",user:authData.user,oauth2:oauth2,method:"XOAUTH2"}}default:return{type:(authData.type||"").toString().toUpperCase()||"LOGIN",user:authData.user,credentials:{user:authData.user||"",pass:authData.pass,options:authData.options},method:(authData.method||"").trim().toUpperCase()||this.options.authMethod||false}}}send(mail,callback){this.getSocket(this.options,((err,socketOptions)=>{if(err){return callback(err)}let returned=false;let options=this.options;if(socketOptions&&socketOptions.connection){this.logger.info({tnx:"proxy",remoteAddress:socketOptions.connection.remoteAddress,remotePort:socketOptions.connection.remotePort,destHost:options.host||"",destPort:options.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",socketOptions.connection.remoteAddress,socketOptions.connection.remotePort,options.host||"",options.port||"");options=shared.assign(false,options);Object.keys(socketOptions).forEach((key=>{options[key]=socketOptions[key]}))}let connection=new SMTPConnection(options);connection.once("error",(err=>{if(returned){return}returned=true;connection.close();return callback(err)}));connection.once("end",(()=>{if(returned){return}let timer=setTimeout((()=>{if(returned){return}returned=true;let err=new Error("Unexpected socket close");if(connection&&connection._socket&&connection._socket.upgrading){err.code="ETLS"}callback(err)}),1e3);try{timer.unref()}catch(E){}}));let sendMessage=()=>{let envelope=mail.message.getEnvelope();let messageId=mail.message.messageId();let recipients=[].concat(envelope.to||[]);if(recipients.length>3){recipients.push("...and "+recipients.splice(2).length+" more")}if(mail.data.dsn){envelope.dsn=mail.data.dsn}this.logger.info({tnx:"send",messageId:messageId},"Sending message %s to <%s>",messageId,recipients.join(", "));connection.send(envelope,mail.message.createReadStream(),((err,info)=>{returned=true;connection.close();if(err){this.logger.error({err:err,tnx:"send"},"Send error for %s: %s",messageId,err.message);return callback(err)}info.envelope={from:envelope.from,to:envelope.to};info.messageId=messageId;try{return callback(null,info)}catch(E){this.logger.error({err:E,tnx:"callback"},"Callback error for %s: %s",messageId,E.message)}}))};connection.connect((()=>{if(returned){return}let auth=this.getAuth(mail.data.auth);if(auth&&(connection.allowsAuth||options.forceAuth)){connection.login(auth,(err=>{if(auth&&auth!==this.auth&&auth.oauth2){auth.oauth2.removeAllListeners()}if(returned){return}if(err){returned=true;connection.close();return callback(err)}sendMessage()}))}else{sendMessage()}}))}))}verify(callback){let promise;if(!callback){promise=new Promise(((resolve,reject)=>{callback=shared.callbackPromise(resolve,reject)}))}this.getSocket(this.options,((err,socketOptions)=>{if(err){return callback(err)}let options=this.options;if(socketOptions&&socketOptions.connection){this.logger.info({tnx:"proxy",remoteAddress:socketOptions.connection.remoteAddress,remotePort:socketOptions.connection.remotePort,destHost:options.host||"",destPort:options.port||"",action:"connected"},"Using proxied socket from %s:%s to %s:%s",socketOptions.connection.remoteAddress,socketOptions.connection.remotePort,options.host||"",options.port||"");options=shared.assign(false,options);Object.keys(socketOptions).forEach((key=>{options[key]=socketOptions[key]}))}let connection=new SMTPConnection(options);let returned=false;connection.once("error",(err=>{if(returned){return}returned=true;connection.close();return callback(err)}));connection.once("end",(()=>{if(returned){return}returned=true;return callback(new Error("Connection closed"))}));let finalize=()=>{if(returned){return}returned=true;connection.quit();return callback(null,true)};connection.connect((()=>{if(returned){return}let authData=this.getAuth({});if(authData&&(connection.allowsAuth||options.forceAuth)){connection.login(authData,(err=>{if(returned){return}if(err){returned=true;connection.close();return callback(err)}finalize()}))}else if(!authData&&connection.allowsAuth&&options.forceAuth){let err=new Error("Authentication info was not provided");err.code="NoAuth";returned=true;connection.close();return callback(err)}else{finalize()}}))}));return promise}close(){if(this.auth&&this.auth.oauth2){this.auth.oauth2.removeAllListeners()}this.emit("close")}}module.exports=SMTPTransport}).call(this)}).call(this,require("timers").setImmediate)},{"../../package.json":326,"../shared":315,"../smtp-connection":318,"../well-known":323,"../xoauth2":325,events:187,timers:433}],322:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const packageData=require("../../package.json");const shared=require("../shared");class StreamTransport{constructor(options){options=options||{};this.options=options||{};this.name="StreamTransport";this.version=packageData.version;this.logger=shared.getLogger(this.options,{component:this.options.component||"stream-transport"});this.winbreak=["win","windows","dos","\r\n"].includes((options.newline||"").toString().toLowerCase())}send(mail,done){mail.message.keepBcc=true;let envelope=mail.data.envelope||mail.message.getEnvelope();let messageId=mail.message.messageId();let recipients=[].concat(envelope.to||[]);if(recipients.length>3){recipients.push("...and "+recipients.splice(2).length+" more")}this.logger.info({tnx:"send",messageId:messageId},"Sending message %s to <%s> using %s line breaks",messageId,recipients.join(", "),this.winbreak?"<CR><LF>":"<LF>");setImmediate((()=>{let stream;try{stream=mail.message.createReadStream()}catch(E){this.logger.error({err:E,tnx:"send",messageId:messageId},"Creating send stream failed for %s. %s",messageId,E.message);return done(E)}if(!this.options.buffer){stream.once("error",(err=>{this.logger.error({err:err,tnx:"send",messageId:messageId},"Failed creating message for %s. %s",messageId,err.message)}));return done(null,{envelope:mail.data.envelope||mail.message.getEnvelope(),messageId:messageId,message:stream})}let chunks=[];let chunklen=0;stream.on("readable",(()=>{let chunk;while((chunk=stream.read())!==null){chunks.push(chunk);chunklen+=chunk.length}}));stream.once("error",(err=>{this.logger.error({err:err,tnx:"send",messageId:messageId},"Failed creating message for %s. %s",messageId,err.message);return done(err)}));stream.on("end",(()=>done(null,{envelope:mail.data.envelope||mail.message.getEnvelope(),messageId:messageId,message:Buffer.concat(chunks,chunklen)})))}))}}module.exports=StreamTransport}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{"../../package.json":326,"../shared":315,buffer:88,timers:433}],323:[function(require,module,exports){"use strict";const services=require("./services.json");const normalized={};Object.keys(services).forEach((key=>{let service=services[key];normalized[normalizeKey(key)]=normalizeService(service);[].concat(service.aliases||[]).forEach((alias=>{normalized[normalizeKey(alias)]=normalizeService(service)}));[].concat(service.domains||[]).forEach((domain=>{normalized[normalizeKey(domain)]=normalizeService(service)}))}));function normalizeKey(key){return key.replace(/[^a-zA-Z0-9.-]/g,"").toLowerCase()}function normalizeService(service){let filter=["domains","aliases"];let response={};Object.keys(service).forEach((key=>{if(filter.indexOf(key)<0){response[key]=service[key]}}));return response}module.exports=function(key){key=normalizeKey(key.split("@").pop());return normalized[key]||false}},{"./services.json":324}],324:[function(require,module,exports){module.exports={"1und1":{host:"smtp.1und1.de",port:465,secure:true,authMethod:"LOGIN"},Aliyun:{domains:["aliyun.com"],host:"smtp.aliyun.com",port:465,secure:true},AOL:{domains:["aol.com"],host:"smtp.aol.com",port:587},Bluewin:{host:"smtpauths.bluewin.ch",domains:["bluewin.ch"],port:465},DebugMail:{host:"debugmail.io",port:25},DynectEmail:{aliases:["Dynect"],host:"smtp.dynect.net",port:25},Ethereal:{aliases:["ethereal.email"],host:"smtp.ethereal.email",port:587},FastMail:{domains:["fastmail.fm"],host:"smtp.fastmail.com",port:465,secure:true},"Forward Email":{aliases:["FE","ForwardEmail"],domains:["forwardemail.net"],host:"smtp.forwardemail.net",port:465,secure:true},GandiMail:{aliases:["Gandi","Gandi Mail"],host:"mail.gandi.net",port:587},Gmail:{aliases:["Google Mail"],domains:["gmail.com","googlemail.com"],host:"smtp.gmail.com",port:465,secure:true},Godaddy:{host:"smtpout.secureserver.net",port:25},GodaddyAsia:{host:"smtp.asia.secureserver.net",port:25},GodaddyEurope:{host:"smtp.europe.secureserver.net",port:25},"hot.ee":{host:"mail.hot.ee"},Hotmail:{aliases:["Outlook","Outlook.com","Hotmail.com"],domains:["hotmail.com","outlook.com"],host:"smtp-mail.outlook.com",port:587},iCloud:{aliases:["Me","Mac"],domains:["me.com","mac.com"],host:"smtp.mail.me.com",port:587},Infomaniak:{host:"mail.infomaniak.com",domains:["ik.me","ikmail.com","etik.com"],port:587},"mail.ee":{host:"smtp.mail.ee"},"Mail.ru":{host:"smtp.mail.ru",port:465,secure:true},Maildev:{port:1025,ignoreTLS:true},Mailgun:{host:"smtp.mailgun.org",port:465,secure:true},Mailjet:{host:"in.mailjet.com",port:587},Mailosaur:{host:"mailosaur.io",port:25},Mailtrap:{host:"smtp.mailtrap.io",port:2525},Mandrill:{host:"smtp.mandrillapp.com",port:587},Naver:{host:"smtp.naver.com",port:587},One:{host:"send.one.com",port:465,secure:true},OpenMailBox:{aliases:["OMB","openmailbox.org"],host:"smtp.openmailbox.org",port:465,secure:true},Outlook365:{host:"smtp.office365.com",port:587,secure:false},OhMySMTP:{host:"smtp.ohmysmtp.com",port:587,secure:false},Postmark:{aliases:["PostmarkApp"],host:"smtp.postmarkapp.com",port:2525},"qiye.aliyun":{host:"smtp.mxhichina.com",port:"465",secure:true},QQ:{domains:["qq.com"],host:"smtp.qq.com",port:465,secure:true},QQex:{aliases:["QQ Enterprise"],domains:["exmail.qq.com"],host:"smtp.exmail.qq.com",port:465,secure:true},SendCloud:{host:"smtp.sendcloud.net",port:2525},SendGrid:{host:"smtp.sendgrid.net",port:587},SendinBlue:{aliases:["Brevo"],host:"smtp-relay.brevo.com",port:587},SendPulse:{host:"smtp-pulse.com",port:465,secure:true},SES:{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:true},"SES-US-EAST-1":{host:"email-smtp.us-east-1.amazonaws.com",port:465,secure:true},"SES-US-WEST-2":{host:"email-smtp.us-west-2.amazonaws.com",port:465,secure:true},"SES-EU-WEST-1":{host:"email-smtp.eu-west-1.amazonaws.com",port:465,secure:true},"SES-AP-SOUTH-1":{host:"email-smtp.ap-south-1.amazonaws.com",port:465,secure:true},"SES-AP-NORTHEAST-1":{host:"email-smtp.ap-northeast-1.amazonaws.com",port:465,secure:true},"SES-AP-NORTHEAST-2":{host:"email-smtp.ap-northeast-2.amazonaws.com",port:465,secure:true},"SES-AP-NORTHEAST-3":{host:"email-smtp.ap-northeast-3.amazonaws.com",port:465,secure:true},"SES-AP-SOUTHEAST-1":{host:"email-smtp.ap-southeast-1.amazonaws.com",port:465,secure:true},"SES-AP-SOUTHEAST-2":{host:"email-smtp.ap-southeast-2.amazonaws.com",port:465,secure:true},Sparkpost:{aliases:["SparkPost","SparkPost Mail"],domains:["sparkpost.com"],host:"smtp.sparkpostmail.com",port:587,secure:false},Tipimail:{host:"smtp.tipimail.com",port:587},Yahoo:{domains:["yahoo.com"],host:"smtp.mail.yahoo.com",port:465,secure:true},Yandex:{domains:["yandex.ru"],host:"smtp.yandex.ru",port:465,secure:true},Zoho:{host:"smtp.zoho.com",port:465,secure:true,authMethod:"LOGIN"},126:{host:"smtp.126.com",port:465,secure:true},163:{host:"smtp.163.com",port:465,secure:true}}},{}],325:[function(require,module,exports){(function(Buffer,setImmediate){(function(){"use strict";const Stream=require("stream").Stream;const nmfetch=require("../fetch");const crypto=require("crypto");const shared=require("../shared");class XOAuth2 extends Stream{constructor(options,logger){super();this.options=options||{};if(options&&options.serviceClient){if(!options.privateKey||!options.user){setImmediate((()=>this.emit("error",new Error('Options "privateKey" and "user" are required for service account!'))));return}let serviceRequestTimeout=Math.min(Math.max(Number(this.options.serviceRequestTimeout)||0,0),3600);this.options.serviceRequestTimeout=serviceRequestTimeout||5*60}this.logger=shared.getLogger({logger:logger},{component:this.options.component||"OAuth2"});this.provisionCallback=typeof this.options.provisionCallback==="function"?this.options.provisionCallback:false;this.options.accessUrl=this.options.accessUrl||"https://accounts.google.com/o/oauth2/token";this.options.customHeaders=this.options.customHeaders||{};this.options.customParams=this.options.customParams||{};this.accessToken=this.options.accessToken||false;if(this.options.expires&&Number(this.options.expires)){this.expires=this.options.expires}else{let timeout=Math.max(Number(this.options.timeout)||0,0);this.expires=timeout&&Date.now()+timeout*1e3||0}}getToken(renew,callback){if(!renew&&this.accessToken&&(!this.expires||this.expires>Date.now())){return callback(null,this.accessToken)}let generateCallback=(...args)=>{if(args[0]){this.logger.error({err:args[0],tnx:"OAUTH2",user:this.options.user,action:"renew"},"Failed generating new Access Token for %s",this.options.user)}else{this.logger.info({tnx:"OAUTH2",user:this.options.user,action:"renew"},"Generated new Access Token for %s",this.options.user)}callback(...args)};if(this.provisionCallback){this.provisionCallback(this.options.user,!!renew,((err,accessToken,expires)=>{if(!err&&accessToken){this.accessToken=accessToken;this.expires=expires||0}generateCallback(err,accessToken)}))}else{this.generateToken(generateCallback)}}updateToken(accessToken,timeout){this.accessToken=accessToken;timeout=Math.max(Number(timeout)||0,0);this.expires=timeout&&Date.now()+timeout*1e3||0;this.emit("token",{user:this.options.user,accessToken:accessToken||"",expires:this.expires})}generateToken(callback){let urlOptions;let loggedUrlOptions;if(this.options.serviceClient){let iat=Math.floor(Date.now()/1e3);let tokenData={iss:this.options.serviceClient,scope:this.options.scope||"https://mail.google.com/",sub:this.options.user,aud:this.options.accessUrl,iat:iat,exp:iat+this.options.serviceRequestTimeout};let token;try{token=this.jwtSignRS256(tokenData)}catch(err){return callback(new Error("Can't generate token. Check your auth options"))}urlOptions={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:token};loggedUrlOptions={grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:tokenData}}else{if(!this.options.refreshToken){return callback(new Error("Can't create new access token for user"))}urlOptions={client_id:this.options.clientId||"",client_secret:this.options.clientSecret||"",refresh_token:this.options.refreshToken,grant_type:"refresh_token"};loggedUrlOptions={client_id:this.options.clientId||"",client_secret:(this.options.clientSecret||"").substr(0,6)+"...",refresh_token:(this.options.refreshToken||"").substr(0,6)+"...",grant_type:"refresh_token"}}Object.keys(this.options.customParams).forEach((key=>{urlOptions[key]=this.options.customParams[key];loggedUrlOptions[key]=this.options.customParams[key]}));this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"generate"},"Requesting token using: %s",JSON.stringify(loggedUrlOptions));this.postRequest(this.options.accessUrl,urlOptions,this.options,((error,body)=>{let data;if(error){return callback(error)}try{data=JSON.parse(body.toString())}catch(E){return callback(E)}if(!data||typeof data!=="object"){this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",(body||"").toString());return callback(new Error("Invalid authentication response"))}let logData={};Object.keys(data).forEach((key=>{if(key!=="access_token"){logData[key]=data[key]}else{logData[key]=(data[key]||"").toString().substr(0,6)+"..."}}));this.logger.debug({tnx:"OAUTH2",user:this.options.user,action:"post"},"Response: %s",JSON.stringify(logData));if(data.error){let errorMessage=data.error;if(data.error_description){errorMessage+=": "+data.error_description}if(data.error_uri){errorMessage+=" ("+data.error_uri+")"}return callback(new Error(errorMessage))}if(data.access_token){this.updateToken(data.access_token,data.expires_in);return callback(null,this.accessToken)}return callback(new Error("No access token"))}))}buildXOAuth2Token(accessToken){let authData=["user="+(this.options.user||""),"auth=Bearer "+(accessToken||this.accessToken),"",""];return Buffer.from(authData.join(""),"utf-8").toString("base64")}postRequest(url,payload,params,callback){let returned=false;let chunks=[];let chunklen=0;let req=nmfetch(url,{method:"post",headers:params.customHeaders,body:payload,allowErrorResponse:true});req.on("readable",(()=>{let chunk;while((chunk=req.read())!==null){chunks.push(chunk);chunklen+=chunk.length}}));req.once("error",(err=>{if(returned){return}returned=true;return callback(err)}));req.once("end",(()=>{if(returned){return}returned=true;return callback(null,Buffer.concat(chunks,chunklen))}))}toBase64URL(data){if(typeof data==="string"){data=Buffer.from(data)}return data.toString("base64").replace(/[=]+/g,"").replace(/\+/g,"-").replace(/\//g,"_")}jwtSignRS256(payload){payload=['{"alg":"RS256","typ":"JWT"}',JSON.stringify(payload)].map((val=>this.toBase64URL(val))).join(".");let signature=crypto.createSign("RSA-SHA256").update(payload).sign(this.options.privateKey);return payload+"."+this.toBase64URL(signature)}}module.exports=XOAuth2}).call(this)}).call(this,require("buffer").Buffer,require("timers").setImmediate)},{"../fetch":300,"../shared":315,buffer:88,crypto:118,stream:398,timers:433}],326:[function(require,module,exports){module.exports={name:"nodemailer",version:"6.9.7",description:"Easy as cake e-mail sending from your Node.js applications",main:"lib/nodemailer.js",scripts:{test:"grunt --trace-warnings",update:"rm -rf node_modules/ package-lock.json && ncu -u && npm install"},repository:{type:"git",url:"https://github.com/nodemailer/nodemailer.git"},keywords:["Nodemailer"],author:"Andris Reinman",license:"MIT-0",bugs:{url:"https://github.com/nodemailer/nodemailer/issues"},homepage:"https://nodemailer.com/",devDependencies:{"@aws-sdk/client-ses":"3.433.0","aws-sdk":"2.1478.0",bunyan:"1.8.15",chai:"4.3.10","eslint-config-nodemailer":"1.2.0","eslint-config-prettier":"9.0.0",grunt:"1.6.1","grunt-cli":"1.4.3","grunt-eslint":"24.3.0","grunt-mocha-test":"0.13.3",libbase64:"1.2.1",libmime:"5.2.1",libqp:"2.0.1",mocha:"10.2.0","nodemailer-ntlm-auth":"1.0.4",proxy:"1.0.2","proxy-test-server":"1.0.0",sinon:"17.0.0","smtp-server":"3.13.0"},engines:{node:">=6.0.0"}}},{}],327:[function(require,module,exports){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:true});exports.generate=exports.compile=void 0;var boolbase_1=__importDefault(require("boolbase"));function compile(parsed){var a=parsed[0];var b=parsed[1]-1;if(b<0&&a<=0)return boolbase_1.default.falseFunc;if(a===-1)return function(index){return index<=b};if(a===0)return function(index){return index===b};if(a===1)return b<0?boolbase_1.default.trueFunc:function(index){return index>=b};var absA=Math.abs(a);var bMod=(b%absA+absA)%absA;return a>1?function(index){return index>=b&&index%absA===bMod}:function(index){return index<=b&&index%absA===bMod}}exports.compile=compile;function generate(parsed){var a=parsed[0];var b=parsed[1]-1;var n=0;if(a<0){var aPos_1=-a;var minValue_1=(b%aPos_1+aPos_1)%aPos_1;return function(){var val=minValue_1+aPos_1*n++;return val>b?null:val}}if(a===0)return b<0?function(){return null}:function(){return n++===0?b:null};if(b<0){b+=a*Math.ceil(-b/a)}return function(){return a*n+++b}}exports.generate=generate},{boolbase:41}],328:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sequence=exports.generate=exports.compile=exports.parse=void 0;var parse_js_1=require("./parse.js");Object.defineProperty(exports,"parse",{enumerable:true,get:function(){return parse_js_1.parse}});var compile_js_1=require("./compile.js");Object.defineProperty(exports,"compile",{enumerable:true,get:function(){return compile_js_1.compile}});Object.defineProperty(exports,"generate",{enumerable:true,get:function(){return compile_js_1.generate}});function nthCheck(formula){return(0,compile_js_1.compile)((0,parse_js_1.parse)(formula))}exports.default=nthCheck;function sequence(formula){return(0,compile_js_1.generate)((0,parse_js_1.parse)(formula))}exports.sequence=sequence},{"./compile.js":327,"./parse.js":329}],329:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.parse=void 0;var whitespace=new Set([9,10,12,13,32]);var ZERO="0".charCodeAt(0);var NINE="9".charCodeAt(0);function parse(formula){formula=formula.trim().toLowerCase();if(formula==="even"){return[2,0]}else if(formula==="odd"){return[2,1]}var idx=0;var a=0;var sign=readSign();var number=readNumber();if(idx<formula.length&&formula.charAt(idx)==="n"){idx++;a=sign*(number!==null&&number!==void 0?number:1);skipWhitespace();if(idx<formula.length){sign=readSign();skipWhitespace();number=readNumber()}else{sign=number=0}}if(number===null||idx<formula.length){throw new Error("n-th rule couldn't be parsed ('".concat(formula,"')"))}return[a,sign*number];function readSign(){if(formula.charAt(idx)==="-"){idx++;return-1}if(formula.charAt(idx)==="+"){idx++}return 1}function readNumber(){var start=idx;var value=0;while(idx<formula.length&&formula.charCodeAt(idx)>=ZERO&&formula.charCodeAt(idx)<=NINE){value=value*10+(formula.charCodeAt(idx)-ZERO);idx++}return idx===start?null:value}function skipWhitespace(){while(idx<formula.length&&whitespace.has(formula.charCodeAt(idx))){idx++}}}exports.parse=parse},{}],330:[function(require,module,exports){var hasMap=typeof Map==="function"&&Map.prototype;var mapSizeDescriptor=Object.getOwnPropertyDescriptor&&hasMap?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null;var mapSize=hasMap&&mapSizeDescriptor&&typeof mapSizeDescriptor.get==="function"?mapSizeDescriptor.get:null;var mapForEach=hasMap&&Map.prototype.forEach;var hasSet=typeof Set==="function"&&Set.prototype;var setSizeDescriptor=Object.getOwnPropertyDescriptor&&hasSet?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null;var setSize=hasSet&&setSizeDescriptor&&typeof setSizeDescriptor.get==="function"?setSizeDescriptor.get:null;var setForEach=hasSet&&Set.prototype.forEach;var hasWeakMap=typeof WeakMap==="function"&&WeakMap.prototype;var weakMapHas=hasWeakMap?WeakMap.prototype.has:null;var hasWeakSet=typeof WeakSet==="function"&&WeakSet.prototype;var weakSetHas=hasWeakSet?WeakSet.prototype.has:null;var hasWeakRef=typeof WeakRef==="function"&&WeakRef.prototype;var weakRefDeref=hasWeakRef?WeakRef.prototype.deref:null;var booleanValueOf=Boolean.prototype.valueOf;var objectToString=Object.prototype.toString;var functionToString=Function.prototype.toString;var $match=String.prototype.match;var $slice=String.prototype.slice;var $replace=String.prototype.replace;var $toUpperCase=String.prototype.toUpperCase;var $toLowerCase=String.prototype.toLowerCase;var $test=RegExp.prototype.test;var $concat=Array.prototype.concat;var $join=Array.prototype.join;var $arrSlice=Array.prototype.slice;var $floor=Math.floor;var bigIntValueOf=typeof BigInt==="function"?BigInt.prototype.valueOf:null;var gOPS=Object.getOwnPropertySymbols;var symToString=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?Symbol.prototype.toString:null;var hasShammedSymbols=typeof Symbol==="function"&&typeof Symbol.iterator==="object";var toStringTag=typeof Symbol==="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===hasShammedSymbols?"object":"symbol")?Symbol.toStringTag:null;var isEnumerable=Object.prototype.propertyIsEnumerable;var gPO=(typeof Reflect==="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(O){return O.__proto__}:null);function addNumericSeparator(num,str){if(num===Infinity||num===-Infinity||num!==num||num&&num>-1e3&&num<1e3||$test.call(/e/,str)){return str}var sepRegex=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof num==="number"){var int=num<0?-$floor(-num):$floor(num);if(int!==num){var intStr=String(int);var dec=$slice.call(str,intStr.length+1);return $replace.call(intStr,sepRegex,"$&_")+"."+$replace.call($replace.call(dec,/([0-9]{3})/g,"$&_"),/_$/,"")}}return $replace.call(str,sepRegex,"$&_")}var utilInspect=require("./util.inspect");var inspectCustom=utilInspect.custom;var inspectSymbol=isSymbol(inspectCustom)?inspectCustom:null;module.exports=function inspect_(obj,options,depth,seen){var opts=options||{};if(has(opts,"quoteStyle")&&(opts.quoteStyle!=="single"&&opts.quoteStyle!=="double")){throw new TypeError('option "quoteStyle" must be "single" or "double"')}if(has(opts,"maxStringLength")&&(typeof opts.maxStringLength==="number"?opts.maxStringLength<0&&opts.maxStringLength!==Infinity:opts.maxStringLength!==null)){throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`')}var customInspect=has(opts,"customInspect")?opts.customInspect:true;if(typeof customInspect!=="boolean"&&customInspect!=="symbol"){throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`")}if(has(opts,"indent")&&opts.indent!==null&&opts.indent!=="\t"&&!(parseInt(opts.indent,10)===opts.indent&&opts.indent>0)){throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`')}if(has(opts,"numericSeparator")&&typeof opts.numericSeparator!=="boolean"){throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`')}var numericSeparator=opts.numericSeparator;if(typeof obj==="undefined"){return"undefined"}if(obj===null){return"null"}if(typeof obj==="boolean"){return obj?"true":"false"}if(typeof obj==="string"){return inspectString(obj,opts)}if(typeof obj==="number"){if(obj===0){return Infinity/obj>0?"0":"-0"}var str=String(obj);return numericSeparator?addNumericSeparator(obj,str):str}if(typeof obj==="bigint"){var bigIntStr=String(obj)+"n";return numericSeparator?addNumericSeparator(obj,bigIntStr):bigIntStr}var maxDepth=typeof opts.depth==="undefined"?5:opts.depth;if(typeof depth==="undefined"){depth=0}if(depth>=maxDepth&&maxDepth>0&&typeof obj==="object"){return isArray(obj)?"[Array]":"[Object]"}var indent=getIndent(opts,depth);if(typeof seen==="undefined"){seen=[]}else if(indexOf(seen,obj)>=0){return"[Circular]"}function inspect(value,from,noIndent){if(from){seen=$arrSlice.call(seen);seen.push(from)}if(noIndent){var newOpts={depth:opts.depth};if(has(opts,"quoteStyle")){newOpts.quoteStyle=opts.quoteStyle}return inspect_(value,newOpts,depth+1,seen)}return inspect_(value,opts,depth+1,seen)}if(typeof obj==="function"&&!isRegExp(obj)){var name=nameOf(obj);var keys=arrObjKeys(obj,inspect);return"[Function"+(name?": "+name:" (anonymous)")+"]"+(keys.length>0?" { "+$join.call(keys,", ")+" }":"")}if(isSymbol(obj)){var symString=hasShammedSymbols?$replace.call(String(obj),/^(Symbol\(.*\))_[^)]*$/,"$1"):symToString.call(obj);return typeof obj==="object"&&!hasShammedSymbols?markBoxed(symString):symString}if(isElement(obj)){var s="<"+$toLowerCase.call(String(obj.nodeName));var attrs=obj.attributes||[];for(var i=0;i<attrs.length;i++){s+=" "+attrs[i].name+"="+wrapQuotes(quote(attrs[i].value),"double",opts)}s+=">";if(obj.childNodes&&obj.childNodes.length){s+="..."}s+="</"+$toLowerCase.call(String(obj.nodeName))+">";return s}if(isArray(obj)){if(obj.length===0){return"[]"}var xs=arrObjKeys(obj,inspect);if(indent&&!singleLineValues(xs)){return"["+indentedJoin(xs,indent)+"]"}return"[ "+$join.call(xs,", ")+" ]"}if(isError(obj)){var parts=arrObjKeys(obj,inspect);if(!("cause"in Error.prototype)&&"cause"in obj&&!isEnumerable.call(obj,"cause")){return"{ ["+String(obj)+"] "+$join.call($concat.call("[cause]: "+inspect(obj.cause),parts),", ")+" }"}if(parts.length===0){return"["+String(obj)+"]"}return"{ ["+String(obj)+"] "+$join.call(parts,", ")+" }"}if(typeof obj==="object"&&customInspect){if(inspectSymbol&&typeof obj[inspectSymbol]==="function"&&utilInspect){return utilInspect(obj,{depth:maxDepth-depth})}else if(customInspect!=="symbol"&&typeof obj.inspect==="function"){return obj.inspect()}}if(isMap(obj)){var mapParts=[];if(mapForEach){mapForEach.call(obj,(function(value,key){mapParts.push(inspect(key,obj,true)+" => "+inspect(value,obj))}))}return collectionOf("Map",mapSize.call(obj),mapParts,indent)}if(isSet(obj)){var setParts=[];if(setForEach){setForEach.call(obj,(function(value){setParts.push(inspect(value,obj))}))}return collectionOf("Set",setSize.call(obj),setParts,indent)}if(isWeakMap(obj)){return weakCollectionOf("WeakMap")}if(isWeakSet(obj)){return weakCollectionOf("WeakSet")}if(isWeakRef(obj)){return weakCollectionOf("WeakRef")}if(isNumber(obj)){return markBoxed(inspect(Number(obj)))}if(isBigInt(obj)){return markBoxed(inspect(bigIntValueOf.call(obj)))}if(isBoolean(obj)){return markBoxed(booleanValueOf.call(obj))}if(isString(obj)){return markBoxed(inspect(String(obj)))}if(!isDate(obj)&&!isRegExp(obj)){var ys=arrObjKeys(obj,inspect);var isPlainObject=gPO?gPO(obj)===Object.prototype:obj instanceof Object||obj.constructor===Object;var protoTag=obj instanceof Object?"":"null prototype";var stringTag=!isPlainObject&&toStringTag&&Object(obj)===obj&&toStringTag in obj?$slice.call(toStr(obj),8,-1):protoTag?"Object":"";var constructorTag=isPlainObject||typeof obj.constructor!=="function"?"":obj.constructor.name?obj.constructor.name+" ":"";var tag=constructorTag+(stringTag||protoTag?"["+$join.call($concat.call([],stringTag||[],protoTag||[]),": ")+"] ":"");if(ys.length===0){return tag+"{}"}if(indent){return tag+"{"+indentedJoin(ys,indent)+"}"}return tag+"{ "+$join.call(ys,", ")+" }"}return String(obj)};function wrapQuotes(s,defaultStyle,opts){var quoteChar=(opts.quoteStyle||defaultStyle)==="double"?'"':"'";return quoteChar+s+quoteChar}function quote(s){return $replace.call(String(s),/"/g,"&quot;")}function isArray(obj){return toStr(obj)==="[object Array]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isDate(obj){return toStr(obj)==="[object Date]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isRegExp(obj){return toStr(obj)==="[object RegExp]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isError(obj){return toStr(obj)==="[object Error]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isString(obj){return toStr(obj)==="[object String]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isNumber(obj){return toStr(obj)==="[object Number]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isBoolean(obj){return toStr(obj)==="[object Boolean]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isSymbol(obj){if(hasShammedSymbols){return obj&&typeof obj==="object"&&obj instanceof Symbol}if(typeof obj==="symbol"){return true}if(!obj||typeof obj!=="object"||!symToString){return false}try{symToString.call(obj);return true}catch(e){}return false}function isBigInt(obj){if(!obj||typeof obj!=="object"||!bigIntValueOf){return false}try{bigIntValueOf.call(obj);return true}catch(e){}return false}var hasOwn=Object.prototype.hasOwnProperty||function(key){return key in this};function has(obj,key){return hasOwn.call(obj,key)}function toStr(obj){return objectToString.call(obj)}function nameOf(f){if(f.name){return f.name}var m=$match.call(functionToString.call(f),/^function\s*([\w$]+)/);if(m){return m[1]}return null}function indexOf(xs,x){if(xs.indexOf){return xs.indexOf(x)}for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x){return i}}return-1}function isMap(x){if(!mapSize||!x||typeof x!=="object"){return false}try{mapSize.call(x);try{setSize.call(x)}catch(s){return true}return x instanceof Map}catch(e){}return false}function isWeakMap(x){if(!weakMapHas||!x||typeof x!=="object"){return false}try{weakMapHas.call(x,weakMapHas);try{weakSetHas.call(x,weakSetHas)}catch(s){return true}return x instanceof WeakMap}catch(e){}return false}function isWeakRef(x){if(!weakRefDeref||!x||typeof x!=="object"){return false}try{weakRefDeref.call(x);return true}catch(e){}return false}function isSet(x){if(!setSize||!x||typeof x!=="object"){return false}try{setSize.call(x);try{mapSize.call(x)}catch(m){return true}return x instanceof Set}catch(e){}return false}function isWeakSet(x){if(!weakSetHas||!x||typeof x!=="object"){return false}try{weakSetHas.call(x,weakSetHas);try{weakMapHas.call(x,weakMapHas)}catch(s){return true}return x instanceof WeakSet}catch(e){}return false}function isElement(x){if(!x||typeof x!=="object"){return false}if(typeof HTMLElement!=="undefined"&&x instanceof HTMLElement){return true}return typeof x.nodeName==="string"&&typeof x.getAttribute==="function"}function inspectString(str,opts){if(str.length>opts.maxStringLength){var remaining=str.length-opts.maxStringLength;var trailer="... "+remaining+" more character"+(remaining>1?"s":"");return inspectString($slice.call(str,0,opts.maxStringLength),opts)+trailer}var s=$replace.call($replace.call(str,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,lowbyte);return wrapQuotes(s,"single",opts)}function lowbyte(c){var n=c.charCodeAt(0);var x={8:"b",9:"t",10:"n",12:"f",13:"r"}[n];if(x){return"\\"+x}return"\\x"+(n<16?"0":"")+$toUpperCase.call(n.toString(16))}function markBoxed(str){return"Object("+str+")"}function weakCollectionOf(type){return type+" { ? }"}function collectionOf(type,size,entries,indent){var joinedEntries=indent?indentedJoin(entries,indent):$join.call(entries,", ");return type+" ("+size+") {"+joinedEntries+"}"}function singleLineValues(xs){for(var i=0;i<xs.length;i++){if(indexOf(xs[i],"\n")>=0){return false}}return true}function getIndent(opts,depth){var baseIndent;if(opts.indent==="\t"){baseIndent="\t"}else if(typeof opts.indent==="number"&&opts.indent>0){baseIndent=$join.call(Array(opts.indent+1)," ")}else{return null}return{base:baseIndent,prev:$join.call(Array(depth+1),baseIndent)}}function indentedJoin(xs,indent){if(xs.length===0){return""}var lineJoiner="\n"+indent.prev+indent.base;return lineJoiner+$join.call(xs,","+lineJoiner)+"\n"+indent.prev}function arrObjKeys(obj,inspect){var isArr=isArray(obj);var xs=[];if(isArr){xs.length=obj.length;for(var i=0;i<obj.length;i++){xs[i]=has(obj,i)?inspect(obj[i],obj):""}}var syms=typeof gOPS==="function"?gOPS(obj):[];var symMap;if(hasShammedSymbols){symMap={};for(var k=0;k<syms.length;k++){symMap["$"+syms[k]]=syms[k]}}for(var key in obj){if(!has(obj,key)){continue}if(isArr&&String(Number(key))===key&&key<obj.length){continue}if(hasShammedSymbols&&symMap["$"+key]instanceof Symbol){continue}else if($test.call(/[^\w$]/,key)){xs.push(inspect(key,obj)+": "+inspect(obj[key],obj))}else{xs.push(key+": "+inspect(obj[key],obj))}}if(typeof gOPS==="function"){for(var j=0;j<syms.length;j++){if(isEnumerable.call(obj,syms[j])){xs.push("["+inspect(syms[j])+"]: "+inspect(obj[syms[j]],obj))}}}return xs}},{"./util.inspect":43}],331:[function(require,module,exports){"use strict";var keysShim;if(!Object.keys){var has=Object.prototype.hasOwnProperty;var toStr=Object.prototype.toString;var isArgs=require("./isArguments");var isEnumerable=Object.prototype.propertyIsEnumerable;var hasDontEnumBug=!isEnumerable.call({toString:null},"toString");var hasProtoEnumBug=isEnumerable.call((function(){}),"prototype");var dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o};var excludedKeys={$applicationCache:true,$console:true,$external:true,$frame:true,$frameElement:true,$frames:true,$innerHeight:true,$innerWidth:true,$onmozfullscreenchange:true,$onmozfullscreenerror:true,$outerHeight:true,$outerWidth:true,$pageXOffset:true,$pageYOffset:true,$parent:true,$scrollLeft:true,$scrollTop:true,$scrollX:true,$scrollY:true,$self:true,$webkitIndexedDB:true,$webkitStorageInfo:true,$window:true};var hasAutomationEqualityBug=function(){if(typeof window==="undefined"){return false}for(var k in window){try{if(!excludedKeys["$"+k]&&has.call(window,k)&&window[k]!==null&&typeof window[k]==="object"){try{equalsConstructorPrototype(window[k])}catch(e){return true}}}catch(e){return true}}return false}();var equalsConstructorPrototypeIfNotBuggy=function(o){if(typeof window==="undefined"||!hasAutomationEqualityBug){return equalsConstructorPrototype(o)}try{return equalsConstructorPrototype(o)}catch(e){return false}};keysShim=function keys(object){var isObject=object!==null&&typeof object==="object";var isFunction=toStr.call(object)==="[object Function]";var isArguments=isArgs(object);var isString=isObject&&toStr.call(object)==="[object String]";var theKeys=[];if(!isObject&&!isFunction&&!isArguments){throw new TypeError("Object.keys called on a non-object")}var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0)){for(var i=0;i<object.length;++i){theKeys.push(String(i))}}if(isArguments&&object.length>0){for(var j=0;j<object.length;++j){theKeys.push(String(j))}}else{for(var name in object){if(!(skipProto&&name==="prototype")&&has.call(object,name)){theKeys.push(String(name))}}}if(hasDontEnumBug){var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object);for(var k=0;k<dontEnums.length;++k){if(!(skipConstructor&&dontEnums[k]==="constructor")&&has.call(object,dontEnums[k])){theKeys.push(dontEnums[k])}}}return theKeys}}module.exports=keysShim},{"./isArguments":333}],332:[function(require,module,exports){"use strict";var slice=Array.prototype.slice;var isArgs=require("./isArguments");var origKeys=Object.keys;var keysShim=origKeys?function keys(o){return origKeys(o)}:require("./implementation");var originalKeys=Object.keys;keysShim.shim=function shimObjectKeys(){if(Object.keys){var keysWorksWithArguments=function(){var args=Object.keys(arguments);return args&&args.length===arguments.length}(1,2);if(!keysWorksWithArguments){Object.keys=function keys(object){if(isArgs(object)){return originalKeys(slice.call(object))}return originalKeys(object)}}}else{Object.keys=keysShim}return Object.keys||keysShim};module.exports=keysShim},{"./implementation":331,"./isArguments":333}],333:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;module.exports=function isArguments(value){var str=toStr.call(value);var isArgs=str==="[object Arguments]";if(!isArgs){isArgs=str!=="[object Array]"&&value!==null&&typeof value==="object"&&typeof value.length==="number"&&value.length>=0&&toStr.call(value.callee)==="[object Function]"}return isArgs}},{}],334:[function(require,module,exports){"use strict";var objectKeys=require("object-keys");var hasSymbols=require("has-symbols/shams")();var callBound=require("call-bind/callBound");var toObject=Object;var $push=callBound("Array.prototype.push");var $propIsEnumerable=callBound("Object.prototype.propertyIsEnumerable");var originalGetSymbols=hasSymbols?Object.getOwnPropertySymbols:null;module.exports=function assign(target,source1){if(target==null){throw new TypeError("target must be an object")}var to=toObject(target);if(arguments.length===1){return to}for(var s=1;s<arguments.length;++s){var from=toObject(arguments[s]);var keys=objectKeys(from);var getSymbols=hasSymbols&&(Object.getOwnPropertySymbols||originalGetSymbols);if(getSymbols){var syms=getSymbols(from);for(var j=0;j<syms.length;++j){var key=syms[j];if($propIsEnumerable(from,key)){$push(keys,key)}}}for(var i=0;i<keys.length;++i){var nextKey=keys[i];if($propIsEnumerable(from,nextKey)){var propValue=from[nextKey];to[nextKey]=propValue}}}return to}},{"call-bind/callBound":92,"has-symbols/shams":197,"object-keys":332}],335:[function(require,module,exports){"use strict";var implementation=require("./implementation");var lacksProperEnumerationOrder=function(){if(!Object.assign){return false}var str="abcdefghijklmnopqrst";var letters=str.split("");var map={};for(var i=0;i<letters.length;++i){map[letters[i]]=letters[i]}var obj=Object.assign({},map);var actual="";for(var k in obj){actual+=k}return str!==actual};var assignHasPendingExceptions=function(){if(!Object.assign||!Object.preventExtensions){return false}var thrower=Object.preventExtensions({1:2});try{Object.assign(thrower,"xy")}catch(e){return thrower[1]==="y"}return false};module.exports=function getPolyfill(){if(!Object.assign){return implementation}if(lacksProperEnumerationOrder()){return implementation}if(assignHasPendingExceptions()){return implementation}return Object.assign}},{"./implementation":334}],336:[function(require,module,exports){exports.endianness=function(){return"LE"};exports.hostname=function(){if(typeof location!=="undefined"){return location.hostname}else return""};exports.loadavg=function(){return[]};exports.uptime=function(){return 0};exports.freemem=function(){return Number.MAX_VALUE};exports.totalmem=function(){return Number.MAX_VALUE};exports.cpus=function(){return[]};exports.type=function(){return"Browser"};exports.release=function(){if(typeof navigator!=="undefined"){return navigator.appVersion}return""};exports.networkInterfaces=exports.getNetworkInterfaces=function(){return{}};exports.arch=function(){return"javascript"};exports.platform=function(){return"browser"};exports.tmpdir=exports.tmpDir=function(){return"/tmp"};exports.EOL="\n";exports.homedir=function(){return"/"}},{}],337:[function(require,module,exports){"use strict";var TYPED_OK=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";function _has(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}exports.assign=function(obj){var sources=Array.prototype.slice.call(arguments,1);while(sources.length){var source=sources.shift();if(!source){continue}if(typeof source!=="object"){throw new TypeError(source+"must be non-object")}for(var p in source){if(_has(source,p)){obj[p]=source[p]}}}return obj};exports.shrinkBuf=function(buf,size){if(buf.length===size){return buf}if(buf.subarray){return buf.subarray(0,size)}buf.length=size;return buf};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray){dest.set(src.subarray(src_offs,src_offs+len),dest_offs);return}for(var i=0;i<len;i++){dest[dest_offs+i]=src[src_offs+i]}},flattenChunks:function(chunks){var i,l,len,pos,chunk,result;len=0;for(i=0,l=chunks.length;i<l;i++){len+=chunks[i].length}result=new Uint8Array(len);pos=0;for(i=0,l=chunks.length;i<l;i++){chunk=chunks[i];result.set(chunk,pos);pos+=chunk.length}return result}};var fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i=0;i<len;i++){dest[dest_offs+i]=src[src_offs+i]}},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports.setTyped=function(on){if(on){exports.Buf8=Uint8Array;exports.Buf16=Uint16Array;exports.Buf32=Int32Array;exports.assign(exports,fnTyped)}else{exports.Buf8=Array;exports.Buf16=Array;exports.Buf32=Array;exports.assign(exports,fnUntyped)}};exports.setTyped(TYPED_OK)},{}],338:[function(require,module,exports){"use strict";function adler32(adler,buf,len,pos){var s1=adler&65535|0,s2=adler>>>16&65535|0,n=0;while(len!==0){n=len>2e3?2e3:len;len-=n;do{s1=s1+buf[pos++]|0;s2=s2+s1|0}while(--n);s1%=65521;s2%=65521}return s1|s2<<16|0}module.exports=adler32},{}],339:[function(require,module,exports){"use strict";module.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],340:[function(require,module,exports){"use strict";function makeTable(){var c,table=[];for(var n=0;n<256;n++){c=n;for(var k=0;k<8;k++){c=c&1?3988292384^c>>>1:c>>>1}table[n]=c}return table}var crcTable=makeTable();function crc32(crc,buf,len,pos){var t=crcTable,end=pos+len;crc^=-1;for(var i=pos;i<end;i++){crc=crc>>>8^t[(crc^buf[i])&255]}return crc^-1}module.exports=crc32},{}],341:[function(require,module,exports){"use strict";var utils=require("../utils/common");var trees=require("./trees");var adler32=require("./adler32");var crc32=require("./crc32");var msg=require("./messages");var Z_NO_FLUSH=0;var Z_PARTIAL_FLUSH=1;var Z_FULL_FLUSH=3;var Z_FINISH=4;var Z_BLOCK=5;var Z_OK=0;var Z_STREAM_END=1;var Z_STREAM_ERROR=-2;var Z_DATA_ERROR=-3;var Z_BUF_ERROR=-5;var Z_DEFAULT_COMPRESSION=-1;var Z_FILTERED=1;var Z_HUFFMAN_ONLY=2;var Z_RLE=3;var Z_FIXED=4;var Z_DEFAULT_STRATEGY=0;var Z_UNKNOWN=2;var Z_DEFLATED=8;var MAX_MEM_LEVEL=9;var MAX_WBITS=15;var DEF_MEM_LEVEL=8;var LENGTH_CODES=29;var LITERALS=256;var L_CODES=LITERALS+1+LENGTH_CODES;var D_CODES=30;var BL_CODES=19;var HEAP_SIZE=2*L_CODES+1;var MAX_BITS=15;var MIN_MATCH=3;var MAX_MATCH=258;var MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1;var PRESET_DICT=32;var INIT_STATE=42;var EXTRA_STATE=69;var NAME_STATE=73;var COMMENT_STATE=91;var HCRC_STATE=103;var BUSY_STATE=113;var FINISH_STATE=666;var BS_NEED_MORE=1;var BS_BLOCK_DONE=2;var BS_FINISH_STARTED=3;var BS_FINISH_DONE=4;var OS_CODE=3;function err(strm,errorCode){strm.msg=msg[errorCode];return errorCode}function rank(f){return(f<<1)-(f>4?9:0)}function zero(buf){var len=buf.length;while(--len>=0){buf[len]=0}}function flush_pending(strm){var s=strm.state;var len=s.pending;if(len>strm.avail_out){len=strm.avail_out}if(len===0){return}utils.arraySet(strm.output,s.pending_buf,s.pending_out,len,strm.next_out);strm.next_out+=len;s.pending_out+=len;strm.total_out+=len;strm.avail_out-=len;s.pending-=len;if(s.pending===0){s.pending_out=0}}function flush_block_only(s,last){trees._tr_flush_block(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,last);s.block_start=s.strstart;flush_pending(s.strm)}function put_byte(s,b){s.pending_buf[s.pending++]=b}function putShortMSB(s,b){s.pending_buf[s.pending++]=b>>>8&255;s.pending_buf[s.pending++]=b&255}function read_buf(strm,buf,start,size){var len=strm.avail_in;if(len>size){len=size}if(len===0){return 0}strm.avail_in-=len;utils.arraySet(buf,strm.input,strm.next_in,len,start);if(strm.state.wrap===1){strm.adler=adler32(strm.adler,buf,len,start)}else if(strm.state.wrap===2){strm.adler=crc32(strm.adler,buf,len,start)}strm.next_in+=len;strm.total_in+=len;return len}function longest_match(s,cur_match){var chain_length=s.max_chain_length;var scan=s.strstart;var match;var len;var best_len=s.prev_length;var nice_match=s.nice_match;var limit=s.strstart>s.w_size-MIN_LOOKAHEAD?s.strstart-(s.w_size-MIN_LOOKAHEAD):0;var _win=s.window;var wmask=s.w_mask;var prev=s.prev;var strend=s.strstart+MAX_MATCH;var scan_end1=_win[scan+best_len-1];var scan_end=_win[scan+best_len];if(s.prev_length>=s.good_match){chain_length>>=2}if(nice_match>s.lookahead){nice_match=s.lookahead}do{match=cur_match;if(_win[match+best_len]!==scan_end||_win[match+best_len-1]!==scan_end1||_win[match]!==_win[scan]||_win[++match]!==_win[scan+1]){continue}scan+=2;match++;do{}while(_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend);len=MAX_MATCH-(strend-scan);scan=strend-MAX_MATCH;if(len>best_len){s.match_start=cur_match;best_len=len;if(len>=nice_match){break}scan_end1=_win[scan+best_len-1];scan_end=_win[scan+best_len]}}while((cur_match=prev[cur_match&wmask])>limit&&--chain_length!==0);if(best_len<=s.lookahead){return best_len}return s.lookahead}function fill_window(s){var _w_size=s.w_size;var p,n,m,more,str;do{more=s.window_size-s.lookahead-s.strstart;if(s.strstart>=_w_size+(_w_size-MIN_LOOKAHEAD)){utils.arraySet(s.window,s.window,_w_size,_w_size,0);s.match_start-=_w_size;s.strstart-=_w_size;s.block_start-=_w_size;n=s.hash_size;p=n;do{m=s.head[--p];s.head[p]=m>=_w_size?m-_w_size:0}while(--n);n=_w_size;p=n;do{m=s.prev[--p];s.prev[p]=m>=_w_size?m-_w_size:0}while(--n);more+=_w_size}if(s.strm.avail_in===0){break}n=read_buf(s.strm,s.window,s.strstart+s.lookahead,more);s.lookahead+=n;if(s.lookahead+s.insert>=MIN_MATCH){str=s.strstart-s.insert;s.ins_h=s.window[str];s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+1])&s.hash_mask;while(s.insert){s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask;s.prev[str&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=str;str++;s.insert--;if(s.lookahead+s.insert<MIN_MATCH){break}}}}while(s.lookahead<MIN_LOOKAHEAD&&s.strm.avail_in!==0)}function deflate_stored(s,flush){var max_block_size=65535;if(max_block_size>s.pending_buf_size-5){max_block_size=s.pending_buf_size-5}for(;;){if(s.lookahead<=1){fill_window(s);if(s.lookahead===0&&flush===Z_NO_FLUSH){return BS_NEED_MORE}if(s.lookahead===0){break}}s.strstart+=s.lookahead;s.lookahead=0;var max_start=s.block_start+max_block_size;if(s.strstart===0||s.strstart>=max_start){s.lookahead=s.strstart-max_start;s.strstart=max_start;flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}if(s.strstart-s.block_start>=s.w_size-MIN_LOOKAHEAD){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}}s.insert=0;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0){return BS_FINISH_STARTED}return BS_FINISH_DONE}if(s.strstart>s.block_start){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}return BS_NEED_MORE}function deflate_fast(s,flush){var hash_head;var bflush;for(;;){if(s.lookahead<MIN_LOOKAHEAD){fill_window(s);if(s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH){return BS_NEED_MORE}if(s.lookahead===0){break}}hash_head=0;if(s.lookahead>=MIN_MATCH){s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask;hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=s.strstart}if(hash_head!==0&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD){s.match_length=longest_match(s,hash_head)}if(s.match_length>=MIN_MATCH){bflush=trees._tr_tally(s,s.strstart-s.match_start,s.match_length-MIN_MATCH);s.lookahead-=s.match_length;if(s.match_length<=s.max_lazy_match&&s.lookahead>=MIN_MATCH){s.match_length--;do{s.strstart++;s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask;hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=s.strstart}while(--s.match_length!==0);s.strstart++}else{s.strstart+=s.match_length;s.match_length=0;s.ins_h=s.window[s.strstart];s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask}}else{bflush=trees._tr_tally(s,0,s.window[s.strstart]);s.lookahead--;s.strstart++}if(bflush){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}}s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0){return BS_FINISH_STARTED}return BS_FINISH_DONE}if(s.last_lit){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}return BS_BLOCK_DONE}function deflate_slow(s,flush){var hash_head;var bflush;var max_insert;for(;;){if(s.lookahead<MIN_LOOKAHEAD){fill_window(s);if(s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH){return BS_NEED_MORE}if(s.lookahead===0){break}}hash_head=0;if(s.lookahead>=MIN_MATCH){s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask;hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=s.strstart}s.prev_length=s.match_length;s.prev_match=s.match_start;s.match_length=MIN_MATCH-1;if(hash_head!==0&&s.prev_length<s.max_lazy_match&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD){s.match_length=longest_match(s,hash_head);if(s.match_length<=5&&(s.strategy===Z_FILTERED||s.match_length===MIN_MATCH&&s.strstart-s.match_start>4096)){s.match_length=MIN_MATCH-1}}if(s.prev_length>=MIN_MATCH&&s.match_length<=s.prev_length){max_insert=s.strstart+s.lookahead-MIN_MATCH;bflush=trees._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-MIN_MATCH);s.lookahead-=s.prev_length-1;s.prev_length-=2;do{if(++s.strstart<=max_insert){s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask;hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=s.strstart}}while(--s.prev_length!==0);s.match_available=0;s.match_length=MIN_MATCH-1;s.strstart++;if(bflush){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}}else if(s.match_available){bflush=trees._tr_tally(s,0,s.window[s.strstart-1]);if(bflush){flush_block_only(s,false)}s.strstart++;s.lookahead--;if(s.strm.avail_out===0){return BS_NEED_MORE}}else{s.match_available=1;s.strstart++;s.lookahead--}}if(s.match_available){bflush=trees._tr_tally(s,0,s.window[s.strstart-1]);s.match_available=0}s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0){return BS_FINISH_STARTED}return BS_FINISH_DONE}if(s.last_lit){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}return BS_BLOCK_DONE}function deflate_rle(s,flush){var bflush;var prev;var scan,strend;var _win=s.window;for(;;){if(s.lookahead<=MAX_MATCH){fill_window(s);if(s.lookahead<=MAX_MATCH&&flush===Z_NO_FLUSH){return BS_NEED_MORE}if(s.lookahead===0){break}}s.match_length=0;if(s.lookahead>=MIN_MATCH&&s.strstart>0){scan=s.strstart-1;prev=_win[scan];if(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]){strend=s.strstart+MAX_MATCH;do{}while(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend);s.match_length=MAX_MATCH-(strend-scan);if(s.match_length>s.lookahead){s.match_length=s.lookahead}}}if(s.match_length>=MIN_MATCH){bflush=trees._tr_tally(s,1,s.match_length-MIN_MATCH);s.lookahead-=s.match_length;s.strstart+=s.match_length;s.match_length=0}else{bflush=trees._tr_tally(s,0,s.window[s.strstart]);s.lookahead--;s.strstart++}if(bflush){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}}s.insert=0;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0){return BS_FINISH_STARTED}return BS_FINISH_DONE}if(s.last_lit){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}return BS_BLOCK_DONE}function deflate_huff(s,flush){var bflush;for(;;){if(s.lookahead===0){fill_window(s);if(s.lookahead===0){if(flush===Z_NO_FLUSH){return BS_NEED_MORE}break}}s.match_length=0;bflush=trees._tr_tally(s,0,s.window[s.strstart]);s.lookahead--;s.strstart++;if(bflush){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}}s.insert=0;if(flush===Z_FINISH){flush_block_only(s,true);if(s.strm.avail_out===0){return BS_FINISH_STARTED}return BS_FINISH_DONE}if(s.last_lit){flush_block_only(s,false);if(s.strm.avail_out===0){return BS_NEED_MORE}}return BS_BLOCK_DONE}function Config(good_length,max_lazy,nice_length,max_chain,func){this.good_length=good_length;this.max_lazy=max_lazy;this.nice_length=nice_length;this.max_chain=max_chain;this.func=func}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(s){s.window_size=2*s.w_size;zero(s.head);s.max_lazy_match=configuration_table[s.level].max_lazy;s.good_match=configuration_table[s.level].good_length;s.nice_match=configuration_table[s.level].nice_length;s.max_chain_length=configuration_table[s.level].max_chain;s.strstart=0;s.block_start=0;s.lookahead=0;s.insert=0;s.match_length=s.prev_length=MIN_MATCH-1;s.match_available=0;s.ins_h=0}function DeflateState(){this.strm=null;this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=Z_DEFLATED;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new utils.Buf16(HEAP_SIZE*2);this.dyn_dtree=new utils.Buf16((2*D_CODES+1)*2);this.bl_tree=new utils.Buf16((2*BL_CODES+1)*2);zero(this.dyn_ltree);zero(this.dyn_dtree);zero(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new utils.Buf16(MAX_BITS+1);this.heap=new utils.Buf16(2*L_CODES+1);zero(this.heap);this.heap_len=0;this.heap_max=0;this.depth=new utils.Buf16(2*L_CODES+1);zero(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function deflateResetKeep(strm){var s;if(!strm||!strm.state){return err(strm,Z_STREAM_ERROR)}strm.total_in=strm.total_out=0;strm.data_type=Z_UNKNOWN;s=strm.state;s.pending=0;s.pending_out=0;if(s.wrap<0){s.wrap=-s.wrap}s.status=s.wrap?INIT_STATE:BUSY_STATE;strm.adler=s.wrap===2?0:1;s.last_flush=Z_NO_FLUSH;trees._tr_init(s);return Z_OK}function deflateReset(strm){var ret=deflateResetKeep(strm);if(ret===Z_OK){lm_init(strm.state)}return ret}function deflateSetHeader(strm,head){if(!strm||!strm.state){return Z_STREAM_ERROR}if(strm.state.wrap!==2){return Z_STREAM_ERROR}strm.state.gzhead=head;return Z_OK}function deflateInit2(strm,level,method,windowBits,memLevel,strategy){if(!strm){return Z_STREAM_ERROR}var wrap=1;if(level===Z_DEFAULT_COMPRESSION){level=6}if(windowBits<0){wrap=0;windowBits=-windowBits}else if(windowBits>15){wrap=2;windowBits-=16}if(memLevel<1||memLevel>MAX_MEM_LEVEL||method!==Z_DEFLATED||windowBits<8||windowBits>15||level<0||level>9||strategy<0||strategy>Z_FIXED){return err(strm,Z_STREAM_ERROR)}if(windowBits===8){windowBits=9}var s=new DeflateState;strm.state=s;s.strm=strm;s.wrap=wrap;s.gzhead=null;s.w_bits=windowBits;s.w_size=1<<s.w_bits;s.w_mask=s.w_size-1;s.hash_bits=memLevel+7;s.hash_size=1<<s.hash_bits;s.hash_mask=s.hash_size-1;s.hash_shift=~~((s.hash_bits+MIN_MATCH-1)/MIN_MATCH);s.window=new utils.Buf8(s.w_size*2);s.head=new utils.Buf16(s.hash_size);s.prev=new utils.Buf16(s.w_size);s.lit_bufsize=1<<memLevel+6;s.pending_buf_size=s.lit_bufsize*4;s.pending_buf=new utils.Buf8(s.pending_buf_size);s.d_buf=1*s.lit_bufsize;s.l_buf=(1+2)*s.lit_bufsize;s.level=level;s.strategy=strategy;s.method=method;return deflateReset(strm)}function deflateInit(strm,level){return deflateInit2(strm,level,Z_DEFLATED,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY)}function deflate(strm,flush){var old_flush,s;var beg,val;if(!strm||!strm.state||flush>Z_BLOCK||flush<0){return strm?err(strm,Z_STREAM_ERROR):Z_STREAM_ERROR}s=strm.state;if(!strm.output||!strm.input&&strm.avail_in!==0||s.status===FINISH_STATE&&flush!==Z_FINISH){return err(strm,strm.avail_out===0?Z_BUF_ERROR:Z_STREAM_ERROR)}s.strm=strm;old_flush=s.last_flush;s.last_flush=flush;if(s.status===INIT_STATE){if(s.wrap===2){strm.adler=0;put_byte(s,31);put_byte(s,139);put_byte(s,8);if(!s.gzhead){put_byte(s,0);put_byte(s,0);put_byte(s,0);put_byte(s,0);put_byte(s,0);put_byte(s,s.level===9?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0);put_byte(s,OS_CODE);s.status=BUSY_STATE}else{put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(!s.gzhead.extra?0:4)+(!s.gzhead.name?0:8)+(!s.gzhead.comment?0:16));put_byte(s,s.gzhead.time&255);put_byte(s,s.gzhead.time>>8&255);put_byte(s,s.gzhead.time>>16&255);put_byte(s,s.gzhead.time>>24&255);put_byte(s,s.level===9?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0);put_byte(s,s.gzhead.os&255);if(s.gzhead.extra&&s.gzhead.extra.length){put_byte(s,s.gzhead.extra.length&255);put_byte(s,s.gzhead.extra.length>>8&255)}if(s.gzhead.hcrc){strm.adler=crc32(strm.adler,s.pending_buf,s.pending,0)}s.gzindex=0;s.status=EXTRA_STATE}}else{var header=Z_DEFLATED+(s.w_bits-8<<4)<<8;var level_flags=-1;if(s.strategy>=Z_HUFFMAN_ONLY||s.level<2){level_flags=0}else if(s.level<6){level_flags=1}else if(s.level===6){level_flags=2}else{level_flags=3}header|=level_flags<<6;if(s.strstart!==0){header|=PRESET_DICT}header+=31-header%31;s.status=BUSY_STATE;putShortMSB(s,header);if(s.strstart!==0){putShortMSB(s,strm.adler>>>16);putShortMSB(s,strm.adler&65535)}strm.adler=1}}if(s.status===EXTRA_STATE){if(s.gzhead.extra){beg=s.pending;while(s.gzindex<(s.gzhead.extra.length&65535)){if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg){strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)}flush_pending(strm);beg=s.pending;if(s.pending===s.pending_buf_size){break}}put_byte(s,s.gzhead.extra[s.gzindex]&255);s.gzindex++}if(s.gzhead.hcrc&&s.pending>beg){strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)}if(s.gzindex===s.gzhead.extra.length){s.gzindex=0;s.status=NAME_STATE}}else{s.status=NAME_STATE}}if(s.status===NAME_STATE){if(s.gzhead.name){beg=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg){strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)}flush_pending(strm);beg=s.pending;if(s.pending===s.pending_buf_size){val=1;break}}if(s.gzindex<s.gzhead.name.length){val=s.gzhead.name.charCodeAt(s.gzindex++)&255}else{val=0}put_byte(s,val)}while(val!==0);if(s.gzhead.hcrc&&s.pending>beg){strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)}if(val===0){s.gzindex=0;s.status=COMMENT_STATE}}else{s.status=COMMENT_STATE}}if(s.status===COMMENT_STATE){if(s.gzhead.comment){beg=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg){strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)}flush_pending(strm);beg=s.pending;if(s.pending===s.pending_buf_size){val=1;break}}if(s.gzindex<s.gzhead.comment.length){val=s.gzhead.comment.charCodeAt(s.gzindex++)&255}else{val=0}put_byte(s,val)}while(val!==0);if(s.gzhead.hcrc&&s.pending>beg){strm.adler=crc32(strm.adler,s.pending_buf,s.pending-beg,beg)}if(val===0){s.status=HCRC_STATE}}else{s.status=HCRC_STATE}}if(s.status===HCRC_STATE){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size){flush_pending(strm)}if(s.pending+2<=s.pending_buf_size){put_byte(s,strm.adler&255);put_byte(s,strm.adler>>8&255);strm.adler=0;s.status=BUSY_STATE}}else{s.status=BUSY_STATE}}if(s.pending!==0){flush_pending(strm);if(strm.avail_out===0){s.last_flush=-1;return Z_OK}}else if(strm.avail_in===0&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH){return err(strm,Z_BUF_ERROR)}if(s.status===FINISH_STATE&&strm.avail_in!==0){return err(strm,Z_BUF_ERROR)}if(strm.avail_in!==0||s.lookahead!==0||flush!==Z_NO_FLUSH&&s.status!==FINISH_STATE){var bstate=s.strategy===Z_HUFFMAN_ONLY?deflate_huff(s,flush):s.strategy===Z_RLE?deflate_rle(s,flush):configuration_table[s.level].func(s,flush);if(bstate===BS_FINISH_STARTED||bstate===BS_FINISH_DONE){s.status=FINISH_STATE}if(bstate===BS_NEED_MORE||bstate===BS_FINISH_STARTED){if(strm.avail_out===0){s.last_flush=-1}return Z_OK}if(bstate===BS_BLOCK_DONE){if(flush===Z_PARTIAL_FLUSH){trees._tr_align(s)}else if(flush!==Z_BLOCK){trees._tr_stored_block(s,0,0,false);if(flush===Z_FULL_FLUSH){zero(s.head);if(s.lookahead===0){s.strstart=0;s.block_start=0;s.insert=0}}}flush_pending(strm);if(strm.avail_out===0){s.last_flush=-1;return Z_OK}}}if(flush!==Z_FINISH){return Z_OK}if(s.wrap<=0){return Z_STREAM_END}if(s.wrap===2){put_byte(s,strm.adler&255);put_byte(s,strm.adler>>8&255);put_byte(s,strm.adler>>16&255);put_byte(s,strm.adler>>24&255);put_byte(s,strm.total_in&255);put_byte(s,strm.total_in>>8&255);put_byte(s,strm.total_in>>16&255);put_byte(s,strm.total_in>>24&255)}else{putShortMSB(s,strm.adler>>>16);putShortMSB(s,strm.adler&65535)}flush_pending(strm);if(s.wrap>0){s.wrap=-s.wrap}return s.pending!==0?Z_OK:Z_STREAM_END}function deflateEnd(strm){var status;if(!strm||!strm.state){return Z_STREAM_ERROR}status=strm.state.status;if(status!==INIT_STATE&&status!==EXTRA_STATE&&status!==NAME_STATE&&status!==COMMENT_STATE&&status!==HCRC_STATE&&status!==BUSY_STATE&&status!==FINISH_STATE){return err(strm,Z_STREAM_ERROR)}strm.state=null;return status===BUSY_STATE?err(strm,Z_DATA_ERROR):Z_OK}function deflateSetDictionary(strm,dictionary){var dictLength=dictionary.length;var s;var str,n;var wrap;var avail;var next;var input;var tmpDict;if(!strm||!strm.state){return Z_STREAM_ERROR}s=strm.state;wrap=s.wrap;if(wrap===2||wrap===1&&s.status!==INIT_STATE||s.lookahead){return Z_STREAM_ERROR}if(wrap===1){strm.adler=adler32(strm.adler,dictionary,dictLength,0)}s.wrap=0;if(dictLength>=s.w_size){if(wrap===0){zero(s.head);s.strstart=0;s.block_start=0;s.insert=0}tmpDict=new utils.Buf8(s.w_size);utils.arraySet(tmpDict,dictionary,dictLength-s.w_size,s.w_size,0);dictionary=tmpDict;dictLength=s.w_size}avail=strm.avail_in;next=strm.next_in;input=strm.input;strm.avail_in=dictLength;strm.next_in=0;strm.input=dictionary;fill_window(s);while(s.lookahead>=MIN_MATCH){str=s.strstart;n=s.lookahead-(MIN_MATCH-1);do{s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask;s.prev[str&s.w_mask]=s.head[s.ins_h];s.head[s.ins_h]=str;str++}while(--n);s.strstart=str;s.lookahead=MIN_MATCH-1;fill_window(s)}s.strstart+=s.lookahead;s.block_start=s.strstart;s.insert=s.lookahead;s.lookahead=0;s.match_length=s.prev_length=MIN_MATCH-1;s.match_available=0;strm.next_in=next;strm.input=input;strm.avail_in=avail;s.wrap=wrap;return Z_OK}exports.deflateInit=deflateInit;exports.deflateInit2=deflateInit2;exports.deflateReset=deflateReset;exports.deflateResetKeep=deflateResetKeep;exports.deflateSetHeader=deflateSetHeader;exports.deflate=deflate;exports.deflateEnd=deflateEnd;exports.deflateSetDictionary=deflateSetDictionary;exports.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":337,"./adler32":338,"./crc32":340,"./messages":345,"./trees":346}],342:[function(require,module,exports){"use strict";var BAD=30;var TYPE=12;module.exports=function inflate_fast(strm,start){var state;var _in;var last;var _out;var beg;var end;var dmax;var wsize;var whave;var wnext;var s_window;var hold;var bits;var lcode;var dcode;var lmask;var dmask;var here;var op;var len;var dist;var from;var from_source;var input,output;state=strm.state;_in=strm.next_in;input=strm.input;last=_in+(strm.avail_in-5);_out=strm.next_out;output=strm.output;beg=_out-(start-strm.avail_out);end=_out+(strm.avail_out-257);dmax=state.dmax;wsize=state.wsize;whave=state.whave;wnext=state.wnext;s_window=state.window;hold=state.hold;bits=state.bits;lcode=state.lencode;dcode=state.distcode;lmask=(1<<state.lenbits)-1;dmask=(1<<state.distbits)-1;top:do{if(bits<15){hold+=input[_in++]<<bits;bits+=8;hold+=input[_in++]<<bits;bits+=8}here=lcode[hold&lmask];dolen:for(;;){op=here>>>24;hold>>>=op;bits-=op;op=here>>>16&255;if(op===0){output[_out++]=here&65535}else if(op&16){len=here&65535;op&=15;if(op){if(bits<op){hold+=input[_in++]<<bits;bits+=8}len+=hold&(1<<op)-1;hold>>>=op;bits-=op}if(bits<15){hold+=input[_in++]<<bits;bits+=8;hold+=input[_in++]<<bits;bits+=8}here=dcode[hold&dmask];dodist:for(;;){op=here>>>24;hold>>>=op;bits-=op;op=here>>>16&255;if(op&16){dist=here&65535;op&=15;if(bits<op){hold+=input[_in++]<<bits;bits+=8;if(bits<op){hold+=input[_in++]<<bits;bits+=8}}dist+=hold&(1<<op)-1;if(dist>dmax){strm.msg="invalid distance too far back";state.mode=BAD;break top}hold>>>=op;bits-=op;op=_out-beg;if(dist>op){op=dist-op;if(op>whave){if(state.sane){strm.msg="invalid distance too far back";state.mode=BAD;break top}}from=0;from_source=s_window;if(wnext===0){from+=wsize-op;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}else if(wnext<op){from+=wsize+wnext-op;op-=wnext;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=0;if(wnext<len){op=wnext;len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}}else{from+=wnext-op;if(op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist;from_source=output}}while(len>2){output[_out++]=from_source[from++];output[_out++]=from_source[from++];output[_out++]=from_source[from++];len-=3}if(len){output[_out++]=from_source[from++];if(len>1){output[_out++]=from_source[from++]}}}else{from=_out-dist;do{output[_out++]=output[from++];output[_out++]=output[from++];output[_out++]=output[from++];len-=3}while(len>2);if(len){output[_out++]=output[from++];if(len>1){output[_out++]=output[from++]}}}}else if((op&64)===0){here=dcode[(here&65535)+(hold&(1<<op)-1)];continue dodist}else{strm.msg="invalid distance code";state.mode=BAD;break top}break}}else if((op&64)===0){here=lcode[(here&65535)+(hold&(1<<op)-1)];continue dolen}else if(op&32){state.mode=TYPE;break top}else{strm.msg="invalid literal/length code";state.mode=BAD;break top}break}}while(_in<last&&_out<end);len=bits>>3;_in-=len;bits-=len<<3;hold&=(1<<bits)-1;strm.next_in=_in;strm.next_out=_out;strm.avail_in=_in<last?5+(last-_in):5-(_in-last);strm.avail_out=_out<end?257+(end-_out):257-(_out-end);state.hold=hold;state.bits=bits;return}},{}],343:[function(require,module,exports){"use strict";var utils=require("../utils/common");var adler32=require("./adler32");var crc32=require("./crc32");var inflate_fast=require("./inffast");var inflate_table=require("./inftrees");var CODES=0;var LENS=1;var DISTS=2;var Z_FINISH=4;var Z_BLOCK=5;var Z_TREES=6;var Z_OK=0;var Z_STREAM_END=1;var Z_NEED_DICT=2;var Z_STREAM_ERROR=-2;var Z_DATA_ERROR=-3;var Z_MEM_ERROR=-4;var Z_BUF_ERROR=-5;var Z_DEFLATED=8;var HEAD=1;var FLAGS=2;var TIME=3;var OS=4;var EXLEN=5;var EXTRA=6;var NAME=7;var COMMENT=8;var HCRC=9;var DICTID=10;var DICT=11;var TYPE=12;var TYPEDO=13;var STORED=14;var COPY_=15;var COPY=16;var TABLE=17;var LENLENS=18;var CODELENS=19;var LEN_=20;var LEN=21;var LENEXT=22;var DIST=23;var DISTEXT=24;var MATCH=25;var LIT=26;var CHECK=27;var LENGTH=28;var DONE=29;var BAD=30;var MEM=31;var SYNC=32;var ENOUGH_LENS=852;var ENOUGH_DISTS=592;var MAX_WBITS=15;var DEF_WBITS=MAX_WBITS;function zswap32(q){return(q>>>24&255)+(q>>>8&65280)+((q&65280)<<8)+((q&255)<<24)}function InflateState(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new utils.Buf16(320);this.work=new utils.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function inflateResetKeep(strm){var state;if(!strm||!strm.state){return Z_STREAM_ERROR}state=strm.state;strm.total_in=strm.total_out=state.total=0;strm.msg="";if(state.wrap){strm.adler=state.wrap&1}state.mode=HEAD;state.last=0;state.havedict=0;state.dmax=32768;state.head=null;state.hold=0;state.bits=0;state.lencode=state.lendyn=new utils.Buf32(ENOUGH_LENS);state.distcode=state.distdyn=new utils.Buf32(ENOUGH_DISTS);state.sane=1;state.back=-1;return Z_OK}function inflateReset(strm){var state;if(!strm||!strm.state){return Z_STREAM_ERROR}state=strm.state;state.wsize=0;state.whave=0;state.wnext=0;return inflateResetKeep(strm)}function inflateReset2(strm,windowBits){var wrap;var state;if(!strm||!strm.state){return Z_STREAM_ERROR}state=strm.state;if(windowBits<0){wrap=0;windowBits=-windowBits}else{wrap=(windowBits>>4)+1;if(windowBits<48){windowBits&=15}}if(windowBits&&(windowBits<8||windowBits>15)){return Z_STREAM_ERROR}if(state.window!==null&&state.wbits!==windowBits){state.window=null}state.wrap=wrap;state.wbits=windowBits;return inflateReset(strm)}function inflateInit2(strm,windowBits){var ret;var state;if(!strm){return Z_STREAM_ERROR}state=new InflateState;strm.state=state;state.window=null;ret=inflateReset2(strm,windowBits);if(ret!==Z_OK){strm.state=null}return ret}function inflateInit(strm){return inflateInit2(strm,DEF_WBITS)}var virgin=true;var lenfix,distfix;function fixedtables(state){if(virgin){var sym;lenfix=new utils.Buf32(512);distfix=new utils.Buf32(32);sym=0;while(sym<144){state.lens[sym++]=8}while(sym<256){state.lens[sym++]=9}while(sym<280){state.lens[sym++]=7}while(sym<288){state.lens[sym++]=8}inflate_table(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9});sym=0;while(sym<32){state.lens[sym++]=5}inflate_table(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5});virgin=false}state.lencode=lenfix;state.lenbits=9;state.distcode=distfix;state.distbits=5}function updatewindow(strm,src,end,copy){var dist;var state=strm.state;if(state.window===null){state.wsize=1<<state.wbits;state.wnext=0;state.whave=0;state.window=new utils.Buf8(state.wsize)}if(copy>=state.wsize){utils.arraySet(state.window,src,end-state.wsize,state.wsize,0);state.wnext=0;state.whave=state.wsize}else{dist=state.wsize-state.wnext;if(dist>copy){dist=copy}utils.arraySet(state.window,src,end-copy,dist,state.wnext);copy-=dist;if(copy){utils.arraySet(state.window,src,end-copy,copy,0);state.wnext=copy;state.whave=state.wsize}else{state.wnext+=dist;if(state.wnext===state.wsize){state.wnext=0}if(state.whave<state.wsize){state.whave+=dist}}}return 0}function inflate(strm,flush){var state;var input,output;var next;var put;var have,left;var hold;var bits;var _in,_out;var copy;var from;var from_source;var here=0;var here_bits,here_op,here_val;var last_bits,last_op,last_val;var len;var ret;var hbuf=new utils.Buf8(4);var opts;var n;var order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&strm.avail_in!==0){return Z_STREAM_ERROR}state=strm.state;if(state.mode===TYPE){state.mode=TYPEDO}put=strm.next_out;output=strm.output;left=strm.avail_out;next=strm.next_in;input=strm.input;have=strm.avail_in;hold=state.hold;bits=state.bits;_in=have;_out=left;ret=Z_OK;inf_leave:for(;;){switch(state.mode){case HEAD:if(state.wrap===0){state.mode=TYPEDO;break}while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state.wrap&2&&hold===35615){state.check=0;hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state.check=crc32(state.check,hbuf,2,0);hold=0;bits=0;state.mode=FLAGS;break}state.flags=0;if(state.head){state.head.done=false}if(!(state.wrap&1)||(((hold&255)<<8)+(hold>>8))%31){strm.msg="incorrect header check";state.mode=BAD;break}if((hold&15)!==Z_DEFLATED){strm.msg="unknown compression method";state.mode=BAD;break}hold>>>=4;bits-=4;len=(hold&15)+8;if(state.wbits===0){state.wbits=len}else if(len>state.wbits){strm.msg="invalid window size";state.mode=BAD;break}state.dmax=1<<len;strm.adler=state.check=1;state.mode=hold&512?DICTID:TYPE;hold=0;bits=0;break;case FLAGS:while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state.flags=hold;if((state.flags&255)!==Z_DEFLATED){strm.msg="unknown compression method";state.mode=BAD;break}if(state.flags&57344){strm.msg="unknown header flags set";state.mode=BAD;break}if(state.head){state.head.text=hold>>8&1}if(state.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state.check=crc32(state.check,hbuf,2,0)}hold=0;bits=0;state.mode=TIME;case TIME:while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state.head){state.head.time=hold}if(state.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;hbuf[2]=hold>>>16&255;hbuf[3]=hold>>>24&255;state.check=crc32(state.check,hbuf,4,0)}hold=0;bits=0;state.mode=OS;case OS:while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(state.head){state.head.xflags=hold&255;state.head.os=hold>>8}if(state.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state.check=crc32(state.check,hbuf,2,0)}hold=0;bits=0;state.mode=EXLEN;case EXLEN:if(state.flags&1024){while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state.length=hold;if(state.head){state.head.extra_len=hold}if(state.flags&512){hbuf[0]=hold&255;hbuf[1]=hold>>>8&255;state.check=crc32(state.check,hbuf,2,0)}hold=0;bits=0}else if(state.head){state.head.extra=null}state.mode=EXTRA;case EXTRA:if(state.flags&1024){copy=state.length;if(copy>have){copy=have}if(copy){if(state.head){len=state.head.extra_len-state.length;if(!state.head.extra){state.head.extra=new Array(state.head.extra_len)}utils.arraySet(state.head.extra,input,next,copy,len)}if(state.flags&512){state.check=crc32(state.check,input,copy,next)}have-=copy;next+=copy;state.length-=copy}if(state.length){break inf_leave}}state.length=0;state.mode=NAME;case NAME:if(state.flags&2048){if(have===0){break inf_leave}copy=0;do{len=input[next+copy++];if(state.head&&len&&state.length<65536){state.head.name+=String.fromCharCode(len)}}while(len&&copy<have);if(state.flags&512){state.check=crc32(state.check,input,copy,next)}have-=copy;next+=copy;if(len){break inf_leave}}else if(state.head){state.head.name=null}state.length=0;state.mode=COMMENT;case COMMENT:if(state.flags&4096){if(have===0){break inf_leave}copy=0;do{len=input[next+copy++];if(state.head&&len&&state.length<65536){state.head.comment+=String.fromCharCode(len)}}while(len&&copy<have);if(state.flags&512){state.check=crc32(state.check,input,copy,next)}have-=copy;next+=copy;if(len){break inf_leave}}else if(state.head){state.head.comment=null}state.mode=HCRC;case HCRC:if(state.flags&512){while(bits<16){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(hold!==(state.check&65535)){strm.msg="header crc mismatch";state.mode=BAD;break}hold=0;bits=0}if(state.head){state.head.hcrc=state.flags>>9&1;state.head.done=true}strm.adler=state.check=0;state.mode=TYPE;break;case DICTID:while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}strm.adler=state.check=zswap32(hold);hold=0;bits=0;state.mode=DICT;case DICT:if(state.havedict===0){strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state.hold=hold;state.bits=bits;return Z_NEED_DICT}strm.adler=state.check=1;state.mode=TYPE;case TYPE:if(flush===Z_BLOCK||flush===Z_TREES){break inf_leave}case TYPEDO:if(state.last){hold>>>=bits&7;bits-=bits&7;state.mode=CHECK;break}while(bits<3){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state.last=hold&1;hold>>>=1;bits-=1;switch(hold&3){case 0:state.mode=STORED;break;case 1:fixedtables(state);state.mode=LEN_;if(flush===Z_TREES){hold>>>=2;bits-=2;break inf_leave}break;case 2:state.mode=TABLE;break;case 3:strm.msg="invalid block type";state.mode=BAD}hold>>>=2;bits-=2;break;case STORED:hold>>>=bits&7;bits-=bits&7;while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if((hold&65535)!==(hold>>>16^65535)){strm.msg="invalid stored block lengths";state.mode=BAD;break}state.length=hold&65535;hold=0;bits=0;state.mode=COPY_;if(flush===Z_TREES){break inf_leave}case COPY_:state.mode=COPY;case COPY:copy=state.length;if(copy){if(copy>have){copy=have}if(copy>left){copy=left}if(copy===0){break inf_leave}utils.arraySet(output,input,next,copy,put);have-=copy;next+=copy;left-=copy;put+=copy;state.length-=copy;break}state.mode=TYPE;break;case TABLE:while(bits<14){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state.nlen=(hold&31)+257;hold>>>=5;bits-=5;state.ndist=(hold&31)+1;hold>>>=5;bits-=5;state.ncode=(hold&15)+4;hold>>>=4;bits-=4;if(state.nlen>286||state.ndist>30){strm.msg="too many length or distance symbols";state.mode=BAD;break}state.have=0;state.mode=LENLENS;case LENLENS:while(state.have<state.ncode){while(bits<3){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state.lens[order[state.have++]]=hold&7;hold>>>=3;bits-=3}while(state.have<19){state.lens[order[state.have++]]=0}state.lencode=state.lendyn;state.lenbits=7;opts={bits:state.lenbits};ret=inflate_table(CODES,state.lens,0,19,state.lencode,0,state.work,opts);state.lenbits=opts.bits;if(ret){strm.msg="invalid code lengths set";state.mode=BAD;break}state.have=0;state.mode=CODELENS;case CODELENS:while(state.have<state.nlen+state.ndist){for(;;){here=state.lencode[hold&(1<<state.lenbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(here_val<16){hold>>>=here_bits;bits-=here_bits;state.lens[state.have++]=here_val}else{if(here_val===16){n=here_bits+2;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;if(state.have===0){strm.msg="invalid bit length repeat";state.mode=BAD;break}len=state.lens[state.have-1];copy=3+(hold&3);hold>>>=2;bits-=2}else if(here_val===17){n=here_bits+3;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;len=0;copy=3+(hold&7);hold>>>=3;bits-=3}else{n=here_bits+7;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=here_bits;bits-=here_bits;len=0;copy=11+(hold&127);hold>>>=7;bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat";state.mode=BAD;break}while(copy--){state.lens[state.have++]=len}}}if(state.mode===BAD){break}if(state.lens[256]===0){strm.msg="invalid code -- missing end-of-block";state.mode=BAD;break}state.lenbits=9;opts={bits:state.lenbits};ret=inflate_table(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts);state.lenbits=opts.bits;if(ret){strm.msg="invalid literal/lengths set";state.mode=BAD;break}state.distbits=6;state.distcode=state.distdyn;opts={bits:state.distbits};ret=inflate_table(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts);state.distbits=opts.bits;if(ret){strm.msg="invalid distances set";state.mode=BAD;break}state.mode=LEN_;if(flush===Z_TREES){break inf_leave}case LEN_:state.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state.hold=hold;state.bits=bits;inflate_fast(strm,_out);put=strm.next_out;output=strm.output;left=strm.avail_out;next=strm.next_in;input=strm.input;have=strm.avail_in;hold=state.hold;bits=state.bits;if(state.mode===TYPE){state.back=-1}break}state.back=0;for(;;){here=state.lencode[hold&(1<<state.lenbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(here_op&&(here_op&240)===0){last_bits=here_bits;last_op=here_op;last_val=here_val;for(;;){here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(last_bits+here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=last_bits;bits-=last_bits;state.back+=last_bits}hold>>>=here_bits;bits-=here_bits;state.back+=here_bits;state.length=here_val;if(here_op===0){state.mode=LIT;break}if(here_op&32){state.back=-1;state.mode=TYPE;break}if(here_op&64){strm.msg="invalid literal/length code";state.mode=BAD;break}state.extra=here_op&15;state.mode=LENEXT;case LENEXT:if(state.extra){n=state.extra;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state.length+=hold&(1<<state.extra)-1;hold>>>=state.extra;bits-=state.extra;state.back+=state.extra}state.was=state.length;state.mode=DIST;case DIST:for(;;){here=state.distcode[hold&(1<<state.distbits)-1];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if((here_op&240)===0){last_bits=here_bits;last_op=here_op;last_val=here_val;for(;;){here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)];here_bits=here>>>24;here_op=here>>>16&255;here_val=here&65535;if(last_bits+here_bits<=bits){break}if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}hold>>>=last_bits;bits-=last_bits;state.back+=last_bits}hold>>>=here_bits;bits-=here_bits;state.back+=here_bits;if(here_op&64){strm.msg="invalid distance code";state.mode=BAD;break}state.offset=here_val;state.extra=here_op&15;state.mode=DISTEXT;case DISTEXT:if(state.extra){n=state.extra;while(bits<n){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}state.offset+=hold&(1<<state.extra)-1;hold>>>=state.extra;bits-=state.extra;state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back";state.mode=BAD;break}state.mode=MATCH;case MATCH:if(left===0){break inf_leave}copy=_out-left;if(state.offset>copy){copy=state.offset-copy;if(copy>state.whave){if(state.sane){strm.msg="invalid distance too far back";state.mode=BAD;break}}if(copy>state.wnext){copy-=state.wnext;from=state.wsize-copy}else{from=state.wnext-copy}if(copy>state.length){copy=state.length}from_source=state.window}else{from_source=output;from=put-state.offset;copy=state.length}if(copy>left){copy=left}left-=copy;state.length-=copy;do{output[put++]=from_source[from++]}while(--copy);if(state.length===0){state.mode=LEN}break;case LIT:if(left===0){break inf_leave}output[put++]=state.length;left--;state.mode=LEN;break;case CHECK:if(state.wrap){while(bits<32){if(have===0){break inf_leave}have--;hold|=input[next++]<<bits;bits+=8}_out-=left;strm.total_out+=_out;state.total+=_out;if(_out){strm.adler=state.check=state.flags?crc32(state.check,output,_out,put-_out):adler32(state.check,output,_out,put-_out)}_out=left;if((state.flags?hold:zswap32(hold))!==state.check){strm.msg="incorrect data check";state.mode=BAD;break}hold=0;bits=0}state.mode=LENGTH;case LENGTH:if(state.wrap&&state.flags){while(bits<32){if(have===0){break inf_leave}have--;hold+=input[next++]<<bits;bits+=8}if(hold!==(state.total&4294967295)){strm.msg="incorrect length check";state.mode=BAD;break}hold=0;bits=0}state.mode=DONE;case DONE:ret=Z_STREAM_END;break inf_leave;case BAD:ret=Z_DATA_ERROR;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}}strm.next_out=put;strm.avail_out=left;strm.next_in=next;strm.avail_in=have;state.hold=hold;state.bits=bits;if(state.wsize||_out!==strm.avail_out&&state.mode<BAD&&(state.mode<CHECK||flush!==Z_FINISH)){if(updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)){state.mode=MEM;return Z_MEM_ERROR}}_in-=strm.avail_in;_out-=strm.avail_out;strm.total_in+=_in;strm.total_out+=_out;state.total+=_out;if(state.wrap&&_out){strm.adler=state.check=state.flags?crc32(state.check,output,_out,strm.next_out-_out):adler32(state.check,output,_out,strm.next_out-_out)}strm.data_type=state.bits+(state.last?64:0)+(state.mode===TYPE?128:0)+(state.mode===LEN_||state.mode===COPY_?256:0);if((_in===0&&_out===0||flush===Z_FINISH)&&ret===Z_OK){ret=Z_BUF_ERROR}return ret}function inflateEnd(strm){if(!strm||!strm.state){return Z_STREAM_ERROR}var state=strm.state;if(state.window){state.window=null}strm.state=null;return Z_OK}function inflateGetHeader(strm,head){var state;if(!strm||!strm.state){return Z_STREAM_ERROR}state=strm.state;if((state.wrap&2)===0){return Z_STREAM_ERROR}state.head=head;head.done=false;return Z_OK}function inflateSetDictionary(strm,dictionary){var dictLength=dictionary.length;var state;var dictid;var ret;if(!strm||!strm.state){return Z_STREAM_ERROR}state=strm.state;if(state.wrap!==0&&state.mode!==DICT){return Z_STREAM_ERROR}if(state.mode===DICT){dictid=1;dictid=adler32(dictid,dictionary,dictLength,0);if(dictid!==state.check){return Z_DATA_ERROR}}ret=updatewindow(strm,dictionary,dictLength,dictLength);if(ret){state.mode=MEM;return Z_MEM_ERROR}state.havedict=1;return Z_OK}exports.inflateReset=inflateReset;exports.inflateReset2=inflateReset2;exports.inflateResetKeep=inflateResetKeep;exports.inflateInit=inflateInit;exports.inflateInit2=inflateInit2;exports.inflate=inflate;exports.inflateEnd=inflateEnd;exports.inflateGetHeader=inflateGetHeader;exports.inflateSetDictionary=inflateSetDictionary;exports.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":337,"./adler32":338,"./crc32":340,"./inffast":342,"./inftrees":344}],344:[function(require,module,exports){"use strict";var utils=require("../utils/common");var MAXBITS=15;var ENOUGH_LENS=852;var ENOUGH_DISTS=592;var CODES=0;var LENS=1;var DISTS=2;var lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];module.exports=function inflate_table(type,lens,lens_index,codes,table,table_index,work,opts){var bits=opts.bits;var len=0;var sym=0;var min=0,max=0;var root=0;var curr=0;var drop=0;var left=0;var used=0;var huff=0;var incr;var fill;var low;var mask;var next;var base=null;var base_index=0;var end;var count=new utils.Buf16(MAXBITS+1);var offs=new utils.Buf16(MAXBITS+1);var extra=null;var extra_index=0;var here_bits,here_op,here_val;for(len=0;len<=MAXBITS;len++){count[len]=0}for(sym=0;sym<codes;sym++){count[lens[lens_index+sym]]++}root=bits;for(max=MAXBITS;max>=1;max--){if(count[max]!==0){break}}if(root>max){root=max}if(max===0){table[table_index++]=1<<24|64<<16|0;table[table_index++]=1<<24|64<<16|0;opts.bits=1;return 0}for(min=1;min<max;min++){if(count[min]!==0){break}}if(root<min){root=min}left=1;for(len=1;len<=MAXBITS;len++){left<<=1;left-=count[len];if(left<0){return-1}}if(left>0&&(type===CODES||max!==1)){return-1}offs[1]=0;for(len=1;len<MAXBITS;len++){offs[len+1]=offs[len]+count[len]}for(sym=0;sym<codes;sym++){if(lens[lens_index+sym]!==0){work[offs[lens[lens_index+sym]]++]=sym}}if(type===CODES){base=extra=work;end=19}else if(type===LENS){base=lbase;base_index-=257;extra=lext;extra_index-=257;end=256}else{base=dbase;extra=dext;end=-1}huff=0;sym=0;len=min;next=table_index;curr=root;drop=0;low=-1;used=1<<root;mask=used-1;if(type===LENS&&used>ENOUGH_LENS||type===DISTS&&used>ENOUGH_DISTS){return 1}for(;;){here_bits=len-drop;if(work[sym]<end){here_op=0;here_val=work[sym]}else if(work[sym]>end){here_op=extra[extra_index+work[sym]];here_val=base[base_index+work[sym]]}else{here_op=32+64;here_val=0}incr=1<<len-drop;fill=1<<curr;min=fill;do{fill-=incr;table[next+(huff>>drop)+fill]=here_bits<<24|here_op<<16|here_val|0}while(fill!==0);incr=1<<len-1;while(huff&incr){incr>>=1}if(incr!==0){huff&=incr-1;huff+=incr}else{huff=0}sym++;if(--count[len]===0){if(len===max){break}len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){if(drop===0){drop=root}next+=min;curr=len-drop;left=1<<curr;while(curr+drop<max){left-=count[curr+drop];if(left<=0){break}curr++;left<<=1}used+=1<<curr;if(type===LENS&&used>ENOUGH_LENS||type===DISTS&&used>ENOUGH_DISTS){return 1}low=huff&mask;table[low]=root<<24|curr<<16|next-table_index|0}}if(huff!==0){table[next+huff]=len-drop<<24|64<<16|0}opts.bits=root;return 0}},{"../utils/common":337}],345:[function(require,module,exports){"use strict";module.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],346:[function(require,module,exports){"use strict";var utils=require("../utils/common");var Z_FIXED=4;var Z_BINARY=0;var Z_TEXT=1;var Z_UNKNOWN=2;function zero(buf){var len=buf.length;while(--len>=0){buf[len]=0}}var STORED_BLOCK=0;var STATIC_TREES=1;var DYN_TREES=2;var MIN_MATCH=3;var MAX_MATCH=258;var LENGTH_CODES=29;var LITERALS=256;var L_CODES=LITERALS+1+LENGTH_CODES;var D_CODES=30;var BL_CODES=19;var HEAP_SIZE=2*L_CODES+1;var MAX_BITS=15;var Buf_size=16;var MAX_BL_BITS=7;var END_BLOCK=256;var REP_3_6=16;var REPZ_3_10=17;var REPZ_11_138=18;var extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];var extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];var bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var DIST_CODE_LEN=512;var static_ltree=new Array((L_CODES+2)*2);zero(static_ltree);var static_dtree=new Array(D_CODES*2);zero(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero(_dist_code);var _length_code=new Array(MAX_MATCH-MIN_MATCH+1);zero(_length_code);var base_length=new Array(LENGTH_CODES);zero(base_length);var base_dist=new Array(D_CODES);zero(base_dist);function StaticTreeDesc(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree;this.extra_bits=extra_bits;this.extra_base=extra_base;this.elems=elems;this.max_length=max_length;this.has_stree=static_tree&&static_tree.length}var static_l_desc;var static_d_desc;var static_bl_desc;function TreeDesc(dyn_tree,stat_desc){this.dyn_tree=dyn_tree;this.max_code=0;this.stat_desc=stat_desc}function d_code(dist){return dist<256?_dist_code[dist]:_dist_code[256+(dist>>>7)]}function put_short(s,w){s.pending_buf[s.pending++]=w&255;s.pending_buf[s.pending++]=w>>>8&255}function send_bits(s,value,length){if(s.bi_valid>Buf_size-length){s.bi_buf|=value<<s.bi_valid&65535;put_short(s,s.bi_buf);s.bi_buf=value>>Buf_size-s.bi_valid;s.bi_valid+=length-Buf_size}else{s.bi_buf|=value<<s.bi_valid&65535;s.bi_valid+=length}}function send_code(s,c,tree){send_bits(s,tree[c*2],tree[c*2+1])}function bi_reverse(code,len){var res=0;do{res|=code&1;code>>>=1;res<<=1}while(--len>0);return res>>>1}function bi_flush(s){if(s.bi_valid===16){put_short(s,s.bi_buf);s.bi_buf=0;s.bi_valid=0}else if(s.bi_valid>=8){s.pending_buf[s.pending++]=s.bi_buf&255;s.bi_buf>>=8;s.bi_valid-=8}}function gen_bitlen(s,desc){var tree=desc.dyn_tree;var max_code=desc.max_code;var stree=desc.stat_desc.static_tree;var has_stree=desc.stat_desc.has_stree;var extra=desc.stat_desc.extra_bits;var base=desc.stat_desc.extra_base;var max_length=desc.stat_desc.max_length;var h;var n,m;var bits;var xbits;var f;var overflow=0;for(bits=0;bits<=MAX_BITS;bits++){s.bl_count[bits]=0}tree[s.heap[s.heap_max]*2+1]=0;for(h=s.heap_max+1;h<HEAP_SIZE;h++){n=s.heap[h];bits=tree[tree[n*2+1]*2+1]+1;if(bits>max_length){bits=max_length;overflow++}tree[n*2+1]=bits;if(n>max_code){continue}s.bl_count[bits]++;xbits=0;if(n>=base){xbits=extra[n-base]}f=tree[n*2];s.opt_len+=f*(bits+xbits);if(has_stree){s.static_len+=f*(stree[n*2+1]+xbits)}}if(overflow===0){return}do{bits=max_length-1;while(s.bl_count[bits]===0){bits--}s.bl_count[bits]--;s.bl_count[bits+1]+=2;s.bl_count[max_length]--;overflow-=2}while(overflow>0);for(bits=max_length;bits!==0;bits--){n=s.bl_count[bits];while(n!==0){m=s.heap[--h];if(m>max_code){continue}if(tree[m*2+1]!==bits){s.opt_len+=(bits-tree[m*2+1])*tree[m*2];tree[m*2+1]=bits}n--}}}function gen_codes(tree,max_code,bl_count){var next_code=new Array(MAX_BITS+1);var code=0;var bits;var n;for(bits=1;bits<=MAX_BITS;bits++){next_code[bits]=code=code+bl_count[bits-1]<<1}for(n=0;n<=max_code;n++){var len=tree[n*2+1];if(len===0){continue}tree[n*2]=bi_reverse(next_code[len]++,len)}}function tr_static_init(){var n;var bits;var length;var code;var dist;var bl_count=new Array(MAX_BITS+1);length=0;for(code=0;code<LENGTH_CODES-1;code++){base_length[code]=length;for(n=0;n<1<<extra_lbits[code];n++){_length_code[length++]=code}}_length_code[length-1]=code;dist=0;for(code=0;code<16;code++){base_dist[code]=dist;for(n=0;n<1<<extra_dbits[code];n++){_dist_code[dist++]=code}}dist>>=7;for(;code<D_CODES;code++){base_dist[code]=dist<<7;for(n=0;n<1<<extra_dbits[code]-7;n++){_dist_code[256+dist++]=code}}for(bits=0;bits<=MAX_BITS;bits++){bl_count[bits]=0}n=0;while(n<=143){static_ltree[n*2+1]=8;n++;bl_count[8]++}while(n<=255){static_ltree[n*2+1]=9;n++;bl_count[9]++}while(n<=279){static_ltree[n*2+1]=7;n++;bl_count[7]++}while(n<=287){static_ltree[n*2+1]=8;n++;bl_count[8]++}gen_codes(static_ltree,L_CODES+1,bl_count);for(n=0;n<D_CODES;n++){static_dtree[n*2+1]=5;static_dtree[n*2]=bi_reverse(n,5)}static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS);static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS);static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)}function init_block(s){var n;for(n=0;n<L_CODES;n++){s.dyn_ltree[n*2]=0}for(n=0;n<D_CODES;n++){s.dyn_dtree[n*2]=0}for(n=0;n<BL_CODES;n++){s.bl_tree[n*2]=0}s.dyn_ltree[END_BLOCK*2]=1;s.opt_len=s.static_len=0;s.last_lit=s.matches=0}function bi_windup(s){if(s.bi_valid>8){put_short(s,s.bi_buf)}else if(s.bi_valid>0){s.pending_buf[s.pending++]=s.bi_buf}s.bi_buf=0;s.bi_valid=0}function copy_block(s,buf,len,header){bi_windup(s);if(header){put_short(s,len);put_short(s,~len)}utils.arraySet(s.pending_buf,s.window,buf,len,s.pending);s.pending+=len}function smaller(tree,n,m,depth){var _n2=n*2;var _m2=m*2;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n]<=depth[m]}function pqdownheap(s,tree,k){var v=s.heap[k];var j=k<<1;while(j<=s.heap_len){if(j<s.heap_len&&smaller(tree,s.heap[j+1],s.heap[j],s.depth)){j++}if(smaller(tree,v,s.heap[j],s.depth)){break}s.heap[k]=s.heap[j];k=j;j<<=1}s.heap[k]=v}function compress_block(s,ltree,dtree){var dist;var lc;var lx=0;var code;var extra;if(s.last_lit!==0){do{dist=s.pending_buf[s.d_buf+lx*2]<<8|s.pending_buf[s.d_buf+lx*2+1];lc=s.pending_buf[s.l_buf+lx];lx++;if(dist===0){send_code(s,lc,ltree)}else{code=_length_code[lc];send_code(s,code+LITERALS+1,ltree);extra=extra_lbits[code];if(extra!==0){lc-=base_length[code];send_bits(s,lc,extra)}dist--;code=d_code(dist);send_code(s,code,dtree);extra=extra_dbits[code];if(extra!==0){dist-=base_dist[code];send_bits(s,dist,extra)}}}while(lx<s.last_lit)}send_code(s,END_BLOCK,ltree)}function build_tree(s,desc){var tree=desc.dyn_tree;var stree=desc.stat_desc.static_tree;var has_stree=desc.stat_desc.has_stree;var elems=desc.stat_desc.elems;var n,m;var max_code=-1;var node;s.heap_len=0;s.heap_max=HEAP_SIZE;for(n=0;n<elems;n++){if(tree[n*2]!==0){s.heap[++s.heap_len]=max_code=n;s.depth[n]=0}else{tree[n*2+1]=0}}while(s.heap_len<2){node=s.heap[++s.heap_len]=max_code<2?++max_code:0;tree[node*2]=1;s.depth[node]=0;s.opt_len--;if(has_stree){s.static_len-=stree[node*2+1]}}desc.max_code=max_code;for(n=s.heap_len>>1;n>=1;n--){pqdownheap(s,tree,n)}node=elems;do{n=s.heap[1];s.heap[1]=s.heap[s.heap_len--];pqdownheap(s,tree,1);m=s.heap[1];s.heap[--s.heap_max]=n;s.heap[--s.heap_max]=m;tree[node*2]=tree[n*2]+tree[m*2];s.depth[node]=(s.depth[n]>=s.depth[m]?s.depth[n]:s.depth[m])+1;tree[n*2+1]=tree[m*2+1]=node;s.heap[1]=node++;pqdownheap(s,tree,1)}while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1];gen_bitlen(s,desc);gen_codes(tree,max_code,s.bl_count)}function scan_tree(s,tree,max_code){var n;var prevlen=-1;var curlen;var nextlen=tree[0*2+1];var count=0;var max_count=7;var min_count=4;if(nextlen===0){max_count=138;min_count=3}tree[(max_code+1)*2+1]=65535;for(n=0;n<=max_code;n++){curlen=nextlen;nextlen=tree[(n+1)*2+1];if(++count<max_count&&curlen===nextlen){continue}else if(count<min_count){s.bl_tree[curlen*2]+=count}else if(curlen!==0){if(curlen!==prevlen){s.bl_tree[curlen*2]++}s.bl_tree[REP_3_6*2]++}else if(count<=10){s.bl_tree[REPZ_3_10*2]++}else{s.bl_tree[REPZ_11_138*2]++}count=0;prevlen=curlen;if(nextlen===0){max_count=138;min_count=3}else if(curlen===nextlen){max_count=6;min_count=3}else{max_count=7;min_count=4}}}function send_tree(s,tree,max_code){var n;var prevlen=-1;var curlen;var nextlen=tree[0*2+1];var count=0;var max_count=7;var min_count=4;if(nextlen===0){max_count=138;min_count=3}for(n=0;n<=max_code;n++){curlen=nextlen;nextlen=tree[(n+1)*2+1];if(++count<max_count&&curlen===nextlen){continue}else if(count<min_count){do{send_code(s,curlen,s.bl_tree)}while(--count!==0)}else if(curlen!==0){if(curlen!==prevlen){send_code(s,curlen,s.bl_tree);count--}send_code(s,REP_3_6,s.bl_tree);send_bits(s,count-3,2)}else if(count<=10){send_code(s,REPZ_3_10,s.bl_tree);send_bits(s,count-3,3)}else{send_code(s,REPZ_11_138,s.bl_tree);send_bits(s,count-11,7)}count=0;prevlen=curlen;if(nextlen===0){max_count=138;min_count=3}else if(curlen===nextlen){max_count=6;min_count=3}else{max_count=7;min_count=4}}}function build_bl_tree(s){var max_blindex;scan_tree(s,s.dyn_ltree,s.l_desc.max_code);scan_tree(s,s.dyn_dtree,s.d_desc.max_code);build_tree(s,s.bl_desc);for(max_blindex=BL_CODES-1;max_blindex>=3;max_blindex--){if(s.bl_tree[bl_order[max_blindex]*2+1]!==0){break}}s.opt_len+=3*(max_blindex+1)+5+5+4;return max_blindex}function send_all_trees(s,lcodes,dcodes,blcodes){var rank;send_bits(s,lcodes-257,5);send_bits(s,dcodes-1,5);send_bits(s,blcodes-4,4);for(rank=0;rank<blcodes;rank++){send_bits(s,s.bl_tree[bl_order[rank]*2+1],3)}send_tree(s,s.dyn_ltree,lcodes-1);send_tree(s,s.dyn_dtree,dcodes-1)}function detect_data_type(s){var black_mask=4093624447;var n;for(n=0;n<=31;n++,black_mask>>>=1){if(black_mask&1&&s.dyn_ltree[n*2]!==0){return Z_BINARY}}if(s.dyn_ltree[9*2]!==0||s.dyn_ltree[10*2]!==0||s.dyn_ltree[13*2]!==0){return Z_TEXT}for(n=32;n<LITERALS;n++){if(s.dyn_ltree[n*2]!==0){return Z_TEXT}}return Z_BINARY}var static_init_done=false;function _tr_init(s){if(!static_init_done){tr_static_init();static_init_done=true}s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc);s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc);s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc);s.bi_buf=0;s.bi_valid=0;init_block(s)}function _tr_stored_block(s,buf,stored_len,last){send_bits(s,(STORED_BLOCK<<1)+(last?1:0),3);copy_block(s,buf,stored_len,true)}function _tr_align(s){send_bits(s,STATIC_TREES<<1,3);send_code(s,END_BLOCK,static_ltree);bi_flush(s)}function _tr_flush_block(s,buf,stored_len,last){var opt_lenb,static_lenb;var max_blindex=0;if(s.level>0){if(s.strm.data_type===Z_UNKNOWN){s.strm.data_type=detect_data_type(s)}build_tree(s,s.l_desc);build_tree(s,s.d_desc);max_blindex=build_bl_tree(s);opt_lenb=s.opt_len+3+7>>>3;static_lenb=s.static_len+3+7>>>3;if(static_lenb<=opt_lenb){opt_lenb=static_lenb}}else{opt_lenb=static_lenb=stored_len+5}if(stored_len+4<=opt_lenb&&buf!==-1){_tr_stored_block(s,buf,stored_len,last)}else if(s.strategy===Z_FIXED||static_lenb===opt_lenb){send_bits(s,(STATIC_TREES<<1)+(last?1:0),3);compress_block(s,static_ltree,static_dtree)}else{send_bits(s,(DYN_TREES<<1)+(last?1:0),3);send_all_trees(s,s.l_desc.max_code+1,s.d_desc.max_code+1,max_blindex+1);compress_block(s,s.dyn_ltree,s.dyn_dtree)}init_block(s);if(last){bi_windup(s)}}function _tr_tally(s,dist,lc){s.pending_buf[s.d_buf+s.last_lit*2]=dist>>>8&255;s.pending_buf[s.d_buf+s.last_lit*2+1]=dist&255;s.pending_buf[s.l_buf+s.last_lit]=lc&255;s.last_lit++;if(dist===0){s.dyn_ltree[lc*2]++}else{s.matches++;dist--;s.dyn_ltree[(_length_code[lc]+LITERALS+1)*2]++;s.dyn_dtree[d_code(dist)*2]++}return s.last_lit===s.lit_bufsize-1}exports._tr_init=_tr_init;exports._tr_stored_block=_tr_stored_block;exports._tr_flush_block=_tr_flush_block;exports._tr_tally=_tr_tally;exports._tr_align=_tr_align},{"../utils/common":337}],347:[function(require,module,exports){"use strict";function ZStream(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}module.exports=ZStream},{}],348:[function(require,module,exports){module.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],349:[function(require,module,exports){"use strict";var asn1=require("asn1.js");exports.certificate=require("./certificate");var RSAPrivateKey=asn1.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));exports.RSAPrivateKey=RSAPrivateKey;var RSAPublicKey=asn1.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));exports.RSAPublicKey=RSAPublicKey;var PublicKey=asn1.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())}));exports.PublicKey=PublicKey;var AlgorithmIdentifier=asn1.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}));var PrivateKeyInfo=asn1.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPrivateKey").octstr())}));exports.PrivateKey=PrivateKeyInfo;var EncryptedPrivateKeyInfo=asn1.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));exports.EncryptedPrivateKey=EncryptedPrivateKeyInfo;var DSAPrivateKey=asn1.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));exports.DSAPrivateKey=DSAPrivateKey;exports.DSAparam=asn1.define("DSAparam",(function(){this.int()}));var ECPrivateKey=asn1.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(ECParameters),this.key("publicKey").optional().explicit(1).bitstr())}));exports.ECPrivateKey=ECPrivateKey;var ECParameters=asn1.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));exports.signature=asn1.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},{"./certificate":350,"asn1.js":20}],350:[function(require,module,exports){"use strict";var asn=require("asn1.js");var Time=asn.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}));var AttributeTypeValue=asn.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}));var AlgorithmIdentifier=asn.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}));var SubjectPublicKeyInfo=asn.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(AlgorithmIdentifier),this.key("subjectPublicKey").bitstr())}));var RelativeDistinguishedName=asn.define("RelativeDistinguishedName",(function(){this.setof(AttributeTypeValue)}));var RDNSequence=asn.define("RDNSequence",(function(){this.seqof(RelativeDistinguishedName)}));var Name=asn.define("Name",(function(){this.choice({rdnSequence:this.use(RDNSequence)})}));var Validity=asn.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(Time),this.key("notAfter").use(Time))}));var Extension=asn.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(false),this.key("extnValue").octstr())}));var TBSCertificate=asn.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(AlgorithmIdentifier),this.key("issuer").use(Name),this.key("validity").use(Validity),this.key("subject").use(Name),this.key("subjectPublicKeyInfo").use(SubjectPublicKeyInfo),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(Extension).optional())}));var X509Certificate=asn.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(TBSCertificate),this.key("signatureAlgorithm").use(AlgorithmIdentifier),this.key("signatureValue").bitstr())}));module.exports=X509Certificate},{"asn1.js":20}],351:[function(require,module,exports){var findProc=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m;var startRegex=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m;var fullRegex=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m;var evp=require("evp_bytestokey");var ciphers=require("browserify-aes");var Buffer=require("safe-buffer").Buffer;module.exports=function(okey,password){var key=okey.toString();var match=key.match(findProc);var decrypted;if(!match){var match2=key.match(fullRegex);decrypted=Buffer.from(match2[2].replace(/[\r\n]/g,""),"base64")}else{var suite="aes"+match[1];var iv=Buffer.from(match[2],"hex");var cipherText=Buffer.from(match[3].replace(/[\r\n]/g,""),"base64");var cipherKey=evp(password,iv.slice(0,8),parseInt(match[1],10)).key;var out=[];var cipher=ciphers.createDecipheriv(suite,cipherKey,iv);out.push(cipher.update(cipherText));out.push(cipher.final());decrypted=Buffer.concat(out)}var tag=key.match(startRegex)[1];return{tag:tag,data:decrypted}}},{"browserify-aes":46,evp_bytestokey:188,"safe-buffer":385}],352:[function(require,module,exports){var asn1=require("./asn1");var aesid=require("./aesid.json");var fixProc=require("./fixProc");var ciphers=require("browserify-aes");var compat=require("pbkdf2");var Buffer=require("safe-buffer").Buffer;module.exports=parseKeys;function parseKeys(buffer){var password;if(typeof buffer==="object"&&!Buffer.isBuffer(buffer)){password=buffer.passphrase;buffer=buffer.key}if(typeof buffer==="string"){buffer=Buffer.from(buffer)}var stripped=fixProc(buffer,password);var type=stripped.tag;var data=stripped.data;var subtype,ndata;switch(type){case"CERTIFICATE":ndata=asn1.certificate.decode(data,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":if(!ndata){ndata=asn1.PublicKey.decode(data,"der")}subtype=ndata.algorithm.algorithm.join(".");switch(subtype){case"1.2.840.113549.1.1.1":return asn1.RSAPublicKey.decode(ndata.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":ndata.subjectPrivateKey=ndata.subjectPublicKey;return{type:"ec",data:ndata};case"1.2.840.10040.4.1":ndata.algorithm.params.pub_key=asn1.DSAparam.decode(ndata.subjectPublicKey.data,"der");return{type:"dsa",data:ndata.algorithm.params};default:throw new Error("unknown key id "+subtype)}case"ENCRYPTED PRIVATE KEY":data=asn1.EncryptedPrivateKey.decode(data,"der");data=decrypt(data,password);case"PRIVATE KEY":ndata=asn1.PrivateKey.decode(data,"der");subtype=ndata.algorithm.algorithm.join(".");switch(subtype){case"1.2.840.113549.1.1.1":return asn1.RSAPrivateKey.decode(ndata.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:ndata.algorithm.curve,privateKey:asn1.ECPrivateKey.decode(ndata.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":ndata.algorithm.params.priv_key=asn1.DSAparam.decode(ndata.subjectPrivateKey,"der");return{type:"dsa",params:ndata.algorithm.params};default:throw new Error("unknown key id "+subtype)}case"RSA PUBLIC KEY":return asn1.RSAPublicKey.decode(data,"der");case"RSA PRIVATE KEY":return asn1.RSAPrivateKey.decode(data,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:asn1.DSAPrivateKey.decode(data,"der")};case"EC PRIVATE KEY":data=asn1.ECPrivateKey.decode(data,"der");return{curve:data.parameters.value,privateKey:data.privateKey};default:throw new Error("unknown key type "+type)}}parseKeys.signature=asn1.signature;function decrypt(data,password){var salt=data.algorithm.decrypt.kde.kdeparams.salt;var iters=parseInt(data.algorithm.decrypt.kde.kdeparams.iters.toString(),10);var algo=aesid[data.algorithm.decrypt.cipher.algo.join(".")];var iv=data.algorithm.decrypt.cipher.iv;var cipherText=data.subjectPrivateKey;var keylen=parseInt(algo.split("-")[1],10)/8;var key=compat.pbkdf2Sync(password,salt,iters,keylen,"sha1");var cipher=ciphers.createDecipheriv(algo,key,iv);var out=[];out.push(cipher.update(cipherText));out.push(cipher.final());return Buffer.concat(out)}},{"./aesid.json":348,"./asn1":349,"./fixProc":351,"browserify-aes":46,pbkdf2:369,"safe-buffer":385}],353:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.adapter=exports.serializeDoctypeContent=void 0;const parse5_1=require("parse5");const domhandler_1=require("domhandler");function createTextNode(value){return new domhandler_1.Text(value)}function enquoteDoctypeId(id){const quote=id.includes('"')?"'":'"';return quote+id+quote}function serializeDoctypeContent(name,publicId,systemId){let str="!DOCTYPE ";if(name){str+=name}if(publicId){str+=` PUBLIC ${enquoteDoctypeId(publicId)}`}else if(systemId){str+=" SYSTEM"}if(systemId){str+=` ${enquoteDoctypeId(systemId)}`}return str}exports.serializeDoctypeContent=serializeDoctypeContent;exports.adapter={isCommentNode:domhandler_1.isComment,isElementNode:domhandler_1.isTag,isTextNode:domhandler_1.isText,createDocument(){const node=new domhandler_1.Document([]);node["x-mode"]=parse5_1.html.DOCUMENT_MODE.NO_QUIRKS;return node},createDocumentFragment(){return new domhandler_1.Document([])},createElement(tagName,namespaceURI,attrs){const attribs=Object.create(null);const attribsNamespace=Object.create(null);const attribsPrefix=Object.create(null);for(let i=0;i<attrs.length;i++){const attrName=attrs[i].name;attribs[attrName]=attrs[i].value;attribsNamespace[attrName]=attrs[i].namespace;attribsPrefix[attrName]=attrs[i].prefix}const node=new domhandler_1.Element(tagName,attribs,[]);node.namespace=namespaceURI;node["x-attribsNamespace"]=attribsNamespace;node["x-attribsPrefix"]=attribsPrefix;return node},createCommentNode(data){return new domhandler_1.Comment(data)},appendChild(parentNode,newNode){const prev=parentNode.children[parentNode.children.length-1];if(prev){prev.next=newNode;newNode.prev=prev}parentNode.children.push(newNode);newNode.parent=parentNode},insertBefore(parentNode,newNode,referenceNode){const insertionIdx=parentNode.children.indexOf(referenceNode);const{prev:prev}=referenceNode;if(prev){prev.next=newNode;newNode.prev=prev}referenceNode.prev=newNode;newNode.next=referenceNode;parentNode.children.splice(insertionIdx,0,newNode);newNode.parent=parentNode},setTemplateContent(templateElement,contentElement){exports.adapter.appendChild(templateElement,contentElement)},getTemplateContent(templateElement){return templateElement.children[0]},setDocumentType(document,name,publicId,systemId){const data=serializeDoctypeContent(name,publicId,systemId);let doctypeNode=document.children.find((node=>(0,domhandler_1.isDirective)(node)&&node.name==="!doctype"));if(doctypeNode){doctypeNode.data=data!==null&&data!==void 0?data:null}else{doctypeNode=new domhandler_1.ProcessingInstruction("!doctype",data);exports.adapter.appendChild(document,doctypeNode)}doctypeNode["x-name"]=name!==null&&name!==void 0?name:undefined;doctypeNode["x-publicId"]=publicId!==null&&publicId!==void 0?publicId:undefined;doctypeNode["x-systemId"]=systemId!==null&&systemId!==void 0?systemId:undefined},setDocumentMode(document,mode){document["x-mode"]=mode},getDocumentMode(document){return document["x-mode"]},detachNode(node){if(node.parent){const idx=node.parent.children.indexOf(node);const{prev:prev,next:next}=node;node.prev=null;node.next=null;if(prev){prev.next=next}if(next){next.prev=prev}node.parent.children.splice(idx,1);node.parent=null}},insertText(parentNode,text){const lastChild=parentNode.children[parentNode.children.length-1];if(lastChild&&(0,domhandler_1.isText)(lastChild)){lastChild.data+=text}else{exports.adapter.appendChild(parentNode,createTextNode(text))}},insertTextBefore(parentNode,text,referenceNode){const prevNode=parentNode.children[parentNode.children.indexOf(referenceNode)-1];if(prevNode&&(0,domhandler_1.isText)(prevNode)){prevNode.data+=text}else{exports.adapter.insertBefore(parentNode,createTextNode(text),referenceNode)}},adoptAttributes(recipient,attrs){for(let i=0;i<attrs.length;i++){const attrName=attrs[i].name;if(typeof recipient.attribs[attrName]==="undefined"){recipient.attribs[attrName]=attrs[i].value;recipient["x-attribsNamespace"][attrName]=attrs[i].namespace;recipient["x-attribsPrefix"][attrName]=attrs[i].prefix}}},getFirstChild(node){return node.children[0]},getChildNodes(node){return node.children},getParentNode(node){return node.parent},getAttrList(element){return element.attributes},getTagName(element){return element.name},getNamespaceURI(element){return element.namespace},getTextNodeContent(textNode){return textNode.data},getCommentNodeContent(commentNode){return commentNode.data},getDocumentTypeNodeName(doctypeNode){var _a;return(_a=doctypeNode["x-name"])!==null&&_a!==void 0?_a:""},getDocumentTypeNodePublicId(doctypeNode){var _a;return(_a=doctypeNode["x-publicId"])!==null&&_a!==void 0?_a:""},getDocumentTypeNodeSystemId(doctypeNode){var _a;return(_a=doctypeNode["x-systemId"])!==null&&_a!==void 0?_a:""},isDocumentTypeNode(node){return(0,domhandler_1.isDirective)(node)&&node.name==="!doctype"},setNodeSourceCodeLocation(node,location){if(location){node.startIndex=location.startOffset;node.endIndex=location.endOffset}node.sourceCodeLocation=location},getNodeSourceCodeLocation(node){return node.sourceCodeLocation},updateNodeSourceCodeLocation(node,endLocation){if(endLocation.endOffset!=null)node.endIndex=endLocation.endOffset;node.sourceCodeLocation=Object.assign(Object.assign({},node.sourceCodeLocation),endLocation)}}},{domhandler:152,parse5:360}],354:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getDocumentMode=exports.isConforming=void 0;const html_js_1=require("./html.js");const VALID_DOCTYPE_NAME="html";const VALID_SYSTEM_ID="about:legacy-compat";const QUIRKS_MODE_SYSTEM_ID="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd";const QUIRKS_MODE_PUBLIC_ID_PREFIXES=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"];const QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES=[...QUIRKS_MODE_PUBLIC_ID_PREFIXES,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];const QUIRKS_MODE_PUBLIC_IDS=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]);const LIMITED_QUIRKS_PUBLIC_ID_PREFIXES=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"];const LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES=[...LIMITED_QUIRKS_PUBLIC_ID_PREFIXES,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function hasPrefix(publicId,prefixes){return prefixes.some((prefix=>publicId.startsWith(prefix)))}function isConforming(token){return token.name===VALID_DOCTYPE_NAME&&token.publicId===null&&(token.systemId===null||token.systemId===VALID_SYSTEM_ID)}exports.isConforming=isConforming;function getDocumentMode(token){if(token.name!==VALID_DOCTYPE_NAME){return html_js_1.DOCUMENT_MODE.QUIRKS}const{systemId:systemId}=token;if(systemId&&systemId.toLowerCase()===QUIRKS_MODE_SYSTEM_ID){return html_js_1.DOCUMENT_MODE.QUIRKS}let{publicId:publicId}=token;if(publicId!==null){publicId=publicId.toLowerCase();if(QUIRKS_MODE_PUBLIC_IDS.has(publicId)){return html_js_1.DOCUMENT_MODE.QUIRKS}let prefixes=systemId===null?QUIRKS_MODE_NO_SYSTEM_ID_PUBLIC_ID_PREFIXES:QUIRKS_MODE_PUBLIC_ID_PREFIXES;if(hasPrefix(publicId,prefixes)){return html_js_1.DOCUMENT_MODE.QUIRKS}prefixes=systemId===null?LIMITED_QUIRKS_PUBLIC_ID_PREFIXES:LIMITED_QUIRKS_WITH_SYSTEM_ID_PUBLIC_ID_PREFIXES;if(hasPrefix(publicId,prefixes)){return html_js_1.DOCUMENT_MODE.LIMITED_QUIRKS}}return html_js_1.DOCUMENT_MODE.NO_QUIRKS}exports.getDocumentMode=getDocumentMode},{"./html.js":357}],355:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ERR=void 0;var ERR;(function(ERR){ERR["controlCharacterInInputStream"]="control-character-in-input-stream";ERR["noncharacterInInputStream"]="noncharacter-in-input-stream";ERR["surrogateInInputStream"]="surrogate-in-input-stream";ERR["nonVoidHtmlElementStartTagWithTrailingSolidus"]="non-void-html-element-start-tag-with-trailing-solidus";ERR["endTagWithAttributes"]="end-tag-with-attributes";ERR["endTagWithTrailingSolidus"]="end-tag-with-trailing-solidus";ERR["unexpectedSolidusInTag"]="unexpected-solidus-in-tag";ERR["unexpectedNullCharacter"]="unexpected-null-character";ERR["unexpectedQuestionMarkInsteadOfTagName"]="unexpected-question-mark-instead-of-tag-name";ERR["invalidFirstCharacterOfTagName"]="invalid-first-character-of-tag-name";ERR["unexpectedEqualsSignBeforeAttributeName"]="unexpected-equals-sign-before-attribute-name";ERR["missingEndTagName"]="missing-end-tag-name";ERR["unexpectedCharacterInAttributeName"]="unexpected-character-in-attribute-name";ERR["unknownNamedCharacterReference"]="unknown-named-character-reference";ERR["missingSemicolonAfterCharacterReference"]="missing-semicolon-after-character-reference";ERR["unexpectedCharacterAfterDoctypeSystemIdentifier"]="unexpected-character-after-doctype-system-identifier";ERR["unexpectedCharacterInUnquotedAttributeValue"]="unexpected-character-in-unquoted-attribute-value";ERR["eofBeforeTagName"]="eof-before-tag-name";ERR["eofInTag"]="eof-in-tag";ERR["missingAttributeValue"]="missing-attribute-value";ERR["missingWhitespaceBetweenAttributes"]="missing-whitespace-between-attributes";ERR["missingWhitespaceAfterDoctypePublicKeyword"]="missing-whitespace-after-doctype-public-keyword";ERR["missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers"]="missing-whitespace-between-doctype-public-and-system-identifiers";ERR["missingWhitespaceAfterDoctypeSystemKeyword"]="missing-whitespace-after-doctype-system-keyword";ERR["missingQuoteBeforeDoctypePublicIdentifier"]="missing-quote-before-doctype-public-identifier";ERR["missingQuoteBeforeDoctypeSystemIdentifier"]="missing-quote-before-doctype-system-identifier";ERR["missingDoctypePublicIdentifier"]="missing-doctype-public-identifier";ERR["missingDoctypeSystemIdentifier"]="missing-doctype-system-identifier";ERR["abruptDoctypePublicIdentifier"]="abrupt-doctype-public-identifier";ERR["abruptDoctypeSystemIdentifier"]="abrupt-doctype-system-identifier";ERR["cdataInHtmlContent"]="cdata-in-html-content";ERR["incorrectlyOpenedComment"]="incorrectly-opened-comment";ERR["eofInScriptHtmlCommentLikeText"]="eof-in-script-html-comment-like-text";ERR["eofInDoctype"]="eof-in-doctype";ERR["nestedComment"]="nested-comment";ERR["abruptClosingOfEmptyComment"]="abrupt-closing-of-empty-comment";ERR["eofInComment"]="eof-in-comment";ERR["incorrectlyClosedComment"]="incorrectly-closed-comment";ERR["eofInCdata"]="eof-in-cdata";ERR["absenceOfDigitsInNumericCharacterReference"]="absence-of-digits-in-numeric-character-reference";ERR["nullCharacterReference"]="null-character-reference";ERR["surrogateCharacterReference"]="surrogate-character-reference";ERR["characterReferenceOutsideUnicodeRange"]="character-reference-outside-unicode-range";ERR["controlCharacterReference"]="control-character-reference";ERR["noncharacterCharacterReference"]="noncharacter-character-reference";ERR["missingWhitespaceBeforeDoctypeName"]="missing-whitespace-before-doctype-name";ERR["missingDoctypeName"]="missing-doctype-name";ERR["invalidCharacterSequenceAfterDoctypeName"]="invalid-character-sequence-after-doctype-name";ERR["duplicateAttribute"]="duplicate-attribute";ERR["nonConformingDoctype"]="non-conforming-doctype";ERR["missingDoctype"]="missing-doctype";ERR["misplacedDoctype"]="misplaced-doctype";ERR["endTagWithoutMatchingOpenElement"]="end-tag-without-matching-open-element";ERR["closingOfElementWithOpenChildElements"]="closing-of-element-with-open-child-elements";ERR["disallowedContentInNoscriptInHead"]="disallowed-content-in-noscript-in-head";ERR["openElementsLeftAfterEof"]="open-elements-left-after-eof";ERR["abandonedHeadElementChild"]="abandoned-head-element-child";ERR["misplacedStartTagForHeadElement"]="misplaced-start-tag-for-head-element";ERR["nestedNoscriptInHead"]="nested-noscript-in-head";ERR["eofInElementThatCanContainOnlyText"]="eof-in-element-that-can-contain-only-text"})(ERR=exports.ERR||(exports.ERR={}))},{}],356:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isIntegrationPoint=exports.adjustTokenSVGTagName=exports.adjustTokenXMLAttrs=exports.adjustTokenSVGAttrs=exports.adjustTokenMathMLAttrs=exports.causesExit=exports.SVG_TAG_NAMES_ADJUSTMENT_MAP=void 0;const html_js_1=require("./html.js");const MIME_TYPES={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"};const DEFINITION_URL_ATTR="definitionurl";const ADJUSTED_DEFINITION_URL_ATTR="definitionURL";const SVG_ATTRS_ADJUSTMENT_MAP=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map((attr=>[attr.toLowerCase(),attr])));const XML_ATTRS_ADJUSTMENT_MAP=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:html_js_1.NS.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:html_js_1.NS.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:html_js_1.NS.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:html_js_1.NS.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:html_js_1.NS.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:html_js_1.NS.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:html_js_1.NS.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:html_js_1.NS.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:html_js_1.NS.XML}],["xml:space",{prefix:"xml",name:"space",namespace:html_js_1.NS.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:html_js_1.NS.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:html_js_1.NS.XMLNS}]]);exports.SVG_TAG_NAMES_ADJUSTMENT_MAP=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map((tn=>[tn.toLowerCase(),tn])));const EXITS_FOREIGN_CONTENT=new Set([html_js_1.TAG_ID.B,html_js_1.TAG_ID.BIG,html_js_1.TAG_ID.BLOCKQUOTE,html_js_1.TAG_ID.BODY,html_js_1.TAG_ID.BR,html_js_1.TAG_ID.CENTER,html_js_1.TAG_ID.CODE,html_js_1.TAG_ID.DD,html_js_1.TAG_ID.DIV,html_js_1.TAG_ID.DL,html_js_1.TAG_ID.DT,html_js_1.TAG_ID.EM,html_js_1.TAG_ID.EMBED,html_js_1.TAG_ID.H1,html_js_1.TAG_ID.H2,html_js_1.TAG_ID.H3,html_js_1.TAG_ID.H4,html_js_1.TAG_ID.H5,html_js_1.TAG_ID.H6,html_js_1.TAG_ID.HEAD,html_js_1.TAG_ID.HR,html_js_1.TAG_ID.I,html_js_1.TAG_ID.IMG,html_js_1.TAG_ID.LI,html_js_1.TAG_ID.LISTING,html_js_1.TAG_ID.MENU,html_js_1.TAG_ID.META,html_js_1.TAG_ID.NOBR,html_js_1.TAG_ID.OL,html_js_1.TAG_ID.P,html_js_1.TAG_ID.PRE,html_js_1.TAG_ID.RUBY,html_js_1.TAG_ID.S,html_js_1.TAG_ID.SMALL,html_js_1.TAG_ID.SPAN,html_js_1.TAG_ID.STRONG,html_js_1.TAG_ID.STRIKE,html_js_1.TAG_ID.SUB,html_js_1.TAG_ID.SUP,html_js_1.TAG_ID.TABLE,html_js_1.TAG_ID.TT,html_js_1.TAG_ID.U,html_js_1.TAG_ID.UL,html_js_1.TAG_ID.VAR]);function causesExit(startTagToken){const tn=startTagToken.tagID;const isFontWithAttrs=tn===html_js_1.TAG_ID.FONT&&startTagToken.attrs.some((({name:name})=>name===html_js_1.ATTRS.COLOR||name===html_js_1.ATTRS.SIZE||name===html_js_1.ATTRS.FACE));return isFontWithAttrs||EXITS_FOREIGN_CONTENT.has(tn)}exports.causesExit=causesExit;function adjustTokenMathMLAttrs(token){for(let i=0;i<token.attrs.length;i++){if(token.attrs[i].name===DEFINITION_URL_ATTR){token.attrs[i].name=ADJUSTED_DEFINITION_URL_ATTR;break}}}exports.adjustTokenMathMLAttrs=adjustTokenMathMLAttrs;function adjustTokenSVGAttrs(token){for(let i=0;i<token.attrs.length;i++){const adjustedAttrName=SVG_ATTRS_ADJUSTMENT_MAP.get(token.attrs[i].name);if(adjustedAttrName!=null){token.attrs[i].name=adjustedAttrName}}}exports.adjustTokenSVGAttrs=adjustTokenSVGAttrs;function adjustTokenXMLAttrs(token){for(let i=0;i<token.attrs.length;i++){const adjustedAttrEntry=XML_ATTRS_ADJUSTMENT_MAP.get(token.attrs[i].name);if(adjustedAttrEntry){token.attrs[i].prefix=adjustedAttrEntry.prefix;token.attrs[i].name=adjustedAttrEntry.name;token.attrs[i].namespace=adjustedAttrEntry.namespace}}}exports.adjustTokenXMLAttrs=adjustTokenXMLAttrs;function adjustTokenSVGTagName(token){const adjustedTagName=exports.SVG_TAG_NAMES_ADJUSTMENT_MAP.get(token.tagName);if(adjustedTagName!=null){token.tagName=adjustedTagName;token.tagID=(0,html_js_1.getTagID)(token.tagName)}}exports.adjustTokenSVGTagName=adjustTokenSVGTagName;function isMathMLTextIntegrationPoint(tn,ns){return ns===html_js_1.NS.MATHML&&(tn===html_js_1.TAG_ID.MI||tn===html_js_1.TAG_ID.MO||tn===html_js_1.TAG_ID.MN||tn===html_js_1.TAG_ID.MS||tn===html_js_1.TAG_ID.MTEXT)}function isHtmlIntegrationPoint(tn,ns,attrs){if(ns===html_js_1.NS.MATHML&&tn===html_js_1.TAG_ID.ANNOTATION_XML){for(let i=0;i<attrs.length;i++){if(attrs[i].name===html_js_1.ATTRS.ENCODING){const value=attrs[i].value.toLowerCase();return value===MIME_TYPES.TEXT_HTML||value===MIME_TYPES.APPLICATION_XML}}}return ns===html_js_1.NS.SVG&&(tn===html_js_1.TAG_ID.FOREIGN_OBJECT||tn===html_js_1.TAG_ID.DESC||tn===html_js_1.TAG_ID.TITLE)}function isIntegrationPoint(tn,ns,attrs,foreignNS){return(!foreignNS||foreignNS===html_js_1.NS.HTML)&&isHtmlIntegrationPoint(tn,ns,attrs)||(!foreignNS||foreignNS===html_js_1.NS.MATHML)&&isMathMLTextIntegrationPoint(tn,ns)}exports.isIntegrationPoint=isIntegrationPoint},{"./html.js":357}],357:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.hasUnescapedText=exports.isNumberedHeader=exports.SPECIAL_ELEMENTS=exports.getTagID=exports.TAG_ID=exports.TAG_NAMES=exports.DOCUMENT_MODE=exports.ATTRS=exports.NS=void 0;var NS;(function(NS){NS["HTML"]="http://www.w3.org/1999/xhtml";NS["MATHML"]="http://www.w3.org/1998/Math/MathML";NS["SVG"]="http://www.w3.org/2000/svg";NS["XLINK"]="http://www.w3.org/1999/xlink";NS["XML"]="http://www.w3.org/XML/1998/namespace";NS["XMLNS"]="http://www.w3.org/2000/xmlns/"})(NS=exports.NS||(exports.NS={}));var ATTRS;(function(ATTRS){ATTRS["TYPE"]="type";ATTRS["ACTION"]="action";ATTRS["ENCODING"]="encoding";ATTRS["PROMPT"]="prompt";ATTRS["NAME"]="name";ATTRS["COLOR"]="color";ATTRS["FACE"]="face";ATTRS["SIZE"]="size"})(ATTRS=exports.ATTRS||(exports.ATTRS={}));var DOCUMENT_MODE;(function(DOCUMENT_MODE){DOCUMENT_MODE["NO_QUIRKS"]="no-quirks";DOCUMENT_MODE["QUIRKS"]="quirks";DOCUMENT_MODE["LIMITED_QUIRKS"]="limited-quirks"})(DOCUMENT_MODE=exports.DOCUMENT_MODE||(exports.DOCUMENT_MODE={}));var TAG_NAMES;(function(TAG_NAMES){TAG_NAMES["A"]="a";TAG_NAMES["ADDRESS"]="address";TAG_NAMES["ANNOTATION_XML"]="annotation-xml";TAG_NAMES["APPLET"]="applet";TAG_NAMES["AREA"]="area";TAG_NAMES["ARTICLE"]="article";TAG_NAMES["ASIDE"]="aside";TAG_NAMES["B"]="b";TAG_NAMES["BASE"]="base";TAG_NAMES["BASEFONT"]="basefont";TAG_NAMES["BGSOUND"]="bgsound";TAG_NAMES["BIG"]="big";TAG_NAMES["BLOCKQUOTE"]="blockquote";TAG_NAMES["BODY"]="body";TAG_NAMES["BR"]="br";TAG_NAMES["BUTTON"]="button";TAG_NAMES["CAPTION"]="caption";TAG_NAMES["CENTER"]="center";TAG_NAMES["CODE"]="code";TAG_NAMES["COL"]="col";TAG_NAMES["COLGROUP"]="colgroup";TAG_NAMES["DD"]="dd";TAG_NAMES["DESC"]="desc";TAG_NAMES["DETAILS"]="details";TAG_NAMES["DIALOG"]="dialog";TAG_NAMES["DIR"]="dir";TAG_NAMES["DIV"]="div";TAG_NAMES["DL"]="dl";TAG_NAMES["DT"]="dt";TAG_NAMES["EM"]="em";TAG_NAMES["EMBED"]="embed";TAG_NAMES["FIELDSET"]="fieldset";TAG_NAMES["FIGCAPTION"]="figcaption";TAG_NAMES["FIGURE"]="figure";TAG_NAMES["FONT"]="font";TAG_NAMES["FOOTER"]="footer";TAG_NAMES["FOREIGN_OBJECT"]="foreignObject";TAG_NAMES["FORM"]="form";TAG_NAMES["FRAME"]="frame";TAG_NAMES["FRAMESET"]="frameset";TAG_NAMES["H1"]="h1";TAG_NAMES["H2"]="h2";TAG_NAMES["H3"]="h3";TAG_NAMES["H4"]="h4";TAG_NAMES["H5"]="h5";TAG_NAMES["H6"]="h6";TAG_NAMES["HEAD"]="head";TAG_NAMES["HEADER"]="header";TAG_NAMES["HGROUP"]="hgroup";TAG_NAMES["HR"]="hr";TAG_NAMES["HTML"]="html";TAG_NAMES["I"]="i";TAG_NAMES["IMG"]="img";TAG_NAMES["IMAGE"]="image";TAG_NAMES["INPUT"]="input";TAG_NAMES["IFRAME"]="iframe";TAG_NAMES["KEYGEN"]="keygen";TAG_NAMES["LABEL"]="label";TAG_NAMES["LI"]="li";TAG_NAMES["LINK"]="link";TAG_NAMES["LISTING"]="listing";TAG_NAMES["MAIN"]="main";TAG_NAMES["MALIGNMARK"]="malignmark";TAG_NAMES["MARQUEE"]="marquee";TAG_NAMES["MATH"]="math";TAG_NAMES["MENU"]="menu";TAG_NAMES["META"]="meta";TAG_NAMES["MGLYPH"]="mglyph";TAG_NAMES["MI"]="mi";TAG_NAMES["MO"]="mo";TAG_NAMES["MN"]="mn";TAG_NAMES["MS"]="ms";TAG_NAMES["MTEXT"]="mtext";TAG_NAMES["NAV"]="nav";TAG_NAMES["NOBR"]="nobr";TAG_NAMES["NOFRAMES"]="noframes";TAG_NAMES["NOEMBED"]="noembed";TAG_NAMES["NOSCRIPT"]="noscript";TAG_NAMES["OBJECT"]="object";TAG_NAMES["OL"]="ol";TAG_NAMES["OPTGROUP"]="optgroup";TAG_NAMES["OPTION"]="option";TAG_NAMES["P"]="p";TAG_NAMES["PARAM"]="param";TAG_NAMES["PLAINTEXT"]="plaintext";TAG_NAMES["PRE"]="pre";TAG_NAMES["RB"]="rb";TAG_NAMES["RP"]="rp";TAG_NAMES["RT"]="rt";TAG_NAMES["RTC"]="rtc";TAG_NAMES["RUBY"]="ruby";TAG_NAMES["S"]="s";TAG_NAMES["SCRIPT"]="script";TAG_NAMES["SECTION"]="section";TAG_NAMES["SELECT"]="select";TAG_NAMES["SOURCE"]="source";TAG_NAMES["SMALL"]="small";TAG_NAMES["SPAN"]="span";TAG_NAMES["STRIKE"]="strike";TAG_NAMES["STRONG"]="strong";TAG_NAMES["STYLE"]="style";TAG_NAMES["SUB"]="sub";TAG_NAMES["SUMMARY"]="summary";TAG_NAMES["SUP"]="sup";TAG_NAMES["TABLE"]="table";TAG_NAMES["TBODY"]="tbody";TAG_NAMES["TEMPLATE"]="template";TAG_NAMES["TEXTAREA"]="textarea";TAG_NAMES["TFOOT"]="tfoot";TAG_NAMES["TD"]="td";TAG_NAMES["TH"]="th";TAG_NAMES["THEAD"]="thead";TAG_NAMES["TITLE"]="title";TAG_NAMES["TR"]="tr";TAG_NAMES["TRACK"]="track";TAG_NAMES["TT"]="tt";TAG_NAMES["U"]="u";TAG_NAMES["UL"]="ul";TAG_NAMES["SVG"]="svg";TAG_NAMES["VAR"]="var";TAG_NAMES["WBR"]="wbr";TAG_NAMES["XMP"]="xmp"})(TAG_NAMES=exports.TAG_NAMES||(exports.TAG_NAMES={}));var TAG_ID;(function(TAG_ID){TAG_ID[TAG_ID["UNKNOWN"]=0]="UNKNOWN";TAG_ID[TAG_ID["A"]=1]="A";TAG_ID[TAG_ID["ADDRESS"]=2]="ADDRESS";TAG_ID[TAG_ID["ANNOTATION_XML"]=3]="ANNOTATION_XML";TAG_ID[TAG_ID["APPLET"]=4]="APPLET";TAG_ID[TAG_ID["AREA"]=5]="AREA";TAG_ID[TAG_ID["ARTICLE"]=6]="ARTICLE";TAG_ID[TAG_ID["ASIDE"]=7]="ASIDE";TAG_ID[TAG_ID["B"]=8]="B";TAG_ID[TAG_ID["BASE"]=9]="BASE";TAG_ID[TAG_ID["BASEFONT"]=10]="BASEFONT";TAG_ID[TAG_ID["BGSOUND"]=11]="BGSOUND";TAG_ID[TAG_ID["BIG"]=12]="BIG";TAG_ID[TAG_ID["BLOCKQUOTE"]=13]="BLOCKQUOTE";TAG_ID[TAG_ID["BODY"]=14]="BODY";TAG_ID[TAG_ID["BR"]=15]="BR";TAG_ID[TAG_ID["BUTTON"]=16]="BUTTON";TAG_ID[TAG_ID["CAPTION"]=17]="CAPTION";TAG_ID[TAG_ID["CENTER"]=18]="CENTER";TAG_ID[TAG_ID["CODE"]=19]="CODE";TAG_ID[TAG_ID["COL"]=20]="COL";TAG_ID[TAG_ID["COLGROUP"]=21]="COLGROUP";TAG_ID[TAG_ID["DD"]=22]="DD";TAG_ID[TAG_ID["DESC"]=23]="DESC";TAG_ID[TAG_ID["DETAILS"]=24]="DETAILS";TAG_ID[TAG_ID["DIALOG"]=25]="DIALOG";TAG_ID[TAG_ID["DIR"]=26]="DIR";TAG_ID[TAG_ID["DIV"]=27]="DIV";TAG_ID[TAG_ID["DL"]=28]="DL";TAG_ID[TAG_ID["DT"]=29]="DT";TAG_ID[TAG_ID["EM"]=30]="EM";TAG_ID[TAG_ID["EMBED"]=31]="EMBED";TAG_ID[TAG_ID["FIELDSET"]=32]="FIELDSET";TAG_ID[TAG_ID["FIGCAPTION"]=33]="FIGCAPTION";TAG_ID[TAG_ID["FIGURE"]=34]="FIGURE";TAG_ID[TAG_ID["FONT"]=35]="FONT";TAG_ID[TAG_ID["FOOTER"]=36]="FOOTER";TAG_ID[TAG_ID["FOREIGN_OBJECT"]=37]="FOREIGN_OBJECT";TAG_ID[TAG_ID["FORM"]=38]="FORM";TAG_ID[TAG_ID["FRAME"]=39]="FRAME";TAG_ID[TAG_ID["FRAMESET"]=40]="FRAMESET";TAG_ID[TAG_ID["H1"]=41]="H1";TAG_ID[TAG_ID["H2"]=42]="H2";TAG_ID[TAG_ID["H3"]=43]="H3";TAG_ID[TAG_ID["H4"]=44]="H4";TAG_ID[TAG_ID["H5"]=45]="H5";TAG_ID[TAG_ID["H6"]=46]="H6";TAG_ID[TAG_ID["HEAD"]=47]="HEAD";TAG_ID[TAG_ID["HEADER"]=48]="HEADER";TAG_ID[TAG_ID["HGROUP"]=49]="HGROUP";TAG_ID[TAG_ID["HR"]=50]="HR";TAG_ID[TAG_ID["HTML"]=51]="HTML";TAG_ID[TAG_ID["I"]=52]="I";TAG_ID[TAG_ID["IMG"]=53]="IMG";TAG_ID[TAG_ID["IMAGE"]=54]="IMAGE";TAG_ID[TAG_ID["INPUT"]=55]="INPUT";TAG_ID[TAG_ID["IFRAME"]=56]="IFRAME";TAG_ID[TAG_ID["KEYGEN"]=57]="KEYGEN";TAG_ID[TAG_ID["LABEL"]=58]="LABEL";TAG_ID[TAG_ID["LI"]=59]="LI";TAG_ID[TAG_ID["LINK"]=60]="LINK";TAG_ID[TAG_ID["LISTING"]=61]="LISTING";TAG_ID[TAG_ID["MAIN"]=62]="MAIN";TAG_ID[TAG_ID["MALIGNMARK"]=63]="MALIGNMARK";TAG_ID[TAG_ID["MARQUEE"]=64]="MARQUEE";TAG_ID[TAG_ID["MATH"]=65]="MATH";TAG_ID[TAG_ID["MENU"]=66]="MENU";TAG_ID[TAG_ID["META"]=67]="META";TAG_ID[TAG_ID["MGLYPH"]=68]="MGLYPH";TAG_ID[TAG_ID["MI"]=69]="MI";TAG_ID[TAG_ID["MO"]=70]="MO";TAG_ID[TAG_ID["MN"]=71]="MN";TAG_ID[TAG_ID["MS"]=72]="MS";TAG_ID[TAG_ID["MTEXT"]=73]="MTEXT";TAG_ID[TAG_ID["NAV"]=74]="NAV";TAG_ID[TAG_ID["NOBR"]=75]="NOBR";TAG_ID[TAG_ID["NOFRAMES"]=76]="NOFRAMES";TAG_ID[TAG_ID["NOEMBED"]=77]="NOEMBED";TAG_ID[TAG_ID["NOSCRIPT"]=78]="NOSCRIPT";TAG_ID[TAG_ID["OBJECT"]=79]="OBJECT";TAG_ID[TAG_ID["OL"]=80]="OL";TAG_ID[TAG_ID["OPTGROUP"]=81]="OPTGROUP";TAG_ID[TAG_ID["OPTION"]=82]="OPTION";TAG_ID[TAG_ID["P"]=83]="P";TAG_ID[TAG_ID["PARAM"]=84]="PARAM";TAG_ID[TAG_ID["PLAINTEXT"]=85]="PLAINTEXT";TAG_ID[TAG_ID["PRE"]=86]="PRE";TAG_ID[TAG_ID["RB"]=87]="RB";TAG_ID[TAG_ID["RP"]=88]="RP";TAG_ID[TAG_ID["RT"]=89]="RT";TAG_ID[TAG_ID["RTC"]=90]="RTC";TAG_ID[TAG_ID["RUBY"]=91]="RUBY";TAG_ID[TAG_ID["S"]=92]="S";TAG_ID[TAG_ID["SCRIPT"]=93]="SCRIPT";TAG_ID[TAG_ID["SECTION"]=94]="SECTION";TAG_ID[TAG_ID["SELECT"]=95]="SELECT";TAG_ID[TAG_ID["SOURCE"]=96]="SOURCE";TAG_ID[TAG_ID["SMALL"]=97]="SMALL";TAG_ID[TAG_ID["SPAN"]=98]="SPAN";TAG_ID[TAG_ID["STRIKE"]=99]="STRIKE";TAG_ID[TAG_ID["STRONG"]=100]="STRONG";TAG_ID[TAG_ID["STYLE"]=101]="STYLE";TAG_ID[TAG_ID["SUB"]=102]="SUB";TAG_ID[TAG_ID["SUMMARY"]=103]="SUMMARY";TAG_ID[TAG_ID["SUP"]=104]="SUP";TAG_ID[TAG_ID["TABLE"]=105]="TABLE";TAG_ID[TAG_ID["TBODY"]=106]="TBODY";TAG_ID[TAG_ID["TEMPLATE"]=107]="TEMPLATE";TAG_ID[TAG_ID["TEXTAREA"]=108]="TEXTAREA";TAG_ID[TAG_ID["TFOOT"]=109]="TFOOT";TAG_ID[TAG_ID["TD"]=110]="TD";TAG_ID[TAG_ID["TH"]=111]="TH";TAG_ID[TAG_ID["THEAD"]=112]="THEAD";TAG_ID[TAG_ID["TITLE"]=113]="TITLE";TAG_ID[TAG_ID["TR"]=114]="TR";TAG_ID[TAG_ID["TRACK"]=115]="TRACK";TAG_ID[TAG_ID["TT"]=116]="TT";TAG_ID[TAG_ID["U"]=117]="U";TAG_ID[TAG_ID["UL"]=118]="UL";TAG_ID[TAG_ID["SVG"]=119]="SVG";TAG_ID[TAG_ID["VAR"]=120]="VAR";TAG_ID[TAG_ID["WBR"]=121]="WBR";TAG_ID[TAG_ID["XMP"]=122]="XMP"})(TAG_ID=exports.TAG_ID||(exports.TAG_ID={}));const TAG_NAME_TO_ID=new Map([[TAG_NAMES.A,TAG_ID.A],[TAG_NAMES.ADDRESS,TAG_ID.ADDRESS],[TAG_NAMES.ANNOTATION_XML,TAG_ID.ANNOTATION_XML],[TAG_NAMES.APPLET,TAG_ID.APPLET],[TAG_NAMES.AREA,TAG_ID.AREA],[TAG_NAMES.ARTICLE,TAG_ID.ARTICLE],[TAG_NAMES.ASIDE,TAG_ID.ASIDE],[TAG_NAMES.B,TAG_ID.B],[TAG_NAMES.BASE,TAG_ID.BASE],[TAG_NAMES.BASEFONT,TAG_ID.BASEFONT],[TAG_NAMES.BGSOUND,TAG_ID.BGSOUND],[TAG_NAMES.BIG,TAG_ID.BIG],[TAG_NAMES.BLOCKQUOTE,TAG_ID.BLOCKQUOTE],[TAG_NAMES.BODY,TAG_ID.BODY],[TAG_NAMES.BR,TAG_ID.BR],[TAG_NAMES.BUTTON,TAG_ID.BUTTON],[TAG_NAMES.CAPTION,TAG_ID.CAPTION],[TAG_NAMES.CENTER,TAG_ID.CENTER],[TAG_NAMES.CODE,TAG_ID.CODE],[TAG_NAMES.COL,TAG_ID.COL],[TAG_NAMES.COLGROUP,TAG_ID.COLGROUP],[TAG_NAMES.DD,TAG_ID.DD],[TAG_NAMES.DESC,TAG_ID.DESC],[TAG_NAMES.DETAILS,TAG_ID.DETAILS],[TAG_NAMES.DIALOG,TAG_ID.DIALOG],[TAG_NAMES.DIR,TAG_ID.DIR],[TAG_NAMES.DIV,TAG_ID.DIV],[TAG_NAMES.DL,TAG_ID.DL],[TAG_NAMES.DT,TAG_ID.DT],[TAG_NAMES.EM,TAG_ID.EM],[TAG_NAMES.EMBED,TAG_ID.EMBED],[TAG_NAMES.FIELDSET,TAG_ID.FIELDSET],[TAG_NAMES.FIGCAPTION,TAG_ID.FIGCAPTION],[TAG_NAMES.FIGURE,TAG_ID.FIGURE],[TAG_NAMES.FONT,TAG_ID.FONT],[TAG_NAMES.FOOTER,TAG_ID.FOOTER],[TAG_NAMES.FOREIGN_OBJECT,TAG_ID.FOREIGN_OBJECT],[TAG_NAMES.FORM,TAG_ID.FORM],[TAG_NAMES.FRAME,TAG_ID.FRAME],[TAG_NAMES.FRAMESET,TAG_ID.FRAMESET],[TAG_NAMES.H1,TAG_ID.H1],[TAG_NAMES.H2,TAG_ID.H2],[TAG_NAMES.H3,TAG_ID.H3],[TAG_NAMES.H4,TAG_ID.H4],[TAG_NAMES.H5,TAG_ID.H5],[TAG_NAMES.H6,TAG_ID.H6],[TAG_NAMES.HEAD,TAG_ID.HEAD],[TAG_NAMES.HEADER,TAG_ID.HEADER],[TAG_NAMES.HGROUP,TAG_ID.HGROUP],[TAG_NAMES.HR,TAG_ID.HR],[TAG_NAMES.HTML,TAG_ID.HTML],[TAG_NAMES.I,TAG_ID.I],[TAG_NAMES.IMG,TAG_ID.IMG],[TAG_NAMES.IMAGE,TAG_ID.IMAGE],[TAG_NAMES.INPUT,TAG_ID.INPUT],[TAG_NAMES.IFRAME,TAG_ID.IFRAME],[TAG_NAMES.KEYGEN,TAG_ID.KEYGEN],[TAG_NAMES.LABEL,TAG_ID.LABEL],[TAG_NAMES.LI,TAG_ID.LI],[TAG_NAMES.LINK,TAG_ID.LINK],[TAG_NAMES.LISTING,TAG_ID.LISTING],[TAG_NAMES.MAIN,TAG_ID.MAIN],[TAG_NAMES.MALIGNMARK,TAG_ID.MALIGNMARK],[TAG_NAMES.MARQUEE,TAG_ID.MARQUEE],[TAG_NAMES.MATH,TAG_ID.MATH],[TAG_NAMES.MENU,TAG_ID.MENU],[TAG_NAMES.META,TAG_ID.META],[TAG_NAMES.MGLYPH,TAG_ID.MGLYPH],[TAG_NAMES.MI,TAG_ID.MI],[TAG_NAMES.MO,TAG_ID.MO],[TAG_NAMES.MN,TAG_ID.MN],[TAG_NAMES.MS,TAG_ID.MS],[TAG_NAMES.MTEXT,TAG_ID.MTEXT],[TAG_NAMES.NAV,TAG_ID.NAV],[TAG_NAMES.NOBR,TAG_ID.NOBR],[TAG_NAMES.NOFRAMES,TAG_ID.NOFRAMES],[TAG_NAMES.NOEMBED,TAG_ID.NOEMBED],[TAG_NAMES.NOSCRIPT,TAG_ID.NOSCRIPT],[TAG_NAMES.OBJECT,TAG_ID.OBJECT],[TAG_NAMES.OL,TAG_ID.OL],[TAG_NAMES.OPTGROUP,TAG_ID.OPTGROUP],[TAG_NAMES.OPTION,TAG_ID.OPTION],[TAG_NAMES.P,TAG_ID.P],[TAG_NAMES.PARAM,TAG_ID.PARAM],[TAG_NAMES.PLAINTEXT,TAG_ID.PLAINTEXT],[TAG_NAMES.PRE,TAG_ID.PRE],[TAG_NAMES.RB,TAG_ID.RB],[TAG_NAMES.RP,TAG_ID.RP],[TAG_NAMES.RT,TAG_ID.RT],[TAG_NAMES.RTC,TAG_ID.RTC],[TAG_NAMES.RUBY,TAG_ID.RUBY],[TAG_NAMES.S,TAG_ID.S],[TAG_NAMES.SCRIPT,TAG_ID.SCRIPT],[TAG_NAMES.SECTION,TAG_ID.SECTION],[TAG_NAMES.SELECT,TAG_ID.SELECT],[TAG_NAMES.SOURCE,TAG_ID.SOURCE],[TAG_NAMES.SMALL,TAG_ID.SMALL],[TAG_NAMES.SPAN,TAG_ID.SPAN],[TAG_NAMES.STRIKE,TAG_ID.STRIKE],[TAG_NAMES.STRONG,TAG_ID.STRONG],[TAG_NAMES.STYLE,TAG_ID.STYLE],[TAG_NAMES.SUB,TAG_ID.SUB],[TAG_NAMES.SUMMARY,TAG_ID.SUMMARY],[TAG_NAMES.SUP,TAG_ID.SUP],[TAG_NAMES.TABLE,TAG_ID.TABLE],[TAG_NAMES.TBODY,TAG_ID.TBODY],[TAG_NAMES.TEMPLATE,TAG_ID.TEMPLATE],[TAG_NAMES.TEXTAREA,TAG_ID.TEXTAREA],[TAG_NAMES.TFOOT,TAG_ID.TFOOT],[TAG_NAMES.TD,TAG_ID.TD],[TAG_NAMES.TH,TAG_ID.TH],[TAG_NAMES.THEAD,TAG_ID.THEAD],[TAG_NAMES.TITLE,TAG_ID.TITLE],[TAG_NAMES.TR,TAG_ID.TR],[TAG_NAMES.TRACK,TAG_ID.TRACK],[TAG_NAMES.TT,TAG_ID.TT],[TAG_NAMES.U,TAG_ID.U],[TAG_NAMES.UL,TAG_ID.UL],[TAG_NAMES.SVG,TAG_ID.SVG],[TAG_NAMES.VAR,TAG_ID.VAR],[TAG_NAMES.WBR,TAG_ID.WBR],[TAG_NAMES.XMP,TAG_ID.XMP]]);function getTagID(tagName){var _a;return(_a=TAG_NAME_TO_ID.get(tagName))!==null&&_a!==void 0?_a:TAG_ID.UNKNOWN}exports.getTagID=getTagID;const $=TAG_ID;exports.SPECIAL_ELEMENTS={[NS.HTML]:new Set([$.ADDRESS,$.APPLET,$.AREA,$.ARTICLE,$.ASIDE,$.BASE,$.BASEFONT,$.BGSOUND,$.BLOCKQUOTE,$.BODY,$.BR,$.BUTTON,$.CAPTION,$.CENTER,$.COL,$.COLGROUP,$.DD,$.DETAILS,$.DIR,$.DIV,$.DL,$.DT,$.EMBED,$.FIELDSET,$.FIGCAPTION,$.FIGURE,$.FOOTER,$.FORM,$.FRAME,$.FRAMESET,$.H1,$.H2,$.H3,$.H4,$.H5,$.H6,$.HEAD,$.HEADER,$.HGROUP,$.HR,$.HTML,$.IFRAME,$.IMG,$.INPUT,$.LI,$.LINK,$.LISTING,$.MAIN,$.MARQUEE,$.MENU,$.META,$.NAV,$.NOEMBED,$.NOFRAMES,$.NOSCRIPT,$.OBJECT,$.OL,$.P,$.PARAM,$.PLAINTEXT,$.PRE,$.SCRIPT,$.SECTION,$.SELECT,$.SOURCE,$.STYLE,$.SUMMARY,$.TABLE,$.TBODY,$.TD,$.TEMPLATE,$.TEXTAREA,$.TFOOT,$.TH,$.THEAD,$.TITLE,$.TR,$.TRACK,$.UL,$.WBR,$.XMP]),[NS.MATHML]:new Set([$.MI,$.MO,$.MN,$.MS,$.MTEXT,$.ANNOTATION_XML]),[NS.SVG]:new Set([$.TITLE,$.FOREIGN_OBJECT,$.DESC]),[NS.XLINK]:new Set,[NS.XML]:new Set,[NS.XMLNS]:new Set};function isNumberedHeader(tn){return tn===$.H1||tn===$.H2||tn===$.H3||tn===$.H4||tn===$.H5||tn===$.H6}exports.isNumberedHeader=isNumberedHeader;const UNESCAPED_TEXT=new Set([TAG_NAMES.STYLE,TAG_NAMES.SCRIPT,TAG_NAMES.XMP,TAG_NAMES.IFRAME,TAG_NAMES.NOEMBED,TAG_NAMES.NOFRAMES,TAG_NAMES.PLAINTEXT]);function hasUnescapedText(tn,scriptingEnabled){return UNESCAPED_TEXT.has(tn)||scriptingEnabled&&tn===TAG_NAMES.NOSCRIPT}exports.hasUnescapedText=hasUnescapedText},{}],358:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getTokenAttr=exports.TokenType=void 0;var TokenType;(function(TokenType){TokenType[TokenType["CHARACTER"]=0]="CHARACTER";TokenType[TokenType["NULL_CHARACTER"]=1]="NULL_CHARACTER";TokenType[TokenType["WHITESPACE_CHARACTER"]=2]="WHITESPACE_CHARACTER";TokenType[TokenType["START_TAG"]=3]="START_TAG";TokenType[TokenType["END_TAG"]=4]="END_TAG";TokenType[TokenType["COMMENT"]=5]="COMMENT";TokenType[TokenType["DOCTYPE"]=6]="DOCTYPE";TokenType[TokenType["EOF"]=7]="EOF";TokenType[TokenType["HIBERNATION"]=8]="HIBERNATION"})(TokenType=exports.TokenType||(exports.TokenType={}));function getTokenAttr(token,attrName){for(let i=token.attrs.length-1;i>=0;i--){if(token.attrs[i].name===attrName){return token.attrs[i].value}}return null}exports.getTokenAttr=getTokenAttr},{}],359:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isUndefinedCodePoint=exports.isControlCodePoint=exports.getSurrogatePairCodePoint=exports.isSurrogatePair=exports.isSurrogate=exports.SEQUENCES=exports.CODE_POINTS=exports.REPLACEMENT_CHARACTER=void 0;const UNDEFINED_CODE_POINTS=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]);exports.REPLACEMENT_CHARACTER="�";var CODE_POINTS;(function(CODE_POINTS){CODE_POINTS[CODE_POINTS["EOF"]=-1]="EOF";CODE_POINTS[CODE_POINTS["NULL"]=0]="NULL";CODE_POINTS[CODE_POINTS["TABULATION"]=9]="TABULATION";CODE_POINTS[CODE_POINTS["CARRIAGE_RETURN"]=13]="CARRIAGE_RETURN";CODE_POINTS[CODE_POINTS["LINE_FEED"]=10]="LINE_FEED";CODE_POINTS[CODE_POINTS["FORM_FEED"]=12]="FORM_FEED";CODE_POINTS[CODE_POINTS["SPACE"]=32]="SPACE";CODE_POINTS[CODE_POINTS["EXCLAMATION_MARK"]=33]="EXCLAMATION_MARK";CODE_POINTS[CODE_POINTS["QUOTATION_MARK"]=34]="QUOTATION_MARK";CODE_POINTS[CODE_POINTS["NUMBER_SIGN"]=35]="NUMBER_SIGN";CODE_POINTS[CODE_POINTS["AMPERSAND"]=38]="AMPERSAND";CODE_POINTS[CODE_POINTS["APOSTROPHE"]=39]="APOSTROPHE";CODE_POINTS[CODE_POINTS["HYPHEN_MINUS"]=45]="HYPHEN_MINUS";CODE_POINTS[CODE_POINTS["SOLIDUS"]=47]="SOLIDUS";CODE_POINTS[CODE_POINTS["DIGIT_0"]=48]="DIGIT_0";CODE_POINTS[CODE_POINTS["DIGIT_9"]=57]="DIGIT_9";CODE_POINTS[CODE_POINTS["SEMICOLON"]=59]="SEMICOLON";CODE_POINTS[CODE_POINTS["LESS_THAN_SIGN"]=60]="LESS_THAN_SIGN";CODE_POINTS[CODE_POINTS["EQUALS_SIGN"]=61]="EQUALS_SIGN";CODE_POINTS[CODE_POINTS["GREATER_THAN_SIGN"]=62]="GREATER_THAN_SIGN";CODE_POINTS[CODE_POINTS["QUESTION_MARK"]=63]="QUESTION_MARK";CODE_POINTS[CODE_POINTS["LATIN_CAPITAL_A"]=65]="LATIN_CAPITAL_A";CODE_POINTS[CODE_POINTS["LATIN_CAPITAL_F"]=70]="LATIN_CAPITAL_F";CODE_POINTS[CODE_POINTS["LATIN_CAPITAL_X"]=88]="LATIN_CAPITAL_X";CODE_POINTS[CODE_POINTS["LATIN_CAPITAL_Z"]=90]="LATIN_CAPITAL_Z";CODE_POINTS[CODE_POINTS["RIGHT_SQUARE_BRACKET"]=93]="RIGHT_SQUARE_BRACKET";CODE_POINTS[CODE_POINTS["GRAVE_ACCENT"]=96]="GRAVE_ACCENT";CODE_POINTS[CODE_POINTS["LATIN_SMALL_A"]=97]="LATIN_SMALL_A";CODE_POINTS[CODE_POINTS["LATIN_SMALL_F"]=102]="LATIN_SMALL_F";CODE_POINTS[CODE_POINTS["LATIN_SMALL_X"]=120]="LATIN_SMALL_X";CODE_POINTS[CODE_POINTS["LATIN_SMALL_Z"]=122]="LATIN_SMALL_Z";CODE_POINTS[CODE_POINTS["REPLACEMENT_CHARACTER"]=65533]="REPLACEMENT_CHARACTER"})(CODE_POINTS=exports.CODE_POINTS||(exports.CODE_POINTS={}));exports.SEQUENCES={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function isSurrogate(cp){return cp>=55296&&cp<=57343}exports.isSurrogate=isSurrogate;function isSurrogatePair(cp){return cp>=56320&&cp<=57343}exports.isSurrogatePair=isSurrogatePair;function getSurrogatePairCodePoint(cp1,cp2){return(cp1-55296)*1024+9216+cp2}exports.getSurrogatePairCodePoint=getSurrogatePairCodePoint;function isControlCodePoint(cp){return cp!==32&&cp!==10&&cp!==13&&cp!==9&&cp!==12&&cp>=1&&cp<=31||cp>=127&&cp<=159}exports.isControlCodePoint=isControlCodePoint;function isUndefinedCodePoint(cp){return cp>=64976&&cp<=65007||UNDEFINED_CODE_POINTS.has(cp)}exports.isUndefinedCodePoint=isUndefinedCodePoint},{}],360:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.parseFragment=exports.parse=exports.TokenizerMode=exports.Tokenizer=exports.Token=exports.html=exports.foreignContent=exports.ErrorCodes=exports.serializeOuter=exports.serialize=exports.Parser=exports.defaultTreeAdapter=void 0;const index_js_1=require("./parser/index.js");var default_js_1=require("./tree-adapters/default.js");Object.defineProperty(exports,"defaultTreeAdapter",{enumerable:true,get:function(){return default_js_1.defaultTreeAdapter}});var index_js_2=require("./parser/index.js");Object.defineProperty(exports,"Parser",{enumerable:true,get:function(){return index_js_2.Parser}});var index_js_3=require("./serializer/index.js");Object.defineProperty(exports,"serialize",{enumerable:true,get:function(){return index_js_3.serialize}});Object.defineProperty(exports,"serializeOuter",{enumerable:true,get:function(){return index_js_3.serializeOuter}});var error_codes_js_1=require("./common/error-codes.js");Object.defineProperty(exports,"ErrorCodes",{enumerable:true,get:function(){return error_codes_js_1.ERR}});exports.foreignContent=require("./common/foreign-content.js");exports.html=require("./common/html.js");exports.Token=require("./common/token.js");var index_js_4=require("./tokenizer/index.js");Object.defineProperty(exports,"Tokenizer",{enumerable:true,get:function(){return index_js_4.Tokenizer}});Object.defineProperty(exports,"TokenizerMode",{enumerable:true,get:function(){return index_js_4.TokenizerMode}});function parse(html,options){return index_js_1.Parser.parse(html,options)}exports.parse=parse;function parseFragment(fragmentContext,html,options){if(typeof fragmentContext==="string"){options=html;html=fragmentContext;fragmentContext=null}const parser=index_js_1.Parser.getFragmentParser(fragmentContext,options);parser.tokenizer.write(html,true);return parser.getFragment()}exports.parseFragment=parseFragment},{"./common/error-codes.js":355,"./common/foreign-content.js":356,"./common/html.js":357,"./common/token.js":358,"./parser/index.js":362,"./serializer/index.js":364,"./tokenizer/index.js":365,"./tree-adapters/default.js":367}],361:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FormattingElementList=exports.EntryType=void 0;const NOAH_ARK_CAPACITY=3;var EntryType;(function(EntryType){EntryType[EntryType["Marker"]=0]="Marker";EntryType[EntryType["Element"]=1]="Element"})(EntryType=exports.EntryType||(exports.EntryType={}));const MARKER={type:EntryType.Marker};class FormattingElementList{constructor(treeAdapter){this.treeAdapter=treeAdapter;this.entries=[];this.bookmark=null}_getNoahArkConditionCandidates(newElement,neAttrs){const candidates=[];const neAttrsLength=neAttrs.length;const neTagName=this.treeAdapter.getTagName(newElement);const neNamespaceURI=this.treeAdapter.getNamespaceURI(newElement);for(let i=0;i<this.entries.length;i++){const entry=this.entries[i];if(entry.type===EntryType.Marker){break}const{element:element}=entry;if(this.treeAdapter.getTagName(element)===neTagName&&this.treeAdapter.getNamespaceURI(element)===neNamespaceURI){const elementAttrs=this.treeAdapter.getAttrList(element);if(elementAttrs.length===neAttrsLength){candidates.push({idx:i,attrs:elementAttrs})}}}return candidates}_ensureNoahArkCondition(newElement){if(this.entries.length<NOAH_ARK_CAPACITY)return;const neAttrs=this.treeAdapter.getAttrList(newElement);const candidates=this._getNoahArkConditionCandidates(newElement,neAttrs);if(candidates.length<NOAH_ARK_CAPACITY)return;const neAttrsMap=new Map(neAttrs.map((neAttr=>[neAttr.name,neAttr.value])));let validCandidates=0;for(let i=0;i<candidates.length;i++){const candidate=candidates[i];if(candidate.attrs.every((cAttr=>neAttrsMap.get(cAttr.name)===cAttr.value))){validCandidates+=1;if(validCandidates>=NOAH_ARK_CAPACITY){this.entries.splice(candidate.idx,1)}}}}insertMarker(){this.entries.unshift(MARKER)}pushElement(element,token){this._ensureNoahArkCondition(element);this.entries.unshift({type:EntryType.Element,element:element,token:token})}insertElementAfterBookmark(element,token){const bookmarkIdx=this.entries.indexOf(this.bookmark);this.entries.splice(bookmarkIdx,0,{type:EntryType.Element,element:element,token:token})}removeEntry(entry){const entryIndex=this.entries.indexOf(entry);if(entryIndex>=0){this.entries.splice(entryIndex,1)}}clearToLastMarker(){const markerIdx=this.entries.indexOf(MARKER);if(markerIdx>=0){this.entries.splice(0,markerIdx+1)}else{this.entries.length=0}}getElementEntryInScopeWithTagName(tagName){const entry=this.entries.find((entry=>entry.type===EntryType.Marker||this.treeAdapter.getTagName(entry.element)===tagName));return entry&&entry.type===EntryType.Element?entry:null}getElementEntry(element){return this.entries.find((entry=>entry.type===EntryType.Element&&entry.element===element))}}exports.FormattingElementList=FormattingElementList},{}],362:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Parser=void 0;const index_js_1=require("../tokenizer/index.js");const open_element_stack_js_1=require("./open-element-stack.js");const formatting_element_list_js_1=require("./formatting-element-list.js");const default_js_1=require("../tree-adapters/default.js");const doctype=require("../common/doctype.js");const foreignContent=require("../common/foreign-content.js");const error_codes_js_1=require("../common/error-codes.js");const unicode=require("../common/unicode.js");const html_js_1=require("../common/html.js");const token_js_1=require("../common/token.js");const HIDDEN_INPUT_TYPE="hidden";const AA_OUTER_LOOP_ITER=8;const AA_INNER_LOOP_ITER=3;var InsertionMode;(function(InsertionMode){InsertionMode[InsertionMode["INITIAL"]=0]="INITIAL";InsertionMode[InsertionMode["BEFORE_HTML"]=1]="BEFORE_HTML";InsertionMode[InsertionMode["BEFORE_HEAD"]=2]="BEFORE_HEAD";InsertionMode[InsertionMode["IN_HEAD"]=3]="IN_HEAD";InsertionMode[InsertionMode["IN_HEAD_NO_SCRIPT"]=4]="IN_HEAD_NO_SCRIPT";InsertionMode[InsertionMode["AFTER_HEAD"]=5]="AFTER_HEAD";InsertionMode[InsertionMode["IN_BODY"]=6]="IN_BODY";InsertionMode[InsertionMode["TEXT"]=7]="TEXT";InsertionMode[InsertionMode["IN_TABLE"]=8]="IN_TABLE";InsertionMode[InsertionMode["IN_TABLE_TEXT"]=9]="IN_TABLE_TEXT";InsertionMode[InsertionMode["IN_CAPTION"]=10]="IN_CAPTION";InsertionMode[InsertionMode["IN_COLUMN_GROUP"]=11]="IN_COLUMN_GROUP";InsertionMode[InsertionMode["IN_TABLE_BODY"]=12]="IN_TABLE_BODY";InsertionMode[InsertionMode["IN_ROW"]=13]="IN_ROW";InsertionMode[InsertionMode["IN_CELL"]=14]="IN_CELL";InsertionMode[InsertionMode["IN_SELECT"]=15]="IN_SELECT";InsertionMode[InsertionMode["IN_SELECT_IN_TABLE"]=16]="IN_SELECT_IN_TABLE";InsertionMode[InsertionMode["IN_TEMPLATE"]=17]="IN_TEMPLATE";InsertionMode[InsertionMode["AFTER_BODY"]=18]="AFTER_BODY";InsertionMode[InsertionMode["IN_FRAMESET"]=19]="IN_FRAMESET";InsertionMode[InsertionMode["AFTER_FRAMESET"]=20]="AFTER_FRAMESET";InsertionMode[InsertionMode["AFTER_AFTER_BODY"]=21]="AFTER_AFTER_BODY";InsertionMode[InsertionMode["AFTER_AFTER_FRAMESET"]=22]="AFTER_AFTER_FRAMESET"})(InsertionMode||(InsertionMode={}));const BASE_LOC={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1};const TABLE_STRUCTURE_TAGS=new Set([html_js_1.TAG_ID.TABLE,html_js_1.TAG_ID.TBODY,html_js_1.TAG_ID.TFOOT,html_js_1.TAG_ID.THEAD,html_js_1.TAG_ID.TR]);const defaultParserOptions={scriptingEnabled:true,sourceCodeLocationInfo:false,treeAdapter:default_js_1.defaultTreeAdapter,onParseError:null};class Parser{constructor(options,document,fragmentContext=null,scriptHandler=null){this.fragmentContext=fragmentContext;this.scriptHandler=scriptHandler;this.currentToken=null;this.stopped=false;this.insertionMode=InsertionMode.INITIAL;this.originalInsertionMode=InsertionMode.INITIAL;this.headElement=null;this.formElement=null;this.currentNotInHTML=false;this.tmplInsertionModeStack=[];this.pendingCharacterTokens=[];this.hasNonWhitespacePendingCharacterToken=false;this.framesetOk=true;this.skipNextNewLine=false;this.fosterParentingEnabled=false;this.options=Object.assign(Object.assign({},defaultParserOptions),options);this.treeAdapter=this.options.treeAdapter;this.onParseError=this.options.onParseError;if(this.onParseError){this.options.sourceCodeLocationInfo=true}this.document=document!==null&&document!==void 0?document:this.treeAdapter.createDocument();this.tokenizer=new index_js_1.Tokenizer(this.options,this);this.activeFormattingElements=new formatting_element_list_js_1.FormattingElementList(this.treeAdapter);this.fragmentContextID=fragmentContext?(0,html_js_1.getTagID)(this.treeAdapter.getTagName(fragmentContext)):html_js_1.TAG_ID.UNKNOWN;this._setContextModes(fragmentContext!==null&&fragmentContext!==void 0?fragmentContext:this.document,this.fragmentContextID);this.openElements=new open_element_stack_js_1.OpenElementStack(this.document,this.treeAdapter,this)}static parse(html,options){const parser=new this(options);parser.tokenizer.write(html,true);return parser.document}static getFragmentParser(fragmentContext,options){const opts=Object.assign(Object.assign({},defaultParserOptions),options);fragmentContext!==null&&fragmentContext!==void 0?fragmentContext:fragmentContext=opts.treeAdapter.createElement(html_js_1.TAG_NAMES.TEMPLATE,html_js_1.NS.HTML,[]);const documentMock=opts.treeAdapter.createElement("documentmock",html_js_1.NS.HTML,[]);const parser=new this(opts,documentMock,fragmentContext);if(parser.fragmentContextID===html_js_1.TAG_ID.TEMPLATE){parser.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE)}parser._initTokenizerForFragmentParsing();parser._insertFakeRootElement();parser._resetInsertionMode();parser._findFormInFragmentContext();return parser}getFragment(){const rootElement=this.treeAdapter.getFirstChild(this.document);const fragment=this.treeAdapter.createDocumentFragment();this._adoptNodes(rootElement,fragment);return fragment}_err(token,code,beforeToken){var _a;if(!this.onParseError)return;const loc=(_a=token.location)!==null&&_a!==void 0?_a:BASE_LOC;const err={code:code,startLine:loc.startLine,startCol:loc.startCol,startOffset:loc.startOffset,endLine:beforeToken?loc.startLine:loc.endLine,endCol:beforeToken?loc.startCol:loc.endCol,endOffset:beforeToken?loc.startOffset:loc.endOffset};this.onParseError(err)}onItemPush(node,tid,isTop){var _a,_b;(_b=(_a=this.treeAdapter).onItemPush)===null||_b===void 0?void 0:_b.call(_a,node);if(isTop&&this.openElements.stackTop>0)this._setContextModes(node,tid)}onItemPop(node,isTop){var _a,_b;if(this.options.sourceCodeLocationInfo){this._setEndLocation(node,this.currentToken)}(_b=(_a=this.treeAdapter).onItemPop)===null||_b===void 0?void 0:_b.call(_a,node,this.openElements.current);if(isTop){let current;let currentTagId;if(this.openElements.stackTop===0&&this.fragmentContext){current=this.fragmentContext;currentTagId=this.fragmentContextID}else{({current:current,currentTagId:currentTagId}=this.openElements)}this._setContextModes(current,currentTagId)}}_setContextModes(current,tid){const isHTML=current===this.document||this.treeAdapter.getNamespaceURI(current)===html_js_1.NS.HTML;this.currentNotInHTML=!isHTML;this.tokenizer.inForeignNode=!isHTML&&!this._isIntegrationPoint(tid,current)}_switchToTextParsing(currentToken,nextTokenizerState){this._insertElement(currentToken,html_js_1.NS.HTML);this.tokenizer.state=nextTokenizerState;this.originalInsertionMode=this.insertionMode;this.insertionMode=InsertionMode.TEXT}switchToPlaintextParsing(){this.insertionMode=InsertionMode.TEXT;this.originalInsertionMode=InsertionMode.IN_BODY;this.tokenizer.state=index_js_1.TokenizerMode.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let node=this.fragmentContext;while(node){if(this.treeAdapter.getTagName(node)===html_js_1.TAG_NAMES.FORM){this.formElement=node;break}node=this.treeAdapter.getParentNode(node)}}_initTokenizerForFragmentParsing(){if(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==html_js_1.NS.HTML){return}switch(this.fragmentContextID){case html_js_1.TAG_ID.TITLE:case html_js_1.TAG_ID.TEXTAREA:{this.tokenizer.state=index_js_1.TokenizerMode.RCDATA;break}case html_js_1.TAG_ID.STYLE:case html_js_1.TAG_ID.XMP:case html_js_1.TAG_ID.IFRAME:case html_js_1.TAG_ID.NOEMBED:case html_js_1.TAG_ID.NOFRAMES:case html_js_1.TAG_ID.NOSCRIPT:{this.tokenizer.state=index_js_1.TokenizerMode.RAWTEXT;break}case html_js_1.TAG_ID.SCRIPT:{this.tokenizer.state=index_js_1.TokenizerMode.SCRIPT_DATA;break}case html_js_1.TAG_ID.PLAINTEXT:{this.tokenizer.state=index_js_1.TokenizerMode.PLAINTEXT;break}default:}}_setDocumentType(token){const name=token.name||"";const publicId=token.publicId||"";const systemId=token.systemId||"";this.treeAdapter.setDocumentType(this.document,name,publicId,systemId);if(token.location){const documentChildren=this.treeAdapter.getChildNodes(this.document);const docTypeNode=documentChildren.find((node=>this.treeAdapter.isDocumentTypeNode(node)));if(docTypeNode){this.treeAdapter.setNodeSourceCodeLocation(docTypeNode,token.location)}}}_attachElementToTree(element,location){if(this.options.sourceCodeLocationInfo){const loc=location&&Object.assign(Object.assign({},location),{startTag:location});this.treeAdapter.setNodeSourceCodeLocation(element,loc)}if(this._shouldFosterParentOnInsertion()){this._fosterParentElement(element)}else{const parent=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(parent,element)}}_appendElement(token,namespaceURI){const element=this.treeAdapter.createElement(token.tagName,namespaceURI,token.attrs);this._attachElementToTree(element,token.location)}_insertElement(token,namespaceURI){const element=this.treeAdapter.createElement(token.tagName,namespaceURI,token.attrs);this._attachElementToTree(element,token.location);this.openElements.push(element,token.tagID)}_insertFakeElement(tagName,tagID){const element=this.treeAdapter.createElement(tagName,html_js_1.NS.HTML,[]);this._attachElementToTree(element,null);this.openElements.push(element,tagID)}_insertTemplate(token){const tmpl=this.treeAdapter.createElement(token.tagName,html_js_1.NS.HTML,token.attrs);const content=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(tmpl,content);this._attachElementToTree(tmpl,token.location);this.openElements.push(tmpl,token.tagID);if(this.options.sourceCodeLocationInfo)this.treeAdapter.setNodeSourceCodeLocation(content,null)}_insertFakeRootElement(){const element=this.treeAdapter.createElement(html_js_1.TAG_NAMES.HTML,html_js_1.NS.HTML,[]);if(this.options.sourceCodeLocationInfo)this.treeAdapter.setNodeSourceCodeLocation(element,null);this.treeAdapter.appendChild(this.openElements.current,element);this.openElements.push(element,html_js_1.TAG_ID.HTML)}_appendCommentNode(token,parent){const commentNode=this.treeAdapter.createCommentNode(token.data);this.treeAdapter.appendChild(parent,commentNode);if(this.options.sourceCodeLocationInfo){this.treeAdapter.setNodeSourceCodeLocation(commentNode,token.location)}}_insertCharacters(token){let parent;let beforeElement;if(this._shouldFosterParentOnInsertion()){({parent:parent,beforeElement:beforeElement}=this._findFosterParentingLocation());if(beforeElement){this.treeAdapter.insertTextBefore(parent,token.chars,beforeElement)}else{this.treeAdapter.insertText(parent,token.chars)}}else{parent=this.openElements.currentTmplContentOrNode;this.treeAdapter.insertText(parent,token.chars)}if(!token.location)return;const siblings=this.treeAdapter.getChildNodes(parent);const textNodeIdx=beforeElement?siblings.lastIndexOf(beforeElement):siblings.length;const textNode=siblings[textNodeIdx-1];const tnLoc=this.treeAdapter.getNodeSourceCodeLocation(textNode);if(tnLoc){const{endLine:endLine,endCol:endCol,endOffset:endOffset}=token.location;this.treeAdapter.updateNodeSourceCodeLocation(textNode,{endLine:endLine,endCol:endCol,endOffset:endOffset})}else if(this.options.sourceCodeLocationInfo){this.treeAdapter.setNodeSourceCodeLocation(textNode,token.location)}}_adoptNodes(donor,recipient){for(let child=this.treeAdapter.getFirstChild(donor);child;child=this.treeAdapter.getFirstChild(donor)){this.treeAdapter.detachNode(child);this.treeAdapter.appendChild(recipient,child)}}_setEndLocation(element,closingToken){if(this.treeAdapter.getNodeSourceCodeLocation(element)&&closingToken.location){const ctLoc=closingToken.location;const tn=this.treeAdapter.getTagName(element);const endLoc=closingToken.type===token_js_1.TokenType.END_TAG&&tn===closingToken.tagName?{endTag:Object.assign({},ctLoc),endLine:ctLoc.endLine,endCol:ctLoc.endCol,endOffset:ctLoc.endOffset}:{endLine:ctLoc.startLine,endCol:ctLoc.startCol,endOffset:ctLoc.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(element,endLoc)}}shouldProcessStartTagTokenInForeignContent(token){if(!this.currentNotInHTML)return false;let current;let currentTagId;if(this.openElements.stackTop===0&&this.fragmentContext){current=this.fragmentContext;currentTagId=this.fragmentContextID}else{({current:current,currentTagId:currentTagId}=this.openElements)}if(token.tagID===html_js_1.TAG_ID.SVG&&this.treeAdapter.getTagName(current)===html_js_1.TAG_NAMES.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(current)===html_js_1.NS.MATHML){return false}return this.tokenizer.inForeignNode||(token.tagID===html_js_1.TAG_ID.MGLYPH||token.tagID===html_js_1.TAG_ID.MALIGNMARK)&&!this._isIntegrationPoint(currentTagId,current,html_js_1.NS.HTML)}_processToken(token){switch(token.type){case token_js_1.TokenType.CHARACTER:{this.onCharacter(token);break}case token_js_1.TokenType.NULL_CHARACTER:{this.onNullCharacter(token);break}case token_js_1.TokenType.COMMENT:{this.onComment(token);break}case token_js_1.TokenType.DOCTYPE:{this.onDoctype(token);break}case token_js_1.TokenType.START_TAG:{this._processStartTag(token);break}case token_js_1.TokenType.END_TAG:{this.onEndTag(token);break}case token_js_1.TokenType.EOF:{this.onEof(token);break}case token_js_1.TokenType.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(token);break}}}_isIntegrationPoint(tid,element,foreignNS){const ns=this.treeAdapter.getNamespaceURI(element);const attrs=this.treeAdapter.getAttrList(element);return foreignContent.isIntegrationPoint(tid,ns,attrs,foreignNS)}_reconstructActiveFormattingElements(){const listLength=this.activeFormattingElements.entries.length;if(listLength){const endIndex=this.activeFormattingElements.entries.findIndex((entry=>entry.type===formatting_element_list_js_1.EntryType.Marker||this.openElements.contains(entry.element)));const unopenIdx=endIndex<0?listLength-1:endIndex-1;for(let i=unopenIdx;i>=0;i--){const entry=this.activeFormattingElements.entries[i];this._insertElement(entry.token,this.treeAdapter.getNamespaceURI(entry.element));entry.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags();this.openElements.popUntilTableCellPopped();this.activeFormattingElements.clearToLastMarker();this.insertionMode=InsertionMode.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.P);this.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.P)}_resetInsertionMode(){for(let i=this.openElements.stackTop;i>=0;i--){switch(i===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[i]){case html_js_1.TAG_ID.TR:{this.insertionMode=InsertionMode.IN_ROW;return}case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.THEAD:case html_js_1.TAG_ID.TFOOT:{this.insertionMode=InsertionMode.IN_TABLE_BODY;return}case html_js_1.TAG_ID.CAPTION:{this.insertionMode=InsertionMode.IN_CAPTION;return}case html_js_1.TAG_ID.COLGROUP:{this.insertionMode=InsertionMode.IN_COLUMN_GROUP;return}case html_js_1.TAG_ID.TABLE:{this.insertionMode=InsertionMode.IN_TABLE;return}case html_js_1.TAG_ID.BODY:{this.insertionMode=InsertionMode.IN_BODY;return}case html_js_1.TAG_ID.FRAMESET:{this.insertionMode=InsertionMode.IN_FRAMESET;return}case html_js_1.TAG_ID.SELECT:{this._resetInsertionModeForSelect(i);return}case html_js_1.TAG_ID.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case html_js_1.TAG_ID.HTML:{this.insertionMode=this.headElement?InsertionMode.AFTER_HEAD:InsertionMode.BEFORE_HEAD;return}case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TH:{if(i>0){this.insertionMode=InsertionMode.IN_CELL;return}break}case html_js_1.TAG_ID.HEAD:{if(i>0){this.insertionMode=InsertionMode.IN_HEAD;return}break}}}this.insertionMode=InsertionMode.IN_BODY}_resetInsertionModeForSelect(selectIdx){if(selectIdx>0){for(let i=selectIdx-1;i>0;i--){const tn=this.openElements.tagIDs[i];if(tn===html_js_1.TAG_ID.TEMPLATE){break}else if(tn===html_js_1.TAG_ID.TABLE){this.insertionMode=InsertionMode.IN_SELECT_IN_TABLE;return}}}this.insertionMode=InsertionMode.IN_SELECT}_isElementCausesFosterParenting(tn){return TABLE_STRUCTURE_TAGS.has(tn)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let i=this.openElements.stackTop;i>=0;i--){const openElement=this.openElements.items[i];switch(this.openElements.tagIDs[i]){case html_js_1.TAG_ID.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(openElement)===html_js_1.NS.HTML){return{parent:this.treeAdapter.getTemplateContent(openElement),beforeElement:null}}break}case html_js_1.TAG_ID.TABLE:{const parent=this.treeAdapter.getParentNode(openElement);if(parent){return{parent:parent,beforeElement:openElement}}return{parent:this.openElements.items[i-1],beforeElement:null}}default:}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(element){const location=this._findFosterParentingLocation();if(location.beforeElement){this.treeAdapter.insertBefore(location.parent,element,location.beforeElement)}else{this.treeAdapter.appendChild(location.parent,element)}}_isSpecialElement(element,id){const ns=this.treeAdapter.getNamespaceURI(element);return html_js_1.SPECIAL_ELEMENTS[ns].has(id)}onCharacter(token){this.skipNextNewLine=false;if(this.tokenizer.inForeignNode){characterInForeignContent(this,token);return}switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,token);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,token);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,token);break}case InsertionMode.IN_HEAD:{tokenInHead(this,token);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,token);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,token);break}case InsertionMode.IN_BODY:case InsertionMode.IN_CAPTION:case InsertionMode.IN_CELL:case InsertionMode.IN_TEMPLATE:{characterInBody(this,token);break}case InsertionMode.TEXT:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:{this._insertCharacters(token);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,token);break}case InsertionMode.IN_TABLE_TEXT:{characterInTableText(this,token);break}case InsertionMode.IN_COLUMN_GROUP:{tokenInColumnGroup(this,token);break}case InsertionMode.AFTER_BODY:{tokenAfterBody(this,token);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,token);break}default:}}onNullCharacter(token){this.skipNextNewLine=false;if(this.tokenizer.inForeignNode){nullCharacterInForeignContent(this,token);return}switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,token);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,token);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,token);break}case InsertionMode.IN_HEAD:{tokenInHead(this,token);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,token);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,token);break}case InsertionMode.TEXT:{this._insertCharacters(token);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,token);break}case InsertionMode.IN_COLUMN_GROUP:{tokenInColumnGroup(this,token);break}case InsertionMode.AFTER_BODY:{tokenAfterBody(this,token);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,token);break}default:}}onComment(token){this.skipNextNewLine=false;if(this.currentNotInHTML){appendComment(this,token);return}switch(this.insertionMode){case InsertionMode.INITIAL:case InsertionMode.BEFORE_HTML:case InsertionMode.BEFORE_HEAD:case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:case InsertionMode.IN_BODY:case InsertionMode.IN_TABLE:case InsertionMode.IN_CAPTION:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:case InsertionMode.IN_CELL:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:case InsertionMode.IN_TEMPLATE:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:{appendComment(this,token);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,token);break}case InsertionMode.AFTER_BODY:{appendCommentToRootHtmlElement(this,token);break}case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{appendCommentToDocument(this,token);break}default:}}onDoctype(token){this.skipNextNewLine=false;switch(this.insertionMode){case InsertionMode.INITIAL:{doctypeInInitialMode(this,token);break}case InsertionMode.BEFORE_HEAD:case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:{this._err(token,error_codes_js_1.ERR.misplacedDoctype);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,token);break}default:}}onStartTag(token){this.skipNextNewLine=false;this.currentToken=token;this._processStartTag(token);if(token.selfClosing&&!token.ackSelfClosing){this._err(token,error_codes_js_1.ERR.nonVoidHtmlElementStartTagWithTrailingSolidus)}}_processStartTag(token){if(this.shouldProcessStartTagTokenInForeignContent(token)){startTagInForeignContent(this,token)}else{this._startTagOutsideForeignContent(token)}}_startTagOutsideForeignContent(token){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,token);break}case InsertionMode.BEFORE_HTML:{startTagBeforeHtml(this,token);break}case InsertionMode.BEFORE_HEAD:{startTagBeforeHead(this,token);break}case InsertionMode.IN_HEAD:{startTagInHead(this,token);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{startTagInHeadNoScript(this,token);break}case InsertionMode.AFTER_HEAD:{startTagAfterHead(this,token);break}case InsertionMode.IN_BODY:{startTagInBody(this,token);break}case InsertionMode.IN_TABLE:{startTagInTable(this,token);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,token);break}case InsertionMode.IN_CAPTION:{startTagInCaption(this,token);break}case InsertionMode.IN_COLUMN_GROUP:{startTagInColumnGroup(this,token);break}case InsertionMode.IN_TABLE_BODY:{startTagInTableBody(this,token);break}case InsertionMode.IN_ROW:{startTagInRow(this,token);break}case InsertionMode.IN_CELL:{startTagInCell(this,token);break}case InsertionMode.IN_SELECT:{startTagInSelect(this,token);break}case InsertionMode.IN_SELECT_IN_TABLE:{startTagInSelectInTable(this,token);break}case InsertionMode.IN_TEMPLATE:{startTagInTemplate(this,token);break}case InsertionMode.AFTER_BODY:{startTagAfterBody(this,token);break}case InsertionMode.IN_FRAMESET:{startTagInFrameset(this,token);break}case InsertionMode.AFTER_FRAMESET:{startTagAfterFrameset(this,token);break}case InsertionMode.AFTER_AFTER_BODY:{startTagAfterAfterBody(this,token);break}case InsertionMode.AFTER_AFTER_FRAMESET:{startTagAfterAfterFrameset(this,token);break}default:}}onEndTag(token){this.skipNextNewLine=false;this.currentToken=token;if(this.currentNotInHTML){endTagInForeignContent(this,token)}else{this._endTagOutsideForeignContent(token)}}_endTagOutsideForeignContent(token){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,token);break}case InsertionMode.BEFORE_HTML:{endTagBeforeHtml(this,token);break}case InsertionMode.BEFORE_HEAD:{endTagBeforeHead(this,token);break}case InsertionMode.IN_HEAD:{endTagInHead(this,token);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{endTagInHeadNoScript(this,token);break}case InsertionMode.AFTER_HEAD:{endTagAfterHead(this,token);break}case InsertionMode.IN_BODY:{endTagInBody(this,token);break}case InsertionMode.TEXT:{endTagInText(this,token);break}case InsertionMode.IN_TABLE:{endTagInTable(this,token);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,token);break}case InsertionMode.IN_CAPTION:{endTagInCaption(this,token);break}case InsertionMode.IN_COLUMN_GROUP:{endTagInColumnGroup(this,token);break}case InsertionMode.IN_TABLE_BODY:{endTagInTableBody(this,token);break}case InsertionMode.IN_ROW:{endTagInRow(this,token);break}case InsertionMode.IN_CELL:{endTagInCell(this,token);break}case InsertionMode.IN_SELECT:{endTagInSelect(this,token);break}case InsertionMode.IN_SELECT_IN_TABLE:{endTagInSelectInTable(this,token);break}case InsertionMode.IN_TEMPLATE:{endTagInTemplate(this,token);break}case InsertionMode.AFTER_BODY:{endTagAfterBody(this,token);break}case InsertionMode.IN_FRAMESET:{endTagInFrameset(this,token);break}case InsertionMode.AFTER_FRAMESET:{endTagAfterFrameset(this,token);break}case InsertionMode.AFTER_AFTER_BODY:{tokenAfterAfterBody(this,token);break}default:}}onEof(token){switch(this.insertionMode){case InsertionMode.INITIAL:{tokenInInitialMode(this,token);break}case InsertionMode.BEFORE_HTML:{tokenBeforeHtml(this,token);break}case InsertionMode.BEFORE_HEAD:{tokenBeforeHead(this,token);break}case InsertionMode.IN_HEAD:{tokenInHead(this,token);break}case InsertionMode.IN_HEAD_NO_SCRIPT:{tokenInHeadNoScript(this,token);break}case InsertionMode.AFTER_HEAD:{tokenAfterHead(this,token);break}case InsertionMode.IN_BODY:case InsertionMode.IN_TABLE:case InsertionMode.IN_CAPTION:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:case InsertionMode.IN_CELL:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:{eofInBody(this,token);break}case InsertionMode.TEXT:{eofInText(this,token);break}case InsertionMode.IN_TABLE_TEXT:{tokenInTableText(this,token);break}case InsertionMode.IN_TEMPLATE:{eofInTemplate(this,token);break}case InsertionMode.AFTER_BODY:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{stopParsing(this,token);break}default:}}onWhitespaceCharacter(token){if(this.skipNextNewLine){this.skipNextNewLine=false;if(token.chars.charCodeAt(0)===unicode.CODE_POINTS.LINE_FEED){if(token.chars.length===1){return}token.chars=token.chars.substr(1)}}if(this.tokenizer.inForeignNode){this._insertCharacters(token);return}switch(this.insertionMode){case InsertionMode.IN_HEAD:case InsertionMode.IN_HEAD_NO_SCRIPT:case InsertionMode.AFTER_HEAD:case InsertionMode.TEXT:case InsertionMode.IN_COLUMN_GROUP:case InsertionMode.IN_SELECT:case InsertionMode.IN_SELECT_IN_TABLE:case InsertionMode.IN_FRAMESET:case InsertionMode.AFTER_FRAMESET:{this._insertCharacters(token);break}case InsertionMode.IN_BODY:case InsertionMode.IN_CAPTION:case InsertionMode.IN_CELL:case InsertionMode.IN_TEMPLATE:case InsertionMode.AFTER_BODY:case InsertionMode.AFTER_AFTER_BODY:case InsertionMode.AFTER_AFTER_FRAMESET:{whitespaceCharacterInBody(this,token);break}case InsertionMode.IN_TABLE:case InsertionMode.IN_TABLE_BODY:case InsertionMode.IN_ROW:{characterInTable(this,token);break}case InsertionMode.IN_TABLE_TEXT:{whitespaceCharacterInTableText(this,token);break}default:}}}exports.Parser=Parser;function aaObtainFormattingElementEntry(p,token){let formattingElementEntry=p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);if(formattingElementEntry){if(!p.openElements.contains(formattingElementEntry.element)){p.activeFormattingElements.removeEntry(formattingElementEntry);formattingElementEntry=null}else if(!p.openElements.hasInScope(token.tagID)){formattingElementEntry=null}}else{genericEndTagInBody(p,token)}return formattingElementEntry}function aaObtainFurthestBlock(p,formattingElementEntry){let furthestBlock=null;let idx=p.openElements.stackTop;for(;idx>=0;idx--){const element=p.openElements.items[idx];if(element===formattingElementEntry.element){break}if(p._isSpecialElement(element,p.openElements.tagIDs[idx])){furthestBlock=element}}if(!furthestBlock){p.openElements.shortenToLength(idx<0?0:idx);p.activeFormattingElements.removeEntry(formattingElementEntry)}return furthestBlock}function aaInnerLoop(p,furthestBlock,formattingElement){let lastElement=furthestBlock;let nextElement=p.openElements.getCommonAncestor(furthestBlock);for(let i=0,element=nextElement;element!==formattingElement;i++,element=nextElement){nextElement=p.openElements.getCommonAncestor(element);const elementEntry=p.activeFormattingElements.getElementEntry(element);const counterOverflow=elementEntry&&i>=AA_INNER_LOOP_ITER;const shouldRemoveFromOpenElements=!elementEntry||counterOverflow;if(shouldRemoveFromOpenElements){if(counterOverflow){p.activeFormattingElements.removeEntry(elementEntry)}p.openElements.remove(element)}else{element=aaRecreateElementFromEntry(p,elementEntry);if(lastElement===furthestBlock){p.activeFormattingElements.bookmark=elementEntry}p.treeAdapter.detachNode(lastElement);p.treeAdapter.appendChild(element,lastElement);lastElement=element}}return lastElement}function aaRecreateElementFromEntry(p,elementEntry){const ns=p.treeAdapter.getNamespaceURI(elementEntry.element);const newElement=p.treeAdapter.createElement(elementEntry.token.tagName,ns,elementEntry.token.attrs);p.openElements.replace(elementEntry.element,newElement);elementEntry.element=newElement;return newElement}function aaInsertLastNodeInCommonAncestor(p,commonAncestor,lastElement){const tn=p.treeAdapter.getTagName(commonAncestor);const tid=(0,html_js_1.getTagID)(tn);if(p._isElementCausesFosterParenting(tid)){p._fosterParentElement(lastElement)}else{const ns=p.treeAdapter.getNamespaceURI(commonAncestor);if(tid===html_js_1.TAG_ID.TEMPLATE&&ns===html_js_1.NS.HTML){commonAncestor=p.treeAdapter.getTemplateContent(commonAncestor)}p.treeAdapter.appendChild(commonAncestor,lastElement)}}function aaReplaceFormattingElement(p,furthestBlock,formattingElementEntry){const ns=p.treeAdapter.getNamespaceURI(formattingElementEntry.element);const{token:token}=formattingElementEntry;const newElement=p.treeAdapter.createElement(token.tagName,ns,token.attrs);p._adoptNodes(furthestBlock,newElement);p.treeAdapter.appendChild(furthestBlock,newElement);p.activeFormattingElements.insertElementAfterBookmark(newElement,token);p.activeFormattingElements.removeEntry(formattingElementEntry);p.openElements.remove(formattingElementEntry.element);p.openElements.insertAfter(furthestBlock,newElement,token.tagID)}function callAdoptionAgency(p,token){for(let i=0;i<AA_OUTER_LOOP_ITER;i++){const formattingElementEntry=aaObtainFormattingElementEntry(p,token);if(!formattingElementEntry){break}const furthestBlock=aaObtainFurthestBlock(p,formattingElementEntry);if(!furthestBlock){break}p.activeFormattingElements.bookmark=formattingElementEntry;const lastElement=aaInnerLoop(p,furthestBlock,formattingElementEntry.element);const commonAncestor=p.openElements.getCommonAncestor(formattingElementEntry.element);p.treeAdapter.detachNode(lastElement);if(commonAncestor)aaInsertLastNodeInCommonAncestor(p,commonAncestor,lastElement);aaReplaceFormattingElement(p,furthestBlock,formattingElementEntry)}}function appendComment(p,token){p._appendCommentNode(token,p.openElements.currentTmplContentOrNode)}function appendCommentToRootHtmlElement(p,token){p._appendCommentNode(token,p.openElements.items[0])}function appendCommentToDocument(p,token){p._appendCommentNode(token,p.document)}function stopParsing(p,token){p.stopped=true;if(token.location){const target=p.fragmentContext?0:2;for(let i=p.openElements.stackTop;i>=target;i--){p._setEndLocation(p.openElements.items[i],token)}if(!p.fragmentContext&&p.openElements.stackTop>=0){const htmlElement=p.openElements.items[0];const htmlLocation=p.treeAdapter.getNodeSourceCodeLocation(htmlElement);if(htmlLocation&&!htmlLocation.endTag){p._setEndLocation(htmlElement,token);if(p.openElements.stackTop>=1){const bodyElement=p.openElements.items[1];const bodyLocation=p.treeAdapter.getNodeSourceCodeLocation(bodyElement);if(bodyLocation&&!bodyLocation.endTag){p._setEndLocation(bodyElement,token)}}}}}}function doctypeInInitialMode(p,token){p._setDocumentType(token);const mode=token.forceQuirks?html_js_1.DOCUMENT_MODE.QUIRKS:doctype.getDocumentMode(token);if(!doctype.isConforming(token)){p._err(token,error_codes_js_1.ERR.nonConformingDoctype)}p.treeAdapter.setDocumentMode(p.document,mode);p.insertionMode=InsertionMode.BEFORE_HTML}function tokenInInitialMode(p,token){p._err(token,error_codes_js_1.ERR.missingDoctype,true);p.treeAdapter.setDocumentMode(p.document,html_js_1.DOCUMENT_MODE.QUIRKS);p.insertionMode=InsertionMode.BEFORE_HTML;p._processToken(token)}function startTagBeforeHtml(p,token){if(token.tagID===html_js_1.TAG_ID.HTML){p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.BEFORE_HEAD}else{tokenBeforeHtml(p,token)}}function endTagBeforeHtml(p,token){const tn=token.tagID;if(tn===html_js_1.TAG_ID.HTML||tn===html_js_1.TAG_ID.HEAD||tn===html_js_1.TAG_ID.BODY||tn===html_js_1.TAG_ID.BR){tokenBeforeHtml(p,token)}}function tokenBeforeHtml(p,token){p._insertFakeRootElement();p.insertionMode=InsertionMode.BEFORE_HEAD;p._processToken(token)}function startTagBeforeHead(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.HEAD:{p._insertElement(token,html_js_1.NS.HTML);p.headElement=p.openElements.current;p.insertionMode=InsertionMode.IN_HEAD;break}default:{tokenBeforeHead(p,token)}}}function endTagBeforeHead(p,token){const tn=token.tagID;if(tn===html_js_1.TAG_ID.HEAD||tn===html_js_1.TAG_ID.BODY||tn===html_js_1.TAG_ID.HTML||tn===html_js_1.TAG_ID.BR){tokenBeforeHead(p,token)}else{p._err(token,error_codes_js_1.ERR.endTagWithoutMatchingOpenElement)}}function tokenBeforeHead(p,token){p._insertFakeElement(html_js_1.TAG_NAMES.HEAD,html_js_1.TAG_ID.HEAD);p.headElement=p.openElements.current;p.insertionMode=InsertionMode.IN_HEAD;p._processToken(token)}function startTagInHead(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.BASE:case html_js_1.TAG_ID.BASEFONT:case html_js_1.TAG_ID.BGSOUND:case html_js_1.TAG_ID.LINK:case html_js_1.TAG_ID.META:{p._appendElement(token,html_js_1.NS.HTML);token.ackSelfClosing=true;break}case html_js_1.TAG_ID.TITLE:{p._switchToTextParsing(token,index_js_1.TokenizerMode.RCDATA);break}case html_js_1.TAG_ID.NOSCRIPT:{if(p.options.scriptingEnabled){p._switchToTextParsing(token,index_js_1.TokenizerMode.RAWTEXT)}else{p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.IN_HEAD_NO_SCRIPT}break}case html_js_1.TAG_ID.NOFRAMES:case html_js_1.TAG_ID.STYLE:{p._switchToTextParsing(token,index_js_1.TokenizerMode.RAWTEXT);break}case html_js_1.TAG_ID.SCRIPT:{p._switchToTextParsing(token,index_js_1.TokenizerMode.SCRIPT_DATA);break}case html_js_1.TAG_ID.TEMPLATE:{p._insertTemplate(token);p.activeFormattingElements.insertMarker();p.framesetOk=false;p.insertionMode=InsertionMode.IN_TEMPLATE;p.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE);break}case html_js_1.TAG_ID.HEAD:{p._err(token,error_codes_js_1.ERR.misplacedStartTagForHeadElement);break}default:{tokenInHead(p,token)}}}function endTagInHead(p,token){switch(token.tagID){case html_js_1.TAG_ID.HEAD:{p.openElements.pop();p.insertionMode=InsertionMode.AFTER_HEAD;break}case html_js_1.TAG_ID.BODY:case html_js_1.TAG_ID.BR:case html_js_1.TAG_ID.HTML:{tokenInHead(p,token);break}case html_js_1.TAG_ID.TEMPLATE:{templateEndTagInHead(p,token);break}default:{p._err(token,error_codes_js_1.ERR.endTagWithoutMatchingOpenElement)}}}function templateEndTagInHead(p,token){if(p.openElements.tmplCount>0){p.openElements.generateImpliedEndTagsThoroughly();if(p.openElements.currentTagId!==html_js_1.TAG_ID.TEMPLATE){p._err(token,error_codes_js_1.ERR.closingOfElementWithOpenChildElements)}p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TEMPLATE);p.activeFormattingElements.clearToLastMarker();p.tmplInsertionModeStack.shift();p._resetInsertionMode()}else{p._err(token,error_codes_js_1.ERR.endTagWithoutMatchingOpenElement)}}function tokenInHead(p,token){p.openElements.pop();p.insertionMode=InsertionMode.AFTER_HEAD;p._processToken(token)}function startTagInHeadNoScript(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.BASEFONT:case html_js_1.TAG_ID.BGSOUND:case html_js_1.TAG_ID.HEAD:case html_js_1.TAG_ID.LINK:case html_js_1.TAG_ID.META:case html_js_1.TAG_ID.NOFRAMES:case html_js_1.TAG_ID.STYLE:{startTagInHead(p,token);break}case html_js_1.TAG_ID.NOSCRIPT:{p._err(token,error_codes_js_1.ERR.nestedNoscriptInHead);break}default:{tokenInHeadNoScript(p,token)}}}function endTagInHeadNoScript(p,token){switch(token.tagID){case html_js_1.TAG_ID.NOSCRIPT:{p.openElements.pop();p.insertionMode=InsertionMode.IN_HEAD;break}case html_js_1.TAG_ID.BR:{tokenInHeadNoScript(p,token);break}default:{p._err(token,error_codes_js_1.ERR.endTagWithoutMatchingOpenElement)}}}function tokenInHeadNoScript(p,token){const errCode=token.type===token_js_1.TokenType.EOF?error_codes_js_1.ERR.openElementsLeftAfterEof:error_codes_js_1.ERR.disallowedContentInNoscriptInHead;p._err(token,errCode);p.openElements.pop();p.insertionMode=InsertionMode.IN_HEAD;p._processToken(token)}function startTagAfterHead(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.BODY:{p._insertElement(token,html_js_1.NS.HTML);p.framesetOk=false;p.insertionMode=InsertionMode.IN_BODY;break}case html_js_1.TAG_ID.FRAMESET:{p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.IN_FRAMESET;break}case html_js_1.TAG_ID.BASE:case html_js_1.TAG_ID.BASEFONT:case html_js_1.TAG_ID.BGSOUND:case html_js_1.TAG_ID.LINK:case html_js_1.TAG_ID.META:case html_js_1.TAG_ID.NOFRAMES:case html_js_1.TAG_ID.SCRIPT:case html_js_1.TAG_ID.STYLE:case html_js_1.TAG_ID.TEMPLATE:case html_js_1.TAG_ID.TITLE:{p._err(token,error_codes_js_1.ERR.abandonedHeadElementChild);p.openElements.push(p.headElement,html_js_1.TAG_ID.HEAD);startTagInHead(p,token);p.openElements.remove(p.headElement);break}case html_js_1.TAG_ID.HEAD:{p._err(token,error_codes_js_1.ERR.misplacedStartTagForHeadElement);break}default:{tokenAfterHead(p,token)}}}function endTagAfterHead(p,token){switch(token.tagID){case html_js_1.TAG_ID.BODY:case html_js_1.TAG_ID.HTML:case html_js_1.TAG_ID.BR:{tokenAfterHead(p,token);break}case html_js_1.TAG_ID.TEMPLATE:{templateEndTagInHead(p,token);break}default:{p._err(token,error_codes_js_1.ERR.endTagWithoutMatchingOpenElement)}}}function tokenAfterHead(p,token){p._insertFakeElement(html_js_1.TAG_NAMES.BODY,html_js_1.TAG_ID.BODY);p.insertionMode=InsertionMode.IN_BODY;modeInBody(p,token)}function modeInBody(p,token){switch(token.type){case token_js_1.TokenType.CHARACTER:{characterInBody(p,token);break}case token_js_1.TokenType.WHITESPACE_CHARACTER:{whitespaceCharacterInBody(p,token);break}case token_js_1.TokenType.COMMENT:{appendComment(p,token);break}case token_js_1.TokenType.START_TAG:{startTagInBody(p,token);break}case token_js_1.TokenType.END_TAG:{endTagInBody(p,token);break}case token_js_1.TokenType.EOF:{eofInBody(p,token);break}default:}}function whitespaceCharacterInBody(p,token){p._reconstructActiveFormattingElements();p._insertCharacters(token)}function characterInBody(p,token){p._reconstructActiveFormattingElements();p._insertCharacters(token);p.framesetOk=false}function htmlStartTagInBody(p,token){if(p.openElements.tmplCount===0){p.treeAdapter.adoptAttributes(p.openElements.items[0],token.attrs)}}function bodyStartTagInBody(p,token){const bodyElement=p.openElements.tryPeekProperlyNestedBodyElement();if(bodyElement&&p.openElements.tmplCount===0){p.framesetOk=false;p.treeAdapter.adoptAttributes(bodyElement,token.attrs)}}function framesetStartTagInBody(p,token){const bodyElement=p.openElements.tryPeekProperlyNestedBodyElement();if(p.framesetOk&&bodyElement){p.treeAdapter.detachNode(bodyElement);p.openElements.popAllUpToHtmlElement();p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.IN_FRAMESET}}function addressStartTagInBody(p,token){if(p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}p._insertElement(token,html_js_1.NS.HTML)}function numberedHeaderStartTagInBody(p,token){if(p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}if((0,html_js_1.isNumberedHeader)(p.openElements.currentTagId)){p.openElements.pop()}p._insertElement(token,html_js_1.NS.HTML)}function preStartTagInBody(p,token){if(p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}p._insertElement(token,html_js_1.NS.HTML);p.skipNextNewLine=true;p.framesetOk=false}function formStartTagInBody(p,token){const inTemplate=p.openElements.tmplCount>0;if(!p.formElement||inTemplate){if(p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}p._insertElement(token,html_js_1.NS.HTML);if(!inTemplate){p.formElement=p.openElements.current}}}function listItemStartTagInBody(p,token){p.framesetOk=false;const tn=token.tagID;for(let i=p.openElements.stackTop;i>=0;i--){const elementId=p.openElements.tagIDs[i];if(tn===html_js_1.TAG_ID.LI&&elementId===html_js_1.TAG_ID.LI||(tn===html_js_1.TAG_ID.DD||tn===html_js_1.TAG_ID.DT)&&(elementId===html_js_1.TAG_ID.DD||elementId===html_js_1.TAG_ID.DT)){p.openElements.generateImpliedEndTagsWithExclusion(elementId);p.openElements.popUntilTagNamePopped(elementId);break}if(elementId!==html_js_1.TAG_ID.ADDRESS&&elementId!==html_js_1.TAG_ID.DIV&&elementId!==html_js_1.TAG_ID.P&&p._isSpecialElement(p.openElements.items[i],elementId)){break}}if(p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}p._insertElement(token,html_js_1.NS.HTML)}function plaintextStartTagInBody(p,token){if(p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}p._insertElement(token,html_js_1.NS.HTML);p.tokenizer.state=index_js_1.TokenizerMode.PLAINTEXT}function buttonStartTagInBody(p,token){if(p.openElements.hasInScope(html_js_1.TAG_ID.BUTTON)){p.openElements.generateImpliedEndTags();p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.BUTTON)}p._reconstructActiveFormattingElements();p._insertElement(token,html_js_1.NS.HTML);p.framesetOk=false}function aStartTagInBody(p,token){const activeElementEntry=p.activeFormattingElements.getElementEntryInScopeWithTagName(html_js_1.TAG_NAMES.A);if(activeElementEntry){callAdoptionAgency(p,token);p.openElements.remove(activeElementEntry.element);p.activeFormattingElements.removeEntry(activeElementEntry)}p._reconstructActiveFormattingElements();p._insertElement(token,html_js_1.NS.HTML);p.activeFormattingElements.pushElement(p.openElements.current,token)}function bStartTagInBody(p,token){p._reconstructActiveFormattingElements();p._insertElement(token,html_js_1.NS.HTML);p.activeFormattingElements.pushElement(p.openElements.current,token)}function nobrStartTagInBody(p,token){p._reconstructActiveFormattingElements();if(p.openElements.hasInScope(html_js_1.TAG_ID.NOBR)){callAdoptionAgency(p,token);p._reconstructActiveFormattingElements()}p._insertElement(token,html_js_1.NS.HTML);p.activeFormattingElements.pushElement(p.openElements.current,token)}function appletStartTagInBody(p,token){p._reconstructActiveFormattingElements();p._insertElement(token,html_js_1.NS.HTML);p.activeFormattingElements.insertMarker();p.framesetOk=false}function tableStartTagInBody(p,token){if(p.treeAdapter.getDocumentMode(p.document)!==html_js_1.DOCUMENT_MODE.QUIRKS&&p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}p._insertElement(token,html_js_1.NS.HTML);p.framesetOk=false;p.insertionMode=InsertionMode.IN_TABLE}function areaStartTagInBody(p,token){p._reconstructActiveFormattingElements();p._appendElement(token,html_js_1.NS.HTML);p.framesetOk=false;token.ackSelfClosing=true}function isHiddenInput(token){const inputType=(0,token_js_1.getTokenAttr)(token,html_js_1.ATTRS.TYPE);return inputType!=null&&inputType.toLowerCase()===HIDDEN_INPUT_TYPE}function inputStartTagInBody(p,token){p._reconstructActiveFormattingElements();p._appendElement(token,html_js_1.NS.HTML);if(!isHiddenInput(token)){p.framesetOk=false}token.ackSelfClosing=true}function paramStartTagInBody(p,token){p._appendElement(token,html_js_1.NS.HTML);token.ackSelfClosing=true}function hrStartTagInBody(p,token){if(p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}p._appendElement(token,html_js_1.NS.HTML);p.framesetOk=false;token.ackSelfClosing=true}function imageStartTagInBody(p,token){token.tagName=html_js_1.TAG_NAMES.IMG;token.tagID=html_js_1.TAG_ID.IMG;areaStartTagInBody(p,token)}function textareaStartTagInBody(p,token){p._insertElement(token,html_js_1.NS.HTML);p.skipNextNewLine=true;p.tokenizer.state=index_js_1.TokenizerMode.RCDATA;p.originalInsertionMode=p.insertionMode;p.framesetOk=false;p.insertionMode=InsertionMode.TEXT}function xmpStartTagInBody(p,token){if(p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._closePElement()}p._reconstructActiveFormattingElements();p.framesetOk=false;p._switchToTextParsing(token,index_js_1.TokenizerMode.RAWTEXT)}function iframeStartTagInBody(p,token){p.framesetOk=false;p._switchToTextParsing(token,index_js_1.TokenizerMode.RAWTEXT)}function noembedStartTagInBody(p,token){p._switchToTextParsing(token,index_js_1.TokenizerMode.RAWTEXT)}function selectStartTagInBody(p,token){p._reconstructActiveFormattingElements();p._insertElement(token,html_js_1.NS.HTML);p.framesetOk=false;p.insertionMode=p.insertionMode===InsertionMode.IN_TABLE||p.insertionMode===InsertionMode.IN_CAPTION||p.insertionMode===InsertionMode.IN_TABLE_BODY||p.insertionMode===InsertionMode.IN_ROW||p.insertionMode===InsertionMode.IN_CELL?InsertionMode.IN_SELECT_IN_TABLE:InsertionMode.IN_SELECT}function optgroupStartTagInBody(p,token){if(p.openElements.currentTagId===html_js_1.TAG_ID.OPTION){p.openElements.pop()}p._reconstructActiveFormattingElements();p._insertElement(token,html_js_1.NS.HTML)}function rbStartTagInBody(p,token){if(p.openElements.hasInScope(html_js_1.TAG_ID.RUBY)){p.openElements.generateImpliedEndTags()}p._insertElement(token,html_js_1.NS.HTML)}function rtStartTagInBody(p,token){if(p.openElements.hasInScope(html_js_1.TAG_ID.RUBY)){p.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.RTC)}p._insertElement(token,html_js_1.NS.HTML)}function mathStartTagInBody(p,token){p._reconstructActiveFormattingElements();foreignContent.adjustTokenMathMLAttrs(token);foreignContent.adjustTokenXMLAttrs(token);if(token.selfClosing){p._appendElement(token,html_js_1.NS.MATHML)}else{p._insertElement(token,html_js_1.NS.MATHML)}token.ackSelfClosing=true}function svgStartTagInBody(p,token){p._reconstructActiveFormattingElements();foreignContent.adjustTokenSVGAttrs(token);foreignContent.adjustTokenXMLAttrs(token);if(token.selfClosing){p._appendElement(token,html_js_1.NS.SVG)}else{p._insertElement(token,html_js_1.NS.SVG)}token.ackSelfClosing=true}function genericStartTagInBody(p,token){p._reconstructActiveFormattingElements();p._insertElement(token,html_js_1.NS.HTML)}function startTagInBody(p,token){switch(token.tagID){case html_js_1.TAG_ID.I:case html_js_1.TAG_ID.S:case html_js_1.TAG_ID.B:case html_js_1.TAG_ID.U:case html_js_1.TAG_ID.EM:case html_js_1.TAG_ID.TT:case html_js_1.TAG_ID.BIG:case html_js_1.TAG_ID.CODE:case html_js_1.TAG_ID.FONT:case html_js_1.TAG_ID.SMALL:case html_js_1.TAG_ID.STRIKE:case html_js_1.TAG_ID.STRONG:{bStartTagInBody(p,token);break}case html_js_1.TAG_ID.A:{aStartTagInBody(p,token);break}case html_js_1.TAG_ID.H1:case html_js_1.TAG_ID.H2:case html_js_1.TAG_ID.H3:case html_js_1.TAG_ID.H4:case html_js_1.TAG_ID.H5:case html_js_1.TAG_ID.H6:{numberedHeaderStartTagInBody(p,token);break}case html_js_1.TAG_ID.P:case html_js_1.TAG_ID.DL:case html_js_1.TAG_ID.OL:case html_js_1.TAG_ID.UL:case html_js_1.TAG_ID.DIV:case html_js_1.TAG_ID.DIR:case html_js_1.TAG_ID.NAV:case html_js_1.TAG_ID.MAIN:case html_js_1.TAG_ID.MENU:case html_js_1.TAG_ID.ASIDE:case html_js_1.TAG_ID.CENTER:case html_js_1.TAG_ID.FIGURE:case html_js_1.TAG_ID.FOOTER:case html_js_1.TAG_ID.HEADER:case html_js_1.TAG_ID.HGROUP:case html_js_1.TAG_ID.DIALOG:case html_js_1.TAG_ID.DETAILS:case html_js_1.TAG_ID.ADDRESS:case html_js_1.TAG_ID.ARTICLE:case html_js_1.TAG_ID.SECTION:case html_js_1.TAG_ID.SUMMARY:case html_js_1.TAG_ID.FIELDSET:case html_js_1.TAG_ID.BLOCKQUOTE:case html_js_1.TAG_ID.FIGCAPTION:{addressStartTagInBody(p,token);break}case html_js_1.TAG_ID.LI:case html_js_1.TAG_ID.DD:case html_js_1.TAG_ID.DT:{listItemStartTagInBody(p,token);break}case html_js_1.TAG_ID.BR:case html_js_1.TAG_ID.IMG:case html_js_1.TAG_ID.WBR:case html_js_1.TAG_ID.AREA:case html_js_1.TAG_ID.EMBED:case html_js_1.TAG_ID.KEYGEN:{areaStartTagInBody(p,token);break}case html_js_1.TAG_ID.HR:{hrStartTagInBody(p,token);break}case html_js_1.TAG_ID.RB:case html_js_1.TAG_ID.RTC:{rbStartTagInBody(p,token);break}case html_js_1.TAG_ID.RT:case html_js_1.TAG_ID.RP:{rtStartTagInBody(p,token);break}case html_js_1.TAG_ID.PRE:case html_js_1.TAG_ID.LISTING:{preStartTagInBody(p,token);break}case html_js_1.TAG_ID.XMP:{xmpStartTagInBody(p,token);break}case html_js_1.TAG_ID.SVG:{svgStartTagInBody(p,token);break}case html_js_1.TAG_ID.HTML:{htmlStartTagInBody(p,token);break}case html_js_1.TAG_ID.BASE:case html_js_1.TAG_ID.LINK:case html_js_1.TAG_ID.META:case html_js_1.TAG_ID.STYLE:case html_js_1.TAG_ID.TITLE:case html_js_1.TAG_ID.SCRIPT:case html_js_1.TAG_ID.BGSOUND:case html_js_1.TAG_ID.BASEFONT:case html_js_1.TAG_ID.TEMPLATE:{startTagInHead(p,token);break}case html_js_1.TAG_ID.BODY:{bodyStartTagInBody(p,token);break}case html_js_1.TAG_ID.FORM:{formStartTagInBody(p,token);break}case html_js_1.TAG_ID.NOBR:{nobrStartTagInBody(p,token);break}case html_js_1.TAG_ID.MATH:{mathStartTagInBody(p,token);break}case html_js_1.TAG_ID.TABLE:{tableStartTagInBody(p,token);break}case html_js_1.TAG_ID.INPUT:{inputStartTagInBody(p,token);break}case html_js_1.TAG_ID.PARAM:case html_js_1.TAG_ID.TRACK:case html_js_1.TAG_ID.SOURCE:{paramStartTagInBody(p,token);break}case html_js_1.TAG_ID.IMAGE:{imageStartTagInBody(p,token);break}case html_js_1.TAG_ID.BUTTON:{buttonStartTagInBody(p,token);break}case html_js_1.TAG_ID.APPLET:case html_js_1.TAG_ID.OBJECT:case html_js_1.TAG_ID.MARQUEE:{appletStartTagInBody(p,token);break}case html_js_1.TAG_ID.IFRAME:{iframeStartTagInBody(p,token);break}case html_js_1.TAG_ID.SELECT:{selectStartTagInBody(p,token);break}case html_js_1.TAG_ID.OPTION:case html_js_1.TAG_ID.OPTGROUP:{optgroupStartTagInBody(p,token);break}case html_js_1.TAG_ID.NOEMBED:{noembedStartTagInBody(p,token);break}case html_js_1.TAG_ID.FRAMESET:{framesetStartTagInBody(p,token);break}case html_js_1.TAG_ID.TEXTAREA:{textareaStartTagInBody(p,token);break}case html_js_1.TAG_ID.NOSCRIPT:{if(p.options.scriptingEnabled){noembedStartTagInBody(p,token)}else{genericStartTagInBody(p,token)}break}case html_js_1.TAG_ID.PLAINTEXT:{plaintextStartTagInBody(p,token);break}case html_js_1.TAG_ID.COL:case html_js_1.TAG_ID.TH:case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TR:case html_js_1.TAG_ID.HEAD:case html_js_1.TAG_ID.FRAME:case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.THEAD:case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.COLGROUP:{break}default:{genericStartTagInBody(p,token)}}}function bodyEndTagInBody(p,token){if(p.openElements.hasInScope(html_js_1.TAG_ID.BODY)){p.insertionMode=InsertionMode.AFTER_BODY;if(p.options.sourceCodeLocationInfo){const bodyElement=p.openElements.tryPeekProperlyNestedBodyElement();if(bodyElement){p._setEndLocation(bodyElement,token)}}}}function htmlEndTagInBody(p,token){if(p.openElements.hasInScope(html_js_1.TAG_ID.BODY)){p.insertionMode=InsertionMode.AFTER_BODY;endTagAfterBody(p,token)}}function addressEndTagInBody(p,token){const tn=token.tagID;if(p.openElements.hasInScope(tn)){p.openElements.generateImpliedEndTags();p.openElements.popUntilTagNamePopped(tn)}}function formEndTagInBody(p){const inTemplate=p.openElements.tmplCount>0;const{formElement:formElement}=p;if(!inTemplate){p.formElement=null}if((formElement||inTemplate)&&p.openElements.hasInScope(html_js_1.TAG_ID.FORM)){p.openElements.generateImpliedEndTags();if(inTemplate){p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.FORM)}else if(formElement){p.openElements.remove(formElement)}}}function pEndTagInBody(p){if(!p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)){p._insertFakeElement(html_js_1.TAG_NAMES.P,html_js_1.TAG_ID.P)}p._closePElement()}function liEndTagInBody(p){if(p.openElements.hasInListItemScope(html_js_1.TAG_ID.LI)){p.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.LI);p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.LI)}}function ddEndTagInBody(p,token){const tn=token.tagID;if(p.openElements.hasInScope(tn)){p.openElements.generateImpliedEndTagsWithExclusion(tn);p.openElements.popUntilTagNamePopped(tn)}}function numberedHeaderEndTagInBody(p){if(p.openElements.hasNumberedHeaderInScope()){p.openElements.generateImpliedEndTags();p.openElements.popUntilNumberedHeaderPopped()}}function appletEndTagInBody(p,token){const tn=token.tagID;if(p.openElements.hasInScope(tn)){p.openElements.generateImpliedEndTags();p.openElements.popUntilTagNamePopped(tn);p.activeFormattingElements.clearToLastMarker()}}function brEndTagInBody(p){p._reconstructActiveFormattingElements();p._insertFakeElement(html_js_1.TAG_NAMES.BR,html_js_1.TAG_ID.BR);p.openElements.pop();p.framesetOk=false}function genericEndTagInBody(p,token){const tn=token.tagName;const tid=token.tagID;for(let i=p.openElements.stackTop;i>0;i--){const element=p.openElements.items[i];const elementId=p.openElements.tagIDs[i];if(tid===elementId&&(tid!==html_js_1.TAG_ID.UNKNOWN||p.treeAdapter.getTagName(element)===tn)){p.openElements.generateImpliedEndTagsWithExclusion(tid);if(p.openElements.stackTop>=i)p.openElements.shortenToLength(i);break}if(p._isSpecialElement(element,elementId)){break}}}function endTagInBody(p,token){switch(token.tagID){case html_js_1.TAG_ID.A:case html_js_1.TAG_ID.B:case html_js_1.TAG_ID.I:case html_js_1.TAG_ID.S:case html_js_1.TAG_ID.U:case html_js_1.TAG_ID.EM:case html_js_1.TAG_ID.TT:case html_js_1.TAG_ID.BIG:case html_js_1.TAG_ID.CODE:case html_js_1.TAG_ID.FONT:case html_js_1.TAG_ID.NOBR:case html_js_1.TAG_ID.SMALL:case html_js_1.TAG_ID.STRIKE:case html_js_1.TAG_ID.STRONG:{callAdoptionAgency(p,token);break}case html_js_1.TAG_ID.P:{pEndTagInBody(p);break}case html_js_1.TAG_ID.DL:case html_js_1.TAG_ID.UL:case html_js_1.TAG_ID.OL:case html_js_1.TAG_ID.DIR:case html_js_1.TAG_ID.DIV:case html_js_1.TAG_ID.NAV:case html_js_1.TAG_ID.PRE:case html_js_1.TAG_ID.MAIN:case html_js_1.TAG_ID.MENU:case html_js_1.TAG_ID.ASIDE:case html_js_1.TAG_ID.BUTTON:case html_js_1.TAG_ID.CENTER:case html_js_1.TAG_ID.FIGURE:case html_js_1.TAG_ID.FOOTER:case html_js_1.TAG_ID.HEADER:case html_js_1.TAG_ID.HGROUP:case html_js_1.TAG_ID.DIALOG:case html_js_1.TAG_ID.ADDRESS:case html_js_1.TAG_ID.ARTICLE:case html_js_1.TAG_ID.DETAILS:case html_js_1.TAG_ID.SECTION:case html_js_1.TAG_ID.SUMMARY:case html_js_1.TAG_ID.LISTING:case html_js_1.TAG_ID.FIELDSET:case html_js_1.TAG_ID.BLOCKQUOTE:case html_js_1.TAG_ID.FIGCAPTION:{addressEndTagInBody(p,token);break}case html_js_1.TAG_ID.LI:{liEndTagInBody(p);break}case html_js_1.TAG_ID.DD:case html_js_1.TAG_ID.DT:{ddEndTagInBody(p,token);break}case html_js_1.TAG_ID.H1:case html_js_1.TAG_ID.H2:case html_js_1.TAG_ID.H3:case html_js_1.TAG_ID.H4:case html_js_1.TAG_ID.H5:case html_js_1.TAG_ID.H6:{numberedHeaderEndTagInBody(p);break}case html_js_1.TAG_ID.BR:{brEndTagInBody(p);break}case html_js_1.TAG_ID.BODY:{bodyEndTagInBody(p,token);break}case html_js_1.TAG_ID.HTML:{htmlEndTagInBody(p,token);break}case html_js_1.TAG_ID.FORM:{formEndTagInBody(p);break}case html_js_1.TAG_ID.APPLET:case html_js_1.TAG_ID.OBJECT:case html_js_1.TAG_ID.MARQUEE:{appletEndTagInBody(p,token);break}case html_js_1.TAG_ID.TEMPLATE:{templateEndTagInHead(p,token);break}default:{genericEndTagInBody(p,token)}}}function eofInBody(p,token){if(p.tmplInsertionModeStack.length>0){eofInTemplate(p,token)}else{stopParsing(p,token)}}function endTagInText(p,token){var _a;if(token.tagID===html_js_1.TAG_ID.SCRIPT){(_a=p.scriptHandler)===null||_a===void 0?void 0:_a.call(p,p.openElements.current)}p.openElements.pop();p.insertionMode=p.originalInsertionMode}function eofInText(p,token){p._err(token,error_codes_js_1.ERR.eofInElementThatCanContainOnlyText);p.openElements.pop();p.insertionMode=p.originalInsertionMode;p.onEof(token)}function characterInTable(p,token){if(TABLE_STRUCTURE_TAGS.has(p.openElements.currentTagId)){p.pendingCharacterTokens.length=0;p.hasNonWhitespacePendingCharacterToken=false;p.originalInsertionMode=p.insertionMode;p.insertionMode=InsertionMode.IN_TABLE_TEXT;switch(token.type){case token_js_1.TokenType.CHARACTER:{characterInTableText(p,token);break}case token_js_1.TokenType.WHITESPACE_CHARACTER:{whitespaceCharacterInTableText(p,token);break}}}else{tokenInTable(p,token)}}function captionStartTagInTable(p,token){p.openElements.clearBackToTableContext();p.activeFormattingElements.insertMarker();p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.IN_CAPTION}function colgroupStartTagInTable(p,token){p.openElements.clearBackToTableContext();p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.IN_COLUMN_GROUP}function colStartTagInTable(p,token){p.openElements.clearBackToTableContext();p._insertFakeElement(html_js_1.TAG_NAMES.COLGROUP,html_js_1.TAG_ID.COLGROUP);p.insertionMode=InsertionMode.IN_COLUMN_GROUP;startTagInColumnGroup(p,token)}function tbodyStartTagInTable(p,token){p.openElements.clearBackToTableContext();p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.IN_TABLE_BODY}function tdStartTagInTable(p,token){p.openElements.clearBackToTableContext();p._insertFakeElement(html_js_1.TAG_NAMES.TBODY,html_js_1.TAG_ID.TBODY);p.insertionMode=InsertionMode.IN_TABLE_BODY;startTagInTableBody(p,token)}function tableStartTagInTable(p,token){if(p.openElements.hasInTableScope(html_js_1.TAG_ID.TABLE)){p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TABLE);p._resetInsertionMode();p._processStartTag(token)}}function inputStartTagInTable(p,token){if(isHiddenInput(token)){p._appendElement(token,html_js_1.NS.HTML)}else{tokenInTable(p,token)}token.ackSelfClosing=true}function formStartTagInTable(p,token){if(!p.formElement&&p.openElements.tmplCount===0){p._insertElement(token,html_js_1.NS.HTML);p.formElement=p.openElements.current;p.openElements.pop()}}function startTagInTable(p,token){switch(token.tagID){case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TH:case html_js_1.TAG_ID.TR:{tdStartTagInTable(p,token);break}case html_js_1.TAG_ID.STYLE:case html_js_1.TAG_ID.SCRIPT:case html_js_1.TAG_ID.TEMPLATE:{startTagInHead(p,token);break}case html_js_1.TAG_ID.COL:{colStartTagInTable(p,token);break}case html_js_1.TAG_ID.FORM:{formStartTagInTable(p,token);break}case html_js_1.TAG_ID.TABLE:{tableStartTagInTable(p,token);break}case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.THEAD:{tbodyStartTagInTable(p,token);break}case html_js_1.TAG_ID.INPUT:{inputStartTagInTable(p,token);break}case html_js_1.TAG_ID.CAPTION:{captionStartTagInTable(p,token);break}case html_js_1.TAG_ID.COLGROUP:{colgroupStartTagInTable(p,token);break}default:{tokenInTable(p,token)}}}function endTagInTable(p,token){switch(token.tagID){case html_js_1.TAG_ID.TABLE:{if(p.openElements.hasInTableScope(html_js_1.TAG_ID.TABLE)){p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TABLE);p._resetInsertionMode()}break}case html_js_1.TAG_ID.TEMPLATE:{templateEndTagInHead(p,token);break}case html_js_1.TAG_ID.BODY:case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.COL:case html_js_1.TAG_ID.COLGROUP:case html_js_1.TAG_ID.HTML:case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.TH:case html_js_1.TAG_ID.THEAD:case html_js_1.TAG_ID.TR:{break}default:{tokenInTable(p,token)}}}function tokenInTable(p,token){const savedFosterParentingState=p.fosterParentingEnabled;p.fosterParentingEnabled=true;modeInBody(p,token);p.fosterParentingEnabled=savedFosterParentingState}function whitespaceCharacterInTableText(p,token){p.pendingCharacterTokens.push(token)}function characterInTableText(p,token){p.pendingCharacterTokens.push(token);p.hasNonWhitespacePendingCharacterToken=true}function tokenInTableText(p,token){let i=0;if(p.hasNonWhitespacePendingCharacterToken){for(;i<p.pendingCharacterTokens.length;i++){tokenInTable(p,p.pendingCharacterTokens[i])}}else{for(;i<p.pendingCharacterTokens.length;i++){p._insertCharacters(p.pendingCharacterTokens[i])}}p.insertionMode=p.originalInsertionMode;p._processToken(token)}const TABLE_VOID_ELEMENTS=new Set([html_js_1.TAG_ID.CAPTION,html_js_1.TAG_ID.COL,html_js_1.TAG_ID.COLGROUP,html_js_1.TAG_ID.TBODY,html_js_1.TAG_ID.TD,html_js_1.TAG_ID.TFOOT,html_js_1.TAG_ID.TH,html_js_1.TAG_ID.THEAD,html_js_1.TAG_ID.TR]);function startTagInCaption(p,token){const tn=token.tagID;if(TABLE_VOID_ELEMENTS.has(tn)){if(p.openElements.hasInTableScope(html_js_1.TAG_ID.CAPTION)){p.openElements.generateImpliedEndTags();p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.CAPTION);p.activeFormattingElements.clearToLastMarker();p.insertionMode=InsertionMode.IN_TABLE;startTagInTable(p,token)}}else{startTagInBody(p,token)}}function endTagInCaption(p,token){const tn=token.tagID;switch(tn){case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.TABLE:{if(p.openElements.hasInTableScope(html_js_1.TAG_ID.CAPTION)){p.openElements.generateImpliedEndTags();p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.CAPTION);p.activeFormattingElements.clearToLastMarker();p.insertionMode=InsertionMode.IN_TABLE;if(tn===html_js_1.TAG_ID.TABLE){endTagInTable(p,token)}}break}case html_js_1.TAG_ID.BODY:case html_js_1.TAG_ID.COL:case html_js_1.TAG_ID.COLGROUP:case html_js_1.TAG_ID.HTML:case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.TH:case html_js_1.TAG_ID.THEAD:case html_js_1.TAG_ID.TR:{break}default:{endTagInBody(p,token)}}}function startTagInColumnGroup(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.COL:{p._appendElement(token,html_js_1.NS.HTML);token.ackSelfClosing=true;break}case html_js_1.TAG_ID.TEMPLATE:{startTagInHead(p,token);break}default:{tokenInColumnGroup(p,token)}}}function endTagInColumnGroup(p,token){switch(token.tagID){case html_js_1.TAG_ID.COLGROUP:{if(p.openElements.currentTagId===html_js_1.TAG_ID.COLGROUP){p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE}break}case html_js_1.TAG_ID.TEMPLATE:{templateEndTagInHead(p,token);break}case html_js_1.TAG_ID.COL:{break}default:{tokenInColumnGroup(p,token)}}}function tokenInColumnGroup(p,token){if(p.openElements.currentTagId===html_js_1.TAG_ID.COLGROUP){p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE;p._processToken(token)}}function startTagInTableBody(p,token){switch(token.tagID){case html_js_1.TAG_ID.TR:{p.openElements.clearBackToTableBodyContext();p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.IN_ROW;break}case html_js_1.TAG_ID.TH:case html_js_1.TAG_ID.TD:{p.openElements.clearBackToTableBodyContext();p._insertFakeElement(html_js_1.TAG_NAMES.TR,html_js_1.TAG_ID.TR);p.insertionMode=InsertionMode.IN_ROW;startTagInRow(p,token);break}case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.COL:case html_js_1.TAG_ID.COLGROUP:case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.THEAD:{if(p.openElements.hasTableBodyContextInTableScope()){p.openElements.clearBackToTableBodyContext();p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE;startTagInTable(p,token)}break}default:{startTagInTable(p,token)}}}function endTagInTableBody(p,token){const tn=token.tagID;switch(token.tagID){case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.THEAD:{if(p.openElements.hasInTableScope(tn)){p.openElements.clearBackToTableBodyContext();p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE}break}case html_js_1.TAG_ID.TABLE:{if(p.openElements.hasTableBodyContextInTableScope()){p.openElements.clearBackToTableBodyContext();p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE;endTagInTable(p,token)}break}case html_js_1.TAG_ID.BODY:case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.COL:case html_js_1.TAG_ID.COLGROUP:case html_js_1.TAG_ID.HTML:case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TH:case html_js_1.TAG_ID.TR:{break}default:{endTagInTable(p,token)}}}function startTagInRow(p,token){switch(token.tagID){case html_js_1.TAG_ID.TH:case html_js_1.TAG_ID.TD:{p.openElements.clearBackToTableRowContext();p._insertElement(token,html_js_1.NS.HTML);p.insertionMode=InsertionMode.IN_CELL;p.activeFormattingElements.insertMarker();break}case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.COL:case html_js_1.TAG_ID.COLGROUP:case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.THEAD:case html_js_1.TAG_ID.TR:{if(p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)){p.openElements.clearBackToTableRowContext();p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE_BODY;startTagInTableBody(p,token)}break}default:{startTagInTable(p,token)}}}function endTagInRow(p,token){switch(token.tagID){case html_js_1.TAG_ID.TR:{if(p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)){p.openElements.clearBackToTableRowContext();p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE_BODY}break}case html_js_1.TAG_ID.TABLE:{if(p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)){p.openElements.clearBackToTableRowContext();p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE_BODY;endTagInTableBody(p,token)}break}case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.THEAD:{if(p.openElements.hasInTableScope(token.tagID)||p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)){p.openElements.clearBackToTableRowContext();p.openElements.pop();p.insertionMode=InsertionMode.IN_TABLE_BODY;endTagInTableBody(p,token)}break}case html_js_1.TAG_ID.BODY:case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.COL:case html_js_1.TAG_ID.COLGROUP:case html_js_1.TAG_ID.HTML:case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TH:{break}default:{endTagInTable(p,token)}}}function startTagInCell(p,token){const tn=token.tagID;if(TABLE_VOID_ELEMENTS.has(tn)){if(p.openElements.hasInTableScope(html_js_1.TAG_ID.TD)||p.openElements.hasInTableScope(html_js_1.TAG_ID.TH)){p._closeTableCell();startTagInRow(p,token)}}else{startTagInBody(p,token)}}function endTagInCell(p,token){const tn=token.tagID;switch(tn){case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TH:{if(p.openElements.hasInTableScope(tn)){p.openElements.generateImpliedEndTags();p.openElements.popUntilTagNamePopped(tn);p.activeFormattingElements.clearToLastMarker();p.insertionMode=InsertionMode.IN_ROW}break}case html_js_1.TAG_ID.TABLE:case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.THEAD:case html_js_1.TAG_ID.TR:{if(p.openElements.hasInTableScope(tn)){p._closeTableCell();endTagInRow(p,token)}break}case html_js_1.TAG_ID.BODY:case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.COL:case html_js_1.TAG_ID.COLGROUP:case html_js_1.TAG_ID.HTML:{break}default:{endTagInBody(p,token)}}}function startTagInSelect(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.OPTION:{if(p.openElements.currentTagId===html_js_1.TAG_ID.OPTION){p.openElements.pop()}p._insertElement(token,html_js_1.NS.HTML);break}case html_js_1.TAG_ID.OPTGROUP:{if(p.openElements.currentTagId===html_js_1.TAG_ID.OPTION){p.openElements.pop()}if(p.openElements.currentTagId===html_js_1.TAG_ID.OPTGROUP){p.openElements.pop()}p._insertElement(token,html_js_1.NS.HTML);break}case html_js_1.TAG_ID.INPUT:case html_js_1.TAG_ID.KEYGEN:case html_js_1.TAG_ID.TEXTAREA:case html_js_1.TAG_ID.SELECT:{if(p.openElements.hasInSelectScope(html_js_1.TAG_ID.SELECT)){p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);p._resetInsertionMode();if(token.tagID!==html_js_1.TAG_ID.SELECT){p._processStartTag(token)}}break}case html_js_1.TAG_ID.SCRIPT:case html_js_1.TAG_ID.TEMPLATE:{startTagInHead(p,token);break}default:}}function endTagInSelect(p,token){switch(token.tagID){case html_js_1.TAG_ID.OPTGROUP:{if(p.openElements.stackTop>0&&p.openElements.currentTagId===html_js_1.TAG_ID.OPTION&&p.openElements.tagIDs[p.openElements.stackTop-1]===html_js_1.TAG_ID.OPTGROUP){p.openElements.pop()}if(p.openElements.currentTagId===html_js_1.TAG_ID.OPTGROUP){p.openElements.pop()}break}case html_js_1.TAG_ID.OPTION:{if(p.openElements.currentTagId===html_js_1.TAG_ID.OPTION){p.openElements.pop()}break}case html_js_1.TAG_ID.SELECT:{if(p.openElements.hasInSelectScope(html_js_1.TAG_ID.SELECT)){p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);p._resetInsertionMode()}break}case html_js_1.TAG_ID.TEMPLATE:{templateEndTagInHead(p,token);break}default:}}function startTagInSelectInTable(p,token){const tn=token.tagID;if(tn===html_js_1.TAG_ID.CAPTION||tn===html_js_1.TAG_ID.TABLE||tn===html_js_1.TAG_ID.TBODY||tn===html_js_1.TAG_ID.TFOOT||tn===html_js_1.TAG_ID.THEAD||tn===html_js_1.TAG_ID.TR||tn===html_js_1.TAG_ID.TD||tn===html_js_1.TAG_ID.TH){p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);p._resetInsertionMode();p._processStartTag(token)}else{startTagInSelect(p,token)}}function endTagInSelectInTable(p,token){const tn=token.tagID;if(tn===html_js_1.TAG_ID.CAPTION||tn===html_js_1.TAG_ID.TABLE||tn===html_js_1.TAG_ID.TBODY||tn===html_js_1.TAG_ID.TFOOT||tn===html_js_1.TAG_ID.THEAD||tn===html_js_1.TAG_ID.TR||tn===html_js_1.TAG_ID.TD||tn===html_js_1.TAG_ID.TH){if(p.openElements.hasInTableScope(tn)){p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);p._resetInsertionMode();p.onEndTag(token)}}else{endTagInSelect(p,token)}}function startTagInTemplate(p,token){switch(token.tagID){case html_js_1.TAG_ID.BASE:case html_js_1.TAG_ID.BASEFONT:case html_js_1.TAG_ID.BGSOUND:case html_js_1.TAG_ID.LINK:case html_js_1.TAG_ID.META:case html_js_1.TAG_ID.NOFRAMES:case html_js_1.TAG_ID.SCRIPT:case html_js_1.TAG_ID.STYLE:case html_js_1.TAG_ID.TEMPLATE:case html_js_1.TAG_ID.TITLE:{startTagInHead(p,token);break}case html_js_1.TAG_ID.CAPTION:case html_js_1.TAG_ID.COLGROUP:case html_js_1.TAG_ID.TBODY:case html_js_1.TAG_ID.TFOOT:case html_js_1.TAG_ID.THEAD:{p.tmplInsertionModeStack[0]=InsertionMode.IN_TABLE;p.insertionMode=InsertionMode.IN_TABLE;startTagInTable(p,token);break}case html_js_1.TAG_ID.COL:{p.tmplInsertionModeStack[0]=InsertionMode.IN_COLUMN_GROUP;p.insertionMode=InsertionMode.IN_COLUMN_GROUP;startTagInColumnGroup(p,token);break}case html_js_1.TAG_ID.TR:{p.tmplInsertionModeStack[0]=InsertionMode.IN_TABLE_BODY;p.insertionMode=InsertionMode.IN_TABLE_BODY;startTagInTableBody(p,token);break}case html_js_1.TAG_ID.TD:case html_js_1.TAG_ID.TH:{p.tmplInsertionModeStack[0]=InsertionMode.IN_ROW;p.insertionMode=InsertionMode.IN_ROW;startTagInRow(p,token);break}default:{p.tmplInsertionModeStack[0]=InsertionMode.IN_BODY;p.insertionMode=InsertionMode.IN_BODY;startTagInBody(p,token)}}}function endTagInTemplate(p,token){if(token.tagID===html_js_1.TAG_ID.TEMPLATE){templateEndTagInHead(p,token)}}function eofInTemplate(p,token){if(p.openElements.tmplCount>0){p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TEMPLATE);p.activeFormattingElements.clearToLastMarker();p.tmplInsertionModeStack.shift();p._resetInsertionMode();p.onEof(token)}else{stopParsing(p,token)}}function startTagAfterBody(p,token){if(token.tagID===html_js_1.TAG_ID.HTML){startTagInBody(p,token)}else{tokenAfterBody(p,token)}}function endTagAfterBody(p,token){var _a;if(token.tagID===html_js_1.TAG_ID.HTML){if(!p.fragmentContext){p.insertionMode=InsertionMode.AFTER_AFTER_BODY}if(p.options.sourceCodeLocationInfo&&p.openElements.tagIDs[0]===html_js_1.TAG_ID.HTML){p._setEndLocation(p.openElements.items[0],token);const bodyElement=p.openElements.items[1];if(bodyElement&&!((_a=p.treeAdapter.getNodeSourceCodeLocation(bodyElement))===null||_a===void 0?void 0:_a.endTag)){p._setEndLocation(bodyElement,token)}}}else{tokenAfterBody(p,token)}}function tokenAfterBody(p,token){p.insertionMode=InsertionMode.IN_BODY;modeInBody(p,token)}function startTagInFrameset(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.FRAMESET:{p._insertElement(token,html_js_1.NS.HTML);break}case html_js_1.TAG_ID.FRAME:{p._appendElement(token,html_js_1.NS.HTML);token.ackSelfClosing=true;break}case html_js_1.TAG_ID.NOFRAMES:{startTagInHead(p,token);break}default:}}function endTagInFrameset(p,token){if(token.tagID===html_js_1.TAG_ID.FRAMESET&&!p.openElements.isRootHtmlElementCurrent()){p.openElements.pop();if(!p.fragmentContext&&p.openElements.currentTagId!==html_js_1.TAG_ID.FRAMESET){p.insertionMode=InsertionMode.AFTER_FRAMESET}}}function startTagAfterFrameset(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.NOFRAMES:{startTagInHead(p,token);break}default:}}function endTagAfterFrameset(p,token){if(token.tagID===html_js_1.TAG_ID.HTML){p.insertionMode=InsertionMode.AFTER_AFTER_FRAMESET}}function startTagAfterAfterBody(p,token){if(token.tagID===html_js_1.TAG_ID.HTML){startTagInBody(p,token)}else{tokenAfterAfterBody(p,token)}}function tokenAfterAfterBody(p,token){p.insertionMode=InsertionMode.IN_BODY;modeInBody(p,token)}function startTagAfterAfterFrameset(p,token){switch(token.tagID){case html_js_1.TAG_ID.HTML:{startTagInBody(p,token);break}case html_js_1.TAG_ID.NOFRAMES:{startTagInHead(p,token);break}default:}}function nullCharacterInForeignContent(p,token){token.chars=unicode.REPLACEMENT_CHARACTER;p._insertCharacters(token)}function characterInForeignContent(p,token){p._insertCharacters(token);p.framesetOk=false}function popUntilHtmlOrIntegrationPoint(p){while(p.treeAdapter.getNamespaceURI(p.openElements.current)!==html_js_1.NS.HTML&&!p._isIntegrationPoint(p.openElements.currentTagId,p.openElements.current)){p.openElements.pop()}}function startTagInForeignContent(p,token){if(foreignContent.causesExit(token)){popUntilHtmlOrIntegrationPoint(p);p._startTagOutsideForeignContent(token)}else{const current=p._getAdjustedCurrentElement();const currentNs=p.treeAdapter.getNamespaceURI(current);if(currentNs===html_js_1.NS.MATHML){foreignContent.adjustTokenMathMLAttrs(token)}else if(currentNs===html_js_1.NS.SVG){foreignContent.adjustTokenSVGTagName(token);foreignContent.adjustTokenSVGAttrs(token)}foreignContent.adjustTokenXMLAttrs(token);if(token.selfClosing){p._appendElement(token,currentNs)}else{p._insertElement(token,currentNs)}token.ackSelfClosing=true}}function endTagInForeignContent(p,token){if(token.tagID===html_js_1.TAG_ID.P||token.tagID===html_js_1.TAG_ID.BR){popUntilHtmlOrIntegrationPoint(p);p._endTagOutsideForeignContent(token);return}for(let i=p.openElements.stackTop;i>0;i--){const element=p.openElements.items[i];if(p.treeAdapter.getNamespaceURI(element)===html_js_1.NS.HTML){p._endTagOutsideForeignContent(token);break}const tagName=p.treeAdapter.getTagName(element);if(tagName.toLowerCase()===token.tagName){token.tagName=tagName;p.openElements.shortenToLength(i);break}}}},{"../common/doctype.js":354,"../common/error-codes.js":355,"../common/foreign-content.js":356,"../common/html.js":357,"../common/token.js":358,"../common/unicode.js":359,"../tokenizer/index.js":365,"../tree-adapters/default.js":367,"./formatting-element-list.js":361,"./open-element-stack.js":363}],363:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.OpenElementStack=void 0;const html_js_1=require("../common/html.js");const IMPLICIT_END_TAG_REQUIRED=new Set([html_js_1.TAG_ID.DD,html_js_1.TAG_ID.DT,html_js_1.TAG_ID.LI,html_js_1.TAG_ID.OPTGROUP,html_js_1.TAG_ID.OPTION,html_js_1.TAG_ID.P,html_js_1.TAG_ID.RB,html_js_1.TAG_ID.RP,html_js_1.TAG_ID.RT,html_js_1.TAG_ID.RTC]);const IMPLICIT_END_TAG_REQUIRED_THOROUGHLY=new Set([...IMPLICIT_END_TAG_REQUIRED,html_js_1.TAG_ID.CAPTION,html_js_1.TAG_ID.COLGROUP,html_js_1.TAG_ID.TBODY,html_js_1.TAG_ID.TD,html_js_1.TAG_ID.TFOOT,html_js_1.TAG_ID.TH,html_js_1.TAG_ID.THEAD,html_js_1.TAG_ID.TR]);const SCOPING_ELEMENT_NS=new Map([[html_js_1.TAG_ID.APPLET,html_js_1.NS.HTML],[html_js_1.TAG_ID.CAPTION,html_js_1.NS.HTML],[html_js_1.TAG_ID.HTML,html_js_1.NS.HTML],[html_js_1.TAG_ID.MARQUEE,html_js_1.NS.HTML],[html_js_1.TAG_ID.OBJECT,html_js_1.NS.HTML],[html_js_1.TAG_ID.TABLE,html_js_1.NS.HTML],[html_js_1.TAG_ID.TD,html_js_1.NS.HTML],[html_js_1.TAG_ID.TEMPLATE,html_js_1.NS.HTML],[html_js_1.TAG_ID.TH,html_js_1.NS.HTML],[html_js_1.TAG_ID.ANNOTATION_XML,html_js_1.NS.MATHML],[html_js_1.TAG_ID.MI,html_js_1.NS.MATHML],[html_js_1.TAG_ID.MN,html_js_1.NS.MATHML],[html_js_1.TAG_ID.MO,html_js_1.NS.MATHML],[html_js_1.TAG_ID.MS,html_js_1.NS.MATHML],[html_js_1.TAG_ID.MTEXT,html_js_1.NS.MATHML],[html_js_1.TAG_ID.DESC,html_js_1.NS.SVG],[html_js_1.TAG_ID.FOREIGN_OBJECT,html_js_1.NS.SVG],[html_js_1.TAG_ID.TITLE,html_js_1.NS.SVG]]);const NAMED_HEADERS=[html_js_1.TAG_ID.H1,html_js_1.TAG_ID.H2,html_js_1.TAG_ID.H3,html_js_1.TAG_ID.H4,html_js_1.TAG_ID.H5,html_js_1.TAG_ID.H6];const TABLE_ROW_CONTEXT=[html_js_1.TAG_ID.TR,html_js_1.TAG_ID.TEMPLATE,html_js_1.TAG_ID.HTML];const TABLE_BODY_CONTEXT=[html_js_1.TAG_ID.TBODY,html_js_1.TAG_ID.TFOOT,html_js_1.TAG_ID.THEAD,html_js_1.TAG_ID.TEMPLATE,html_js_1.TAG_ID.HTML];const TABLE_CONTEXT=[html_js_1.TAG_ID.TABLE,html_js_1.TAG_ID.TEMPLATE,html_js_1.TAG_ID.HTML];const TABLE_CELLS=[html_js_1.TAG_ID.TD,html_js_1.TAG_ID.TH];class OpenElementStack{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(document,treeAdapter,handler){this.treeAdapter=treeAdapter;this.handler=handler;this.items=[];this.tagIDs=[];this.stackTop=-1;this.tmplCount=0;this.currentTagId=html_js_1.TAG_ID.UNKNOWN;this.current=document}_indexOf(element){return this.items.lastIndexOf(element,this.stackTop)}_isInTemplate(){return this.currentTagId===html_js_1.TAG_ID.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===html_js_1.NS.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop];this.currentTagId=this.tagIDs[this.stackTop]}push(element,tagID){this.stackTop++;this.items[this.stackTop]=element;this.current=element;this.tagIDs[this.stackTop]=tagID;this.currentTagId=tagID;if(this._isInTemplate()){this.tmplCount++}this.handler.onItemPush(element,tagID,true)}pop(){const popped=this.current;if(this.tmplCount>0&&this._isInTemplate()){this.tmplCount--}this.stackTop--;this._updateCurrentElement();this.handler.onItemPop(popped,true)}replace(oldElement,newElement){const idx=this._indexOf(oldElement);this.items[idx]=newElement;if(idx===this.stackTop){this.current=newElement}}insertAfter(referenceElement,newElement,newElementID){const insertionIdx=this._indexOf(referenceElement)+1;this.items.splice(insertionIdx,0,newElement);this.tagIDs.splice(insertionIdx,0,newElementID);this.stackTop++;if(insertionIdx===this.stackTop){this._updateCurrentElement()}this.handler.onItemPush(this.current,this.currentTagId,insertionIdx===this.stackTop)}popUntilTagNamePopped(tagName){let targetIdx=this.stackTop+1;do{targetIdx=this.tagIDs.lastIndexOf(tagName,targetIdx-1)}while(targetIdx>0&&this.treeAdapter.getNamespaceURI(this.items[targetIdx])!==html_js_1.NS.HTML);this.shortenToLength(targetIdx<0?0:targetIdx)}shortenToLength(idx){while(this.stackTop>=idx){const popped=this.current;if(this.tmplCount>0&&this._isInTemplate()){this.tmplCount-=1}this.stackTop--;this._updateCurrentElement();this.handler.onItemPop(popped,this.stackTop<idx)}}popUntilElementPopped(element){const idx=this._indexOf(element);this.shortenToLength(idx<0?0:idx)}popUntilPopped(tagNames,targetNS){const idx=this._indexOfTagNames(tagNames,targetNS);this.shortenToLength(idx<0?0:idx)}popUntilNumberedHeaderPopped(){this.popUntilPopped(NAMED_HEADERS,html_js_1.NS.HTML)}popUntilTableCellPopped(){this.popUntilPopped(TABLE_CELLS,html_js_1.NS.HTML)}popAllUpToHtmlElement(){this.tmplCount=0;this.shortenToLength(1)}_indexOfTagNames(tagNames,namespace){for(let i=this.stackTop;i>=0;i--){if(tagNames.includes(this.tagIDs[i])&&this.treeAdapter.getNamespaceURI(this.items[i])===namespace){return i}}return-1}clearBackTo(tagNames,targetNS){const idx=this._indexOfTagNames(tagNames,targetNS);this.shortenToLength(idx+1)}clearBackToTableContext(){this.clearBackTo(TABLE_CONTEXT,html_js_1.NS.HTML)}clearBackToTableBodyContext(){this.clearBackTo(TABLE_BODY_CONTEXT,html_js_1.NS.HTML)}clearBackToTableRowContext(){this.clearBackTo(TABLE_ROW_CONTEXT,html_js_1.NS.HTML)}remove(element){const idx=this._indexOf(element);if(idx>=0){if(idx===this.stackTop){this.pop()}else{this.items.splice(idx,1);this.tagIDs.splice(idx,1);this.stackTop--;this._updateCurrentElement();this.handler.onItemPop(element,false)}}}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===html_js_1.TAG_ID.BODY?this.items[1]:null}contains(element){return this._indexOf(element)>-1}getCommonAncestor(element){const elementIdx=this._indexOf(element)-1;return elementIdx>=0?this.items[elementIdx]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===html_js_1.TAG_ID.HTML}hasInScope(tagName){for(let i=this.stackTop;i>=0;i--){const tn=this.tagIDs[i];const ns=this.treeAdapter.getNamespaceURI(this.items[i]);if(tn===tagName&&ns===html_js_1.NS.HTML){return true}if(SCOPING_ELEMENT_NS.get(tn)===ns){return false}}return true}hasNumberedHeaderInScope(){for(let i=this.stackTop;i>=0;i--){const tn=this.tagIDs[i];const ns=this.treeAdapter.getNamespaceURI(this.items[i]);if((0,html_js_1.isNumberedHeader)(tn)&&ns===html_js_1.NS.HTML){return true}if(SCOPING_ELEMENT_NS.get(tn)===ns){return false}}return true}hasInListItemScope(tagName){for(let i=this.stackTop;i>=0;i--){const tn=this.tagIDs[i];const ns=this.treeAdapter.getNamespaceURI(this.items[i]);if(tn===tagName&&ns===html_js_1.NS.HTML){return true}if((tn===html_js_1.TAG_ID.UL||tn===html_js_1.TAG_ID.OL)&&ns===html_js_1.NS.HTML||SCOPING_ELEMENT_NS.get(tn)===ns){return false}}return true}hasInButtonScope(tagName){for(let i=this.stackTop;i>=0;i--){const tn=this.tagIDs[i];const ns=this.treeAdapter.getNamespaceURI(this.items[i]);if(tn===tagName&&ns===html_js_1.NS.HTML){return true}if(tn===html_js_1.TAG_ID.BUTTON&&ns===html_js_1.NS.HTML||SCOPING_ELEMENT_NS.get(tn)===ns){return false}}return true}hasInTableScope(tagName){for(let i=this.stackTop;i>=0;i--){const tn=this.tagIDs[i];const ns=this.treeAdapter.getNamespaceURI(this.items[i]);if(ns!==html_js_1.NS.HTML){continue}if(tn===tagName){return true}if(tn===html_js_1.TAG_ID.TABLE||tn===html_js_1.TAG_ID.TEMPLATE||tn===html_js_1.TAG_ID.HTML){return false}}return true}hasTableBodyContextInTableScope(){for(let i=this.stackTop;i>=0;i--){const tn=this.tagIDs[i];const ns=this.treeAdapter.getNamespaceURI(this.items[i]);if(ns!==html_js_1.NS.HTML){continue}if(tn===html_js_1.TAG_ID.TBODY||tn===html_js_1.TAG_ID.THEAD||tn===html_js_1.TAG_ID.TFOOT){return true}if(tn===html_js_1.TAG_ID.TABLE||tn===html_js_1.TAG_ID.HTML){return false}}return true}hasInSelectScope(tagName){for(let i=this.stackTop;i>=0;i--){const tn=this.tagIDs[i];const ns=this.treeAdapter.getNamespaceURI(this.items[i]);if(ns!==html_js_1.NS.HTML){continue}if(tn===tagName){return true}if(tn!==html_js_1.TAG_ID.OPTION&&tn!==html_js_1.TAG_ID.OPTGROUP){return false}}return true}generateImpliedEndTags(){while(IMPLICIT_END_TAG_REQUIRED.has(this.currentTagId)){this.pop()}}generateImpliedEndTagsThoroughly(){while(IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId)){this.pop()}}generateImpliedEndTagsWithExclusion(exclusionId){while(this.currentTagId!==exclusionId&&IMPLICIT_END_TAG_REQUIRED_THOROUGHLY.has(this.currentTagId)){this.pop()}}}exports.OpenElementStack=OpenElementStack},{"../common/html.js":357}],364:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.serializeOuter=exports.serialize=void 0;const html_js_1=require("../common/html.js");const escape_js_1=require("entities/lib/escape.js");const default_js_1=require("../tree-adapters/default.js");const VOID_ELEMENTS=new Set([html_js_1.TAG_NAMES.AREA,html_js_1.TAG_NAMES.BASE,html_js_1.TAG_NAMES.BASEFONT,html_js_1.TAG_NAMES.BGSOUND,html_js_1.TAG_NAMES.BR,html_js_1.TAG_NAMES.COL,html_js_1.TAG_NAMES.EMBED,html_js_1.TAG_NAMES.FRAME,html_js_1.TAG_NAMES.HR,html_js_1.TAG_NAMES.IMG,html_js_1.TAG_NAMES.INPUT,html_js_1.TAG_NAMES.KEYGEN,html_js_1.TAG_NAMES.LINK,html_js_1.TAG_NAMES.META,html_js_1.TAG_NAMES.PARAM,html_js_1.TAG_NAMES.SOURCE,html_js_1.TAG_NAMES.TRACK,html_js_1.TAG_NAMES.WBR]);function isVoidElement(node,options){return options.treeAdapter.isElementNode(node)&&options.treeAdapter.getNamespaceURI(node)===html_js_1.NS.HTML&&VOID_ELEMENTS.has(options.treeAdapter.getTagName(node))}const defaultOpts={treeAdapter:default_js_1.defaultTreeAdapter,scriptingEnabled:true};function serialize(node,options){const opts=Object.assign(Object.assign({},defaultOpts),options);if(isVoidElement(node,opts)){return""}return serializeChildNodes(node,opts)}exports.serialize=serialize;function serializeOuter(node,options){const opts=Object.assign(Object.assign({},defaultOpts),options);return serializeNode(node,opts)}exports.serializeOuter=serializeOuter;function serializeChildNodes(parentNode,options){let html="";const container=options.treeAdapter.isElementNode(parentNode)&&options.treeAdapter.getTagName(parentNode)===html_js_1.TAG_NAMES.TEMPLATE&&options.treeAdapter.getNamespaceURI(parentNode)===html_js_1.NS.HTML?options.treeAdapter.getTemplateContent(parentNode):parentNode;const childNodes=options.treeAdapter.getChildNodes(container);if(childNodes){for(const currentNode of childNodes){html+=serializeNode(currentNode,options)}}return html}function serializeNode(node,options){if(options.treeAdapter.isElementNode(node)){return serializeElement(node,options)}if(options.treeAdapter.isTextNode(node)){return serializeTextNode(node,options)}if(options.treeAdapter.isCommentNode(node)){return serializeCommentNode(node,options)}if(options.treeAdapter.isDocumentTypeNode(node)){return serializeDocumentTypeNode(node,options)}return""}function serializeElement(node,options){const tn=options.treeAdapter.getTagName(node);return`<${tn}${serializeAttributes(node,options)}>${isVoidElement(node,options)?"":`${serializeChildNodes(node,options)}</${tn}>`}`}function serializeAttributes(node,{treeAdapter:treeAdapter}){let html="";for(const attr of treeAdapter.getAttrList(node)){html+=" ";if(!attr.namespace){html+=attr.name}else switch(attr.namespace){case html_js_1.NS.XML:{html+=`xml:${attr.name}`;break}case html_js_1.NS.XMLNS:{if(attr.name!=="xmlns"){html+="xmlns:"}html+=attr.name;break}case html_js_1.NS.XLINK:{html+=`xlink:${attr.name}`;break}default:{html+=`${attr.prefix}:${attr.name}`}}html+=`="${(0,escape_js_1.escapeAttribute)(attr.value)}"`}return html}function serializeTextNode(node,options){const{treeAdapter:treeAdapter}=options;const content=treeAdapter.getTextNodeContent(node);const parent=treeAdapter.getParentNode(node);const parentTn=parent&&treeAdapter.isElementNode(parent)&&treeAdapter.getTagName(parent);return parentTn&&treeAdapter.getNamespaceURI(parent)===html_js_1.NS.HTML&&(0,html_js_1.hasUnescapedText)(parentTn,options.scriptingEnabled)?content:(0,escape_js_1.escapeText)(content)}function serializeCommentNode(node,{treeAdapter:treeAdapter}){return`\x3c!--${treeAdapter.getCommentNodeContent(node)}--\x3e`}function serializeDocumentTypeNode(node,{treeAdapter:treeAdapter}){return`<!DOCTYPE ${treeAdapter.getDocumentTypeNodeName(node)}>`}},{"../common/html.js":357,"../tree-adapters/default.js":367,"entities/lib/escape.js":182}],365:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Tokenizer=exports.TokenizerMode=void 0;const preprocessor_js_1=require("./preprocessor.js");const unicode_js_1=require("../common/unicode.js");const token_js_1=require("../common/token.js");const decode_js_1=require("entities/lib/decode.js");const error_codes_js_1=require("../common/error-codes.js");const html_js_1=require("../common/html.js");const C1_CONTROLS_REFERENCE_REPLACEMENTS=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);var State;(function(State){State[State["DATA"]=0]="DATA";State[State["RCDATA"]=1]="RCDATA";State[State["RAWTEXT"]=2]="RAWTEXT";State[State["SCRIPT_DATA"]=3]="SCRIPT_DATA";State[State["PLAINTEXT"]=4]="PLAINTEXT";State[State["TAG_OPEN"]=5]="TAG_OPEN";State[State["END_TAG_OPEN"]=6]="END_TAG_OPEN";State[State["TAG_NAME"]=7]="TAG_NAME";State[State["RCDATA_LESS_THAN_SIGN"]=8]="RCDATA_LESS_THAN_SIGN";State[State["RCDATA_END_TAG_OPEN"]=9]="RCDATA_END_TAG_OPEN";State[State["RCDATA_END_TAG_NAME"]=10]="RCDATA_END_TAG_NAME";State[State["RAWTEXT_LESS_THAN_SIGN"]=11]="RAWTEXT_LESS_THAN_SIGN";State[State["RAWTEXT_END_TAG_OPEN"]=12]="RAWTEXT_END_TAG_OPEN";State[State["RAWTEXT_END_TAG_NAME"]=13]="RAWTEXT_END_TAG_NAME";State[State["SCRIPT_DATA_LESS_THAN_SIGN"]=14]="SCRIPT_DATA_LESS_THAN_SIGN";State[State["SCRIPT_DATA_END_TAG_OPEN"]=15]="SCRIPT_DATA_END_TAG_OPEN";State[State["SCRIPT_DATA_END_TAG_NAME"]=16]="SCRIPT_DATA_END_TAG_NAME";State[State["SCRIPT_DATA_ESCAPE_START"]=17]="SCRIPT_DATA_ESCAPE_START";State[State["SCRIPT_DATA_ESCAPE_START_DASH"]=18]="SCRIPT_DATA_ESCAPE_START_DASH";State[State["SCRIPT_DATA_ESCAPED"]=19]="SCRIPT_DATA_ESCAPED";State[State["SCRIPT_DATA_ESCAPED_DASH"]=20]="SCRIPT_DATA_ESCAPED_DASH";State[State["SCRIPT_DATA_ESCAPED_DASH_DASH"]=21]="SCRIPT_DATA_ESCAPED_DASH_DASH";State[State["SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN"]=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN";State[State["SCRIPT_DATA_ESCAPED_END_TAG_OPEN"]=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN";State[State["SCRIPT_DATA_ESCAPED_END_TAG_NAME"]=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME";State[State["SCRIPT_DATA_DOUBLE_ESCAPE_START"]=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START";State[State["SCRIPT_DATA_DOUBLE_ESCAPED"]=26]="SCRIPT_DATA_DOUBLE_ESCAPED";State[State["SCRIPT_DATA_DOUBLE_ESCAPED_DASH"]=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH";State[State["SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH"]=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH";State[State["SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN"]=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN";State[State["SCRIPT_DATA_DOUBLE_ESCAPE_END"]=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END";State[State["BEFORE_ATTRIBUTE_NAME"]=31]="BEFORE_ATTRIBUTE_NAME";State[State["ATTRIBUTE_NAME"]=32]="ATTRIBUTE_NAME";State[State["AFTER_ATTRIBUTE_NAME"]=33]="AFTER_ATTRIBUTE_NAME";State[State["BEFORE_ATTRIBUTE_VALUE"]=34]="BEFORE_ATTRIBUTE_VALUE";State[State["ATTRIBUTE_VALUE_DOUBLE_QUOTED"]=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED";State[State["ATTRIBUTE_VALUE_SINGLE_QUOTED"]=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED";State[State["ATTRIBUTE_VALUE_UNQUOTED"]=37]="ATTRIBUTE_VALUE_UNQUOTED";State[State["AFTER_ATTRIBUTE_VALUE_QUOTED"]=38]="AFTER_ATTRIBUTE_VALUE_QUOTED";State[State["SELF_CLOSING_START_TAG"]=39]="SELF_CLOSING_START_TAG";State[State["BOGUS_COMMENT"]=40]="BOGUS_COMMENT";State[State["MARKUP_DECLARATION_OPEN"]=41]="MARKUP_DECLARATION_OPEN";State[State["COMMENT_START"]=42]="COMMENT_START";State[State["COMMENT_START_DASH"]=43]="COMMENT_START_DASH";State[State["COMMENT"]=44]="COMMENT";State[State["COMMENT_LESS_THAN_SIGN"]=45]="COMMENT_LESS_THAN_SIGN";State[State["COMMENT_LESS_THAN_SIGN_BANG"]=46]="COMMENT_LESS_THAN_SIGN_BANG";State[State["COMMENT_LESS_THAN_SIGN_BANG_DASH"]=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH";State[State["COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH"]=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH";State[State["COMMENT_END_DASH"]=49]="COMMENT_END_DASH";State[State["COMMENT_END"]=50]="COMMENT_END";State[State["COMMENT_END_BANG"]=51]="COMMENT_END_BANG";State[State["DOCTYPE"]=52]="DOCTYPE";State[State["BEFORE_DOCTYPE_NAME"]=53]="BEFORE_DOCTYPE_NAME";State[State["DOCTYPE_NAME"]=54]="DOCTYPE_NAME";State[State["AFTER_DOCTYPE_NAME"]=55]="AFTER_DOCTYPE_NAME";State[State["AFTER_DOCTYPE_PUBLIC_KEYWORD"]=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD";State[State["BEFORE_DOCTYPE_PUBLIC_IDENTIFIER"]=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER";State[State["DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED"]=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED";State[State["DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED"]=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED";State[State["AFTER_DOCTYPE_PUBLIC_IDENTIFIER"]=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER";State[State["BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS"]=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS";State[State["AFTER_DOCTYPE_SYSTEM_KEYWORD"]=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD";State[State["BEFORE_DOCTYPE_SYSTEM_IDENTIFIER"]=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER";State[State["DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED"]=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED";State[State["DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED"]=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED";State[State["AFTER_DOCTYPE_SYSTEM_IDENTIFIER"]=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER";State[State["BOGUS_DOCTYPE"]=67]="BOGUS_DOCTYPE";State[State["CDATA_SECTION"]=68]="CDATA_SECTION";State[State["CDATA_SECTION_BRACKET"]=69]="CDATA_SECTION_BRACKET";State[State["CDATA_SECTION_END"]=70]="CDATA_SECTION_END";State[State["CHARACTER_REFERENCE"]=71]="CHARACTER_REFERENCE";State[State["NAMED_CHARACTER_REFERENCE"]=72]="NAMED_CHARACTER_REFERENCE";State[State["AMBIGUOUS_AMPERSAND"]=73]="AMBIGUOUS_AMPERSAND";State[State["NUMERIC_CHARACTER_REFERENCE"]=74]="NUMERIC_CHARACTER_REFERENCE";State[State["HEXADEMICAL_CHARACTER_REFERENCE_START"]=75]="HEXADEMICAL_CHARACTER_REFERENCE_START";State[State["HEXADEMICAL_CHARACTER_REFERENCE"]=76]="HEXADEMICAL_CHARACTER_REFERENCE";State[State["DECIMAL_CHARACTER_REFERENCE"]=77]="DECIMAL_CHARACTER_REFERENCE";State[State["NUMERIC_CHARACTER_REFERENCE_END"]=78]="NUMERIC_CHARACTER_REFERENCE_END"})(State||(State={}));exports.TokenizerMode={DATA:State.DATA,RCDATA:State.RCDATA,RAWTEXT:State.RAWTEXT,SCRIPT_DATA:State.SCRIPT_DATA,PLAINTEXT:State.PLAINTEXT,CDATA_SECTION:State.CDATA_SECTION};function isAsciiDigit(cp){return cp>=unicode_js_1.CODE_POINTS.DIGIT_0&&cp<=unicode_js_1.CODE_POINTS.DIGIT_9}function isAsciiUpper(cp){return cp>=unicode_js_1.CODE_POINTS.LATIN_CAPITAL_A&&cp<=unicode_js_1.CODE_POINTS.LATIN_CAPITAL_Z}function isAsciiLower(cp){return cp>=unicode_js_1.CODE_POINTS.LATIN_SMALL_A&&cp<=unicode_js_1.CODE_POINTS.LATIN_SMALL_Z}function isAsciiLetter(cp){return isAsciiLower(cp)||isAsciiUpper(cp)}function isAsciiAlphaNumeric(cp){return isAsciiLetter(cp)||isAsciiDigit(cp)}function isAsciiUpperHexDigit(cp){return cp>=unicode_js_1.CODE_POINTS.LATIN_CAPITAL_A&&cp<=unicode_js_1.CODE_POINTS.LATIN_CAPITAL_F}function isAsciiLowerHexDigit(cp){return cp>=unicode_js_1.CODE_POINTS.LATIN_SMALL_A&&cp<=unicode_js_1.CODE_POINTS.LATIN_SMALL_F}function isAsciiHexDigit(cp){return isAsciiDigit(cp)||isAsciiUpperHexDigit(cp)||isAsciiLowerHexDigit(cp)}function toAsciiLower(cp){return cp+32}function isWhitespace(cp){return cp===unicode_js_1.CODE_POINTS.SPACE||cp===unicode_js_1.CODE_POINTS.LINE_FEED||cp===unicode_js_1.CODE_POINTS.TABULATION||cp===unicode_js_1.CODE_POINTS.FORM_FEED}function isEntityInAttributeInvalidEnd(nextCp){return nextCp===unicode_js_1.CODE_POINTS.EQUALS_SIGN||isAsciiAlphaNumeric(nextCp)}function isScriptDataDoubleEscapeSequenceEnd(cp){return isWhitespace(cp)||cp===unicode_js_1.CODE_POINTS.SOLIDUS||cp===unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN}class Tokenizer{constructor(options,handler){this.options=options;this.handler=handler;this.paused=false;this.inLoop=false;this.inForeignNode=false;this.lastStartTagName="";this.active=false;this.state=State.DATA;this.returnState=State.DATA;this.charRefCode=-1;this.consumedAfterSnapshot=-1;this.currentCharacterToken=null;this.currentToken=null;this.currentAttr={name:"",value:""};this.preprocessor=new preprocessor_js_1.Preprocessor(handler);this.currentLocation=this.getCurrentLocation(-1)}_err(code){var _a,_b;(_b=(_a=this.handler).onParseError)===null||_b===void 0?void 0:_b.call(_a,this.preprocessor.getError(code))}getCurrentLocation(offset){if(!this.options.sourceCodeLocationInfo){return null}return{startLine:this.preprocessor.line,startCol:this.preprocessor.col-offset,startOffset:this.preprocessor.offset-offset,endLine:-1,endCol:-1,endOffset:-1}}_runParsingLoop(){if(this.inLoop)return;this.inLoop=true;while(this.active&&!this.paused){this.consumedAfterSnapshot=0;const cp=this._consume();if(!this._ensureHibernation()){this._callState(cp)}}this.inLoop=false}pause(){this.paused=true}resume(writeCallback){if(!this.paused){throw new Error("Parser was already resumed")}this.paused=false;if(this.inLoop)return;this._runParsingLoop();if(!this.paused){writeCallback===null||writeCallback===void 0?void 0:writeCallback()}}write(chunk,isLastChunk,writeCallback){this.active=true;this.preprocessor.write(chunk,isLastChunk);this._runParsingLoop();if(!this.paused){writeCallback===null||writeCallback===void 0?void 0:writeCallback()}}insertHtmlAtCurrentPos(chunk){this.active=true;this.preprocessor.insertHtmlAtCurrentPos(chunk);this._runParsingLoop()}_ensureHibernation(){if(this.preprocessor.endOfChunkHit){this._unconsume(this.consumedAfterSnapshot);this.active=false;return true}return false}_consume(){this.consumedAfterSnapshot++;return this.preprocessor.advance()}_unconsume(count){this.consumedAfterSnapshot-=count;this.preprocessor.retreat(count)}_reconsumeInState(state,cp){this.state=state;this._callState(cp)}_advanceBy(count){this.consumedAfterSnapshot+=count;for(let i=0;i<count;i++){this.preprocessor.advance()}}_consumeSequenceIfMatch(pattern,caseSensitive){if(this.preprocessor.startsWith(pattern,caseSensitive)){this._advanceBy(pattern.length-1);return true}return false}_createStartTagToken(){this.currentToken={type:token_js_1.TokenType.START_TAG,tagName:"",tagID:html_js_1.TAG_ID.UNKNOWN,selfClosing:false,ackSelfClosing:false,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:token_js_1.TokenType.END_TAG,tagName:"",tagID:html_js_1.TAG_ID.UNKNOWN,selfClosing:false,ackSelfClosing:false,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(offset){this.currentToken={type:token_js_1.TokenType.COMMENT,data:"",location:this.getCurrentLocation(offset)}}_createDoctypeToken(initialName){this.currentToken={type:token_js_1.TokenType.DOCTYPE,name:initialName,forceQuirks:false,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(type,chars){this.currentCharacterToken={type:type,chars:chars,location:this.currentLocation}}_createAttr(attrNameFirstCh){this.currentAttr={name:attrNameFirstCh,value:""};this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var _a;var _b;const token=this.currentToken;if((0,token_js_1.getTokenAttr)(token,this.currentAttr.name)===null){token.attrs.push(this.currentAttr);if(token.location&&this.currentLocation){const attrLocations=(_a=(_b=token.location).attrs)!==null&&_a!==void 0?_a:_b.attrs=Object.create(null);attrLocations[this.currentAttr.name]=this.currentLocation;this._leaveAttrValue()}}else{this._err(error_codes_js_1.ERR.duplicateAttribute)}}_leaveAttrValue(){if(this.currentLocation){this.currentLocation.endLine=this.preprocessor.line;this.currentLocation.endCol=this.preprocessor.col;this.currentLocation.endOffset=this.preprocessor.offset}}prepareToken(ct){this._emitCurrentCharacterToken(ct.location);this.currentToken=null;if(ct.location){ct.location.endLine=this.preprocessor.line;ct.location.endCol=this.preprocessor.col+1;ct.location.endOffset=this.preprocessor.offset+1}this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const ct=this.currentToken;this.prepareToken(ct);ct.tagID=(0,html_js_1.getTagID)(ct.tagName);if(ct.type===token_js_1.TokenType.START_TAG){this.lastStartTagName=ct.tagName;this.handler.onStartTag(ct)}else{if(ct.attrs.length>0){this._err(error_codes_js_1.ERR.endTagWithAttributes)}if(ct.selfClosing){this._err(error_codes_js_1.ERR.endTagWithTrailingSolidus)}this.handler.onEndTag(ct)}this.preprocessor.dropParsedChunk()}emitCurrentComment(ct){this.prepareToken(ct);this.handler.onComment(ct);this.preprocessor.dropParsedChunk()}emitCurrentDoctype(ct){this.prepareToken(ct);this.handler.onDoctype(ct);this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(nextLocation){if(this.currentCharacterToken){if(nextLocation&&this.currentCharacterToken.location){this.currentCharacterToken.location.endLine=nextLocation.startLine;this.currentCharacterToken.location.endCol=nextLocation.startCol;this.currentCharacterToken.location.endOffset=nextLocation.startOffset}switch(this.currentCharacterToken.type){case token_js_1.TokenType.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case token_js_1.TokenType.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case token_js_1.TokenType.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const location=this.getCurrentLocation(0);if(location){location.endLine=location.startLine;location.endCol=location.startCol;location.endOffset=location.startOffset}this._emitCurrentCharacterToken(location);this.handler.onEof({type:token_js_1.TokenType.EOF,location:location});this.active=false}_appendCharToCurrentCharacterToken(type,ch){if(this.currentCharacterToken){if(this.currentCharacterToken.type!==type){this.currentLocation=this.getCurrentLocation(0);this._emitCurrentCharacterToken(this.currentLocation);this.preprocessor.dropParsedChunk()}else{this.currentCharacterToken.chars+=ch;return}}this._createCharacterToken(type,ch)}_emitCodePoint(cp){const type=isWhitespace(cp)?token_js_1.TokenType.WHITESPACE_CHARACTER:cp===unicode_js_1.CODE_POINTS.NULL?token_js_1.TokenType.NULL_CHARACTER:token_js_1.TokenType.CHARACTER;this._appendCharToCurrentCharacterToken(type,String.fromCodePoint(cp))}_emitChars(ch){this._appendCharToCurrentCharacterToken(token_js_1.TokenType.CHARACTER,ch)}_matchNamedCharacterReference(cp){let result=null;let excess=0;let withoutSemicolon=false;for(let i=0,current=decode_js_1.htmlDecodeTree[0];i>=0;cp=this._consume()){i=(0,decode_js_1.determineBranch)(decode_js_1.htmlDecodeTree,current,i+1,cp);if(i<0)break;excess+=1;current=decode_js_1.htmlDecodeTree[i];const masked=current&decode_js_1.BinTrieFlags.VALUE_LENGTH;if(masked){const valueLength=(masked>>14)-1;if(cp!==unicode_js_1.CODE_POINTS.SEMICOLON&&this._isCharacterReferenceInAttribute()&&isEntityInAttributeInvalidEnd(this.preprocessor.peek(1))){result=[unicode_js_1.CODE_POINTS.AMPERSAND];i+=valueLength}else{result=valueLength===0?[decode_js_1.htmlDecodeTree[i]&~decode_js_1.BinTrieFlags.VALUE_LENGTH]:valueLength===1?[decode_js_1.htmlDecodeTree[++i]]:[decode_js_1.htmlDecodeTree[++i],decode_js_1.htmlDecodeTree[++i]];excess=0;withoutSemicolon=cp!==unicode_js_1.CODE_POINTS.SEMICOLON}if(valueLength===0){this._consume();break}}}this._unconsume(excess);if(withoutSemicolon&&!this.preprocessor.endOfChunkHit){this._err(error_codes_js_1.ERR.missingSemicolonAfterCharacterReference)}this._unconsume(1);return result}_isCharacterReferenceInAttribute(){return this.returnState===State.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===State.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===State.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(cp){if(this._isCharacterReferenceInAttribute()){this.currentAttr.value+=String.fromCodePoint(cp)}else{this._emitCodePoint(cp)}}_callState(cp){switch(this.state){case State.DATA:{this._stateData(cp);break}case State.RCDATA:{this._stateRcdata(cp);break}case State.RAWTEXT:{this._stateRawtext(cp);break}case State.SCRIPT_DATA:{this._stateScriptData(cp);break}case State.PLAINTEXT:{this._statePlaintext(cp);break}case State.TAG_OPEN:{this._stateTagOpen(cp);break}case State.END_TAG_OPEN:{this._stateEndTagOpen(cp);break}case State.TAG_NAME:{this._stateTagName(cp);break}case State.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(cp);break}case State.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(cp);break}case State.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(cp);break}case State.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(cp);break}case State.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(cp);break}case State.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(cp);break}case State.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(cp);break}case State.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(cp);break}case State.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(cp);break}case State.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(cp);break}case State.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(cp);break}case State.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(cp);break}case State.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(cp);break}case State.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(cp);break}case State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(cp);break}case State.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(cp);break}case State.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(cp);break}case State.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(cp);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(cp);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(cp);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(cp);break}case State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(cp);break}case State.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(cp);break}case State.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(cp);break}case State.ATTRIBUTE_NAME:{this._stateAttributeName(cp);break}case State.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(cp);break}case State.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(cp);break}case State.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(cp);break}case State.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(cp);break}case State.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(cp);break}case State.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(cp);break}case State.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(cp);break}case State.BOGUS_COMMENT:{this._stateBogusComment(cp);break}case State.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(cp);break}case State.COMMENT_START:{this._stateCommentStart(cp);break}case State.COMMENT_START_DASH:{this._stateCommentStartDash(cp);break}case State.COMMENT:{this._stateComment(cp);break}case State.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(cp);break}case State.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(cp);break}case State.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(cp);break}case State.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(cp);break}case State.COMMENT_END_DASH:{this._stateCommentEndDash(cp);break}case State.COMMENT_END:{this._stateCommentEnd(cp);break}case State.COMMENT_END_BANG:{this._stateCommentEndBang(cp);break}case State.DOCTYPE:{this._stateDoctype(cp);break}case State.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(cp);break}case State.DOCTYPE_NAME:{this._stateDoctypeName(cp);break}case State.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(cp);break}case State.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(cp);break}case State.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(cp);break}case State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(cp);break}case State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(cp);break}case State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(cp);break}case State.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(cp);break}case State.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(cp);break}case State.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(cp);break}case State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(cp);break}case State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(cp);break}case State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(cp);break}case State.BOGUS_DOCTYPE:{this._stateBogusDoctype(cp);break}case State.CDATA_SECTION:{this._stateCdataSection(cp);break}case State.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(cp);break}case State.CDATA_SECTION_END:{this._stateCdataSectionEnd(cp);break}case State.CHARACTER_REFERENCE:{this._stateCharacterReference(cp);break}case State.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(cp);break}case State.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(cp);break}case State.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(cp);break}case State.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(cp);break}case State.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(cp);break}case State.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(cp);break}case State.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(cp);break}default:{throw new Error("Unknown state")}}}_stateData(cp){switch(cp){case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.TAG_OPEN;break}case unicode_js_1.CODE_POINTS.AMPERSAND:{this.returnState=State.DATA;this.state=State.CHARACTER_REFERENCE;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this._emitCodePoint(cp);break}case unicode_js_1.CODE_POINTS.EOF:{this._emitEOFToken();break}default:{this._emitCodePoint(cp)}}}_stateRcdata(cp){switch(cp){case unicode_js_1.CODE_POINTS.AMPERSAND:{this.returnState=State.RCDATA;this.state=State.CHARACTER_REFERENCE;break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.RCDATA_LESS_THAN_SIGN;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._emitEOFToken();break}default:{this._emitCodePoint(cp)}}}_stateRawtext(cp){switch(cp){case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.RAWTEXT_LESS_THAN_SIGN;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._emitEOFToken();break}default:{this._emitCodePoint(cp)}}}_stateScriptData(cp){switch(cp){case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_LESS_THAN_SIGN;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._emitEOFToken();break}default:{this._emitCodePoint(cp)}}}_statePlaintext(cp){switch(cp){case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._emitEOFToken();break}default:{this._emitCodePoint(cp)}}}_stateTagOpen(cp){if(isAsciiLetter(cp)){this._createStartTagToken();this.state=State.TAG_NAME;this._stateTagName(cp)}else switch(cp){case unicode_js_1.CODE_POINTS.EXCLAMATION_MARK:{this.state=State.MARKUP_DECLARATION_OPEN;break}case unicode_js_1.CODE_POINTS.SOLIDUS:{this.state=State.END_TAG_OPEN;break}case unicode_js_1.CODE_POINTS.QUESTION_MARK:{this._err(error_codes_js_1.ERR.unexpectedQuestionMarkInsteadOfTagName);this._createCommentToken(1);this.state=State.BOGUS_COMMENT;this._stateBogusComment(cp);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofBeforeTagName);this._emitChars("<");this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.invalidFirstCharacterOfTagName);this._emitChars("<");this.state=State.DATA;this._stateData(cp)}}}_stateEndTagOpen(cp){if(isAsciiLetter(cp)){this._createEndTagToken();this.state=State.TAG_NAME;this._stateTagName(cp)}else switch(cp){case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.missingEndTagName);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofBeforeTagName);this._emitChars("</");this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.invalidFirstCharacterOfTagName);this._createCommentToken(2);this.state=State.BOGUS_COMMENT;this._stateBogusComment(cp)}}}_stateTagName(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_ATTRIBUTE_NAME;break}case unicode_js_1.CODE_POINTS.SOLIDUS:{this.state=State.SELF_CLOSING_START_TAG;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;this.emitCurrentTagToken();break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);token.tagName+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInTag);this._emitEOFToken();break}default:{token.tagName+=String.fromCodePoint(isAsciiUpper(cp)?toAsciiLower(cp):cp)}}}_stateRcdataLessThanSign(cp){if(cp===unicode_js_1.CODE_POINTS.SOLIDUS){this.state=State.RCDATA_END_TAG_OPEN}else{this._emitChars("<");this.state=State.RCDATA;this._stateRcdata(cp)}}_stateRcdataEndTagOpen(cp){if(isAsciiLetter(cp)){this.state=State.RCDATA_END_TAG_NAME;this._stateRcdataEndTagName(cp)}else{this._emitChars("</");this.state=State.RCDATA;this._stateRcdata(cp)}}handleSpecialEndTag(_cp){if(!this.preprocessor.startsWith(this.lastStartTagName,false)){return!this._ensureHibernation()}this._createEndTagToken();const token=this.currentToken;token.tagName=this.lastStartTagName;const cp=this.preprocessor.peek(this.lastStartTagName.length);switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this._advanceBy(this.lastStartTagName.length);this.state=State.BEFORE_ATTRIBUTE_NAME;return false}case unicode_js_1.CODE_POINTS.SOLIDUS:{this._advanceBy(this.lastStartTagName.length);this.state=State.SELF_CLOSING_START_TAG;return false}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._advanceBy(this.lastStartTagName.length);this.emitCurrentTagToken();this.state=State.DATA;return false}default:{return!this._ensureHibernation()}}}_stateRcdataEndTagName(cp){if(this.handleSpecialEndTag(cp)){this._emitChars("</");this.state=State.RCDATA;this._stateRcdata(cp)}}_stateRawtextLessThanSign(cp){if(cp===unicode_js_1.CODE_POINTS.SOLIDUS){this.state=State.RAWTEXT_END_TAG_OPEN}else{this._emitChars("<");this.state=State.RAWTEXT;this._stateRawtext(cp)}}_stateRawtextEndTagOpen(cp){if(isAsciiLetter(cp)){this.state=State.RAWTEXT_END_TAG_NAME;this._stateRawtextEndTagName(cp)}else{this._emitChars("</");this.state=State.RAWTEXT;this._stateRawtext(cp)}}_stateRawtextEndTagName(cp){if(this.handleSpecialEndTag(cp)){this._emitChars("</");this.state=State.RAWTEXT;this._stateRawtext(cp)}}_stateScriptDataLessThanSign(cp){switch(cp){case unicode_js_1.CODE_POINTS.SOLIDUS:{this.state=State.SCRIPT_DATA_END_TAG_OPEN;break}case unicode_js_1.CODE_POINTS.EXCLAMATION_MARK:{this.state=State.SCRIPT_DATA_ESCAPE_START;this._emitChars("<!");break}default:{this._emitChars("<");this.state=State.SCRIPT_DATA;this._stateScriptData(cp)}}}_stateScriptDataEndTagOpen(cp){if(isAsciiLetter(cp)){this.state=State.SCRIPT_DATA_END_TAG_NAME;this._stateScriptDataEndTagName(cp)}else{this._emitChars("</");this.state=State.SCRIPT_DATA;this._stateScriptData(cp)}}_stateScriptDataEndTagName(cp){if(this.handleSpecialEndTag(cp)){this._emitChars("</");this.state=State.SCRIPT_DATA;this._stateScriptData(cp)}}_stateScriptDataEscapeStart(cp){if(cp===unicode_js_1.CODE_POINTS.HYPHEN_MINUS){this.state=State.SCRIPT_DATA_ESCAPE_START_DASH;this._emitChars("-")}else{this.state=State.SCRIPT_DATA;this._stateScriptData(cp)}}_stateScriptDataEscapeStartDash(cp){if(cp===unicode_js_1.CODE_POINTS.HYPHEN_MINUS){this.state=State.SCRIPT_DATA_ESCAPED_DASH_DASH;this._emitChars("-")}else{this.state=State.SCRIPT_DATA;this._stateScriptData(cp)}}_stateScriptDataEscaped(cp){switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_ESCAPED_DASH;this._emitChars("-");break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break}default:{this._emitCodePoint(cp)}}}_stateScriptDataEscapedDash(cp){switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_ESCAPED_DASH_DASH;this._emitChars("-");break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this.state=State.SCRIPT_DATA_ESCAPED;this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break}default:{this.state=State.SCRIPT_DATA_ESCAPED;this._emitCodePoint(cp)}}}_stateScriptDataEscapedDashDash(cp){switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this._emitChars("-");break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.SCRIPT_DATA;this._emitChars(">");break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this.state=State.SCRIPT_DATA_ESCAPED;this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break}default:{this.state=State.SCRIPT_DATA_ESCAPED;this._emitCodePoint(cp)}}}_stateScriptDataEscapedLessThanSign(cp){if(cp===unicode_js_1.CODE_POINTS.SOLIDUS){this.state=State.SCRIPT_DATA_ESCAPED_END_TAG_OPEN}else if(isAsciiLetter(cp)){this._emitChars("<");this.state=State.SCRIPT_DATA_DOUBLE_ESCAPE_START;this._stateScriptDataDoubleEscapeStart(cp)}else{this._emitChars("<");this.state=State.SCRIPT_DATA_ESCAPED;this._stateScriptDataEscaped(cp)}}_stateScriptDataEscapedEndTagOpen(cp){if(isAsciiLetter(cp)){this.state=State.SCRIPT_DATA_ESCAPED_END_TAG_NAME;this._stateScriptDataEscapedEndTagName(cp)}else{this._emitChars("</");this.state=State.SCRIPT_DATA_ESCAPED;this._stateScriptDataEscaped(cp)}}_stateScriptDataEscapedEndTagName(cp){if(this.handleSpecialEndTag(cp)){this._emitChars("</");this.state=State.SCRIPT_DATA_ESCAPED;this._stateScriptDataEscaped(cp)}}_stateScriptDataDoubleEscapeStart(cp){if(this.preprocessor.startsWith(unicode_js_1.SEQUENCES.SCRIPT,false)&&isScriptDataDoubleEscapeSequenceEnd(this.preprocessor.peek(unicode_js_1.SEQUENCES.SCRIPT.length))){this._emitCodePoint(cp);for(let i=0;i<unicode_js_1.SEQUENCES.SCRIPT.length;i++){this._emitCodePoint(this._consume())}this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED}else if(!this._ensureHibernation()){this.state=State.SCRIPT_DATA_ESCAPED;this._stateScriptDataEscaped(cp)}}_stateScriptDataDoubleEscaped(cp){switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH;this._emitChars("-");break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN;this._emitChars("<");break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break}default:{this._emitCodePoint(cp)}}}_stateScriptDataDoubleEscapedDash(cp){switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH;this._emitChars("-");break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN;this._emitChars("<");break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED;this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break}default:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED;this._emitCodePoint(cp)}}}_stateScriptDataDoubleEscapedDashDash(cp){switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this._emitChars("-");break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN;this._emitChars("<");break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.SCRIPT_DATA;this._emitChars(">");break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED;this._emitChars(unicode_js_1.REPLACEMENT_CHARACTER);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInScriptHtmlCommentLikeText);this._emitEOFToken();break}default:{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED;this._emitCodePoint(cp)}}}_stateScriptDataDoubleEscapedLessThanSign(cp){if(cp===unicode_js_1.CODE_POINTS.SOLIDUS){this.state=State.SCRIPT_DATA_DOUBLE_ESCAPE_END;this._emitChars("/")}else{this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED;this._stateScriptDataDoubleEscaped(cp)}}_stateScriptDataDoubleEscapeEnd(cp){if(this.preprocessor.startsWith(unicode_js_1.SEQUENCES.SCRIPT,false)&&isScriptDataDoubleEscapeSequenceEnd(this.preprocessor.peek(unicode_js_1.SEQUENCES.SCRIPT.length))){this._emitCodePoint(cp);for(let i=0;i<unicode_js_1.SEQUENCES.SCRIPT.length;i++){this._emitCodePoint(this._consume())}this.state=State.SCRIPT_DATA_ESCAPED}else if(!this._ensureHibernation()){this.state=State.SCRIPT_DATA_DOUBLE_ESCAPED;this._stateScriptDataDoubleEscaped(cp)}}_stateBeforeAttributeName(cp){switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.SOLIDUS:case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:case unicode_js_1.CODE_POINTS.EOF:{this.state=State.AFTER_ATTRIBUTE_NAME;this._stateAfterAttributeName(cp);break}case unicode_js_1.CODE_POINTS.EQUALS_SIGN:{this._err(error_codes_js_1.ERR.unexpectedEqualsSignBeforeAttributeName);this._createAttr("=");this.state=State.ATTRIBUTE_NAME;break}default:{this._createAttr("");this.state=State.ATTRIBUTE_NAME;this._stateAttributeName(cp)}}}_stateAttributeName(cp){switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:case unicode_js_1.CODE_POINTS.SOLIDUS:case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:case unicode_js_1.CODE_POINTS.EOF:{this._leaveAttrName();this.state=State.AFTER_ATTRIBUTE_NAME;this._stateAfterAttributeName(cp);break}case unicode_js_1.CODE_POINTS.EQUALS_SIGN:{this._leaveAttrName();this.state=State.BEFORE_ATTRIBUTE_VALUE;break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:case unicode_js_1.CODE_POINTS.APOSTROPHE:case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{this._err(error_codes_js_1.ERR.unexpectedCharacterInAttributeName);this.currentAttr.name+=String.fromCodePoint(cp);break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this.currentAttr.name+=unicode_js_1.REPLACEMENT_CHARACTER;break}default:{this.currentAttr.name+=String.fromCodePoint(isAsciiUpper(cp)?toAsciiLower(cp):cp)}}}_stateAfterAttributeName(cp){switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.SOLIDUS:{this.state=State.SELF_CLOSING_START_TAG;break}case unicode_js_1.CODE_POINTS.EQUALS_SIGN:{this.state=State.BEFORE_ATTRIBUTE_VALUE;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;this.emitCurrentTagToken();break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInTag);this._emitEOFToken();break}default:{this._createAttr("");this.state=State.ATTRIBUTE_NAME;this._stateAttributeName(cp)}}}_stateBeforeAttributeValue(cp){switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{this.state=State.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case unicode_js_1.CODE_POINTS.APOSTROPHE:{this.state=State.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.missingAttributeValue);this.state=State.DATA;this.emitCurrentTagToken();break}default:{this.state=State.ATTRIBUTE_VALUE_UNQUOTED;this._stateAttributeValueUnquoted(cp)}}}_stateAttributeValueDoubleQuoted(cp){switch(cp){case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case unicode_js_1.CODE_POINTS.AMPERSAND:{this.returnState=State.ATTRIBUTE_VALUE_DOUBLE_QUOTED;this.state=State.CHARACTER_REFERENCE;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this.currentAttr.value+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInTag);this._emitEOFToken();break}default:{this.currentAttr.value+=String.fromCodePoint(cp)}}}_stateAttributeValueSingleQuoted(cp){switch(cp){case unicode_js_1.CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case unicode_js_1.CODE_POINTS.AMPERSAND:{this.returnState=State.ATTRIBUTE_VALUE_SINGLE_QUOTED;this.state=State.CHARACTER_REFERENCE;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this.currentAttr.value+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInTag);this._emitEOFToken();break}default:{this.currentAttr.value+=String.fromCodePoint(cp)}}}_stateAttributeValueUnquoted(cp){switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this._leaveAttrValue();this.state=State.BEFORE_ATTRIBUTE_NAME;break}case unicode_js_1.CODE_POINTS.AMPERSAND:{this.returnState=State.ATTRIBUTE_VALUE_UNQUOTED;this.state=State.CHARACTER_REFERENCE;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._leaveAttrValue();this.state=State.DATA;this.emitCurrentTagToken();break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this.currentAttr.value+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:case unicode_js_1.CODE_POINTS.APOSTROPHE:case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:case unicode_js_1.CODE_POINTS.EQUALS_SIGN:case unicode_js_1.CODE_POINTS.GRAVE_ACCENT:{this._err(error_codes_js_1.ERR.unexpectedCharacterInUnquotedAttributeValue);this.currentAttr.value+=String.fromCodePoint(cp);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInTag);this._emitEOFToken();break}default:{this.currentAttr.value+=String.fromCodePoint(cp)}}}_stateAfterAttributeValueQuoted(cp){switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this._leaveAttrValue();this.state=State.BEFORE_ATTRIBUTE_NAME;break}case unicode_js_1.CODE_POINTS.SOLIDUS:{this._leaveAttrValue();this.state=State.SELF_CLOSING_START_TAG;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._leaveAttrValue();this.state=State.DATA;this.emitCurrentTagToken();break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInTag);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.missingWhitespaceBetweenAttributes);this.state=State.BEFORE_ATTRIBUTE_NAME;this._stateBeforeAttributeName(cp)}}}_stateSelfClosingStartTag(cp){switch(cp){case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{const token=this.currentToken;token.selfClosing=true;this.state=State.DATA;this.emitCurrentTagToken();break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInTag);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.unexpectedSolidusInTag);this.state=State.BEFORE_ATTRIBUTE_NAME;this._stateBeforeAttributeName(cp)}}}_stateBogusComment(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;this.emitCurrentComment(token);break}case unicode_js_1.CODE_POINTS.EOF:{this.emitCurrentComment(token);this._emitEOFToken();break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);token.data+=unicode_js_1.REPLACEMENT_CHARACTER;break}default:{token.data+=String.fromCodePoint(cp)}}}_stateMarkupDeclarationOpen(cp){if(this._consumeSequenceIfMatch(unicode_js_1.SEQUENCES.DASH_DASH,true)){this._createCommentToken(unicode_js_1.SEQUENCES.DASH_DASH.length+1);this.state=State.COMMENT_START}else if(this._consumeSequenceIfMatch(unicode_js_1.SEQUENCES.DOCTYPE,false)){this.currentLocation=this.getCurrentLocation(unicode_js_1.SEQUENCES.DOCTYPE.length+1);this.state=State.DOCTYPE}else if(this._consumeSequenceIfMatch(unicode_js_1.SEQUENCES.CDATA_START,true)){if(this.inForeignNode){this.state=State.CDATA_SECTION}else{this._err(error_codes_js_1.ERR.cdataInHtmlContent);this._createCommentToken(unicode_js_1.SEQUENCES.CDATA_START.length+1);this.currentToken.data="[CDATA[";this.state=State.BOGUS_COMMENT}}else if(!this._ensureHibernation()){this._err(error_codes_js_1.ERR.incorrectlyOpenedComment);this._createCommentToken(2);this.state=State.BOGUS_COMMENT;this._stateBogusComment(cp)}}_stateCommentStart(cp){switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_START_DASH;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.abruptClosingOfEmptyComment);this.state=State.DATA;const token=this.currentToken;this.emitCurrentComment(token);break}default:{this.state=State.COMMENT;this._stateComment(cp)}}}_stateCommentStartDash(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.abruptClosingOfEmptyComment);this.state=State.DATA;this.emitCurrentComment(token);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInComment);this.emitCurrentComment(token);this._emitEOFToken();break}default:{token.data+="-";this.state=State.COMMENT;this._stateComment(cp)}}}_stateComment(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END_DASH;break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{token.data+="<";this.state=State.COMMENT_LESS_THAN_SIGN;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);token.data+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInComment);this.emitCurrentComment(token);this._emitEOFToken();break}default:{token.data+=String.fromCodePoint(cp)}}}_stateCommentLessThanSign(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.EXCLAMATION_MARK:{token.data+="!";this.state=State.COMMENT_LESS_THAN_SIGN_BANG;break}case unicode_js_1.CODE_POINTS.LESS_THAN_SIGN:{token.data+="<";break}default:{this.state=State.COMMENT;this._stateComment(cp)}}}_stateCommentLessThanSignBang(cp){if(cp===unicode_js_1.CODE_POINTS.HYPHEN_MINUS){this.state=State.COMMENT_LESS_THAN_SIGN_BANG_DASH}else{this.state=State.COMMENT;this._stateComment(cp)}}_stateCommentLessThanSignBangDash(cp){if(cp===unicode_js_1.CODE_POINTS.HYPHEN_MINUS){this.state=State.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH}else{this.state=State.COMMENT_END_DASH;this._stateCommentEndDash(cp)}}_stateCommentLessThanSignBangDashDash(cp){if(cp!==unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN&&cp!==unicode_js_1.CODE_POINTS.EOF){this._err(error_codes_js_1.ERR.nestedComment)}this.state=State.COMMENT_END;this._stateCommentEnd(cp)}_stateCommentEndDash(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{this.state=State.COMMENT_END;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInComment);this.emitCurrentComment(token);this._emitEOFToken();break}default:{token.data+="-";this.state=State.COMMENT;this._stateComment(cp)}}}_stateCommentEnd(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;this.emitCurrentComment(token);break}case unicode_js_1.CODE_POINTS.EXCLAMATION_MARK:{this.state=State.COMMENT_END_BANG;break}case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{token.data+="-";break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInComment);this.emitCurrentComment(token);this._emitEOFToken();break}default:{token.data+="--";this.state=State.COMMENT;this._stateComment(cp)}}}_stateCommentEndBang(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.HYPHEN_MINUS:{token.data+="--!";this.state=State.COMMENT_END_DASH;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.incorrectlyClosedComment);this.state=State.DATA;this.emitCurrentComment(token);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInComment);this.emitCurrentComment(token);this._emitEOFToken();break}default:{token.data+="--!";this.state=State.COMMENT;this._stateComment(cp)}}}_stateDoctype(cp){switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_NAME;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.BEFORE_DOCTYPE_NAME;this._stateBeforeDoctypeName(cp);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);this._createDoctypeToken(null);const token=this.currentToken;token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.missingWhitespaceBeforeDoctypeName);this.state=State.BEFORE_DOCTYPE_NAME;this._stateBeforeDoctypeName(cp)}}}_stateBeforeDoctypeName(cp){if(isAsciiUpper(cp)){this._createDoctypeToken(String.fromCharCode(toAsciiLower(cp)));this.state=State.DOCTYPE_NAME}else switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);this._createDoctypeToken(unicode_js_1.REPLACEMENT_CHARACTER);this.state=State.DOCTYPE_NAME;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.missingDoctypeName);this._createDoctypeToken(null);const token=this.currentToken;token.forceQuirks=true;this.emitCurrentDoctype(token);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);this._createDoctypeToken(null);const token=this.currentToken;token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._createDoctypeToken(String.fromCodePoint(cp));this.state=State.DOCTYPE_NAME}}}_stateDoctypeName(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this.state=State.AFTER_DOCTYPE_NAME;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;this.emitCurrentDoctype(token);break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);token.name+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{token.name+=String.fromCodePoint(isAsciiUpper(cp)?toAsciiLower(cp):cp)}}}_stateAfterDoctypeName(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;this.emitCurrentDoctype(token);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{if(this._consumeSequenceIfMatch(unicode_js_1.SEQUENCES.PUBLIC,false)){this.state=State.AFTER_DOCTYPE_PUBLIC_KEYWORD}else if(this._consumeSequenceIfMatch(unicode_js_1.SEQUENCES.SYSTEM,false)){this.state=State.AFTER_DOCTYPE_SYSTEM_KEYWORD}else if(!this._ensureHibernation()){this._err(error_codes_js_1.ERR.invalidCharacterSequenceAfterDoctypeName);token.forceQuirks=true;this.state=State.BOGUS_DOCTYPE;this._stateBogusDoctype(cp)}}}}_stateAfterDoctypePublicKeyword(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{this._err(error_codes_js_1.ERR.missingWhitespaceAfterDoctypePublicKeyword);token.publicId="";this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case unicode_js_1.CODE_POINTS.APOSTROPHE:{this._err(error_codes_js_1.ERR.missingWhitespaceAfterDoctypePublicKeyword);token.publicId="";this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.missingDoctypePublicIdentifier);token.forceQuirks=true;this.state=State.DATA;this.emitCurrentDoctype(token);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.missingQuoteBeforeDoctypePublicIdentifier);token.forceQuirks=true;this.state=State.BOGUS_DOCTYPE;this._stateBogusDoctype(cp)}}}_stateBeforeDoctypePublicIdentifier(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{token.publicId="";this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case unicode_js_1.CODE_POINTS.APOSTROPHE:{token.publicId="";this.state=State.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.missingDoctypePublicIdentifier);token.forceQuirks=true;this.state=State.DATA;this.emitCurrentDoctype(token);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.missingQuoteBeforeDoctypePublicIdentifier);token.forceQuirks=true;this.state=State.BOGUS_DOCTYPE;this._stateBogusDoctype(cp)}}}_stateDoctypePublicIdentifierDoubleQuoted(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);token.publicId+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.abruptDoctypePublicIdentifier);token.forceQuirks=true;this.emitCurrentDoctype(token);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{token.publicId+=String.fromCodePoint(cp)}}}_stateDoctypePublicIdentifierSingleQuoted(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);token.publicId+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.abruptDoctypePublicIdentifier);token.forceQuirks=true;this.emitCurrentDoctype(token);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{token.publicId+=String.fromCodePoint(cp)}}}_stateAfterDoctypePublicIdentifier(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this.state=State.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;this.emitCurrentDoctype(token);break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{this._err(error_codes_js_1.ERR.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers);token.systemId="";this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case unicode_js_1.CODE_POINTS.APOSTROPHE:{this._err(error_codes_js_1.ERR.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers);token.systemId="";this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.missingQuoteBeforeDoctypeSystemIdentifier);token.forceQuirks=true;this.state=State.BOGUS_DOCTYPE;this._stateBogusDoctype(cp)}}}_stateBetweenDoctypePublicAndSystemIdentifiers(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(token);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{token.systemId="";this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case unicode_js_1.CODE_POINTS.APOSTROPHE:{token.systemId="";this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.missingQuoteBeforeDoctypeSystemIdentifier);token.forceQuirks=true;this.state=State.BOGUS_DOCTYPE;this._stateBogusDoctype(cp)}}}_stateAfterDoctypeSystemKeyword(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{this.state=State.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{this._err(error_codes_js_1.ERR.missingWhitespaceAfterDoctypeSystemKeyword);token.systemId="";this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case unicode_js_1.CODE_POINTS.APOSTROPHE:{this._err(error_codes_js_1.ERR.missingWhitespaceAfterDoctypeSystemKeyword);token.systemId="";this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.missingDoctypeSystemIdentifier);token.forceQuirks=true;this.state=State.DATA;this.emitCurrentDoctype(token);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.missingQuoteBeforeDoctypeSystemIdentifier);token.forceQuirks=true;this.state=State.BOGUS_DOCTYPE;this._stateBogusDoctype(cp)}}}_stateBeforeDoctypeSystemIdentifier(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{token.systemId="";this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case unicode_js_1.CODE_POINTS.APOSTROPHE:{token.systemId="";this.state=State.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.missingDoctypeSystemIdentifier);token.forceQuirks=true;this.state=State.DATA;this.emitCurrentDoctype(token);break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.missingQuoteBeforeDoctypeSystemIdentifier);token.forceQuirks=true;this.state=State.BOGUS_DOCTYPE;this._stateBogusDoctype(cp)}}}_stateDoctypeSystemIdentifierDoubleQuoted(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.QUOTATION_MARK:{this.state=State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);token.systemId+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.abruptDoctypeSystemIdentifier);token.forceQuirks=true;this.emitCurrentDoctype(token);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{token.systemId+=String.fromCodePoint(cp)}}}_stateDoctypeSystemIdentifierSingleQuoted(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.APOSTROPHE:{this.state=State.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);token.systemId+=unicode_js_1.REPLACEMENT_CHARACTER;break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this._err(error_codes_js_1.ERR.abruptDoctypeSystemIdentifier);token.forceQuirks=true;this.emitCurrentDoctype(token);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{token.systemId+=String.fromCodePoint(cp)}}}_stateAfterDoctypeSystemIdentifier(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.SPACE:case unicode_js_1.CODE_POINTS.LINE_FEED:case unicode_js_1.CODE_POINTS.TABULATION:case unicode_js_1.CODE_POINTS.FORM_FEED:{break}case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(token);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInDoctype);token.forceQuirks=true;this.emitCurrentDoctype(token);this._emitEOFToken();break}default:{this._err(error_codes_js_1.ERR.unexpectedCharacterAfterDoctypeSystemIdentifier);this.state=State.BOGUS_DOCTYPE;this._stateBogusDoctype(cp)}}}_stateBogusDoctype(cp){const token=this.currentToken;switch(cp){case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.emitCurrentDoctype(token);this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.NULL:{this._err(error_codes_js_1.ERR.unexpectedNullCharacter);break}case unicode_js_1.CODE_POINTS.EOF:{this.emitCurrentDoctype(token);this._emitEOFToken();break}default:}}_stateCdataSection(cp){switch(cp){case unicode_js_1.CODE_POINTS.RIGHT_SQUARE_BRACKET:{this.state=State.CDATA_SECTION_BRACKET;break}case unicode_js_1.CODE_POINTS.EOF:{this._err(error_codes_js_1.ERR.eofInCdata);this._emitEOFToken();break}default:{this._emitCodePoint(cp)}}}_stateCdataSectionBracket(cp){if(cp===unicode_js_1.CODE_POINTS.RIGHT_SQUARE_BRACKET){this.state=State.CDATA_SECTION_END}else{this._emitChars("]");this.state=State.CDATA_SECTION;this._stateCdataSection(cp)}}_stateCdataSectionEnd(cp){switch(cp){case unicode_js_1.CODE_POINTS.GREATER_THAN_SIGN:{this.state=State.DATA;break}case unicode_js_1.CODE_POINTS.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:{this._emitChars("]]");this.state=State.CDATA_SECTION;this._stateCdataSection(cp)}}}_stateCharacterReference(cp){if(cp===unicode_js_1.CODE_POINTS.NUMBER_SIGN){this.state=State.NUMERIC_CHARACTER_REFERENCE}else if(isAsciiAlphaNumeric(cp)){this.state=State.NAMED_CHARACTER_REFERENCE;this._stateNamedCharacterReference(cp)}else{this._flushCodePointConsumedAsCharacterReference(unicode_js_1.CODE_POINTS.AMPERSAND);this._reconsumeInState(this.returnState,cp)}}_stateNamedCharacterReference(cp){const matchResult=this._matchNamedCharacterReference(cp);if(this._ensureHibernation()){}else if(matchResult){for(let i=0;i<matchResult.length;i++){this._flushCodePointConsumedAsCharacterReference(matchResult[i])}this.state=this.returnState}else{this._flushCodePointConsumedAsCharacterReference(unicode_js_1.CODE_POINTS.AMPERSAND);this.state=State.AMBIGUOUS_AMPERSAND}}_stateAmbiguousAmpersand(cp){if(isAsciiAlphaNumeric(cp)){this._flushCodePointConsumedAsCharacterReference(cp)}else{if(cp===unicode_js_1.CODE_POINTS.SEMICOLON){this._err(error_codes_js_1.ERR.unknownNamedCharacterReference)}this._reconsumeInState(this.returnState,cp)}}_stateNumericCharacterReference(cp){this.charRefCode=0;if(cp===unicode_js_1.CODE_POINTS.LATIN_SMALL_X||cp===unicode_js_1.CODE_POINTS.LATIN_CAPITAL_X){this.state=State.HEXADEMICAL_CHARACTER_REFERENCE_START}else if(isAsciiDigit(cp)){this.state=State.DECIMAL_CHARACTER_REFERENCE;this._stateDecimalCharacterReference(cp)}else{this._err(error_codes_js_1.ERR.absenceOfDigitsInNumericCharacterReference);this._flushCodePointConsumedAsCharacterReference(unicode_js_1.CODE_POINTS.AMPERSAND);this._flushCodePointConsumedAsCharacterReference(unicode_js_1.CODE_POINTS.NUMBER_SIGN);this._reconsumeInState(this.returnState,cp)}}_stateHexademicalCharacterReferenceStart(cp){if(isAsciiHexDigit(cp)){this.state=State.HEXADEMICAL_CHARACTER_REFERENCE;this._stateHexademicalCharacterReference(cp)}else{this._err(error_codes_js_1.ERR.absenceOfDigitsInNumericCharacterReference);this._flushCodePointConsumedAsCharacterReference(unicode_js_1.CODE_POINTS.AMPERSAND);this._flushCodePointConsumedAsCharacterReference(unicode_js_1.CODE_POINTS.NUMBER_SIGN);this._unconsume(2);this.state=this.returnState}}_stateHexademicalCharacterReference(cp){if(isAsciiUpperHexDigit(cp)){this.charRefCode=this.charRefCode*16+cp-55}else if(isAsciiLowerHexDigit(cp)){this.charRefCode=this.charRefCode*16+cp-87}else if(isAsciiDigit(cp)){this.charRefCode=this.charRefCode*16+cp-48}else if(cp===unicode_js_1.CODE_POINTS.SEMICOLON){this.state=State.NUMERIC_CHARACTER_REFERENCE_END}else{this._err(error_codes_js_1.ERR.missingSemicolonAfterCharacterReference);this.state=State.NUMERIC_CHARACTER_REFERENCE_END;this._stateNumericCharacterReferenceEnd(cp)}}_stateDecimalCharacterReference(cp){if(isAsciiDigit(cp)){this.charRefCode=this.charRefCode*10+cp-48}else if(cp===unicode_js_1.CODE_POINTS.SEMICOLON){this.state=State.NUMERIC_CHARACTER_REFERENCE_END}else{this._err(error_codes_js_1.ERR.missingSemicolonAfterCharacterReference);this.state=State.NUMERIC_CHARACTER_REFERENCE_END;this._stateNumericCharacterReferenceEnd(cp)}}_stateNumericCharacterReferenceEnd(cp){if(this.charRefCode===unicode_js_1.CODE_POINTS.NULL){this._err(error_codes_js_1.ERR.nullCharacterReference);this.charRefCode=unicode_js_1.CODE_POINTS.REPLACEMENT_CHARACTER}else if(this.charRefCode>1114111){this._err(error_codes_js_1.ERR.characterReferenceOutsideUnicodeRange);this.charRefCode=unicode_js_1.CODE_POINTS.REPLACEMENT_CHARACTER}else if((0,unicode_js_1.isSurrogate)(this.charRefCode)){this._err(error_codes_js_1.ERR.surrogateCharacterReference);this.charRefCode=unicode_js_1.CODE_POINTS.REPLACEMENT_CHARACTER}else if((0,unicode_js_1.isUndefinedCodePoint)(this.charRefCode)){this._err(error_codes_js_1.ERR.noncharacterCharacterReference)}else if((0,unicode_js_1.isControlCodePoint)(this.charRefCode)||this.charRefCode===unicode_js_1.CODE_POINTS.CARRIAGE_RETURN){this._err(error_codes_js_1.ERR.controlCharacterReference);const replacement=C1_CONTROLS_REFERENCE_REPLACEMENTS.get(this.charRefCode);if(replacement!==undefined){this.charRefCode=replacement}}this._flushCodePointConsumedAsCharacterReference(this.charRefCode);this._reconsumeInState(this.returnState,cp)}}exports.Tokenizer=Tokenizer},{"../common/error-codes.js":355,"../common/html.js":357,"../common/token.js":358,"../common/unicode.js":359,"./preprocessor.js":366,"entities/lib/decode.js":179}],366:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Preprocessor=void 0;const unicode_js_1=require("../common/unicode.js");const error_codes_js_1=require("../common/error-codes.js");const DEFAULT_BUFFER_WATERLINE=1<<16;class Preprocessor{constructor(handler){this.handler=handler;this.html="";this.pos=-1;this.lastGapPos=-2;this.gapStack=[];this.skipNextNewLine=false;this.lastChunkWritten=false;this.endOfChunkHit=false;this.bufferWaterline=DEFAULT_BUFFER_WATERLINE;this.isEol=false;this.lineStartPos=0;this.droppedBufferSize=0;this.line=1;this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(code){const{line:line,col:col,offset:offset}=this;return{code:code,startLine:line,endLine:line,startCol:col,endCol:col,startOffset:offset,endOffset:offset}}_err(code){if(this.handler.onParseError&&this.lastErrOffset!==this.offset){this.lastErrOffset=this.offset;this.handler.onParseError(this.getError(code))}}_addGap(){this.gapStack.push(this.lastGapPos);this.lastGapPos=this.pos}_processSurrogate(cp){if(this.pos!==this.html.length-1){const nextCp=this.html.charCodeAt(this.pos+1);if((0,unicode_js_1.isSurrogatePair)(nextCp)){this.pos++;this._addGap();return(0,unicode_js_1.getSurrogatePairCodePoint)(cp,nextCp)}}else if(!this.lastChunkWritten){this.endOfChunkHit=true;return unicode_js_1.CODE_POINTS.EOF}this._err(error_codes_js_1.ERR.surrogateInInputStream);return cp}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){if(this.willDropParsedChunk()){this.html=this.html.substring(this.pos);this.lineStartPos-=this.pos;this.droppedBufferSize+=this.pos;this.pos=0;this.lastGapPos=-2;this.gapStack.length=0}}write(chunk,isLastChunk){if(this.html.length>0){this.html+=chunk}else{this.html=chunk}this.endOfChunkHit=false;this.lastChunkWritten=isLastChunk}insertHtmlAtCurrentPos(chunk){this.html=this.html.substring(0,this.pos+1)+chunk+this.html.substring(this.pos+1);this.endOfChunkHit=false}startsWith(pattern,caseSensitive){if(this.pos+pattern.length>this.html.length){this.endOfChunkHit=!this.lastChunkWritten;return false}if(caseSensitive){return this.html.startsWith(pattern,this.pos)}for(let i=0;i<pattern.length;i++){const cp=this.html.charCodeAt(this.pos+i)|32;if(cp!==pattern.charCodeAt(i)){return false}}return true}peek(offset){const pos=this.pos+offset;if(pos>=this.html.length){this.endOfChunkHit=!this.lastChunkWritten;return unicode_js_1.CODE_POINTS.EOF}const code=this.html.charCodeAt(pos);return code===unicode_js_1.CODE_POINTS.CARRIAGE_RETURN?unicode_js_1.CODE_POINTS.LINE_FEED:code}advance(){this.pos++;if(this.isEol){this.isEol=false;this.line++;this.lineStartPos=this.pos}if(this.pos>=this.html.length){this.endOfChunkHit=!this.lastChunkWritten;return unicode_js_1.CODE_POINTS.EOF}let cp=this.html.charCodeAt(this.pos);if(cp===unicode_js_1.CODE_POINTS.CARRIAGE_RETURN){this.isEol=true;this.skipNextNewLine=true;return unicode_js_1.CODE_POINTS.LINE_FEED}if(cp===unicode_js_1.CODE_POINTS.LINE_FEED){this.isEol=true;if(this.skipNextNewLine){this.line--;this.skipNextNewLine=false;this._addGap();return this.advance()}}this.skipNextNewLine=false;if((0,unicode_js_1.isSurrogate)(cp)){cp=this._processSurrogate(cp)}const isCommonValidRange=this.handler.onParseError===null||cp>31&&cp<127||cp===unicode_js_1.CODE_POINTS.LINE_FEED||cp===unicode_js_1.CODE_POINTS.CARRIAGE_RETURN||cp>159&&cp<64976;if(!isCommonValidRange){this._checkForProblematicCharacters(cp)}return cp}_checkForProblematicCharacters(cp){if((0,unicode_js_1.isControlCodePoint)(cp)){this._err(error_codes_js_1.ERR.controlCharacterInInputStream)}else if((0,unicode_js_1.isUndefinedCodePoint)(cp)){this._err(error_codes_js_1.ERR.noncharacterInInputStream)}}retreat(count){this.pos-=count;while(this.pos<this.lastGapPos){this.lastGapPos=this.gapStack.pop();this.pos--}this.isEol=false}}exports.Preprocessor=Preprocessor},{"../common/error-codes.js":355,"../common/unicode.js":359}],367:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.defaultTreeAdapter=void 0;const html_js_1=require("../common/html.js");function createTextNode(value){return{nodeName:"#text",value:value,parentNode:null}}exports.defaultTreeAdapter={createDocument(){return{nodeName:"#document",mode:html_js_1.DOCUMENT_MODE.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(tagName,namespaceURI,attrs){return{nodeName:tagName,tagName:tagName,attrs:attrs,namespaceURI:namespaceURI,childNodes:[],parentNode:null}},createCommentNode(data){return{nodeName:"#comment",data:data,parentNode:null}},appendChild(parentNode,newNode){parentNode.childNodes.push(newNode);newNode.parentNode=parentNode},insertBefore(parentNode,newNode,referenceNode){const insertionIdx=parentNode.childNodes.indexOf(referenceNode);parentNode.childNodes.splice(insertionIdx,0,newNode);newNode.parentNode=parentNode},setTemplateContent(templateElement,contentElement){templateElement.content=contentElement},getTemplateContent(templateElement){return templateElement.content},setDocumentType(document,name,publicId,systemId){const doctypeNode=document.childNodes.find((node=>node.nodeName==="#documentType"));if(doctypeNode){doctypeNode.name=name;doctypeNode.publicId=publicId;doctypeNode.systemId=systemId}else{const node={nodeName:"#documentType",name:name,publicId:publicId,systemId:systemId,parentNode:null};exports.defaultTreeAdapter.appendChild(document,node)}},setDocumentMode(document,mode){document.mode=mode},getDocumentMode(document){return document.mode},detachNode(node){if(node.parentNode){const idx=node.parentNode.childNodes.indexOf(node);node.parentNode.childNodes.splice(idx,1);node.parentNode=null}},insertText(parentNode,text){if(parentNode.childNodes.length>0){const prevNode=parentNode.childNodes[parentNode.childNodes.length-1];if(exports.defaultTreeAdapter.isTextNode(prevNode)){prevNode.value+=text;return}}exports.defaultTreeAdapter.appendChild(parentNode,createTextNode(text))},insertTextBefore(parentNode,text,referenceNode){const prevNode=parentNode.childNodes[parentNode.childNodes.indexOf(referenceNode)-1];if(prevNode&&exports.defaultTreeAdapter.isTextNode(prevNode)){prevNode.value+=text}else{exports.defaultTreeAdapter.insertBefore(parentNode,createTextNode(text),referenceNode)}},adoptAttributes(recipient,attrs){const recipientAttrsMap=new Set(recipient.attrs.map((attr=>attr.name)));for(let j=0;j<attrs.length;j++){if(!recipientAttrsMap.has(attrs[j].name)){recipient.attrs.push(attrs[j])}}},getFirstChild(node){return node.childNodes[0]},getChildNodes(node){return node.childNodes},getParentNode(node){return node.parentNode},getAttrList(element){return element.attrs},getTagName(element){return element.tagName},getNamespaceURI(element){return element.namespaceURI},getTextNodeContent(textNode){return textNode.value},getCommentNodeContent(commentNode){return commentNode.data},getDocumentTypeNodeName(doctypeNode){return doctypeNode.name},getDocumentTypeNodePublicId(doctypeNode){return doctypeNode.publicId},getDocumentTypeNodeSystemId(doctypeNode){return doctypeNode.systemId},isTextNode(node){return node.nodeName==="#text"},isCommentNode(node){return node.nodeName==="#comment"},isDocumentTypeNode(node){return node.nodeName==="#documentType"},isElementNode(node){return Object.prototype.hasOwnProperty.call(node,"tagName")},setNodeSourceCodeLocation(node,location){node.sourceCodeLocation=location},getNodeSourceCodeLocation(node){return node.sourceCodeLocation},updateNodeSourceCodeLocation(node,endLocation){node.sourceCodeLocation=Object.assign(Object.assign({},node.sourceCodeLocation),endLocation)}}},{"../common/html.js":357}],368:[function(require,module,exports){(function(process){(function(){"use strict";function assertPath(path){if(typeof path!=="string"){throw new TypeError("Path must be a string. Received "+JSON.stringify(path))}}function normalizeStringPosix(path,allowAboveRoot){var res="";var lastSegmentLength=0;var lastSlash=-1;var dots=0;var code;for(var i=0;i<=path.length;++i){if(i<path.length)code=path.charCodeAt(i);else if(code===47)break;else code=47;if(code===47){if(lastSlash===i-1||dots===1){}else if(lastSlash!==i-1&&dots===2){if(res.length<2||lastSegmentLength!==2||res.charCodeAt(res.length-1)!==46||res.charCodeAt(res.length-2)!==46){if(res.length>2){var lastSlashIndex=res.lastIndexOf("/");if(lastSlashIndex!==res.length-1){if(lastSlashIndex===-1){res="";lastSegmentLength=0}else{res=res.slice(0,lastSlashIndex);lastSegmentLength=res.length-1-res.lastIndexOf("/")}lastSlash=i;dots=0;continue}}else if(res.length===2||res.length===1){res="";lastSegmentLength=0;lastSlash=i;dots=0;continue}}if(allowAboveRoot){if(res.length>0)res+="/..";else res="..";lastSegmentLength=2}}else{if(res.length>0)res+="/"+path.slice(lastSlash+1,i);else res=path.slice(lastSlash+1,i);lastSegmentLength=i-lastSlash-1}lastSlash=i;dots=0}else if(code===46&&dots!==-1){++dots}else{dots=-1}}return res}function _format(sep,pathObject){var dir=pathObject.dir||pathObject.root;var base=pathObject.base||(pathObject.name||"")+(pathObject.ext||"");if(!dir){return base}if(dir===pathObject.root){return dir+base}return dir+sep+base}var posix={resolve:function resolve(){var resolvedPath="";var resolvedAbsolute=false;var cwd;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path;if(i>=0)path=arguments[i];else{if(cwd===undefined)cwd=process.cwd();path=cwd}assertPath(path);if(path.length===0){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charCodeAt(0)===47}resolvedPath=normalizeStringPosix(resolvedPath,!resolvedAbsolute);if(resolvedAbsolute){if(resolvedPath.length>0)return"/"+resolvedPath;else return"/"}else if(resolvedPath.length>0){return resolvedPath}else{return"."}},normalize:function normalize(path){assertPath(path);if(path.length===0)return".";var isAbsolute=path.charCodeAt(0)===47;var trailingSeparator=path.charCodeAt(path.length-1)===47;path=normalizeStringPosix(path,!isAbsolute);if(path.length===0&&!isAbsolute)path=".";if(path.length>0&&trailingSeparator)path+="/";if(isAbsolute)return"/"+path;return path},isAbsolute:function isAbsolute(path){assertPath(path);return path.length>0&&path.charCodeAt(0)===47},join:function join(){if(arguments.length===0)return".";var joined;for(var i=0;i<arguments.length;++i){var arg=arguments[i];assertPath(arg);if(arg.length>0){if(joined===undefined)joined=arg;else joined+="/"+arg}}if(joined===undefined)return".";return posix.normalize(joined)},relative:function relative(from,to){assertPath(from);assertPath(to);if(from===to)return"";from=posix.resolve(from);to=posix.resolve(to);if(from===to)return"";var fromStart=1;for(;fromStart<from.length;++fromStart){if(from.charCodeAt(fromStart)!==47)break}var fromEnd=from.length;var fromLen=fromEnd-fromStart;var toStart=1;for(;toStart<to.length;++toStart){if(to.charCodeAt(toStart)!==47)break}var toEnd=to.length;var toLen=toEnd-toStart;var length=fromLen<toLen?fromLen:toLen;var lastCommonSep=-1;var i=0;for(;i<=length;++i){if(i===length){if(toLen>length){if(to.charCodeAt(toStart+i)===47){return to.slice(toStart+i+1)}else if(i===0){return to.slice(toStart+i)}}else if(fromLen>length){if(from.charCodeAt(fromStart+i)===47){lastCommonSep=i}else if(i===0){lastCommonSep=0}}break}var fromCode=from.charCodeAt(fromStart+i);var toCode=to.charCodeAt(toStart+i);if(fromCode!==toCode)break;else if(fromCode===47)lastCommonSep=i}var out="";for(i=fromStart+lastCommonSep+1;i<=fromEnd;++i){if(i===fromEnd||from.charCodeAt(i)===47){if(out.length===0)out+="..";else out+="/.."}}if(out.length>0)return out+to.slice(toStart+lastCommonSep);else{toStart+=lastCommonSep;if(to.charCodeAt(toStart)===47)++toStart;return to.slice(toStart)}},_makeLong:function _makeLong(path){return path},dirname:function dirname(path){assertPath(path);if(path.length===0)return".";var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break}}else{matchedSlash=false}}if(end===-1)return hasRoot?"/":".";if(hasRoot&&end===1)return"//";return path.slice(0,end)},basename:function basename(path,ext){if(ext!==undefined&&typeof ext!=="string")throw new TypeError('"ext" argument must be a string');assertPath(path);var start=0;var end=-1;var matchedSlash=true;var i;if(ext!==undefined&&ext.length>0&&ext.length<=path.length){if(ext.length===path.length&&ext===path)return"";var extIdx=ext.length-1;var firstNonSlashEnd=-1;for(i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){start=i+1;break}}else{if(firstNonSlashEnd===-1){matchedSlash=false;firstNonSlashEnd=i+1}if(extIdx>=0){if(code===ext.charCodeAt(extIdx)){if(--extIdx===-1){end=i}}else{extIdx=-1;end=firstNonSlashEnd}}}}if(start===end)end=firstNonSlashEnd;else if(end===-1)end=path.length;return path.slice(start,end)}else{for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break}}else if(end===-1){matchedSlash=false;end=i+1}}if(end===-1)return"";return path.slice(start,end)}},extname:function extname(path){assertPath(path);var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return""}return path.slice(startDot,end)},format:function format(pathObject){if(pathObject===null||typeof pathObject!=="object"){throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof pathObject)}return _format("/",pathObject)},parse:function parse(path){assertPath(path);var ret={root:"",dir:"",base:"",ext:"",name:""};if(path.length===0)return ret;var code=path.charCodeAt(0);var isAbsolute=code===47;var start;if(isAbsolute){ret.root="/";start=1}else{start=0}var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var i=path.length-1;var preDotState=0;for(;i>=start;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break}continue}if(end===-1){matchedSlash=false;end=i+1}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1}else if(startDot!==-1){preDotState=-1}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){if(end!==-1){if(startPart===0&&isAbsolute)ret.base=ret.name=path.slice(1,end);else ret.base=ret.name=path.slice(startPart,end)}}else{if(startPart===0&&isAbsolute){ret.name=path.slice(1,startDot);ret.base=path.slice(1,end)}else{ret.name=path.slice(startPart,startDot);ret.base=path.slice(startPart,end)}ret.ext=path.slice(startDot,end)}if(startPart>0)ret.dir=path.slice(0,startPart-1);else if(isAbsolute)ret.dir="/";return ret},sep:"/",delimiter:":",win32:null,posix:null};posix.posix=posix;module.exports=posix}).call(this)}).call(this,require("_process"))},{_process:88}],369:[function(require,module,exports){exports.pbkdf2=require("./lib/async");exports.pbkdf2Sync=require("./lib/sync")},{"./lib/async":370,"./lib/sync":373}],370:[function(require,module,exports){(function(global){(function(){var Buffer=require("safe-buffer").Buffer;var checkParameters=require("./precondition");var defaultEncoding=require("./default-encoding");var sync=require("./sync");var toBuffer=require("./to-buffer");var ZERO_BUF;var subtle=global.crypto&&global.crypto.subtle;var toBrowser={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"};var checks=[];function checkNative(algo){if(global.process&&!global.process.browser){return Promise.resolve(false)}if(!subtle||!subtle.importKey||!subtle.deriveBits){return Promise.resolve(false)}if(checks[algo]!==undefined){return checks[algo]}ZERO_BUF=ZERO_BUF||Buffer.alloc(8);var prom=browserPbkdf2(ZERO_BUF,ZERO_BUF,10,128,algo).then((function(){return true})).catch((function(){return false}));checks[algo]=prom;return prom}var nextTick;function getNextTick(){if(nextTick){return nextTick}if(global.process&&global.process.nextTick){nextTick=global.process.nextTick}else if(global.queueMicrotask){nextTick=global.queueMicrotask}else if(global.setImmediate){nextTick=global.setImmediate}else{nextTick=global.setTimeout}return nextTick}function browserPbkdf2(password,salt,iterations,length,algo){return subtle.importKey("raw",password,{name:"PBKDF2"},false,["deriveBits"]).then((function(key){return subtle.deriveBits({name:"PBKDF2",salt:salt,iterations:iterations,hash:{name:algo}},key,length<<3)})).then((function(res){return Buffer.from(res)}))}function resolvePromise(promise,callback){promise.then((function(out){getNextTick()((function(){callback(null,out)}))}),(function(e){getNextTick()((function(){callback(e)}))}))}module.exports=function(password,salt,iterations,keylen,digest,callback){if(typeof digest==="function"){callback=digest;digest=undefined}digest=digest||"sha1";var algo=toBrowser[digest.toLowerCase()];if(!algo||typeof global.Promise!=="function"){getNextTick()((function(){var out;try{out=sync(password,salt,iterations,keylen,digest)}catch(e){return callback(e)}callback(null,out)}));return}checkParameters(iterations,keylen);password=toBuffer(password,defaultEncoding,"Password");salt=toBuffer(salt,defaultEncoding,"Salt");if(typeof callback!=="function")throw new Error("No callback provided to pbkdf2");resolvePromise(checkNative(algo).then((function(resp){if(resp)return browserPbkdf2(password,salt,iterations,keylen,algo);return sync(password,salt,iterations,keylen,digest)})),callback)}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./default-encoding":371,"./precondition":372,"./sync":373,"./to-buffer":374,"safe-buffer":385}],371:[function(require,module,exports){(function(process,global){(function(){var defaultEncoding;if(global.process&&global.process.browser){defaultEncoding="utf-8"}else if(global.process&&global.process.version){var pVersionMajor=parseInt(process.version.split(".")[0].slice(1),10);defaultEncoding=pVersionMajor>=6?"utf-8":"binary"}else{defaultEncoding="utf-8"}module.exports=defaultEncoding}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:88}],372:[function(require,module,exports){var MAX_ALLOC=Math.pow(2,30)-1;module.exports=function(iterations,keylen){if(typeof iterations!=="number"){throw new TypeError("Iterations not a number")}if(iterations<0){throw new TypeError("Bad iterations")}if(typeof keylen!=="number"){throw new TypeError("Key length not a number")}if(keylen<0||keylen>MAX_ALLOC||keylen!==keylen){throw new TypeError("Bad key length")}}},{}],373:[function(require,module,exports){var md5=require("create-hash/md5");var RIPEMD160=require("ripemd160");var sha=require("sha.js");var Buffer=require("safe-buffer").Buffer;var checkParameters=require("./precondition");var defaultEncoding=require("./default-encoding");var toBuffer=require("./to-buffer");var ZEROS=Buffer.alloc(128);var sizes={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function Hmac(alg,key,saltLen){var hash=getDigest(alg);var blocksize=alg==="sha512"||alg==="sha384"?128:64;if(key.length>blocksize){key=hash(key)}else if(key.length<blocksize){key=Buffer.concat([key,ZEROS],blocksize)}var ipad=Buffer.allocUnsafe(blocksize+sizes[alg]);var opad=Buffer.allocUnsafe(blocksize+sizes[alg]);for(var i=0;i<blocksize;i++){ipad[i]=key[i]^54;opad[i]=key[i]^92}var ipad1=Buffer.allocUnsafe(blocksize+saltLen+4);ipad.copy(ipad1,0,0,blocksize);this.ipad1=ipad1;this.ipad2=ipad;this.opad=opad;this.alg=alg;this.blocksize=blocksize;this.hash=hash;this.size=sizes[alg]}Hmac.prototype.run=function(data,ipad){data.copy(ipad,this.blocksize);var h=this.hash(ipad);h.copy(this.opad,this.blocksize);return this.hash(this.opad)};function getDigest(alg){function shaFunc(data){return sha(alg).update(data).digest()}function rmd160Func(data){return(new RIPEMD160).update(data).digest()}if(alg==="rmd160"||alg==="ripemd160")return rmd160Func;if(alg==="md5")return md5;return shaFunc}function pbkdf2(password,salt,iterations,keylen,digest){checkParameters(iterations,keylen);password=toBuffer(password,defaultEncoding,"Password");salt=toBuffer(salt,defaultEncoding,"Salt");digest=digest||"sha1";var hmac=new Hmac(digest,password,salt.length);var DK=Buffer.allocUnsafe(keylen);var block1=Buffer.allocUnsafe(salt.length+4);salt.copy(block1,0,0,salt.length);var destPos=0;var hLen=sizes[digest];var l=Math.ceil(keylen/hLen);for(var i=1;i<=l;i++){block1.writeUInt32BE(i,salt.length);var T=hmac.run(block1,hmac.ipad1);var U=T;for(var j=1;j<iterations;j++){U=hmac.run(U,hmac.ipad2);for(var k=0;k<hLen;k++)T[k]^=U[k]}T.copy(DK,destPos);destPos+=hLen}return DK}module.exports=pbkdf2},{"./default-encoding":371,"./precondition":372,"./to-buffer":374,"create-hash/md5":115,ripemd160:384,"safe-buffer":385,"sha.js":389}],374:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;module.exports=function(thing,encoding,name){if(Buffer.isBuffer(thing)){return thing}else if(typeof thing==="string"){return Buffer.from(thing,encoding)}else if(ArrayBuffer.isView(thing)){return Buffer.from(thing.buffer)}else{throw new TypeError(name+" must be a string, a Buffer, a typed array or a DataView")}}},{"safe-buffer":385}],375:[function(require,module,exports){exports.publicEncrypt=require("./publicEncrypt");exports.privateDecrypt=require("./privateDecrypt");exports.privateEncrypt=function privateEncrypt(key,buf){return exports.publicEncrypt(key,buf,true)};exports.publicDecrypt=function publicDecrypt(key,buf){return exports.privateDecrypt(key,buf,true)}},{"./privateDecrypt":378,"./publicEncrypt":379}],376:[function(require,module,exports){var createHash=require("create-hash");var Buffer=require("safe-buffer").Buffer;module.exports=function(seed,len){var t=Buffer.alloc(0);var i=0;var c;while(t.length<len){c=i2ops(i++);t=Buffer.concat([t,createHash("sha1").update(seed).update(c).digest()])}return t.slice(0,len)};function i2ops(c){var out=Buffer.allocUnsafe(4);out.writeUInt32BE(c,0);return out}},{"create-hash":114,"safe-buffer":385}],377:[function(require,module,exports){arguments[4][34][0].apply(exports,arguments)},{buffer:88,dup:34}],378:[function(require,module,exports){var parseKeys=require("parse-asn1");var mgf=require("./mgf");var xor=require("./xor");var BN=require("bn.js");var crt=require("browserify-rsa");var createHash=require("create-hash");var withPublic=require("./withPublic");var Buffer=require("safe-buffer").Buffer;module.exports=function privateDecrypt(privateKey,enc,reverse){var padding;if(privateKey.padding){padding=privateKey.padding}else if(reverse){padding=1}else{padding=4}var key=parseKeys(privateKey);var k=key.modulus.byteLength();if(enc.length>k||new BN(enc).cmp(key.modulus)>=0){throw new Error("decryption error")}var msg;if(reverse){msg=withPublic(new BN(enc),key)}else{msg=crt(enc,key)}var zBuffer=Buffer.alloc(k-msg.length);msg=Buffer.concat([zBuffer,msg],k);if(padding===4){return oaep(key,msg)}else if(padding===1){return pkcs1(key,msg,reverse)}else if(padding===3){return msg}else{throw new Error("unknown padding")}};function oaep(key,msg){var k=key.modulus.byteLength();var iHash=createHash("sha1").update(Buffer.alloc(0)).digest();var hLen=iHash.length;if(msg[0]!==0){throw new Error("decryption error")}var maskedSeed=msg.slice(1,hLen+1);var maskedDb=msg.slice(hLen+1);var seed=xor(maskedSeed,mgf(maskedDb,hLen));var db=xor(maskedDb,mgf(seed,k-hLen-1));if(compare(iHash,db.slice(0,hLen))){throw new Error("decryption error")}var i=hLen;while(db[i]===0){i++}if(db[i++]!==1){throw new Error("decryption error")}return db.slice(i)}function pkcs1(key,msg,reverse){var p1=msg.slice(0,2);var i=2;var status=0;while(msg[i++]!==0){if(i>=msg.length){status++;break}}var ps=msg.slice(2,i-1);if(p1.toString("hex")!=="0002"&&!reverse||p1.toString("hex")!=="0001"&&reverse){status++}if(ps.length<8){status++}if(status){throw new Error("decryption error")}return msg.slice(i)}function compare(a,b){a=Buffer.from(a);b=Buffer.from(b);var dif=0;var len=a.length;if(a.length!==b.length){dif++;len=Math.min(a.length,b.length)}var i=-1;while(++i<len){dif+=a[i]^b[i]}return dif}},{"./mgf":376,"./withPublic":380,"./xor":381,"bn.js":377,"browserify-rsa":64,"create-hash":114,"parse-asn1":352,"safe-buffer":385}],379:[function(require,module,exports){var parseKeys=require("parse-asn1");var randomBytes=require("randombytes");var createHash=require("create-hash");var mgf=require("./mgf");var xor=require("./xor");var BN=require("bn.js");var withPublic=require("./withPublic");var crt=require("browserify-rsa");var Buffer=require("safe-buffer").Buffer;module.exports=function publicEncrypt(publicKey,msg,reverse){var padding;if(publicKey.padding){padding=publicKey.padding}else if(reverse){padding=1}else{padding=4}var key=parseKeys(publicKey);var paddedMsg;if(padding===4){paddedMsg=oaep(key,msg)}else if(padding===1){paddedMsg=pkcs1(key,msg,reverse)}else if(padding===3){paddedMsg=new BN(msg);if(paddedMsg.cmp(key.modulus)>=0){throw new Error("data too long for modulus")}}else{throw new Error("unknown padding")}if(reverse){return crt(paddedMsg,key)}else{return withPublic(paddedMsg,key)}};function oaep(key,msg){var k=key.modulus.byteLength();var mLen=msg.length;var iHash=createHash("sha1").update(Buffer.alloc(0)).digest();var hLen=iHash.length;var hLen2=2*hLen;if(mLen>k-hLen2-2){throw new Error("message too long")}var ps=Buffer.alloc(k-mLen-hLen2-2);var dblen=k-hLen-1;var seed=randomBytes(hLen);var maskedDb=xor(Buffer.concat([iHash,ps,Buffer.alloc(1,1),msg],dblen),mgf(seed,dblen));var maskedSeed=xor(seed,mgf(maskedDb,hLen));return new BN(Buffer.concat([Buffer.alloc(1),maskedSeed,maskedDb],k))}function pkcs1(key,msg,reverse){var mLen=msg.length;var k=key.modulus.byteLength();if(mLen>k-11){throw new Error("message too long")}var ps;if(reverse){ps=Buffer.alloc(k-mLen-3,255)}else{ps=nonZero(k-mLen-3)}return new BN(Buffer.concat([Buffer.from([0,reverse?1:2]),ps,Buffer.alloc(1),msg],k))}function nonZero(len){var out=Buffer.allocUnsafe(len);var i=0;var cache=randomBytes(len*2);var cur=0;var num;while(i<len){if(cur===cache.length){cache=randomBytes(len*2);cur=0}num=cache[cur++];if(num){out[i++]=num}}return out}},{"./mgf":376,"./withPublic":380,"./xor":381,"bn.js":377,"browserify-rsa":64,"create-hash":114,"parse-asn1":352,randombytes:382,"safe-buffer":385}],380:[function(require,module,exports){var BN=require("bn.js");var Buffer=require("safe-buffer").Buffer;function withPublic(paddedMsg,key){return Buffer.from(paddedMsg.toRed(BN.mont(key.modulus)).redPow(new BN(key.publicExponent)).fromRed().toArray())}module.exports=withPublic},{"bn.js":377,"safe-buffer":385}],381:[function(require,module,exports){module.exports=function xor(a,b){var len=a.length;var i=-1;while(++i<len){a[i]^=b[i]}return a}},{}],382:[function(require,module,exports){(function(process,global){(function(){"use strict";var MAX_BYTES=65536;var MAX_UINT32=4294967295;function oldBrowser(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var Buffer=require("safe-buffer").Buffer;var crypto=global.crypto||global.msCrypto;if(crypto&&crypto.getRandomValues){module.exports=randomBytes}else{module.exports=oldBrowser}function randomBytes(size,cb){if(size>MAX_UINT32)throw new RangeError("requested too many random bytes");var bytes=Buffer.allocUnsafe(size);if(size>0){if(size>MAX_BYTES){for(var generated=0;generated<size;generated+=MAX_BYTES){crypto.getRandomValues(bytes.slice(generated,generated+MAX_BYTES))}}else{crypto.getRandomValues(bytes)}}if(typeof cb==="function"){return process.nextTick((function(){cb(null,bytes)}))}return bytes}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:88,"safe-buffer":385}],383:[function(require,module,exports){(function(process,global){(function(){"use strict";function oldBrowser(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var safeBuffer=require("safe-buffer");var randombytes=require("randombytes");var Buffer=safeBuffer.Buffer;var kBufferMaxLength=safeBuffer.kMaxLength;var crypto=global.crypto||global.msCrypto;var kMaxUint32=Math.pow(2,32)-1;function assertOffset(offset,length){if(typeof offset!=="number"||offset!==offset){throw new TypeError("offset must be a number")}if(offset>kMaxUint32||offset<0){throw new TypeError("offset must be a uint32")}if(offset>kBufferMaxLength||offset>length){throw new RangeError("offset out of range")}}function assertSize(size,offset,length){if(typeof size!=="number"||size!==size){throw new TypeError("size must be a number")}if(size>kMaxUint32||size<0){throw new TypeError("size must be a uint32")}if(size+offset>length||size>kBufferMaxLength){throw new RangeError("buffer too small")}}if(crypto&&crypto.getRandomValues||!process.browser){exports.randomFill=randomFill;exports.randomFillSync=randomFillSync}else{exports.randomFill=oldBrowser;exports.randomFillSync=oldBrowser}function randomFill(buf,offset,size,cb){if(!Buffer.isBuffer(buf)&&!(buf instanceof global.Uint8Array)){throw new TypeError('"buf" argument must be a Buffer or Uint8Array')}if(typeof offset==="function"){cb=offset;offset=0;size=buf.length}else if(typeof size==="function"){cb=size;size=buf.length-offset}else if(typeof cb!=="function"){throw new TypeError('"cb" argument must be a function')}assertOffset(offset,buf.length);assertSize(size,offset,buf.length);return actualFill(buf,offset,size,cb)}function actualFill(buf,offset,size,cb){if(process.browser){var ourBuf=buf.buffer;var uint=new Uint8Array(ourBuf,offset,size);crypto.getRandomValues(uint);if(cb){process.nextTick((function(){cb(null,buf)}));return}return buf}if(cb){randombytes(size,(function(err,bytes){if(err){return cb(err)}bytes.copy(buf,offset);cb(null,buf)}));return}var bytes=randombytes(size);bytes.copy(buf,offset);return buf}function randomFillSync(buf,offset,size){if(typeof offset==="undefined"){offset=0}if(!Buffer.isBuffer(buf)&&!(buf instanceof global.Uint8Array)){throw new TypeError('"buf" argument must be a Buffer or Uint8Array')}assertOffset(offset,buf.length);if(size===undefined)size=buf.length-offset;assertSize(size,offset,buf.length);return actualFill(buf,offset,size)}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:88,randombytes:382,"safe-buffer":385}],384:[function(require,module,exports){"use strict";var Buffer=require("buffer").Buffer;var inherits=require("inherits");var HashBase=require("hash-base");var ARRAY16=new Array(16);var zl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var zr=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var sl=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var sr=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var hl=[0,1518500249,1859775393,2400959708,2840853838];var hr=[1352829926,1548603684,1836072691,2053994217,0];function RIPEMD160(){HashBase.call(this,64);this._a=1732584193;this._b=4023233417;this._c=2562383102;this._d=271733878;this._e=3285377520}inherits(RIPEMD160,HashBase);RIPEMD160.prototype._update=function(){var words=ARRAY16;for(var j=0;j<16;++j)words[j]=this._block.readInt32LE(j*4);var al=this._a|0;var bl=this._b|0;var cl=this._c|0;var dl=this._d|0;var el=this._e|0;var ar=this._a|0;var br=this._b|0;var cr=this._c|0;var dr=this._d|0;var er=this._e|0;for(var i=0;i<80;i+=1){var tl;var tr;if(i<16){tl=fn1(al,bl,cl,dl,el,words[zl[i]],hl[0],sl[i]);tr=fn5(ar,br,cr,dr,er,words[zr[i]],hr[0],sr[i])}else if(i<32){tl=fn2(al,bl,cl,dl,el,words[zl[i]],hl[1],sl[i]);tr=fn4(ar,br,cr,dr,er,words[zr[i]],hr[1],sr[i])}else if(i<48){tl=fn3(al,bl,cl,dl,el,words[zl[i]],hl[2],sl[i]);tr=fn3(ar,br,cr,dr,er,words[zr[i]],hr[2],sr[i])}else if(i<64){tl=fn4(al,bl,cl,dl,el,words[zl[i]],hl[3],sl[i]);tr=fn2(ar,br,cr,dr,er,words[zr[i]],hr[3],sr[i])}else{tl=fn5(al,bl,cl,dl,el,words[zl[i]],hl[4],sl[i]);tr=fn1(ar,br,cr,dr,er,words[zr[i]],hr[4],sr[i])}al=el;el=dl;dl=rotl(cl,10);cl=bl;bl=tl;ar=er;er=dr;dr=rotl(cr,10);cr=br;br=tr}var t=this._b+cl+dr|0;this._b=this._c+dl+er|0;this._c=this._d+el+ar|0;this._d=this._e+al+br|0;this._e=this._a+bl+cr|0;this._a=t};RIPEMD160.prototype._digest=function(){this._block[this._blockOffset++]=128;if(this._blockOffset>56){this._block.fill(0,this._blockOffset,64);this._update();this._blockOffset=0}this._block.fill(0,this._blockOffset,56);this._block.writeUInt32LE(this._length[0],56);this._block.writeUInt32LE(this._length[1],60);this._update();var buffer=Buffer.alloc?Buffer.alloc(20):new Buffer(20);buffer.writeInt32LE(this._a,0);buffer.writeInt32LE(this._b,4);buffer.writeInt32LE(this._c,8);buffer.writeInt32LE(this._d,12);buffer.writeInt32LE(this._e,16);return buffer};function rotl(x,n){return x<<n|x>>>32-n}function fn1(a,b,c,d,e,m,k,s){return rotl(a+(b^c^d)+m+k|0,s)+e|0}function fn2(a,b,c,d,e,m,k,s){return rotl(a+(b&c|~b&d)+m+k|0,s)+e|0}function fn3(a,b,c,d,e,m,k,s){return rotl(a+((b|~c)^d)+m+k|0,s)+e|0}function fn4(a,b,c,d,e,m,k,s){return rotl(a+(b&d|c&~d)+m+k|0,s)+e|0}function fn5(a,b,c,d,e,m,k,s){return rotl(a+(b^(c|~d))+m+k|0,s)+e|0}module.exports=RIPEMD160},{buffer:88,"hash-base":199,inherits:233}],385:[function(require,module,exports){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var buffer=require("buffer");var Buffer=buffer.Buffer;function copyProps(src,dst){for(var key in src){dst[key]=src[key]}}if(Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow){module.exports=buffer}else{copyProps(buffer,exports);exports.Buffer=SafeBuffer}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}SafeBuffer.prototype=Object.create(Buffer.prototype);copyProps(Buffer,SafeBuffer);SafeBuffer.from=function(arg,encodingOrOffset,length){if(typeof arg==="number"){throw new TypeError("Argument must not be a number")}return Buffer(arg,encodingOrOffset,length)};SafeBuffer.alloc=function(size,fill,encoding){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}var buf=Buffer(size);if(fill!==undefined){if(typeof encoding==="string"){buf.fill(fill,encoding)}else{buf.fill(fill)}}else{buf.fill(0)}return buf};SafeBuffer.allocUnsafe=function(size){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}return Buffer(size)};SafeBuffer.allocUnsafeSlow=function(size){if(typeof size!=="number"){throw new TypeError("Argument must be a number")}return buffer.SlowBuffer(size)}},{buffer:88}],386:[function(require,module,exports){(function(process){(function(){"use strict";var buffer=require("buffer");var Buffer=buffer.Buffer;var safer={};var key;for(key in buffer){if(!buffer.hasOwnProperty(key))continue;if(key==="SlowBuffer"||key==="Buffer")continue;safer[key]=buffer[key]}var Safer=safer.Buffer={};for(key in Buffer){if(!Buffer.hasOwnProperty(key))continue;if(key==="allocUnsafe"||key==="allocUnsafeSlow")continue;Safer[key]=Buffer[key]}safer.Buffer.prototype=Buffer.prototype;if(!Safer.from||Safer.from===Uint8Array.from){Safer.from=function(value,encodingOrOffset,length){if(typeof value==="number"){throw new TypeError('The "value" argument must not be of type number. Received type '+typeof value)}if(value&&typeof value.length==="undefined"){throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof value)}return Buffer(value,encodingOrOffset,length)}}if(!Safer.alloc){Safer.alloc=function(size,fill,encoding){if(typeof size!=="number"){throw new TypeError('The "size" argument must be of type number. Received type '+typeof size)}if(size<0||size>=2*(1<<30)){throw new RangeError('The value "'+size+'" is invalid for option "size"')}var buf=Buffer(size);if(!fill||fill.length===0){buf.fill(0)}else if(typeof encoding==="string"){buf.fill(fill,encoding)}else{buf.fill(fill)}return buf}}if(!safer.kStringMaxLength){try{safer.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}}if(!safer.constants){safer.constants={MAX_LENGTH:safer.kMaxLength};if(safer.kStringMaxLength){safer.constants.MAX_STRING_LENGTH=safer.kStringMaxLength}}module.exports=safer}).call(this)}).call(this,require("_process"))},{_process:88,buffer:88}],387:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var define=require("define-data-property");var hasDescriptors=require("has-property-descriptors")();var gOPD=require("gopd");var $TypeError=GetIntrinsic("%TypeError%");var $floor=GetIntrinsic("%Math.floor%");module.exports=function setFunctionLength(fn,length){if(typeof fn!=="function"){throw new $TypeError("`fn` is not a function")}if(typeof length!=="number"||length<0||length>4294967295||$floor(length)!==length){throw new $TypeError("`length` must be a positive 32-bit integer")}var loose=arguments.length>2&&!!arguments[2];var functionLengthIsConfigurable=true;var functionLengthIsWritable=true;if("length"in fn&&gOPD){var desc=gOPD(fn,"length");if(desc&&!desc.configurable){functionLengthIsConfigurable=false}if(desc&&!desc.writable){functionLengthIsWritable=false}}if(functionLengthIsConfigurable||functionLengthIsWritable||!loose){if(hasDescriptors){define(fn,"length",length,true,true)}else{define(fn,"length",length)}}return fn}},{"define-data-property":137,"get-intrinsic":192,gopd:193,"has-property-descriptors":194}],388:[function(require,module,exports){var Buffer=require("safe-buffer").Buffer;function Hash(blockSize,finalSize){this._block=Buffer.alloc(blockSize);this._finalSize=finalSize;this._blockSize=blockSize;this._len=0}Hash.prototype.update=function(data,enc){if(typeof data==="string"){enc=enc||"utf8";data=Buffer.from(data,enc)}var block=this._block;var blockSize=this._blockSize;var length=data.length;var accum=this._len;for(var offset=0;offset<length;){var assigned=accum%blockSize;var remainder=Math.min(length-offset,blockSize-assigned);for(var i=0;i<remainder;i++){block[assigned+i]=data[offset+i]}accum+=remainder;offset+=remainder;if(accum%blockSize===0){this._update(block)}}this._len+=length;return this};Hash.prototype.digest=function(enc){var rem=this._len%this._blockSize;this._block[rem]=128;this._block.fill(0,rem+1);if(rem>=this._finalSize){this._update(this._block);this._block.fill(0)}var bits=this._len*8;if(bits<=4294967295){this._block.writeUInt32BE(bits,this._blockSize-4)}else{var lowBits=(bits&4294967295)>>>0;var highBits=(bits-lowBits)/4294967296;this._block.writeUInt32BE(highBits,this._blockSize-8);this._block.writeUInt32BE(lowBits,this._blockSize-4)}this._update(this._block);var hash=this._hash();return enc?hash.toString(enc):hash};Hash.prototype._update=function(){throw new Error("_update must be implemented by subclass")};module.exports=Hash},{"safe-buffer":385}],389:[function(require,module,exports){var exports=module.exports=function SHA(algorithm){algorithm=algorithm.toLowerCase();var Algorithm=exports[algorithm];if(!Algorithm)throw new Error(algorithm+" is not supported (we accept pull requests)");return new Algorithm};exports.sha=require("./sha");exports.sha1=require("./sha1");exports.sha224=require("./sha224");exports.sha256=require("./sha256");exports.sha384=require("./sha384");exports.sha512=require("./sha512")},{"./sha":390,"./sha1":391,"./sha224":392,"./sha256":393,"./sha384":394,"./sha512":395}],390:[function(require,module,exports){var inherits=require("inherits");var Hash=require("./hash");var Buffer=require("safe-buffer").Buffer;var K=[1518500249,1859775393,2400959708|0,3395469782|0];var W=new Array(80);function Sha(){this.init();this._w=W;Hash.call(this,64,56)}inherits(Sha,Hash);Sha.prototype.init=function(){this._a=1732584193;this._b=4023233417;this._c=2562383102;this._d=271733878;this._e=3285377520;return this};function rotl5(num){return num<<5|num>>>27}function rotl30(num){return num<<30|num>>>2}function ft(s,b,c,d){if(s===0)return b&c|~b&d;if(s===2)return b&c|b&d|c&d;return b^c^d}Sha.prototype._update=function(M){var W=this._w;var a=this._a|0;var b=this._b|0;var c=this._c|0;var d=this._d|0;var e=this._e|0;for(var i=0;i<16;++i)W[i]=M.readInt32BE(i*4);for(;i<80;++i)W[i]=W[i-3]^W[i-8]^W[i-14]^W[i-16];for(var j=0;j<80;++j){var s=~~(j/20);var t=rotl5(a)+ft(s,b,c,d)+e+W[j]+K[s]|0;e=d;d=c;c=rotl30(b);b=a;a=t}this._a=a+this._a|0;this._b=b+this._b|0;this._c=c+this._c|0;this._d=d+this._d|0;this._e=e+this._e|0};Sha.prototype._hash=function(){var H=Buffer.allocUnsafe(20);H.writeInt32BE(this._a|0,0);H.writeInt32BE(this._b|0,4);H.writeInt32BE(this._c|0,8);H.writeInt32BE(this._d|0,12);H.writeInt32BE(this._e|0,16);return H};module.exports=Sha},{"./hash":388,inherits:233,"safe-buffer":385}],391:[function(require,module,exports){var inherits=require("inherits");var Hash=require("./hash");var Buffer=require("safe-buffer").Buffer;var K=[1518500249,1859775393,2400959708|0,3395469782|0];var W=new Array(80);function Sha1(){this.init();this._w=W;Hash.call(this,64,56)}inherits(Sha1,Hash);Sha1.prototype.init=function(){this._a=1732584193;this._b=4023233417;this._c=2562383102;this._d=271733878;this._e=3285377520;return this};function rotl1(num){return num<<1|num>>>31}function rotl5(num){return num<<5|num>>>27}function rotl30(num){return num<<30|num>>>2}function ft(s,b,c,d){if(s===0)return b&c|~b&d;if(s===2)return b&c|b&d|c&d;return b^c^d}Sha1.prototype._update=function(M){var W=this._w;var a=this._a|0;var b=this._b|0;var c=this._c|0;var d=this._d|0;var e=this._e|0;for(var i=0;i<16;++i)W[i]=M.readInt32BE(i*4);for(;i<80;++i)W[i]=rotl1(W[i-3]^W[i-8]^W[i-14]^W[i-16]);for(var j=0;j<80;++j){var s=~~(j/20);var t=rotl5(a)+ft(s,b,c,d)+e+W[j]+K[s]|0;e=d;d=c;c=rotl30(b);b=a;a=t}this._a=a+this._a|0;this._b=b+this._b|0;this._c=c+this._c|0;this._d=d+this._d|0;this._e=e+this._e|0};Sha1.prototype._hash=function(){var H=Buffer.allocUnsafe(20);H.writeInt32BE(this._a|0,0);H.writeInt32BE(this._b|0,4);H.writeInt32BE(this._c|0,8);H.writeInt32BE(this._d|0,12);H.writeInt32BE(this._e|0,16);return H};module.exports=Sha1},{"./hash":388,inherits:233,"safe-buffer":385}],392:[function(require,module,exports){var inherits=require("inherits");var Sha256=require("./sha256");var Hash=require("./hash");var Buffer=require("safe-buffer").Buffer;var W=new Array(64);function Sha224(){this.init();this._w=W;Hash.call(this,64,56)}inherits(Sha224,Sha256);Sha224.prototype.init=function(){this._a=3238371032;this._b=914150663;this._c=812702999;this._d=4144912697;this._e=4290775857;this._f=1750603025;this._g=1694076839;this._h=3204075428;return this};Sha224.prototype._hash=function(){var H=Buffer.allocUnsafe(28);H.writeInt32BE(this._a,0);H.writeInt32BE(this._b,4);H.writeInt32BE(this._c,8);H.writeInt32BE(this._d,12);H.writeInt32BE(this._e,16);H.writeInt32BE(this._f,20);H.writeInt32BE(this._g,24);return H};module.exports=Sha224},{"./hash":388,"./sha256":393,inherits:233,"safe-buffer":385}],393:[function(require,module,exports){var inherits=require("inherits");var Hash=require("./hash");var Buffer=require("safe-buffer").Buffer;var K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var W=new Array(64);function Sha256(){this.init();this._w=W;Hash.call(this,64,56)}inherits(Sha256,Hash);Sha256.prototype.init=function(){this._a=1779033703;this._b=3144134277;this._c=1013904242;this._d=2773480762;this._e=1359893119;this._f=2600822924;this._g=528734635;this._h=1541459225;return this};function ch(x,y,z){return z^x&(y^z)}function maj(x,y,z){return x&y|z&(x|y)}function sigma0(x){return(x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10)}function sigma1(x){return(x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7)}function gamma0(x){return(x>>>7|x<<25)^(x>>>18|x<<14)^x>>>3}function gamma1(x){return(x>>>17|x<<15)^(x>>>19|x<<13)^x>>>10}Sha256.prototype._update=function(M){var W=this._w;var a=this._a|0;var b=this._b|0;var c=this._c|0;var d=this._d|0;var e=this._e|0;var f=this._f|0;var g=this._g|0;var h=this._h|0;for(var i=0;i<16;++i)W[i]=M.readInt32BE(i*4);for(;i<64;++i)W[i]=gamma1(W[i-2])+W[i-7]+gamma0(W[i-15])+W[i-16]|0;for(var j=0;j<64;++j){var T1=h+sigma1(e)+ch(e,f,g)+K[j]+W[j]|0;var T2=sigma0(a)+maj(a,b,c)|0;h=g;g=f;f=e;e=d+T1|0;d=c;c=b;b=a;a=T1+T2|0}this._a=a+this._a|0;this._b=b+this._b|0;this._c=c+this._c|0;this._d=d+this._d|0;this._e=e+this._e|0;this._f=f+this._f|0;this._g=g+this._g|0;this._h=h+this._h|0};Sha256.prototype._hash=function(){var H=Buffer.allocUnsafe(32);H.writeInt32BE(this._a,0);H.writeInt32BE(this._b,4);H.writeInt32BE(this._c,8);H.writeInt32BE(this._d,12);H.writeInt32BE(this._e,16);H.writeInt32BE(this._f,20);H.writeInt32BE(this._g,24);H.writeInt32BE(this._h,28);return H};module.exports=Sha256},{"./hash":388,inherits:233,"safe-buffer":385}],394:[function(require,module,exports){var inherits=require("inherits");var SHA512=require("./sha512");var Hash=require("./hash");var Buffer=require("safe-buffer").Buffer;var W=new Array(160);function Sha384(){this.init();this._w=W;Hash.call(this,128,112)}inherits(Sha384,SHA512);Sha384.prototype.init=function(){this._ah=3418070365;this._bh=1654270250;this._ch=2438529370;this._dh=355462360;this._eh=1731405415;this._fh=2394180231;this._gh=3675008525;this._hh=1203062813;this._al=3238371032;this._bl=914150663;this._cl=812702999;this._dl=4144912697;this._el=4290775857;this._fl=1750603025;this._gl=1694076839;this._hl=3204075428;return this};Sha384.prototype._hash=function(){var H=Buffer.allocUnsafe(48);function writeInt64BE(h,l,offset){H.writeInt32BE(h,offset);H.writeInt32BE(l,offset+4)}writeInt64BE(this._ah,this._al,0);writeInt64BE(this._bh,this._bl,8);writeInt64BE(this._ch,this._cl,16);writeInt64BE(this._dh,this._dl,24);writeInt64BE(this._eh,this._el,32);writeInt64BE(this._fh,this._fl,40);return H};module.exports=Sha384},{"./hash":388,"./sha512":395,inherits:233,"safe-buffer":385}],395:[function(require,module,exports){var inherits=require("inherits");var Hash=require("./hash");var Buffer=require("safe-buffer").Buffer;var K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];var W=new Array(160);function Sha512(){this.init();this._w=W;Hash.call(this,128,112)}inherits(Sha512,Hash);Sha512.prototype.init=function(){this._ah=1779033703;this._bh=3144134277;this._ch=1013904242;this._dh=2773480762;this._eh=1359893119;this._fh=2600822924;this._gh=528734635;this._hh=1541459225;this._al=4089235720;this._bl=2227873595;this._cl=4271175723;this._dl=1595750129;this._el=2917565137;this._fl=725511199;this._gl=4215389547;this._hl=327033209;return this};function Ch(x,y,z){return z^x&(y^z)}function maj(x,y,z){return x&y|z&(x|y)}function sigma0(x,xl){return(x>>>28|xl<<4)^(xl>>>2|x<<30)^(xl>>>7|x<<25)}function sigma1(x,xl){return(x>>>14|xl<<18)^(x>>>18|xl<<14)^(xl>>>9|x<<23)}function Gamma0(x,xl){return(x>>>1|xl<<31)^(x>>>8|xl<<24)^x>>>7}function Gamma0l(x,xl){return(x>>>1|xl<<31)^(x>>>8|xl<<24)^(x>>>7|xl<<25)}function Gamma1(x,xl){return(x>>>19|xl<<13)^(xl>>>29|x<<3)^x>>>6}function Gamma1l(x,xl){return(x>>>19|xl<<13)^(xl>>>29|x<<3)^(x>>>6|xl<<26)}function getCarry(a,b){return a>>>0<b>>>0?1:0}Sha512.prototype._update=function(M){var W=this._w;var ah=this._ah|0;var bh=this._bh|0;var ch=this._ch|0;var dh=this._dh|0;var eh=this._eh|0;var fh=this._fh|0;var gh=this._gh|0;var hh=this._hh|0;var al=this._al|0;var bl=this._bl|0;var cl=this._cl|0;var dl=this._dl|0;var el=this._el|0;var fl=this._fl|0;var gl=this._gl|0;var hl=this._hl|0;for(var i=0;i<32;i+=2){W[i]=M.readInt32BE(i*4);W[i+1]=M.readInt32BE(i*4+4)}for(;i<160;i+=2){var xh=W[i-15*2];var xl=W[i-15*2+1];var gamma0=Gamma0(xh,xl);var gamma0l=Gamma0l(xl,xh);xh=W[i-2*2];xl=W[i-2*2+1];var gamma1=Gamma1(xh,xl);var gamma1l=Gamma1l(xl,xh);var Wi7h=W[i-7*2];var Wi7l=W[i-7*2+1];var Wi16h=W[i-16*2];var Wi16l=W[i-16*2+1];var Wil=gamma0l+Wi7l|0;var Wih=gamma0+Wi7h+getCarry(Wil,gamma0l)|0;Wil=Wil+gamma1l|0;Wih=Wih+gamma1+getCarry(Wil,gamma1l)|0;Wil=Wil+Wi16l|0;Wih=Wih+Wi16h+getCarry(Wil,Wi16l)|0;W[i]=Wih;W[i+1]=Wil}for(var j=0;j<160;j+=2){Wih=W[j];Wil=W[j+1];var majh=maj(ah,bh,ch);var majl=maj(al,bl,cl);var sigma0h=sigma0(ah,al);var sigma0l=sigma0(al,ah);var sigma1h=sigma1(eh,el);var sigma1l=sigma1(el,eh);var Kih=K[j];var Kil=K[j+1];var chh=Ch(eh,fh,gh);var chl=Ch(el,fl,gl);var t1l=hl+sigma1l|0;var t1h=hh+sigma1h+getCarry(t1l,hl)|0;t1l=t1l+chl|0;t1h=t1h+chh+getCarry(t1l,chl)|0;t1l=t1l+Kil|0;t1h=t1h+Kih+getCarry(t1l,Kil)|0;t1l=t1l+Wil|0;t1h=t1h+Wih+getCarry(t1l,Wil)|0;var t2l=sigma0l+majl|0;var t2h=sigma0h+majh+getCarry(t2l,sigma0l)|0;hh=gh;hl=gl;gh=fh;gl=fl;fh=eh;fl=el;el=dl+t1l|0;eh=dh+t1h+getCarry(el,dl)|0;dh=ch;dl=cl;ch=bh;cl=bl;bh=ah;bl=al;al=t1l+t2l|0;ah=t1h+t2h+getCarry(al,t1l)|0}this._al=this._al+al|0;this._bl=this._bl+bl|0;this._cl=this._cl+cl|0;this._dl=this._dl+dl|0;this._el=this._el+el|0;this._fl=this._fl+fl|0;this._gl=this._gl+gl|0;this._hl=this._hl+hl|0;this._ah=this._ah+ah+getCarry(this._al,al)|0;this._bh=this._bh+bh+getCarry(this._bl,bl)|0;this._ch=this._ch+ch+getCarry(this._cl,cl)|0;this._dh=this._dh+dh+getCarry(this._dl,dl)|0;this._eh=this._eh+eh+getCarry(this._el,el)|0;this._fh=this._fh+fh+getCarry(this._fl,fl)|0;this._gh=this._gh+gh+getCarry(this._gl,gl)|0;this._hh=this._hh+hh+getCarry(this._hl,hl)|0};Sha512.prototype._hash=function(){var H=Buffer.allocUnsafe(64);function writeInt64BE(h,l,offset){H.writeInt32BE(h,offset);H.writeInt32BE(l,offset+4)}writeInt64BE(this._ah,this._al,0);writeInt64BE(this._bh,this._bl,8);writeInt64BE(this._ch,this._cl,16);writeInt64BE(this._dh,this._dl,24);writeInt64BE(this._eh,this._el,32);writeInt64BE(this._fh,this._fl,40);writeInt64BE(this._gh,this._gl,48);writeInt64BE(this._hh,this._hl,56);return H};module.exports=Sha512},{"./hash":388,inherits:233,"safe-buffer":385}],396:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBound=require("call-bind/callBound");var inspect=require("object-inspect");var $TypeError=GetIntrinsic("%TypeError%");var $WeakMap=GetIntrinsic("%WeakMap%",true);var $Map=GetIntrinsic("%Map%",true);var $weakMapGet=callBound("WeakMap.prototype.get",true);var $weakMapSet=callBound("WeakMap.prototype.set",true);var $weakMapHas=callBound("WeakMap.prototype.has",true);var $mapGet=callBound("Map.prototype.get",true);var $mapSet=callBound("Map.prototype.set",true);var $mapHas=callBound("Map.prototype.has",true);var listGetNode=function(list,key){for(var prev=list,curr;(curr=prev.next)!==null;prev=curr){if(curr.key===key){prev.next=curr.next;curr.next=list.next;list.next=curr;return curr}}};var listGet=function(objects,key){var node=listGetNode(objects,key);return node&&node.value};var listSet=function(objects,key,value){var node=listGetNode(objects,key);if(node){node.value=value}else{objects.next={key:key,next:objects.next,value:value}}};var listHas=function(objects,key){return!!listGetNode(objects,key)};module.exports=function getSideChannel(){var $wm;var $m;var $o;var channel={assert:function(key){if(!channel.has(key)){throw new $TypeError("Side channel does not contain "+inspect(key))}},get:function(key){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if($wm){return $weakMapGet($wm,key)}}else if($Map){if($m){return $mapGet($m,key)}}else{if($o){return listGet($o,key)}}},has:function(key){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if($wm){return $weakMapHas($wm,key)}}else if($Map){if($m){return $mapHas($m,key)}}else{if($o){return listHas($o,key)}}return false},set:function(key,value){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if(!$wm){$wm=new $WeakMap}$weakMapSet($wm,key,value)}else if($Map){if(!$m){$m=new $Map}$mapSet($m,key,value)}else{if(!$o){$o={key:{},next:null}}listSet($o,key,value)}}};return channel}},{"call-bind/callBound":92,"get-intrinsic":192,"object-inspect":330}],397:[function(require,module,exports){"use strict";var escapeRe=/([-.*+?^${}()|[\]\/\\])/g,unescapeRe=/\\/g;var escape=function(string){return(string+"").replace(escapeRe,"\\$1")};var unescape=function(string){return(string+"").replace(unescapeRe,"")};var slickRe=RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+escape(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));var Part=function Part(combinator){this.combinator=combinator||" ";this.tag="*"};Part.prototype.toString=function(){if(!this.raw){var xpr="",k,part;xpr+=this.tag||"*";if(this.id)xpr+="#"+this.id;if(this.classes)xpr+="."+this.classList.join(".");if(this.attributes)for(k=0;part=this.attributes[k++];){xpr+="["+part.name+(part.operator?part.operator+'"'+part.value+'"':"")+"]"}if(this.pseudos)for(k=0;part=this.pseudos[k++];){xpr+=":"+part.name;if(part.value)xpr+="("+part.value+")"}this.raw=xpr}return this.raw};var Expression=function Expression(){this.length=0};Expression.prototype.toString=function(){if(!this.raw){var xpr="";for(var j=0,bit;bit=this[j++];){if(j!==1)xpr+=" ";if(bit.combinator!==" ")xpr+=bit.combinator+" ";xpr+=bit}this.raw=xpr}return this.raw};var replacer=function(rawMatch,separator,combinator,combinatorChildren,tagName,id,className,attributeKey,attributeOperator,attributeQuote,attributeValue,pseudoMarker,pseudoClass,pseudoQuote,pseudoClassQuotedValue,pseudoClassValue){var expression,current;if(separator||!this.length){expression=this[this.length++]=new Expression;if(separator)return""}if(!expression)expression=this[this.length-1];if(combinator||combinatorChildren||!expression.length){current=expression[expression.length++]=new Part(combinator)}if(!current)current=expression[expression.length-1];if(tagName){current.tag=unescape(tagName)}else if(id){current.id=unescape(id)}else if(className){var unescaped=unescape(className);var classes=current.classes||(current.classes={});if(!classes[unescaped]){classes[unescaped]=escape(className);var classList=current.classList||(current.classList=[]);classList.push(unescaped);classList.sort()}}else if(pseudoClass){pseudoClassValue=pseudoClassValue||pseudoClassQuotedValue;(current.pseudos||(current.pseudos=[])).push({type:pseudoMarker.length==1?"class":"element",name:unescape(pseudoClass),escapedName:escape(pseudoClass),value:pseudoClassValue?unescape(pseudoClassValue):null,escapedValue:pseudoClassValue?escape(pseudoClassValue):null})}else if(attributeKey){attributeValue=attributeValue?escape(attributeValue):null;(current.attributes||(current.attributes=[])).push({operator:attributeOperator,name:unescape(attributeKey),escapedName:escape(attributeKey),value:attributeValue?unescape(attributeValue):null,escapedValue:attributeValue?escape(attributeValue):null})}return""};var Expressions=function Expressions(expression){this.length=0;var self=this;var original=expression,replaced;while(expression){replaced=expression.replace(slickRe,(function(){return replacer.apply(self,arguments)}));if(replaced===expression)throw new Error(original+" is an invalid expression");expression=replaced}};Expressions.prototype.toString=function(){if(!this.raw){var expressions=[];for(var i=0,expression;expression=this[i++];)expressions.push(expression);this.raw=expressions.join(", ")}return this.raw};var cache={};var parse=function(expression){if(expression==null)return null;expression=(""+expression).replace(/^\s+|\s+$/g,"");return cache[expression]||(cache[expression]=new Expressions(expression))};module.exports=parse},{}],398:[function(require,module,exports){module.exports=Stream;var EE=require("events").EventEmitter;var inherits=require("inherits");inherits(Stream,EE);Stream.Readable=require("readable-stream/lib/_stream_readable.js");Stream.Writable=require("readable-stream/lib/_stream_writable.js");Stream.Duplex=require("readable-stream/lib/_stream_duplex.js");Stream.Transform=require("readable-stream/lib/_stream_transform.js");Stream.PassThrough=require("readable-stream/lib/_stream_passthrough.js");Stream.finished=require("readable-stream/lib/internal/streams/end-of-stream.js");Stream.pipeline=require("readable-stream/lib/internal/streams/pipeline.js");Stream.Stream=Stream;function Stream(){EE.call(this)}Stream.prototype.pipe=function(dest,options){var source=this;function ondata(chunk){if(dest.writable){if(false===dest.write(chunk)&&source.pause){source.pause()}}}source.on("data",ondata);function ondrain(){if(source.readable&&source.resume){source.resume()}}dest.on("drain",ondrain);if(!dest._isStdio&&(!options||options.end!==false)){source.on("end",onend);source.on("close",onclose)}var didOnEnd=false;function onend(){if(didOnEnd)return;didOnEnd=true;dest.end()}function onclose(){if(didOnEnd)return;didOnEnd=true;if(typeof dest.destroy==="function")dest.destroy()}function onerror(er){cleanup();if(EE.listenerCount(this,"error")===0){throw er}}source.on("error",onerror);dest.on("error",onerror);function cleanup(){source.removeListener("data",ondata);dest.removeListener("drain",ondrain);source.removeListener("end",onend);source.removeListener("close",onclose);source.removeListener("error",onerror);dest.removeListener("error",onerror);source.removeListener("end",cleanup);source.removeListener("close",cleanup);dest.removeListener("close",cleanup)}source.on("end",cleanup);source.on("close",cleanup);dest.on("close",cleanup);dest.emit("pipe",source);return dest}},{events:187,inherits:233,"readable-stream/lib/_stream_duplex.js":400,"readable-stream/lib/_stream_passthrough.js":401,"readable-stream/lib/_stream_readable.js":402,"readable-stream/lib/_stream_transform.js":403,"readable-stream/lib/_stream_writable.js":404,"readable-stream/lib/internal/streams/end-of-stream.js":408,"readable-stream/lib/internal/streams/pipeline.js":410}],399:[function(require,module,exports){arguments[4][71][0].apply(exports,arguments)},{dup:71}],400:[function(require,module,exports){arguments[4][72][0].apply(exports,arguments)},{"./_stream_readable":402,"./_stream_writable":404,_process:88,dup:72,inherits:233}],401:[function(require,module,exports){arguments[4][73][0].apply(exports,arguments)},{"./_stream_transform":403,dup:73,inherits:233}],402:[function(require,module,exports){arguments[4][74][0].apply(exports,arguments)},{"../errors":399,"./_stream_duplex":400,"./internal/streams/async_iterator":405,"./internal/streams/buffer_list":406,"./internal/streams/destroy":407,"./internal/streams/from":409,"./internal/streams/state":411,"./internal/streams/stream":412,_process:88,buffer:88,dup:74,events:187,inherits:233,"string_decoder/":432,util:43}],403:[function(require,module,exports){arguments[4][75][0].apply(exports,arguments)},{"../errors":399,"./_stream_duplex":400,dup:75,inherits:233}],404:[function(require,module,exports){arguments[4][76][0].apply(exports,arguments)},{"../errors":399,"./_stream_duplex":400,"./internal/streams/destroy":407,"./internal/streams/state":411,"./internal/streams/stream":412,_process:88,buffer:88,dup:76,inherits:233,"util-deprecate":440}],405:[function(require,module,exports){arguments[4][77][0].apply(exports,arguments)},{"./end-of-stream":408,_process:88,dup:77}],406:[function(require,module,exports){arguments[4][78][0].apply(exports,arguments)},{buffer:88,dup:78,util:43}],407:[function(require,module,exports){arguments[4][79][0].apply(exports,arguments)},{_process:88,dup:79}],408:[function(require,module,exports){arguments[4][80][0].apply(exports,arguments)},{"../../../errors":399,dup:80}],409:[function(require,module,exports){arguments[4][81][0].apply(exports,arguments)},{dup:81}],410:[function(require,module,exports){arguments[4][82][0].apply(exports,arguments)},{"../../../errors":399,"./end-of-stream":408,dup:82}],411:[function(require,module,exports){arguments[4][83][0].apply(exports,arguments)},{"../../../errors":399,dup:83}],412:[function(require,module,exports){arguments[4][84][0].apply(exports,arguments)},{dup:84,events:187}],413:[function(require,module,exports){(function(global){(function(){var ClientRequest=require("./lib/request");var response=require("./lib/response");var extend=require("xtend");var statusCodes=require("builtin-status-codes");var url=require("url");var http=exports;http.request=function(opts,cb){if(typeof opts==="string")opts=url.parse(opts);else opts=extend(opts);var defaultProtocol=global.location.protocol.search(/^https?:$/)===-1?"http:":"";var protocol=opts.protocol||defaultProtocol;var host=opts.hostname||opts.host;var port=opts.port;var path=opts.path||"/";if(host&&host.indexOf(":")!==-1)host="["+host+"]";opts.url=(host?protocol+"//"+host:"")+(port?":"+port:"")+path;opts.method=(opts.method||"GET").toUpperCase();opts.headers=opts.headers||{};var req=new ClientRequest(opts);if(cb)req.on("response",cb);return req};http.get=function get(opts,cb){var req=http.request(opts,cb);req.end();return req};http.ClientRequest=ClientRequest;http.IncomingMessage=response.IncomingMessage;http.Agent=function(){};http.Agent.defaultMaxSockets=4;http.globalAgent=new http.Agent;http.STATUS_CODES=statusCodes;http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./lib/request":415,"./lib/response":416,"builtin-status-codes":91,url:439,xtend:445}],414:[function(require,module,exports){(function(global){(function(){exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableStream);exports.writableStream=isFunction(global.WritableStream);exports.abortController=isFunction(global.AbortController);var xhr;function getXHR(){if(xhr!==undefined)return xhr;if(global.XMLHttpRequest){xhr=new global.XMLHttpRequest;try{xhr.open("GET",global.XDomainRequest?"/":"https://example.com")}catch(e){xhr=null}}else{xhr=null}return xhr}function checkTypeSupport(type){var xhr=getXHR();if(!xhr)return false;try{xhr.responseType=type;return xhr.responseType===type}catch(e){}return false}exports.arraybuffer=exports.fetch||checkTypeSupport("arraybuffer");exports.msstream=!exports.fetch&&checkTypeSupport("ms-stream");exports.mozchunkedarraybuffer=!exports.fetch&&checkTypeSupport("moz-chunked-arraybuffer");exports.overrideMimeType=exports.fetch||(getXHR()?isFunction(getXHR().overrideMimeType):false);function isFunction(value){return typeof value==="function"}xhr=null}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],415:[function(require,module,exports){(function(process,global,Buffer){(function(){var capability=require("./capability");var inherits=require("inherits");var response=require("./response");var stream=require("readable-stream");var IncomingMessage=response.IncomingMessage;var rStates=response.readyStates;function decideMode(preferBinary,useFetch){if(capability.fetch&&useFetch){return"fetch"}else if(capability.mozchunkedarraybuffer){return"moz-chunked-arraybuffer"}else if(capability.msstream){return"ms-stream"}else if(capability.arraybuffer&&preferBinary){return"arraybuffer"}else{return"text"}}var ClientRequest=module.exports=function(opts){var self=this;stream.Writable.call(self);self._opts=opts;self._body=[];self._headers={};if(opts.auth)self.setHeader("Authorization","Basic "+Buffer.from(opts.auth).toString("base64"));Object.keys(opts.headers).forEach((function(name){self.setHeader(name,opts.headers[name])}));var preferBinary;var useFetch=true;if(opts.mode==="disable-fetch"||"requestTimeout"in opts&&!capability.abortController){useFetch=false;preferBinary=true}else if(opts.mode==="prefer-streaming"){preferBinary=false}else if(opts.mode==="allow-wrong-content-type"){preferBinary=!capability.overrideMimeType}else if(!opts.mode||opts.mode==="default"||opts.mode==="prefer-fast"){preferBinary=true}else{throw new Error("Invalid value for opts.mode")}self._mode=decideMode(preferBinary,useFetch);self._fetchTimer=null;self._socketTimeout=null;self._socketTimer=null;self.on("finish",(function(){self._onFinish()}))};inherits(ClientRequest,stream.Writable);ClientRequest.prototype.setHeader=function(name,value){var self=this;var lowerName=name.toLowerCase();if(unsafeHeaders.indexOf(lowerName)!==-1)return;self._headers[lowerName]={name:name,value:value}};ClientRequest.prototype.getHeader=function(name){var header=this._headers[name.toLowerCase()];if(header)return header.value;return null};ClientRequest.prototype.removeHeader=function(name){var self=this;delete self._headers[name.toLowerCase()]};ClientRequest.prototype._onFinish=function(){var self=this;if(self._destroyed)return;var opts=self._opts;if("timeout"in opts&&opts.timeout!==0){self.setTimeout(opts.timeout)}var headersObj=self._headers;var body=null;if(opts.method!=="GET"&&opts.method!=="HEAD"){body=new Blob(self._body,{type:(headersObj["content-type"]||{}).value||""})}var headersList=[];Object.keys(headersObj).forEach((function(keyName){var name=headersObj[keyName].name;var value=headersObj[keyName].value;if(Array.isArray(value)){value.forEach((function(v){headersList.push([name,v])}))}else{headersList.push([name,value])}}));if(self._mode==="fetch"){var signal=null;if(capability.abortController){var controller=new AbortController;signal=controller.signal;self._fetchAbortController=controller;if("requestTimeout"in opts&&opts.requestTimeout!==0){self._fetchTimer=global.setTimeout((function(){self.emit("requestTimeout");if(self._fetchAbortController)self._fetchAbortController.abort()}),opts.requestTimeout)}}global.fetch(self._opts.url,{method:self._opts.method,headers:headersList,body:body||undefined,mode:"cors",credentials:opts.withCredentials?"include":"same-origin",signal:signal}).then((function(response){self._fetchResponse=response;self._resetTimers(false);self._connect()}),(function(reason){self._resetTimers(true);if(!self._destroyed)self.emit("error",reason)}))}else{var xhr=self._xhr=new global.XMLHttpRequest;try{xhr.open(self._opts.method,self._opts.url,true)}catch(err){process.nextTick((function(){self.emit("error",err)}));return}if("responseType"in xhr)xhr.responseType=self._mode;if("withCredentials"in xhr)xhr.withCredentials=!!opts.withCredentials;if(self._mode==="text"&&"overrideMimeType"in xhr)xhr.overrideMimeType("text/plain; charset=x-user-defined");if("requestTimeout"in opts){xhr.timeout=opts.requestTimeout;xhr.ontimeout=function(){self.emit("requestTimeout")}}headersList.forEach((function(header){xhr.setRequestHeader(header[0],header[1])}));self._response=null;xhr.onreadystatechange=function(){switch(xhr.readyState){case rStates.LOADING:case rStates.DONE:self._onXHRProgress();break}};if(self._mode==="moz-chunked-arraybuffer"){xhr.onprogress=function(){self._onXHRProgress()}}xhr.onerror=function(){if(self._destroyed)return;self._resetTimers(true);self.emit("error",new Error("XHR error"))};try{xhr.send(body)}catch(err){process.nextTick((function(){self.emit("error",err)}));return}}};function statusValid(xhr){try{var status=xhr.status;return status!==null&&status!==0}catch(e){return false}}ClientRequest.prototype._onXHRProgress=function(){var self=this;self._resetTimers(false);if(!statusValid(self._xhr)||self._destroyed)return;if(!self._response)self._connect();self._response._onXHRProgress(self._resetTimers.bind(self))};ClientRequest.prototype._connect=function(){var self=this;if(self._destroyed)return;self._response=new IncomingMessage(self._xhr,self._fetchResponse,self._mode,self._resetTimers.bind(self));self._response.on("error",(function(err){self.emit("error",err)}));self.emit("response",self._response)};ClientRequest.prototype._write=function(chunk,encoding,cb){var self=this;self._body.push(chunk);cb()};ClientRequest.prototype._resetTimers=function(done){var self=this;global.clearTimeout(self._socketTimer);self._socketTimer=null;if(done){global.clearTimeout(self._fetchTimer);self._fetchTimer=null}else if(self._socketTimeout){self._socketTimer=global.setTimeout((function(){self.emit("timeout")}),self._socketTimeout)}};ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(err){var self=this;self._destroyed=true;self._resetTimers(true);if(self._response)self._response._destroyed=true;if(self._xhr)self._xhr.abort();else if(self._fetchAbortController)self._fetchAbortController.abort();if(err)self.emit("error",err)};ClientRequest.prototype.end=function(data,encoding,cb){var self=this;if(typeof data==="function"){cb=data;data=undefined}stream.Writable.prototype.end.call(self,data,encoding,cb)};ClientRequest.prototype.setTimeout=function(timeout,cb){var self=this;if(cb)self.once("timeout",cb);self._socketTimeout=timeout;self._resetTimers(false)};ClientRequest.prototype.flushHeaders=function(){};ClientRequest.prototype.setNoDelay=function(){};ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"./capability":414,"./response":416,_process:88,buffer:88,inherits:233,"readable-stream":431}],416:[function(require,module,exports){(function(process,global,Buffer){(function(){var capability=require("./capability");var inherits=require("inherits");var stream=require("readable-stream");var rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var IncomingMessage=exports.IncomingMessage=function(xhr,response,mode,resetTimers){var self=this;stream.Readable.call(self);self._mode=mode;self.headers={};self.rawHeaders=[];self.trailers={};self.rawTrailers=[];self.on("end",(function(){process.nextTick((function(){self.emit("close")}))}));if(mode==="fetch"){self._fetchResponse=response;self.url=response.url;self.statusCode=response.status;self.statusMessage=response.statusText;response.headers.forEach((function(header,key){self.headers[key.toLowerCase()]=header;self.rawHeaders.push(key,header)}));if(capability.writableStream){var writable=new WritableStream({write:function(chunk){resetTimers(false);return new Promise((function(resolve,reject){if(self._destroyed){reject()}else if(self.push(Buffer.from(chunk))){resolve()}else{self._resumeFetch=resolve}}))},close:function(){resetTimers(true);if(!self._destroyed)self.push(null)},abort:function(err){resetTimers(true);if(!self._destroyed)self.emit("error",err)}});try{response.body.pipeTo(writable).catch((function(err){resetTimers(true);if(!self._destroyed)self.emit("error",err)}));return}catch(e){}}var reader=response.body.getReader();function read(){reader.read().then((function(result){if(self._destroyed)return;resetTimers(result.done);if(result.done){self.push(null);return}self.push(Buffer.from(result.value));read()})).catch((function(err){resetTimers(true);if(!self._destroyed)self.emit("error",err)}))}read()}else{self._xhr=xhr;self._pos=0;self.url=xhr.responseURL;self.statusCode=xhr.status;self.statusMessage=xhr.statusText;var headers=xhr.getAllResponseHeaders().split(/\r?\n/);headers.forEach((function(header){var matches=header.match(/^([^:]+):\s*(.*)/);if(matches){var key=matches[1].toLowerCase();if(key==="set-cookie"){if(self.headers[key]===undefined){self.headers[key]=[]}self.headers[key].push(matches[2])}else if(self.headers[key]!==undefined){self.headers[key]+=", "+matches[2]}else{self.headers[key]=matches[2]}self.rawHeaders.push(matches[1],matches[2])}}));self._charset="x-user-defined";if(!capability.overrideMimeType){var mimeType=self.rawHeaders["mime-type"];if(mimeType){var charsetMatch=mimeType.match(/;\s*charset=([^;])(;|$)/);if(charsetMatch){self._charset=charsetMatch[1].toLowerCase()}}if(!self._charset)self._charset="utf-8"}}};inherits(IncomingMessage,stream.Readable);IncomingMessage.prototype._read=function(){var self=this;var resolve=self._resumeFetch;if(resolve){self._resumeFetch=null;resolve()}};IncomingMessage.prototype._onXHRProgress=function(resetTimers){var self=this;var xhr=self._xhr;var response=null;switch(self._mode){case"text":response=xhr.responseText;if(response.length>self._pos){var newData=response.substr(self._pos);if(self._charset==="x-user-defined"){var buffer=Buffer.alloc(newData.length);for(var i=0;i<newData.length;i++)buffer[i]=newData.charCodeAt(i)&255;self.push(buffer)}else{self.push(newData,self._charset)}self._pos=response.length}break;case"arraybuffer":if(xhr.readyState!==rStates.DONE||!xhr.response)break;response=xhr.response;self.push(Buffer.from(new Uint8Array(response)));break;case"moz-chunked-arraybuffer":response=xhr.response;if(xhr.readyState!==rStates.LOADING||!response)break;self.push(Buffer.from(new Uint8Array(response)));break;case"ms-stream":response=xhr.response;if(xhr.readyState!==rStates.LOADING)break;var reader=new global.MSStreamReader;reader.onprogress=function(){if(reader.result.byteLength>self._pos){self.push(Buffer.from(new Uint8Array(reader.result.slice(self._pos))));self._pos=reader.result.byteLength}};reader.onload=function(){resetTimers(true);self.push(null)};reader.readAsArrayBuffer(response);break}if(self._xhr.readyState===rStates.DONE&&self._mode!=="ms-stream"){resetTimers(true);self.push(null)}}}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"./capability":414,_process:88,buffer:88,inherits:233,"readable-stream":431}],417:[function(require,module,exports){arguments[4][71][0].apply(exports,arguments)},{dup:71}],418:[function(require,module,exports){arguments[4][72][0].apply(exports,arguments)},{"./_stream_readable":420,"./_stream_writable":422,_process:88,dup:72,inherits:233}],419:[function(require,module,exports){arguments[4][73][0].apply(exports,arguments)},{"./_stream_transform":421,dup:73,inherits:233}],420:[function(require,module,exports){arguments[4][74][0].apply(exports,arguments)},{"../errors":417,"./_stream_duplex":418,"./internal/streams/async_iterator":423,"./internal/streams/buffer_list":424,"./internal/streams/destroy":425,"./internal/streams/from":427,"./internal/streams/state":429,"./internal/streams/stream":430,_process:88,buffer:88,dup:74,events:187,inherits:233,"string_decoder/":432,util:43}],421:[function(require,module,exports){arguments[4][75][0].apply(exports,arguments)},{"../errors":417,"./_stream_duplex":418,dup:75,inherits:233}],422:[function(require,module,exports){arguments[4][76][0].apply(exports,arguments)},{"../errors":417,"./_stream_duplex":418,"./internal/streams/destroy":425,"./internal/streams/state":429,"./internal/streams/stream":430,_process:88,buffer:88,dup:76,inherits:233,"util-deprecate":440}],423:[function(require,module,exports){arguments[4][77][0].apply(exports,arguments)},{"./end-of-stream":426,_process:88,dup:77}],424:[function(require,module,exports){arguments[4][78][0].apply(exports,arguments)},{buffer:88,dup:78,util:43}],425:[function(require,module,exports){arguments[4][79][0].apply(exports,arguments)},{_process:88,dup:79}],426:[function(require,module,exports){arguments[4][80][0].apply(exports,arguments)},{"../../../errors":417,dup:80}],427:[function(require,module,exports){arguments[4][81][0].apply(exports,arguments)},{dup:81}],428:[function(require,module,exports){arguments[4][82][0].apply(exports,arguments)},{"../../../errors":417,"./end-of-stream":426,dup:82}],429:[function(require,module,exports){arguments[4][83][0].apply(exports,arguments)},{"../../../errors":417,dup:83}],430:[function(require,module,exports){arguments[4][84][0].apply(exports,arguments)},{dup:84,events:187}],431:[function(require,module,exports){arguments[4][85][0].apply(exports,arguments)},{"./lib/_stream_duplex.js":418,"./lib/_stream_passthrough.js":419,"./lib/_stream_readable.js":420,"./lib/_stream_transform.js":421,"./lib/_stream_writable.js":422,"./lib/internal/streams/end-of-stream.js":426,"./lib/internal/streams/pipeline.js":428,dup:85}],432:[function(require,module,exports){"use strict";var Buffer=require("safe-buffer").Buffer;var isEncoding=Buffer.isEncoding||function(encoding){encoding=""+encoding;switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function _normalizeEncoding(enc){if(!enc)return"utf8";var retried;while(true){switch(enc){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return enc;default:if(retried)return;enc=(""+enc).toLowerCase();retried=true}}}function normalizeEncoding(enc){var nenc=_normalizeEncoding(enc);if(typeof nenc!=="string"&&(Buffer.isEncoding===isEncoding||!isEncoding(enc)))throw new Error("Unknown encoding: "+enc);return nenc||enc}exports.StringDecoder=StringDecoder;function StringDecoder(encoding){this.encoding=normalizeEncoding(encoding);var nb;switch(this.encoding){case"utf16le":this.text=utf16Text;this.end=utf16End;nb=4;break;case"utf8":this.fillLast=utf8FillLast;nb=4;break;case"base64":this.text=base64Text;this.end=base64End;nb=3;break;default:this.write=simpleWrite;this.end=simpleEnd;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=Buffer.allocUnsafe(nb)}StringDecoder.prototype.write=function(buf){if(buf.length===0)return"";var r;var i;if(this.lastNeed){r=this.fillLast(buf);if(r===undefined)return"";i=this.lastNeed;this.lastNeed=0}else{i=0}if(i<buf.length)return r?r+this.text(buf,i):this.text(buf,i);return r||""};StringDecoder.prototype.end=utf8End;StringDecoder.prototype.text=utf8Text;StringDecoder.prototype.fillLast=function(buf){if(this.lastNeed<=buf.length){buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,buf.length);this.lastNeed-=buf.length};function utf8CheckByte(byte){if(byte<=127)return 0;else if(byte>>5===6)return 2;else if(byte>>4===14)return 3;else if(byte>>3===30)return 4;return byte>>6===2?-1:-2}function utf8CheckIncomplete(self,buf,i){var j=buf.length-1;if(j<i)return 0;var nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0)self.lastNeed=nb-1;return nb}if(--j<i||nb===-2)return 0;nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0)self.lastNeed=nb-2;return nb}if(--j<i||nb===-2)return 0;nb=utf8CheckByte(buf[j]);if(nb>=0){if(nb>0){if(nb===2)nb=0;else self.lastNeed=nb-3}return nb}return 0}function utf8CheckExtraBytes(self,buf,p){if((buf[0]&192)!==128){self.lastNeed=0;return"�"}if(self.lastNeed>1&&buf.length>1){if((buf[1]&192)!==128){self.lastNeed=1;return"�"}if(self.lastNeed>2&&buf.length>2){if((buf[2]&192)!==128){self.lastNeed=2;return"�"}}}}function utf8FillLast(buf){var p=this.lastTotal-this.lastNeed;var r=utf8CheckExtraBytes(this,buf,p);if(r!==undefined)return r;if(this.lastNeed<=buf.length){buf.copy(this.lastChar,p,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}buf.copy(this.lastChar,p,0,buf.length);this.lastNeed-=buf.length}function utf8Text(buf,i){var total=utf8CheckIncomplete(this,buf,i);if(!this.lastNeed)return buf.toString("utf8",i);this.lastTotal=total;var end=buf.length-(total-this.lastNeed);buf.copy(this.lastChar,0,end);return buf.toString("utf8",i,end)}function utf8End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed)return r+"�";return r}function utf16Text(buf,i){if((buf.length-i)%2===0){var r=buf.toString("utf16le",i);if(r){var c=r.charCodeAt(r.length-1);if(c>=55296&&c<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=buf[buf.length-2];this.lastChar[1]=buf[buf.length-1];return r.slice(0,-1)}}return r}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=buf[buf.length-1];return buf.toString("utf16le",i,buf.length-1)}function utf16End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed){var end=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,end)}return r}function base64Text(buf,i){var n=(buf.length-i)%3;if(n===0)return buf.toString("base64",i);this.lastNeed=3-n;this.lastTotal=3;if(n===1){this.lastChar[0]=buf[buf.length-1]}else{this.lastChar[0]=buf[buf.length-2];this.lastChar[1]=buf[buf.length-1]}return buf.toString("base64",i,buf.length-n)}function base64End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed)return r+this.lastChar.toString("base64",0,3-this.lastNeed);return r}function simpleWrite(buf){return buf.toString(this.encoding)}function simpleEnd(buf){return buf&&buf.length?this.write(buf):""}},{"safe-buffer":385}],433:[function(require,module,exports){(function(setImmediate,clearImmediate){(function(){var nextTick=require("process/browser.js").nextTick;var apply=Function.prototype.apply;var slice=Array.prototype.slice;var immediateIds={};var nextImmediateId=0;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)};exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)};exports.clearTimeout=exports.clearInterval=function(timeout){timeout.close()};function Timeout(id,clearFn){this._id=id;this._clearFn=clearFn}Timeout.prototype.unref=Timeout.prototype.ref=function(){};Timeout.prototype.close=function(){this._clearFn.call(window,this._id)};exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId);item._idleTimeout=msecs};exports.unenroll=function(item){clearTimeout(item._idleTimeoutId);item._idleTimeout=-1};exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;if(msecs>=0){item._idleTimeoutId=setTimeout((function onTimeout(){if(item._onTimeout)item._onTimeout()}),msecs)}};exports.setImmediate=typeof setImmediate==="function"?setImmediate:function(fn){var id=nextImmediateId++;var args=arguments.length<2?false:slice.call(arguments,1);immediateIds[id]=true;nextTick((function onNextTick(){if(immediateIds[id]){if(args){fn.apply(null,args)}else{fn.call(null)}exports.clearImmediate(id)}}));return id};exports.clearImmediate=typeof clearImmediate==="function"?clearImmediate:function(id){delete immediateIds[id]}}).call(this)}).call(this,require("timers").setImmediate,require("timers").clearImmediate)},{"process/browser.js":88,timers:433}],434:[function(require,module,exports){"use strict";var replace=String.prototype.replace;var percentTwenties=/%20/g;var Format={RFC1738:"RFC1738",RFC3986:"RFC3986"};module.exports={default:Format.RFC3986,formatters:{RFC1738:function(value){return replace.call(value,percentTwenties,"+")},RFC3986:function(value){return String(value)}},RFC1738:Format.RFC1738,RFC3986:Format.RFC3986}},{}],435:[function(require,module,exports){"use strict";var stringify=require("./stringify");var parse=require("./parse");var formats=require("./formats");module.exports={formats:formats,parse:parse,stringify:stringify}},{"./formats":434,"./parse":436,"./stringify":437}],436:[function(require,module,exports){"use strict";var utils=require("./utils");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var defaults={allowDots:false,allowPrototypes:false,allowSparse:false,arrayLimit:20,charset:"utf-8",charsetSentinel:false,comma:false,decoder:utils.decode,delimiter:"&",depth:5,ignoreQueryPrefix:false,interpretNumericEntities:false,parameterLimit:1e3,parseArrays:true,plainObjects:false,strictNullHandling:false};var interpretNumericEntities=function(str){return str.replace(/&#(\d+);/g,(function($0,numberStr){return String.fromCharCode(parseInt(numberStr,10))}))};var parseArrayValue=function(val,options){if(val&&typeof val==="string"&&options.comma&&val.indexOf(",")>-1){return val.split(",")}return val};var isoSentinel="utf8=%26%2310003%3B";var charsetSentinel="utf8=%E2%9C%93";var parseValues=function parseQueryStringValues(str,options){var obj={__proto__:null};var cleanStr=options.ignoreQueryPrefix?str.replace(/^\?/,""):str;var limit=options.parameterLimit===Infinity?undefined:options.parameterLimit;var parts=cleanStr.split(options.delimiter,limit);var skipIndex=-1;var i;var charset=options.charset;if(options.charsetSentinel){for(i=0;i<parts.length;++i){if(parts[i].indexOf("utf8=")===0){if(parts[i]===charsetSentinel){charset="utf-8"}else if(parts[i]===isoSentinel){charset="iso-8859-1"}skipIndex=i;i=parts.length}}}for(i=0;i<parts.length;++i){if(i===skipIndex){continue}var part=parts[i];var bracketEqualsPos=part.indexOf("]=");var pos=bracketEqualsPos===-1?part.indexOf("="):bracketEqualsPos+1;var key,val;if(pos===-1){key=options.decoder(part,defaults.decoder,charset,"key");val=options.strictNullHandling?null:""}else{key=options.decoder(part.slice(0,pos),defaults.decoder,charset,"key");val=utils.maybeMap(parseArrayValue(part.slice(pos+1),options),(function(encodedVal){return options.decoder(encodedVal,defaults.decoder,charset,"value")}))}if(val&&options.interpretNumericEntities&&charset==="iso-8859-1"){val=interpretNumericEntities(val)}if(part.indexOf("[]=")>-1){val=isArray(val)?[val]:val}if(has.call(obj,key)){obj[key]=utils.combine(obj[key],val)}else{obj[key]=val}}return obj};var parseObject=function(chain,val,options,valuesParsed){var leaf=valuesParsed?val:parseArrayValue(val,options);for(var i=chain.length-1;i>=0;--i){var obj;var root=chain[i];if(root==="[]"&&options.parseArrays){obj=[].concat(leaf)}else{obj=options.plainObjects?Object.create(null):{};var cleanRoot=root.charAt(0)==="["&&root.charAt(root.length-1)==="]"?root.slice(1,-1):root;var index=parseInt(cleanRoot,10);if(!options.parseArrays&&cleanRoot===""){obj={0:leaf}}else if(!isNaN(index)&&root!==cleanRoot&&String(index)===cleanRoot&&index>=0&&(options.parseArrays&&index<=options.arrayLimit)){obj=[];obj[index]=leaf}else if(cleanRoot!=="__proto__"){obj[cleanRoot]=leaf}}leaf=obj}return leaf};var parseKeys=function parseQueryStringKeys(givenKey,val,options,valuesParsed){if(!givenKey){return}var key=options.allowDots?givenKey.replace(/\.([^.[]+)/g,"[$1]"):givenKey;var brackets=/(\[[^[\]]*])/;var child=/(\[[^[\]]*])/g;var segment=options.depth>0&&brackets.exec(key);var parent=segment?key.slice(0,segment.index):key;var keys=[];if(parent){if(!options.plainObjects&&has.call(Object.prototype,parent)){if(!options.allowPrototypes){return}}keys.push(parent)}var i=0;while(options.depth>0&&(segment=child.exec(key))!==null&&i<options.depth){i+=1;if(!options.plainObjects&&has.call(Object.prototype,segment[1].slice(1,-1))){if(!options.allowPrototypes){return}}keys.push(segment[1])}if(segment){keys.push("["+key.slice(segment.index)+"]")}return parseObject(keys,val,options,valuesParsed)};var normalizeParseOptions=function normalizeParseOptions(opts){if(!opts){return defaults}if(opts.decoder!==null&&opts.decoder!==undefined&&typeof opts.decoder!=="function"){throw new TypeError("Decoder has to be a function.")}if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var charset=typeof opts.charset==="undefined"?defaults.charset:opts.charset;return{allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,allowPrototypes:typeof opts.allowPrototypes==="boolean"?opts.allowPrototypes:defaults.allowPrototypes,allowSparse:typeof opts.allowSparse==="boolean"?opts.allowSparse:defaults.allowSparse,arrayLimit:typeof opts.arrayLimit==="number"?opts.arrayLimit:defaults.arrayLimit,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,comma:typeof opts.comma==="boolean"?opts.comma:defaults.comma,decoder:typeof opts.decoder==="function"?opts.decoder:defaults.decoder,delimiter:typeof opts.delimiter==="string"||utils.isRegExp(opts.delimiter)?opts.delimiter:defaults.delimiter,depth:typeof opts.depth==="number"||opts.depth===false?+opts.depth:defaults.depth,ignoreQueryPrefix:opts.ignoreQueryPrefix===true,interpretNumericEntities:typeof opts.interpretNumericEntities==="boolean"?opts.interpretNumericEntities:defaults.interpretNumericEntities,parameterLimit:typeof opts.parameterLimit==="number"?opts.parameterLimit:defaults.parameterLimit,parseArrays:opts.parseArrays!==false,plainObjects:typeof opts.plainObjects==="boolean"?opts.plainObjects:defaults.plainObjects,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(str,opts){var options=normalizeParseOptions(opts);if(str===""||str===null||typeof str==="undefined"){return options.plainObjects?Object.create(null):{}}var tempObj=typeof str==="string"?parseValues(str,options):str;var obj=options.plainObjects?Object.create(null):{};var keys=Object.keys(tempObj);for(var i=0;i<keys.length;++i){var key=keys[i];var newObj=parseKeys(key,tempObj[key],options,typeof str==="string");obj=utils.merge(obj,newObj,options)}if(options.allowSparse===true){return obj}return utils.compact(obj)}},{"./utils":438}],437:[function(require,module,exports){"use strict";var getSideChannel=require("side-channel");var utils=require("./utils");var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var arrayPrefixGenerators={brackets:function brackets(prefix){return prefix+"[]"},comma:"comma",indices:function indices(prefix,key){return prefix+"["+key+"]"},repeat:function repeat(prefix){return prefix}};var isArray=Array.isArray;var push=Array.prototype.push;var pushToArray=function(arr,valueOrArray){push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])};var toISO=Date.prototype.toISOString;var defaultFormat=formats["default"];var defaults={addQueryPrefix:false,allowDots:false,charset:"utf-8",charsetSentinel:false,delimiter:"&",encode:true,encoder:utils.encode,encodeValuesOnly:false,format:defaultFormat,formatter:formats.formatters[defaultFormat],indices:false,serializeDate:function serializeDate(date){return toISO.call(date)},skipNulls:false,strictNullHandling:false};var isNonNullishPrimitive=function isNonNullishPrimitive(v){return typeof v==="string"||typeof v==="number"||typeof v==="boolean"||typeof v==="symbol"||typeof v==="bigint"};var sentinel={};var stringify=function stringify(object,prefix,generateArrayPrefix,commaRoundTrip,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset,sideChannel){var obj=object;var tmpSc=sideChannel;var step=0;var findFlag=false;while((tmpSc=tmpSc.get(sentinel))!==void undefined&&!findFlag){var pos=tmpSc.get(object);step+=1;if(typeof pos!=="undefined"){if(pos===step){throw new RangeError("Cyclic object value")}else{findFlag=true}}if(typeof tmpSc.get(sentinel)==="undefined"){step=0}}if(typeof filter==="function"){obj=filter(prefix,obj)}else if(obj instanceof Date){obj=serializeDate(obj)}else if(generateArrayPrefix==="comma"&&isArray(obj)){obj=utils.maybeMap(obj,(function(value){if(value instanceof Date){return serializeDate(value)}return value}))}if(obj===null){if(strictNullHandling){return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset,"key",format):prefix}obj=""}if(isNonNullishPrimitive(obj)||utils.isBuffer(obj)){if(encoder){var keyValue=encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset,"key",format);return[formatter(keyValue)+"="+formatter(encoder(obj,defaults.encoder,charset,"value",format))]}return[formatter(prefix)+"="+formatter(String(obj))]}var values=[];if(typeof obj==="undefined"){return values}var objKeys;if(generateArrayPrefix==="comma"&&isArray(obj)){if(encodeValuesOnly&&encoder){obj=utils.maybeMap(obj,encoder)}objKeys=[{value:obj.length>0?obj.join(",")||null:void undefined}]}else if(isArray(filter)){objKeys=filter}else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}var adjustedPrefix=commaRoundTrip&&isArray(obj)&&obj.length===1?prefix+"[]":prefix;for(var j=0;j<objKeys.length;++j){var key=objKeys[j];var value=typeof key==="object"&&typeof key.value!=="undefined"?key.value:obj[key];if(skipNulls&&value===null){continue}var keyPrefix=isArray(obj)?typeof generateArrayPrefix==="function"?generateArrayPrefix(adjustedPrefix,key):adjustedPrefix:adjustedPrefix+(allowDots?"."+key:"["+key+"]");sideChannel.set(object,step);var valueSideChannel=getSideChannel();valueSideChannel.set(sentinel,sideChannel);pushToArray(values,stringify(value,keyPrefix,generateArrayPrefix,commaRoundTrip,strictNullHandling,skipNulls,generateArrayPrefix==="comma"&&encodeValuesOnly&&isArray(obj)?null:encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset,valueSideChannel))}return values};var normalizeStringifyOptions=function normalizeStringifyOptions(opts){if(!opts){return defaults}if(opts.encoder!==null&&typeof opts.encoder!=="undefined"&&typeof opts.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var charset=opts.charset||defaults.charset;if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var format=formats["default"];if(typeof opts.format!=="undefined"){if(!has.call(formats.formatters,opts.format)){throw new TypeError("Unknown format option provided.")}format=opts.format}var formatter=formats.formatters[format];var filter=defaults.filter;if(typeof opts.filter==="function"||isArray(opts.filter)){filter=opts.filter}return{addQueryPrefix:typeof opts.addQueryPrefix==="boolean"?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,delimiter:typeof opts.delimiter==="undefined"?defaults.delimiter:opts.delimiter,encode:typeof opts.encode==="boolean"?opts.encode:defaults.encode,encoder:typeof opts.encoder==="function"?opts.encoder:defaults.encoder,encodeValuesOnly:typeof opts.encodeValuesOnly==="boolean"?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,format:format,formatter:formatter,serializeDate:typeof opts.serializeDate==="function"?opts.serializeDate:defaults.serializeDate,skipNulls:typeof opts.skipNulls==="boolean"?opts.skipNulls:defaults.skipNulls,sort:typeof opts.sort==="function"?opts.sort:null,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(object,opts){var obj=object;var options=normalizeStringifyOptions(opts);var objKeys;var filter;if(typeof options.filter==="function"){filter=options.filter;obj=filter("",obj)}else if(isArray(options.filter)){filter=options.filter;objKeys=filter}var keys=[];if(typeof obj!=="object"||obj===null){return""}var arrayFormat;if(opts&&opts.arrayFormat in arrayPrefixGenerators){arrayFormat=opts.arrayFormat}else if(opts&&"indices"in opts){arrayFormat=opts.indices?"indices":"repeat"}else{arrayFormat="indices"}var generateArrayPrefix=arrayPrefixGenerators[arrayFormat];if(opts&&"commaRoundTrip"in opts&&typeof opts.commaRoundTrip!=="boolean"){throw new TypeError("`commaRoundTrip` must be a boolean, or absent")}var commaRoundTrip=generateArrayPrefix==="comma"&&opts&&opts.commaRoundTrip;if(!objKeys){objKeys=Object.keys(obj)}if(options.sort){objKeys.sort(options.sort)}var sideChannel=getSideChannel();for(var i=0;i<objKeys.length;++i){var key=objKeys[i];if(options.skipNulls&&obj[key]===null){continue}pushToArray(keys,stringify(obj[key],key,generateArrayPrefix,commaRoundTrip,options.strictNullHandling,options.skipNulls,options.encode?options.encoder:null,options.filter,options.sort,options.allowDots,options.serializeDate,options.format,options.formatter,options.encodeValuesOnly,options.charset,sideChannel))}var joined=keys.join(options.delimiter);var prefix=options.addQueryPrefix===true?"?":"";if(options.charsetSentinel){if(options.charset==="iso-8859-1"){prefix+="utf8=%26%2310003%3B&"}else{prefix+="utf8=%E2%9C%93&"}}return joined.length>0?prefix+joined:""}},{"./formats":434,"./utils":438,"side-channel":396}],438:[function(require,module,exports){"use strict";var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var hexTable=function(){var array=[];for(var i=0;i<256;++i){array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase())}return array}();var compactQueue=function compactQueue(queue){while(queue.length>1){var item=queue.pop();var obj=item.obj[item.prop];if(isArray(obj)){var compacted=[];for(var j=0;j<obj.length;++j){if(typeof obj[j]!=="undefined"){compacted.push(obj[j])}}item.obj[item.prop]=compacted}}};var arrayToObject=function arrayToObject(source,options){var obj=options&&options.plainObjects?Object.create(null):{};for(var i=0;i<source.length;++i){if(typeof source[i]!=="undefined"){obj[i]=source[i]}}return obj};var merge=function merge(target,source,options){if(!source){return target}if(typeof source!=="object"){if(isArray(target)){target.push(source)}else if(target&&typeof target==="object"){if(options&&(options.plainObjects||options.allowPrototypes)||!has.call(Object.prototype,source)){target[source]=true}}else{return[target,source]}return target}if(!target||typeof target!=="object"){return[target].concat(source)}var mergeTarget=target;if(isArray(target)&&!isArray(source)){mergeTarget=arrayToObject(target,options)}if(isArray(target)&&isArray(source)){source.forEach((function(item,i){if(has.call(target,i)){var targetItem=target[i];if(targetItem&&typeof targetItem==="object"&&item&&typeof item==="object"){target[i]=merge(targetItem,item,options)}else{target.push(item)}}else{target[i]=item}}));return target}return Object.keys(source).reduce((function(acc,key){var value=source[key];if(has.call(acc,key)){acc[key]=merge(acc[key],value,options)}else{acc[key]=value}return acc}),mergeTarget)};var assign=function assignSingleSource(target,source){return Object.keys(source).reduce((function(acc,key){acc[key]=source[key];return acc}),target)};var decode=function(str,decoder,charset){var strWithoutPlus=str.replace(/\+/g," ");if(charset==="iso-8859-1"){return strWithoutPlus.replace(/%[0-9a-f]{2}/gi,unescape)}try{return decodeURIComponent(strWithoutPlus)}catch(e){return strWithoutPlus}};var encode=function encode(str,defaultEncoder,charset,kind,format){if(str.length===0){return str}var string=str;if(typeof str==="symbol"){string=Symbol.prototype.toString.call(str)}else if(typeof str!=="string"){string=String(str)}if(charset==="iso-8859-1"){return escape(string).replace(/%u[0-9a-f]{4}/gi,(function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"}))}var out="";for(var i=0;i<string.length;++i){var c=string.charCodeAt(i);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||format===formats.RFC1738&&(c===40||c===41)){out+=string.charAt(i);continue}if(c<128){out=out+hexTable[c];continue}if(c<2048){out=out+(hexTable[192|c>>6]+hexTable[128|c&63]);continue}if(c<55296||c>=57344){out=out+(hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|c&63]);continue}i+=1;c=65536+((c&1023)<<10|string.charCodeAt(i)&1023);out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|c&63]}return out};var compact=function compact(value){var queue=[{obj:{o:value},prop:"o"}];var refs=[];for(var i=0;i<queue.length;++i){var item=queue[i];var obj=item.obj[item.prop];var keys=Object.keys(obj);for(var j=0;j<keys.length;++j){var key=keys[j];var val=obj[key];if(typeof val==="object"&&val!==null&&refs.indexOf(val)===-1){queue.push({obj:obj,prop:key});refs.push(val)}}}compactQueue(queue);return value};var isRegExp=function isRegExp(obj){return Object.prototype.toString.call(obj)==="[object RegExp]"};var isBuffer=function isBuffer(obj){if(!obj||typeof obj!=="object"){return false}return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))};var combine=function combine(a,b){return[].concat(a,b)};var maybeMap=function maybeMap(val,fn){if(isArray(val)){var mapped=[];for(var i=0;i<val.length;i+=1){mapped.push(fn(val[i]))}return mapped}return fn(val)};module.exports={arrayToObject:arrayToObject,assign:assign,combine:combine,compact:compact,decode:decode,encode:encode,isBuffer:isBuffer,isRegExp:isRegExp,maybeMap:maybeMap,merge:merge}},{"./formats":434}],439:[function(require,module,exports){"use strict";var punycode=require("punycode");function Url(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:true,"javascript:":true},hostlessProtocol={javascript:true,"javascript:":true},slashedProtocol={http:true,https:true,ftp:true,gopher:true,file:true,"http:":true,"https:":true,"ftp:":true,"gopher:":true,"file:":true},querystring=require("qs");function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&typeof url==="object"&&url instanceof Url){return url}var u=new Url;u.parse(url,parseQueryString,slashesDenoteHost);return u}Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(typeof url!=="string"){throw new TypeError("Parameter 'url' must be a string, not "+typeof url)}var queryIndex=url.indexOf("?"),splitter=queryIndex!==-1&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/");url=uSplit.join(splitter);var rest=url;rest=rest.trim();if(!slashesDenoteHost&&url.split("#").length===1){var simplePath=simplePathPattern.exec(rest);if(simplePath){this.path=rest;this.href=rest;this.pathname=simplePath[1];if(simplePath[2]){this.search=simplePath[2];if(parseQueryString){this.query=querystring.parse(this.search.substr(1))}else{this.query=this.search.substr(1)}}else if(parseQueryString){this.search="";this.query={}}return this}}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto;rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@/]+@[^@/]+/)){var slashes=rest.substr(0,2)==="//";if(slashes&&!(proto&&hostlessProtocol[proto])){rest=rest.substr(2);this.slashes=true}}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){var hostEnd=-1;for(var i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd)){hostEnd=hec}}var auth,atSign;if(hostEnd===-1){atSign=rest.lastIndexOf("@")}else{atSign=rest.lastIndexOf("@",hostEnd)}if(atSign!==-1){auth=rest.slice(0,atSign);rest=rest.slice(atSign+1);this.auth=decodeURIComponent(auth)}hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);if(hec!==-1&&(hostEnd===-1||hec<hostEnd)){hostEnd=hec}}if(hostEnd===-1){hostEnd=rest.length}this.host=rest.slice(0,hostEnd);rest=rest.slice(hostEnd);this.parseHost();this.hostname=this.hostname||"";var ipv6Hostname=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ipv6Hostname){var hostparts=this.hostname.split(/\./);for(var i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(!part){continue}if(!part.match(hostnamePartPattern)){var newpart="";for(var j=0,k=part.length;j<k;j++){if(part.charCodeAt(j)>127){newpart+="x"}else{newpart+=part[j]}}if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i);var notHost=hostparts.slice(i+1);var bit=part.match(hostnamePartStart);if(bit){validParts.push(bit[1]);notHost.unshift(bit[2])}if(notHost.length){rest="/"+notHost.join(".")+rest}this.hostname=validParts.join(".");break}}}}if(this.hostname.length>hostnameMaxLen){this.hostname=""}else{this.hostname=this.hostname.toLowerCase()}if(!ipv6Hostname){this.hostname=punycode.toASCII(this.hostname)}var p=this.port?":"+this.port:"";var h=this.hostname||"";this.host=h+p;this.href+=this.host;if(ipv6Hostname){this.hostname=this.hostname.substr(1,this.hostname.length-2);if(rest[0]!=="/"){rest="/"+rest}}}if(!unsafeProtocol[lowerProto]){for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(rest.indexOf(ae)===-1){continue}var esc=encodeURIComponent(ae);if(esc===ae){esc=escape(ae)}rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");if(hash!==-1){this.hash=rest.substr(hash);rest=rest.slice(0,hash)}var qm=rest.indexOf("?");if(qm!==-1){this.search=rest.substr(qm);this.query=rest.substr(qm+1);if(parseQueryString){this.query=querystring.parse(this.query)}rest=rest.slice(0,qm)}else if(parseQueryString){this.search="";this.query={}}if(rest){this.pathname=rest}if(slashedProtocol[lowerProto]&&this.hostname&&!this.pathname){this.pathname="/"}if(this.pathname||this.search){var p=this.pathname||"";var s=this.search||"";this.path=p+s}this.href=this.format();return this};function urlFormat(obj){if(typeof obj==="string"){obj=urlParse(obj)}if(!(obj instanceof Url)){return Url.prototype.format.call(obj)}return obj.format()}Url.prototype.format=function(){var auth=this.auth||"";if(auth){auth=encodeURIComponent(auth);auth=auth.replace(/%3A/i,":");auth+="@"}var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=false,query="";if(this.host){host=auth+this.host}else if(this.hostname){host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]");if(this.port){host+=":"+this.port}}if(this.query&&typeof this.query==="object"&&Object.keys(this.query).length){query=querystring.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:false})}var search=this.search||query&&"?"+query||"";if(protocol&&protocol.substr(-1)!==":"){protocol+=":"}if(this.slashes||(!protocol||slashedProtocol[protocol])&&host!==false){host="//"+(host||"");if(pathname&&pathname.charAt(0)!=="/"){pathname="/"+pathname}}else if(!host){host=""}if(hash&&hash.charAt(0)!=="#"){hash="#"+hash}if(search&&search.charAt(0)!=="?"){search="?"+search}pathname=pathname.replace(/[?#]/g,(function(match){return encodeURIComponent(match)}));search=search.replace("#","%23");return protocol+host+pathname+search+hash};function urlResolve(source,relative){return urlParse(source,false,true).resolve(relative)}Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,false,true)).format()};function urlResolveObject(source,relative){if(!source){return relative}return urlParse(source,false,true).resolveObject(relative)}Url.prototype.resolveObject=function(relative){if(typeof relative==="string"){var rel=new Url;rel.parse(relative,false,true);relative=rel}var result=new Url;var tkeys=Object.keys(this);for(var tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}result.hash=relative.hash;if(relative.href===""){result.href=result.format();return result}if(relative.slashes&&!relative.protocol){var rkeys=Object.keys(relative);for(var rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];if(rkey!=="protocol"){result[rkey]=relative[rkey]}}if(slashedProtocol[result.protocol]&&result.hostname&&!result.pathname){result.pathname="/";result.path=result.pathname}result.href=result.format();return result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){var keys=Object.keys(relative);for(var v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}result.href=result.format();return result}result.protocol=relative.protocol;if(!relative.host&&!hostlessProtocol[relative.protocol]){var relPath=(relative.pathname||"").split("/");while(relPath.length&&!(relative.host=relPath.shift())){}if(!relative.host){relative.host=""}if(!relative.hostname){relative.hostname=""}if(relPath[0]!==""){relPath.unshift("")}if(relPath.length<2){relPath.unshift("")}result.pathname=relPath.join("/")}else{result.pathname=relative.pathname}result.search=relative.search;result.query=relative.query;result.host=relative.host||"";result.auth=relative.auth;result.hostname=relative.hostname||relative.host;result.port=relative.port;if(result.pathname||result.search){var p=result.pathname||"";var s=result.search||"";result.path=p+s}result.slashes=result.slashes||relative.slashes;result.href=result.format();return result}var isSourceAbs=result.pathname&&result.pathname.charAt(0)==="/",isRelAbs=relative.host||relative.pathname&&relative.pathname.charAt(0)==="/",mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic){result.hostname="";result.port=null;if(result.host){if(srcPath[0]===""){srcPath[0]=result.host}else{srcPath.unshift(result.host)}}result.host="";if(relative.protocol){relative.hostname=null;relative.port=null;if(relative.host){if(relPath[0]===""){relPath[0]=relative.host}else{relPath.unshift(relative.host)}}relative.host=null}mustEndAbs=mustEndAbs&&(relPath[0]===""||srcPath[0]==="")}if(isRelAbs){result.host=relative.host||relative.host===""?relative.host:result.host;result.hostname=relative.hostname||relative.hostname===""?relative.hostname:result.hostname;result.search=relative.search;result.query=relative.query;srcPath=relPath}else if(relPath.length){if(!srcPath){srcPath=[]}srcPath.pop();srcPath=srcPath.concat(relPath);result.search=relative.search;result.query=relative.query}else if(relative.search!=null){if(psychotic){result.host=srcPath.shift();result.hostname=result.host;var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.hostname=authInHost.shift();result.host=result.hostname}}result.search=relative.search;result.query=relative.query;if(result.pathname!==null||result.search!==null){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.href=result.format();return result}if(!srcPath.length){result.pathname=null;if(result.search){result.path="/"+result.search}else{result.path=null}result.href=result.format();return result}var last=srcPath.slice(-1)[0];var hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&(last==="."||last==="..")||last==="";var up=0;for(var i=srcPath.length;i>=0;i--){last=srcPath[i];if(last==="."){srcPath.splice(i,1)}else if(last===".."){srcPath.splice(i,1);up++}else if(up){srcPath.splice(i,1);up--}}if(!mustEndAbs&&!removeAllDots){for(;up--;up){srcPath.unshift("..")}}if(mustEndAbs&&srcPath[0]!==""&&(!srcPath[0]||srcPath[0].charAt(0)!=="/")){srcPath.unshift("")}if(hasTrailingSlash&&srcPath.join("/").substr(-1)!=="/"){srcPath.push("")}var isAbsolute=srcPath[0]===""||srcPath[0]&&srcPath[0].charAt(0)==="/";if(psychotic){result.hostname=isAbsolute?"":srcPath.length?srcPath.shift():"";result.host=result.hostname;var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):false;if(authInHost){result.auth=authInHost.shift();result.hostname=authInHost.shift();result.host=result.hostname}}mustEndAbs=mustEndAbs||result.host&&srcPath.length;if(mustEndAbs&&!isAbsolute){srcPath.unshift("")}if(srcPath.length>0){result.pathname=srcPath.join("/")}else{result.pathname=null;result.path=null}if(result.pathname!==null||result.search!==null){result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")}result.auth=relative.auth||result.auth;result.slashes=result.slashes||relative.slashes;result.href=result.format();return result};Url.prototype.parseHost=function(){var host=this.host;var port=portPattern.exec(host);if(port){port=port[0];if(port!==":"){this.port=port.substr(1)}host=host.substr(0,host.length-port.length)}if(host){this.hostname=host}};exports.parse=urlParse;exports.resolve=urlResolve;exports.resolveObject=urlResolveObject;exports.format=urlFormat;exports.Url=Url},{punycode:89,qs:435}],440:[function(require,module,exports){(function(global){(function(){module.exports=deprecate;function deprecate(fn,msg){if(config("noDeprecation")){return fn}var warned=false;function deprecated(){if(!warned){if(config("throwDeprecation")){throw new Error(msg)}else if(config("traceDeprecation")){console.trace(msg)}else{console.warn(msg)}warned=true}return fn.apply(this,arguments)}return deprecated}function config(name){try{if(!global.localStorage)return false}catch(_){return false}var val=global.localStorage[name];if(null==val)return false;return String(val).toLowerCase()==="true"}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],441:[function(require,module,exports){arguments[4][37][0].apply(exports,arguments)},{dup:37}],442:[function(require,module,exports){"use strict";var isArgumentsObject=require("is-arguments");var isGeneratorFunction=require("is-generator-function");var whichTypedArray=require("which-typed-array");var isTypedArray=require("is-typed-array");function uncurryThis(f){return f.call.bind(f)}var BigIntSupported=typeof BigInt!=="undefined";var SymbolSupported=typeof Symbol!=="undefined";var ObjectToString=uncurryThis(Object.prototype.toString);var numberValue=uncurryThis(Number.prototype.valueOf);var stringValue=uncurryThis(String.prototype.valueOf);var booleanValue=uncurryThis(Boolean.prototype.valueOf);if(BigIntSupported){var bigIntValue=uncurryThis(BigInt.prototype.valueOf)}if(SymbolSupported){var symbolValue=uncurryThis(Symbol.prototype.valueOf)}function checkBoxedPrimitive(value,prototypeValueOf){if(typeof value!=="object"){return false}try{prototypeValueOf(value);return true}catch(e){return false}}exports.isArgumentsObject=isArgumentsObject;exports.isGeneratorFunction=isGeneratorFunction;exports.isTypedArray=isTypedArray;function isPromise(input){return typeof Promise!=="undefined"&&input instanceof Promise||input!==null&&typeof input==="object"&&typeof input.then==="function"&&typeof input.catch==="function"}exports.isPromise=isPromise;function isArrayBufferView(value){if(typeof ArrayBuffer!=="undefined"&&ArrayBuffer.isView){return ArrayBuffer.isView(value)}return isTypedArray(value)||isDataView(value)}exports.isArrayBufferView=isArrayBufferView;function isUint8Array(value){return whichTypedArray(value)==="Uint8Array"}exports.isUint8Array=isUint8Array;function isUint8ClampedArray(value){return whichTypedArray(value)==="Uint8ClampedArray"}exports.isUint8ClampedArray=isUint8ClampedArray;function isUint16Array(value){return whichTypedArray(value)==="Uint16Array"}exports.isUint16Array=isUint16Array;function isUint32Array(value){return whichTypedArray(value)==="Uint32Array"}exports.isUint32Array=isUint32Array;function isInt8Array(value){return whichTypedArray(value)==="Int8Array"}exports.isInt8Array=isInt8Array;function isInt16Array(value){return whichTypedArray(value)==="Int16Array"}exports.isInt16Array=isInt16Array;function isInt32Array(value){return whichTypedArray(value)==="Int32Array"}exports.isInt32Array=isInt32Array;function isFloat32Array(value){return whichTypedArray(value)==="Float32Array"}exports.isFloat32Array=isFloat32Array;function isFloat64Array(value){return whichTypedArray(value)==="Float64Array"}exports.isFloat64Array=isFloat64Array;function isBigInt64Array(value){return whichTypedArray(value)==="BigInt64Array"}exports.isBigInt64Array=isBigInt64Array;function isBigUint64Array(value){return whichTypedArray(value)==="BigUint64Array"}exports.isBigUint64Array=isBigUint64Array;function isMapToString(value){return ObjectToString(value)==="[object Map]"}isMapToString.working=typeof Map!=="undefined"&&isMapToString(new Map);function isMap(value){if(typeof Map==="undefined"){return false}return isMapToString.working?isMapToString(value):value instanceof Map}exports.isMap=isMap;function isSetToString(value){return ObjectToString(value)==="[object Set]"}isSetToString.working=typeof Set!=="undefined"&&isSetToString(new Set);function isSet(value){if(typeof Set==="undefined"){return false}return isSetToString.working?isSetToString(value):value instanceof Set}exports.isSet=isSet;function isWeakMapToString(value){return ObjectToString(value)==="[object WeakMap]"}isWeakMapToString.working=typeof WeakMap!=="undefined"&&isWeakMapToString(new WeakMap);function isWeakMap(value){if(typeof WeakMap==="undefined"){return false}return isWeakMapToString.working?isWeakMapToString(value):value instanceof WeakMap}exports.isWeakMap=isWeakMap;function isWeakSetToString(value){return ObjectToString(value)==="[object WeakSet]"}isWeakSetToString.working=typeof WeakSet!=="undefined"&&isWeakSetToString(new WeakSet);function isWeakSet(value){return isWeakSetToString(value)}exports.isWeakSet=isWeakSet;function isArrayBufferToString(value){return ObjectToString(value)==="[object ArrayBuffer]"}isArrayBufferToString.working=typeof ArrayBuffer!=="undefined"&&isArrayBufferToString(new ArrayBuffer);function isArrayBuffer(value){if(typeof ArrayBuffer==="undefined"){return false}return isArrayBufferToString.working?isArrayBufferToString(value):value instanceof ArrayBuffer}exports.isArrayBuffer=isArrayBuffer;function isDataViewToString(value){return ObjectToString(value)==="[object DataView]"}isDataViewToString.working=typeof ArrayBuffer!=="undefined"&&typeof DataView!=="undefined"&&isDataViewToString(new DataView(new ArrayBuffer(1),0,1));function isDataView(value){if(typeof DataView==="undefined"){return false}return isDataViewToString.working?isDataViewToString(value):value instanceof DataView}exports.isDataView=isDataView;var SharedArrayBufferCopy=typeof SharedArrayBuffer!=="undefined"?SharedArrayBuffer:undefined;function isSharedArrayBufferToString(value){return ObjectToString(value)==="[object SharedArrayBuffer]"}function isSharedArrayBuffer(value){if(typeof SharedArrayBufferCopy==="undefined"){return false}if(typeof isSharedArrayBufferToString.working==="undefined"){isSharedArrayBufferToString.working=isSharedArrayBufferToString(new SharedArrayBufferCopy)}return isSharedArrayBufferToString.working?isSharedArrayBufferToString(value):value instanceof SharedArrayBufferCopy}exports.isSharedArrayBuffer=isSharedArrayBuffer;function isAsyncFunction(value){return ObjectToString(value)==="[object AsyncFunction]"}exports.isAsyncFunction=isAsyncFunction;function isMapIterator(value){return ObjectToString(value)==="[object Map Iterator]"}exports.isMapIterator=isMapIterator;function isSetIterator(value){return ObjectToString(value)==="[object Set Iterator]"}exports.isSetIterator=isSetIterator;function isGeneratorObject(value){return ObjectToString(value)==="[object Generator]"}exports.isGeneratorObject=isGeneratorObject;function isWebAssemblyCompiledModule(value){return ObjectToString(value)==="[object WebAssembly.Module]"}exports.isWebAssemblyCompiledModule=isWebAssemblyCompiledModule;function isNumberObject(value){return checkBoxedPrimitive(value,numberValue)}exports.isNumberObject=isNumberObject;function isStringObject(value){return checkBoxedPrimitive(value,stringValue)}exports.isStringObject=isStringObject;function isBooleanObject(value){return checkBoxedPrimitive(value,booleanValue)}exports.isBooleanObject=isBooleanObject;function isBigIntObject(value){return BigIntSupported&&checkBoxedPrimitive(value,bigIntValue)}exports.isBigIntObject=isBigIntObject;function isSymbolObject(value){return SymbolSupported&&checkBoxedPrimitive(value,symbolValue)}exports.isSymbolObject=isSymbolObject;function isBoxedPrimitive(value){return isNumberObject(value)||isStringObject(value)||isBooleanObject(value)||isBigIntObject(value)||isSymbolObject(value)}exports.isBoxedPrimitive=isBoxedPrimitive;function isAnyArrayBuffer(value){return typeof Uint8Array!=="undefined"&&(isArrayBuffer(value)||isSharedArrayBuffer(value))}exports.isAnyArrayBuffer=isAnyArrayBuffer;["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(method){Object.defineProperty(exports,method,{enumerable:false,value:function(){throw new Error(method+" is not supported in userland")}})}))},{"is-arguments":234,"is-generator-function":237,"is-typed-array":238,"which-typed-array":444}],443:[function(require,module,exports){(function(process){(function(){var getOwnPropertyDescriptors=Object.getOwnPropertyDescriptors||function getOwnPropertyDescriptors(obj){var keys=Object.keys(obj);var descriptors={};for(var i=0;i<keys.length;i++){descriptors[keys[i]]=Object.getOwnPropertyDescriptor(obj,keys[i])}return descriptors};var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){var objects=[];for(var i=0;i<arguments.length;i++){objects.push(inspect(arguments[i]))}return objects.join(" ")}var i=1;var args=arguments;var len=args.length;var str=String(f).replace(formatRegExp,(function(x){if(x==="%%")return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}));for(var x=args[i];i<len;x=args[++i]){if(isNull(x)||!isObject(x)){str+=" "+x}else{str+=" "+inspect(x)}}return str};exports.deprecate=function(fn,msg){if(typeof process!=="undefined"&&process.noDeprecation===true){return fn}if(typeof process==="undefined"){return function(){return exports.deprecate(fn,msg).apply(this,arguments)}}var warned=false;function deprecated(){if(!warned){if(process.throwDeprecation){throw new Error(msg)}else if(process.traceDeprecation){console.trace(msg)}else{console.error(msg)}warned=true}return fn.apply(this,arguments)}return deprecated};var debugs={};var debugEnvRegex=/^$/;if(process.env.NODE_DEBUG){var debugEnv=process.env.NODE_DEBUG;debugEnv=debugEnv.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase();debugEnvRegex=new RegExp("^"+debugEnv+"$","i")}exports.debuglog=function(set){set=set.toUpperCase();if(!debugs[set]){if(debugEnvRegex.test(set)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else{debugs[set]=function(){}}}return debugs[set]};function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};if(arguments.length>=3)ctx.depth=arguments[2];if(arguments.length>=4)ctx.colors=arguments[3];if(isBoolean(opts)){ctx.showHidden=opts}else if(opts){exports._extend(ctx,opts)}if(isUndefined(ctx.showHidden))ctx.showHidden=false;if(isUndefined(ctx.depth))ctx.depth=2;if(isUndefined(ctx.colors))ctx.colors=false;if(isUndefined(ctx.customInspect))ctx.customInspect=true;if(ctx.colors)ctx.stylize=stylizeWithColor;return formatValue(ctx,obj,ctx.depth)}exports.inspect=inspect;inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];if(style){return"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m"}else{return str}}function stylizeNoColor(str,styleType){return str}function arrayToHash(array){var hash={};array.forEach((function(val,idx){hash[val]=true}));return hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&!(value.constructor&&value.constructor.prototype===value)){var ret=value.inspect(recurseTimes,ctx);if(!isString(ret)){ret=formatValue(ctx,ret,recurseTimes)}return ret}var primitive=formatPrimitive(ctx,value);if(primitive){return primitive}var keys=Object.keys(value);var visibleKeys=arrayToHash(keys);if(ctx.showHidden){keys=Object.getOwnPropertyNames(value)}if(isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0)){return formatError(value)}if(keys.length===0){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}if(isDate(value)){return ctx.stylize(Date.prototype.toString.call(value),"date")}if(isError(value)){return formatError(value)}}var base="",array=false,braces=["{","}"];if(isArray(value)){array=true;braces=["[","]"]}if(isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)){base=" "+RegExp.prototype.toString.call(value)}if(isDate(value)){base=" "+Date.prototype.toUTCString.call(value)}if(isError(value)){base=" "+formatError(value)}if(keys.length===0&&(!array||value.length==0)){return braces[0]+base+braces[1]}if(recurseTimes<0){if(isRegExp(value)){return ctx.stylize(RegExp.prototype.toString.call(value),"regexp")}else{return ctx.stylize("[Object]","special")}}ctx.seen.push(value);var output;if(array){output=formatArray(ctx,value,recurseTimes,visibleKeys,keys)}else{output=keys.map((function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}))}ctx.seen.pop();return reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}if(isNumber(value))return ctx.stylize(""+value,"number");if(isBoolean(value))return ctx.stylize(""+value,"boolean");if(isNull(value))return ctx.stylize("null","null")}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){var output=[];for(var i=0,l=value.length;i<l;++i){if(hasOwnProperty(value,String(i))){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),true))}else{output.push("")}}keys.forEach((function(key){if(!key.match(/^\d+$/)){output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,true))}}));return output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]};if(desc.get){if(desc.set){str=ctx.stylize("[Getter/Setter]","special")}else{str=ctx.stylize("[Getter]","special")}}else{if(desc.set){str=ctx.stylize("[Setter]","special")}}if(!hasOwnProperty(visibleKeys,key)){name="["+key+"]"}if(!str){if(ctx.seen.indexOf(desc.value)<0){if(isNull(recurseTimes)){str=formatValue(ctx,desc.value,null)}else{str=formatValue(ctx,desc.value,recurseTimes-1)}if(str.indexOf("\n")>-1){if(array){str=str.split("\n").map((function(line){return"  "+line})).join("\n").slice(2)}else{str="\n"+str.split("\n").map((function(line){return"   "+line})).join("\n")}}}else{str=ctx.stylize("[Circular]","special")}}if(isUndefined(name)){if(array&&key.match(/^\d+$/)){return str}name=JSON.stringify(""+key);if(name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)){name=name.slice(1,-1);name=ctx.stylize(name,"name")}else{name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'");name=ctx.stylize(name,"string")}}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0;var length=output.reduce((function(prev,cur){numLinesEst++;if(cur.indexOf("\n")>=0)numLinesEst++;return prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(length>60){return braces[0]+(base===""?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]}return braces[0]+base+" "+output.join(", ")+" "+braces[1]}exports.types=require("./support/types");function isArray(ar){return Array.isArray(ar)}exports.isArray=isArray;function isBoolean(arg){return typeof arg==="boolean"}exports.isBoolean=isBoolean;function isNull(arg){return arg===null}exports.isNull=isNull;function isNullOrUndefined(arg){return arg==null}exports.isNullOrUndefined=isNullOrUndefined;function isNumber(arg){return typeof arg==="number"}exports.isNumber=isNumber;function isString(arg){return typeof arg==="string"}exports.isString=isString;function isSymbol(arg){return typeof arg==="symbol"}exports.isSymbol=isSymbol;function isUndefined(arg){return arg===void 0}exports.isUndefined=isUndefined;function isRegExp(re){return isObject(re)&&objectToString(re)==="[object RegExp]"}exports.isRegExp=isRegExp;exports.types.isRegExp=isRegExp;function isObject(arg){return typeof arg==="object"&&arg!==null}exports.isObject=isObject;function isDate(d){return isObject(d)&&objectToString(d)==="[object Date]"}exports.isDate=isDate;exports.types.isDate=isDate;function isError(e){return isObject(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}exports.isError=isError;exports.types.isNativeError=isError;function isFunction(arg){return typeof arg==="function"}exports.isFunction=isFunction;function isPrimitive(arg){return arg===null||typeof arg==="boolean"||typeof arg==="number"||typeof arg==="string"||typeof arg==="symbol"||typeof arg==="undefined"}exports.isPrimitive=isPrimitive;exports.isBuffer=require("./support/isBuffer");function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return n<10?"0"+n.toString(10):n.toString(10)}var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var d=new Date;var time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))};exports.inherits=require("inherits");exports._extend=function(origin,add){if(!add||!isObject(add))return origin;var keys=Object.keys(add);var i=keys.length;while(i--){origin[keys[i]]=add[keys[i]]}return origin};function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var kCustomPromisifiedSymbol=typeof Symbol!=="undefined"?Symbol("util.promisify.custom"):undefined;exports.promisify=function promisify(original){if(typeof original!=="function")throw new TypeError('The "original" argument must be of type Function');if(kCustomPromisifiedSymbol&&original[kCustomPromisifiedSymbol]){var fn=original[kCustomPromisifiedSymbol];if(typeof fn!=="function"){throw new TypeError('The "util.promisify.custom" argument must be of type Function')}Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:false,writable:false,configurable:true});return fn}function fn(){var promiseResolve,promiseReject;var promise=new Promise((function(resolve,reject){promiseResolve=resolve;promiseReject=reject}));var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i])}args.push((function(err,value){if(err){promiseReject(err)}else{promiseResolve(value)}}));try{original.apply(this,args)}catch(err){promiseReject(err)}return promise}Object.setPrototypeOf(fn,Object.getPrototypeOf(original));if(kCustomPromisifiedSymbol)Object.defineProperty(fn,kCustomPromisifiedSymbol,{value:fn,enumerable:false,writable:false,configurable:true});return Object.defineProperties(fn,getOwnPropertyDescriptors(original))};exports.promisify.custom=kCustomPromisifiedSymbol;function callbackifyOnRejected(reason,cb){if(!reason){var newReason=new Error("Promise was rejected with a falsy value");newReason.reason=reason;reason=newReason}return cb(reason)}function callbackify(original){if(typeof original!=="function"){throw new TypeError('The "original" argument must be of type Function')}function callbackified(){var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i])}var maybeCb=args.pop();if(typeof maybeCb!=="function"){throw new TypeError("The last argument must be of type Function")}var self=this;var cb=function(){return maybeCb.apply(self,arguments)};original.apply(this,args).then((function(ret){process.nextTick(cb.bind(null,null,ret))}),(function(rej){process.nextTick(callbackifyOnRejected.bind(null,rej,cb))}))}Object.setPrototypeOf(callbackified,Object.getPrototypeOf(original));Object.defineProperties(callbackified,getOwnPropertyDescriptors(original));return callbackified}exports.callbackify=callbackify}).call(this)}).call(this,require("_process"))},{"./support/isBuffer":441,"./support/types":442,_process:88,inherits:233}],444:[function(require,module,exports){(function(global){(function(){"use strict";var forEach=require("for-each");var availableTypedArrays=require("available-typed-arrays");var callBind=require("call-bind");var callBound=require("call-bind/callBound");var gOPD=require("gopd");var $toString=callBound("Object.prototype.toString");var hasToStringTag=require("has-tostringtag/shams")();var g=typeof globalThis==="undefined"?global:globalThis;var typedArrays=availableTypedArrays();var $slice=callBound("String.prototype.slice");var getPrototypeOf=Object.getPrototypeOf;var $indexOf=callBound("Array.prototype.indexOf",true)||function indexOf(array,value){for(var i=0;i<array.length;i+=1){if(array[i]===value){return i}}return-1};var cache={__proto__:null};if(hasToStringTag&&gOPD&&getPrototypeOf){forEach(typedArrays,(function(typedArray){var arr=new g[typedArray];if(Symbol.toStringTag in arr){var proto=getPrototypeOf(arr);var descriptor=gOPD(proto,Symbol.toStringTag);if(!descriptor){var superProto=getPrototypeOf(proto);descriptor=gOPD(superProto,Symbol.toStringTag)}cache["$"+typedArray]=callBind(descriptor.get)}}))}else{forEach(typedArrays,(function(typedArray){var arr=new g[typedArray];var fn=arr.slice||arr.set;if(fn){cache["$"+typedArray]=callBind(fn)}}))}var tryTypedArrays=function tryAllTypedArrays(value){var found=false;forEach(cache,(function(getter,typedArray){if(!found){try{if("$"+getter(value)===typedArray){found=$slice(typedArray,1)}}catch(e){}}}));return found};var trySlices=function tryAllSlices(value){var found=false;forEach(cache,(function(getter,name){if(!found){try{getter(value);found=$slice(name,1)}catch(e){}}}));return found};module.exports=function whichTypedArray(value){if(!value||typeof value!=="object"){return false}if(!hasToStringTag){var tag=$slice($toString(value),8,-1);if($indexOf(typedArrays,tag)>-1){return tag}if(tag!=="Object"){return false}return trySlices(value)}if(!gOPD){return null}return tryTypedArrays(value)}}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"available-typed-arrays":39,"call-bind":93,"call-bind/callBound":92,"for-each":189,gopd:193,"has-tostringtag/shams":198}],445:[function(require,module,exports){module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){var target={};for(var i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target}},{}]},{},[6])(6)}));